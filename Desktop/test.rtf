{\rtf1\ansi\ansicpg1252\cocoartf2638
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\fswiss\fcharset0 ArialMT;\f1\fswiss\fcharset0 Helvetica;\f2\fswiss\fcharset0 Arial-BoldMT;
\f3\fswiss\fcharset0 Helvetica-Bold;\f4\fnil\fcharset134 PingFangSC-Regular;\f5\fnil\fcharset77 KohinoorDevanagari-Regular;
}
{\colortbl;\red255\green255\blue255;\red0\green0\blue0;\red24\green25\blue27;\red24\green25\blue27;
\red146\green146\blue146;\red29\green38\blue42;\red255\green255\blue255;\red77\green77\blue77;}
{\*\expandedcolortbl;;\cssrgb\c0\c0\c0;\cssrgb\c12549\c12941\c14118;\cssrgb\c12549\c12941\c14118\c3922;
\cssrgb\c63922\c63922\c63922;\cssrgb\c14902\c19608\c21961;\cssrgb\c100000\c100000\c100000;\cssrgb\c37647\c37647\c37647;}
\paperw11900\paperh16840\margl1440\margr1440\vieww25400\viewh12620\viewkind0
\deftab720
\pard\pardeftab720\sl276\slmult1\partightenfactor0

\f0\fs22 \cf2 \
\
\
\
Host *\
  AddKeysToAgent yes\
  IdentityFile ~/.ssh/id_ed25519\
  IgnoreUnknown UseKeychain\
\
Tester: 
\f1\fs28 \cf3 \cb4 \expnd0\expndtw0\kerning0
7982334114 /  123456\

\f0\fs22 \cf2 \cb1 \kerning1\expnd0\expndtw0 \
\
DSP:  
\f2\b Rashi/Navyug 
\f0\b0 9791021814 / rashi111\
 \
DSP: 
\f2\b Rohit/RK Sports 
\f0\b0 8295670125/qwerty P:qwert123\
 \
P
\f2\b : AnujBuyerMy 
\f0\b0 9899332889/12345678\
P: 9416380053/anuj123\
 \
DSP
\f2\b : Shikha 
\f0\b0 9540325165/12345678\
 \
P: 
\f2\b Mayank 
\f0\b0 6597862277/123456789\
 \
\pard\pardeftab720\li540\sl276\slmult1\partightenfactor0
\cf2 DSP: 
\f2\b Raunak 
\f0\b0 9953068044/Raunak@98\
\
DSP: 
\f2\b Cornet/Rani Katiyar
\f0\b0  - 9999150402/0987654321\
\
P: 
\f2\b Shivang Sood 
\f0\b0 9882703210/0000\
\pard\pardeftab720\sl276\slmult1\partightenfactor0
\cf2  \
P: 
\f2\b Shantanu\
\
\
\
Check user agent\
Sending and contact\

\f0\b0  \

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrt\brdrnil \trbrdrl\brdrnil \trbrdrt\brdrnil \trbrdrr\brdrnil 
\clvertalt \clshdrawnil \clwWidth1260\clftsWidth3 \clheight500 \clbrdrt\brdrs\brdrw20\brdrcf5 \clbrdrl\brdrs\brdrw20\brdrcf5 \clbrdrb\brdrs\brdrw20\brdrcf5 \clbrdrr\brdrs\brdrw20\brdrcf5 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx4320
\clvertalt \clshdrawnil \clwWidth2380\clftsWidth3 \clheight500 \clbrdrt\brdrs\brdrw20\brdrcf5 \clbrdrl\brdrs\brdrw20\brdrcf5 \clbrdrb\brdrs\brdrw20\brdrcf5 \clbrdrr\brdrs\brdrw20\brdrcf5 \clpadt80 \clpadl80 \clpadb80 \clpadr80 \gaph\cellx8640
\pard\intbl\itap1\pardeftab720\sl276\slmult1\partightenfactor0
\cf2 P: 
\f2\b Anchit -
\f1\b0\fs24 \cf0 \cell 
\pard\intbl\itap1\pardeftab720\sl276\slmult1\partightenfactor0

\f0\fs22 \cf2 8077386785 / aj@anchit\cell \lastrow\row
\pard\pardeftab720\sl276\slmult1\partightenfactor0
\cf2  \
\pard\pardeftab720\sl276\slmult1\partightenfactor0

\fs36 \cf2 P [Foreign User] : 
\f1 majormaster23@gmail.com
\f0  / qwerty123\
P:[Foreign User]  :
\f1 ayadav192@student.solbridge.ac.kr\cf6  / anuj123\
\
P:  
\f3\b Hitesh 
\f0\b0 \cf2 8860898362 / 123456\
 \
P: 
\f2\b Dipesh 
\f0\b0 8700390552 / dipeshpack5\
\
DSP: 
\f2\b Vibhor 
\f0\b0 7838162794 /adminthe\
 \
DSP: 
\f2\b Mahi Toys 
\f0\b0 9582944261\
 \
DSP: 
\f2\b Global Lift Pvt. Ltd. 
\f0\b0\fs26 \cf3 \cb7 \expnd0\expndtw0\kerning0
9127333629
\fs36 \cf2 \cb1 \kerning1\expnd0\expndtw0 / theadmin\
 \
DSP: 
\f2\b Imagine Great India / Mohit 
\f0\b0 9660264489 /\
qwerty321\
 (Works on dev-seller)\
 \
P: 
\f2\b Bikram 
\f0\b0  7082826147/imtester\
\
P: 
\f2\b Yash
\f0\b0  / yash@123789\
 \
P: 
\f2\b Rachit\
\pard\pardeftab720\sl276\slmult1\partightenfactor0
\cf8 \cb7 7317591202 / lms202050\
\
P: Saransh\
\pard\pardeftab720\sl276\slmult1\partightenfactor0

\f0\b0 \cf2 \cb1 8048371699 / zxcvbnm2\
 \
Dev 1112223334\
\pard\pardeftab720\partightenfactor0
\cf3 \cb7 \expnd0\expndtw0\kerning0
\
\
\
/*! Copyright (c) 2011 Piotr Rochala (http://rocha.la)\
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)\
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.\
 *\
 * Version: 1.3.8\
 *\
 */\
\
\
//myFunc();// to verify popup\
var amtvalid = 0;\
\
var prdvalid = 0;\
var saved_template_code = null;\
var mltemplateused = 0;\
var comname =""; \
var pphone_no = "";\
var pemail = "";\
var pname ="";\
var Comp_url1 = '';\
let cataloglnk ='';\
let position_flag = null; // position number of the suggestive reply template that the user clicks\
(function(e) \{\
	e.fn.extend(\{\
		slimScroll: function(f) \{\
			var a = e.extend(\{\
				width: "auto",\
				height: "450px",\
				size: "7px",\
				color: "#000",\
				position: "right",\
				distance: "1px",\
				start: "top",\
				opacity: .4,\
				alwaysVisible: !1,\
				disableFadeOut: !1,\
				railVisible: !1,\
				railColor: "#333",\
				railOpacity: .2,\
				railDraggable: !0,\
				railClass: "slimScrollRail",\
				barClass: "slimScrollBar",\
				wrapperClass: "slimScrollDiv",\
				allowPageScroll: !1,\
				wheelStep: 20,\
				touchScrollStep: 200,\
				borderRadius: "7px",\
				railBorderRadius: "7px"\
			\}, f);\
			this.each(function() \{\
				function v(d) \{\
					if(r) \{\
						d = d || window.event;\
						var c = 0;\
						d.wheelDelta && (c = -d.wheelDelta / 120);\
						d.detail && (c = d.detail / 3);\
						e(d.target || d.srcTarget || d.srcElement).closest("." + a.wrapperClass).is(b.parent()) && n(c, !0);\
						d.preventDefault && !k && d.preventDefault();\
						k || (d.returnValue = !1)\
					\}\
				\}\
\
				function n(d, g, e) \{\
					k = !1;\
					var f = b.outerHeight() - c.outerHeight();\
					g && (g = parseInt(c.css("top")) + d * parseInt(a.wheelStep) / 100 * c.outerHeight(), g = Math.min(Math.max(g, 0), f), g = 0 < d ? Math.ceil(g) : Math.floor(g), c.css(\{\
						top: g + "px"\
					\}));\
					l = parseInt(c.css("top")) / (b.outerHeight() - c.outerHeight());\
					g = l * (b[0].scrollHeight - b.outerHeight());\
					e && (g = d, d = g / b[0].scrollHeight * b.outerHeight(), d = Math.min(Math.max(d, 0), f), c.css(\{\
						top: d + "px"\
					\}));\
					b.scrollTop(g);\
					b.trigger("slimscrolling", ~~g);\
					w();\
					p()\
				\}\
\
				function x() \{\
					u = Math.max(b.outerHeight() / b[0].scrollHeight * b.outerHeight(), 30);\
					c.css(\{\
						height: u + "px"\
					\});\
					var a = u == b.outerHeight() ? "none" : "block";\
					c.css(\{\
						display: a\
					\})\
				\}\
\
				function w() \{\
					x();\
					clearTimeout(B);\
					l == ~~l ? (k = a.allowPageScroll, C != l && b.trigger("slimscroll", 0 == ~~l ? "top" : "bottom")) : k = !1;\
					C = l;\
					u >= b.outerHeight() ? k = !0 : (c.stop(!0, !0).fadeIn("fast"), a.railVisible && m.stop(!0, !0).fadeIn("fast"))\
				\}\
\
				function p() \{\
					a.alwaysVisible || (B = setTimeout(function() \{\
						a.disableFadeOut && r || y || z || (c.fadeOut("slow"), m.fadeOut("slow"))\
					\}, 1E3))\
				\}\
				var r, y, z, B, A, u, l, C, k = !1,\
					b = e(this);\
				if(b.parent().hasClass(a.wrapperClass)) \{\
					var q = b.scrollTop(),\
						c = b.siblings("." + a.barClass),\
						m = b.siblings("." + a.railClass);\
					x();\
					if(e.isPlainObject(f)) \{\
						if("height" in f && "auto" == f.height) \{\
							b.parent().css("height", "auto");\
							b.css("height", "auto");\
							var h = b.parent().parent().height();\
							b.parent().css("height", h);\
							b.css("height", h)\
						\} else "height" in f && (h = f.height, b.parent().css("height", h), b.css("height", h));\
						if("scrollTo" in f) q = parseInt(a.scrollTo);\
						else if("scrollBy" in f) q += parseInt(a.scrollBy);\
						else if("destroy" in f) \{\
							c.remove();\
							m.remove();\
							b.unwrap();\
							return\
						\}\
						n(q, !1, !0)\
					\}\
				\} else if(!(e.isPlainObject(f) && "destroy" in f)) \{\
					a.height = "auto" == a.height ? b.parent().height() : a.height;\
					q = e("<div></div>").addClass(a.wrapperClass).css(\{\
						position: "relative",\
						overflow: "hidden",\
						width: a.width,\
						height: a.height\
					\});\
					b.css(\{\
						overflow: "hidden",\
						width: a.width,\
						height: a.height\
					\});\
					var m = e("<div></div>").addClass(a.railClass).css(\{\
							width: a.size,\
							height: "100%",\
							position: "absolute",\
							top: 0,\
							display: a.alwaysVisible && a.railVisible ? "block" : "none",\
							"border-radius": a.railBorderRadius,\
							background: a.railColor,\
							opacity: a.railOpacity,\
							zIndex: 90\
						\}),\
						c = e("<div></div>").addClass(a.barClass).css(\{\
							background: a.color,\
							width: a.size,\
							position: "absolute",\
							top: 0,\
							opacity: a.opacity,\
							display: a.alwaysVisible ? "block" : "none",\
							"border-radius": a.borderRadius,\
							BorderRadius: a.borderRadius,\
							MozBorderRadius: a.borderRadius,\
							WebkitBorderRadius: a.borderRadius,\
							zIndex: 99\
						\}),\
						h = "right" == a.position ? \{\
							right: a.distance\
						\} : \{\
							left: a.distance\
						\};\
					m.css(h);\
					c.css(h);\
					b.wrap(q);\
					b.parent().append(c);\
					b.parent().append(m);\
					a.railDraggable && c.bind("mousedown", function(a) \{\
						var b = e(document);\
						z = !0;\
						t = parseFloat(c.css("top"));\
						pageY = a.pageY;\
						b.bind("mousemove.slimscroll", function(a) \{\
							currTop = t + a.pageY - pageY;\
							c.css("top", currTop);\
							n(0, c.position().top, !1)\
						\});\
						b.bind("mouseup.slimscroll", function(a) \{\
							z = !1;\
							p();\
							b.unbind(".slimscroll")\
						\});\
						return !1\
					\}).bind("selectstart.slimscroll", function(a) \{\
						a.stopPropagation();\
						a.preventDefault();\
						return !1\
					\});\
					m.hover(function() \{\
						w()\
					\}, function() \{\
						p()\
					\});\
					c.hover(function() \{\
						y = !0\
					\}, function() \{\
						y = !1\
					\});\
					b.hover(function() \{\
						r = !0;\
						w();\
						p()\
					\}, function() \{\
						r = !1;\
						p()\
					\});\
					b.bind("touchstart", function(a, b) \{\
						a.originalEvent.touches.length && (A = a.originalEvent.touches[0].pageY)\
					\});\
					b.bind("touchmove", function(b) \{\
						k || b.originalEvent.preventDefault();\
						b.originalEvent.touches.length && (n((A - b.originalEvent.touches[0].pageY) / a.touchScrollStep, !0), A = b.originalEvent.touches[0].pageY)\
					\});\
					x();\
					"bottom" === a.start ? (c.css(\{\
						top: b.outerHeight() - c.outerHeight()\
					\}), n(0, !0)) : "top" !== a.start && (n(e(a.start).position().top, null, !0), a.alwaysVisible || c.hide());\
					window.addEventListener ? (this.addEventListener("DOMMouseScroll", v, !1), this.addEventListener("mousewheel", v, !1)) : document.attachEvent("onmousewheel", v)\
				\}\
			\});\
			return this\
		\}\
	\});\
	e.fn.extend(\{\
		slimscroll: e.fn.slimScroll\
	\})\
\})(jQuery);\
var list = \{\};\
var showUnreadLeadsFlag = true;\
var disabled_send_reply = false;\
var mr = 0;\
var search_paused = false;\
var ATTACH_FILE_NAME_ARR = [];\
var ATTACH_FILE_ARR = [];\
var ATTACH_FILE_COUNTER = 0;\
var ATTACH_IFRAME = "<i class='fa fa-angle-left' id='attach_left_navigate' onclick='navigatePreview(\\"next\\")'></i>" + "<iframe id='attach_preview' current_idx='0' src='' type='application/pdf' width='80%' height='100%' style='overflow: auto;z-index: 3;border: none;'></iframe>" + "<i class='fa fa-angle-right' id='attach_right_navigate' onclick='navigatePreview(\\"prev\\")'></i>";\
var EXCEL_ICN = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAZ3SURBVHhe7Z1bbFRFGMfxxUefffcN00oLbfCCtwcVitpoatRoSBqJLxqjIpH0hgVpRIMEQSMBUWMAuZSLQUQlMVCjCNRQqUGipVYQsECptNL7cWfzDe75zn+6Zwe/yQDzS34hbc8M5/sBp7t7yHZCIBAIBAKBQCAQCAQCgUAgcAVx3c01pTcV1U+uKqotaSqqK91ZXFtykr4W+D+Z2DDx+qKG0tJM4OpM6GWZX/dkovcW15VGXFoSsKW8ofyGTORpxTUlz2d+XZ2JfbC4tnQQxUbSNoE0TGwouzET+oHiusmvZkJvKK4r+TUTcYxHLUTaOsCA12sU8HKl3+/apZDrtYR0GtcGl3u9lpBO7epD4notIZ3u1Qca1kdnbql0a3Pl8YotD8+gTHKgYX0URhK2ormyizLJgYb1URTIhZRJDjSsj6I4LqRMcqBhfRTFcSFlkgMN66MojgspkxxoWB9FcVxImeRAw/ooiuNCyiQHGtZHURwXUiY50LA+iuK4kDLJgYb1URM8mC18Hy1lkgMN66MmeDBb+D5ayiQHGtZHTfBgtvB9tJRJDjSsj5rgwWzh+2gpkxxo2FwfeacqGhkdodNMsmTXUrgu11vqJ0dtf/xEK+KMjo1GT77/NFyXqwkezBa+j5YyyYGG5a79fj2dZpLuv7ujssZb4Trty+vn0tFJNu7fDNdwTfBgtvB9tJRJDjQs986me6Ke/vN0qkkWfrYIrlOWNJRFHd3H6Mg4Pf092b3ROi6K40LKJAcaFqkimzjRcyIbGq1r3LaQjkoyf2sjXINEcVxImeRAwyInNUyJjpw8QumS1GyuT6wpb7wtOt17mo6Ic6irLfu9ga8xieK4kDLJgYY1Wf3BbMqX5Le/OqJJ9VNixy/9chl9Nc7o6GhUteKJ2LH5RHFcSJnkQMOO567DX1HGJC+um3PpuGmL7o56/+mlr8RZ+9262J5pNMGD2cL30VImOdCw43n/WzOii0MX6bTjtJ/4+dJxa/Z+RJ+N033hTHT763fF9kyjCR7MFr6PljLJgYbN5/Ld79JpJ3lmzbPZv/0DQwP0mTjzNtXCPfNpggezhe+jpUxyoGHzqR73/3n+JJ16nK2t26MF2/EjpgPHDhb0jTdXEzyYLXwfLWWSAw2bxjmGJ1d9A33R4ePt9NF/DI8MZ59Vo73SaIIHs4Xvo6VMcqBh0/pDx346/fx82PIx3COtJngwW/g+WsokBxo2rfleJ9Ko5wJTF9wB90griuNCyiQHGrYQ1+/bQJnNzN0wD64tRBTHhZRJDjRsIW460EyZzazY/R5cW4gojgspkxxo2LRWr54djY2NUWYzA8ODUcXbD8E90oriuJAyyYGGTWPZa1OjzjOdlDg/e4+2wH3SaoIHs4Xvo6VMcqBh07jym1V06nF2tn0R9Q/200dxXlr3CtwrjSZ4MFv4PlrKJAcaNp+PLn8s+7ge8dwnL0Rft++mj+Kc6j1l/WjIBA9mC99HS5nkQMOOp3pZWr2UjFA3XtR9gVmrqukzSWyfD5jgwWzh+2gpkxxo2PFs2rGYTjlJ7iVmzy976bNx1PMG9S8od880muDBbOH7aCmTHGhYk+qVUNP1Xd10z32dp2rF49kb7ojWzh8Lfk3IBA9mC99HS5nkQMOaNP2tVqibNfz4HYd20leT1DfPTxw/niiOCymTHGhYpHo2a6Ll6LdwjXrsb/pmfa7vXOob8koUx4WUSQ40LFe9vn+27yyli6MuM+pyg9YpP923kY5Mkva/pChRHBdSJjnQsNwtrdsoWRJ1mUFrtPcuvs94B0394T21chZcx0VxXEiZ5EDD5qrucJlebhgaGYqmL3kQrst19Z41tCKJ+p8W6qEtWperCR7MFr6PljLJgYbVqjtfv5/tolNMkvbmurqEXbh4gVYleePzN+G6XE3wYLbwfbSUSQ40rI+a4MFs4ftoKZMcaFgfNcGD2cL30VImOdCwPmqCB7OF76OlTHKgYX3UBA9mC99HS5nkQMP6KIrjQsokBxrWR1EcF1ImOdCwPoriuJAyyYGG9VEUx4WUSQ40rI+iOC6kTHKgYX0UxXEhZZIDDeujKI4LKZMcaFgfRXFcSJnkQMP6KIojbXjTvhxRIElV/JnNldMpkxzhjVs9JLx1sYeEN+/2k/D29T4SfoCDh4QfYeIh4Yf4+En4MVaBQCAQCAQCgUAgEAgEAoErgAkT/gVZ4uX8GbSTVQAAAABJRU5ErkJggg==';\
var PPT_ICN = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAARhSURBVHhe7ZfLq1VlGMa3SAgOnAg1MAfSJAdOxP+gSTZoEE6aORIS0yMiiJQpWEE5KksQBQeCFAgiOFBQvEA0UAQJoosgaje6mTdSotez4NmstZ/1uC5O3m+t9/vBb+L3fvs863nPce89yWQymUwmk8k8C/b2xIbk/5sm7yH6OFAPmbqjWoJ6wCE4miWoh0vSE3O1fxvFEvihkvXejXEugR8oWYsFjHEJ/DDJOl3A2JbAD5Ks1QWMaQn8EMnKCxjLEvgBklUtoHDoS+DwyarKnzrkJXDwZFXFVx3qEjh0sqrS2SEugQMnqypcObQlcNhkVWU/zSEtgYMmqyq6yaEsgUMmqyq5zSEsgQMmqyq4i6kvgcMlqyq3qykvgYMlqyq2j6kugUMlqyq1r2IJqMEPDpSsqtBnkZaAGvyohokoavBDhYokavBDhYokavBDhYokavBDhYokavBDhYokavBDhYokavBDhYokavBDhYokavBDhYokavBDhYokavBDhYokavBDhYokavBDhYokavBDhYokavBDhYokavBDhYokavBDhYokavBDhZI28e9ds9tXzU7vNdv5gr7/4SoMP4UHf5pdv2R2fM5s2+L6/Z+uYbAn/DokavBDhZJ25eEdswOv1e+3LaDK7z+a7V05ez8voAePHph9tHr2fp8FFPx102zH0vJ+XgBxbEPp6ffN7v6GA/D9udn7vIA7t8v7X7xlduETs/8e4RCc3VfeP7xu9mcWMnxeWM0gRA1+qFBShs8/fxUHFd5ZVp7zAorf6Or9wlO7cAj++cVs84L63FRGzbSIGvxQoaQMnxdFFW+kVQ6+Xp53WcDuFTis8O6L9bmpjJppETX4oUJJGTXz8zc4BEfXl2ddFrB1EQ4rFPd4biqjZlpEDX6oUFJGzfD7wKE3yrMuC9i1HIcVir8KnpvKqJkWUYMfKpSU4fNPX8FBhT0vleddFnByBw5B8V/aloX1uamMmmkRNfihQkmZ6ieNMx/Uf/tvfD17nxfAn4Iu7q9/Crr42exrsIyaaRE1+KFCSfvw+KHZx2tm7/MC2vj71vy36udnX4Nl1EyLqMEPFUralft/zH8TXlu/32cBv347/0345fprsIyaaRE1+KFCSZmbl0t/OG925ZjZlxvNti/R93kBxV9J9TW+O2v21SGzI2+azT2nX4Nl1EyLqMEPFUrKqJkmu7wJ95VRMy2iBj9UKCmjZprMC9CoUFJGzTSZF6BRoaSMmmkyL0CjQkkZNdNkXoBGhZIyaqbJvACNCiVl1EyTeQEaFSqSqMEPFSqSqMEPFSqSqMEPFSqSqMEPFSqSqMEPFSqSqMEPFSqSqMEPFSqSqMEPFSqSqMEPFSqSqMEPFSqSqMEPFSqSqMEPFSqSqMEPFSqSqMEPFSqSqMEPFSqSqMEPFSqSqMEPFSqSqMEPFSqSqMEPFSqSqMEPFSqSqMEPFSqSqMEPFSqSqMEPFSqSqCGTyWQymUwm04PJ5Am2vob6LVnpfgAAAABJRU5ErkJggg==';\
var DOC_ICN = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAXTSURBVHhe7Zrba1xVFMbzZ3h/0AcVlIIgKIKIL+KDqCA+qA9eqA8KgiC10tJWpWJLK7bY1luhNVaqolSRaktqRLFKpYhJkyZNm0ybmkmn01zGJJMJyHHWZJ3kzNrf2J4LrH1m7w9+L3PWyXznW2fO2Zd0eHl5eXl5eXl5JdHVq3qCPHHVqp71bL09hC7SdtqqCegC80DbNAFdnI2s+65ofNYWTZAXZSujlX/bswnygmyFGtCWTZAXYythA9quCfJCbCXagLZqgrwIW5ENaJsmyAuwFdQAIvdNkOZtBYUfkusmSOO2goKPktsmSNO2gkKX5LIJ0rCtoMARuWuCNGsrKOxW5KoJ0qitoKD/j9w0QZq0FRTy5chFE6RBW0EBXwnWN0GasxUU7pVidROkMVtBwcbB2iZIU7aCQo0LagLHoCdpyFZQoEmQTeAY9BQ14yIcg56QKZfgGPSETLkEx6AnZMolOAY9IVMuwTHoCZlyCY5BT8iUS3AMekKmXIJj0BMy5RIcg56QKZfgGPSETLkEx6AnZMolOAY9IVMuwTHoCZlyCY5BT8iUS3AMekKmXIJj0BMyFYddP40He34tGdyxsR/WP/HxsFG7rcvcqQpZe+C8UU88tGMI1seFY9ATMhWHo0PTwcLCgsFze0dg/VfHy0ZtrbYQ3LqhD9afuTBr1BMPbvcNaLCjexwGtPXwGKwfLuFA6Zcha29e19dojqydrdaCG17rNeqTwDHoCZmKw8rOESMg4vveCaN2xZv9sJbY/IPZsId3noa1x4anjdqkcAx6QqbicOdbJ2FIhYtzRu3Te4ZhLXGkf9KoX/31KKz96OcLRm1SOAY9IVNxKU7OwaBuWd/8XN9+pAjriHKlGlz7avPf3Xu0BGtf/KzQVJcGjkFPyFRc6HGDgnp01+mmuu6BSVgXct/WwaZ6etSguns2DzTVpYFj0BMyFZdN9ec3CmpNfQgZ1ly3ujeYnJmHdSGvfHmuqX4K1Jenq8E14peSBo5BT8hUXB7/8IwRFNH528WlmvvfGYQ1Ufb9vlxPdzmqQe+KNHAMekKm4kJjeDRcPF6oLNXQ3S2PSwbGZpbqV36CR1dbDuHhbVI4Bj0hU0mg8GRYldn5xqOEjtPdLY9LohMymkegmqd2m/OFNHAMekKmkvD5H+YMl7h3y+ILEzVoHIyewgnZwR78Yqe5RPR708Ix6AmZSkKrMfvznQX4iCpNVRvrSNHPiHBCdrY+j5DHRkrm3CItHIOekKkk0NqMDIx4t6vYuKvl5zR0fQZMzOglSw2TnxMH/rwEvzsNHIOekKkk0NrMzFzNCO3QiYnGXS0/33hwLLj9DXNp4lJlPnjsAzyq2vDt8rA2KzgGPSFTSUETp9HyXNDVZ07AHtm5OEkbLJrvhlYv7PCcLOEY9IRMJeV98Ewn5ISKVjNvXHOicc6n9blC9BiBJmDV+Vpw09rFc7KEY9ATMpWUF/YVjOAQ9EsJz3lp/1lYI/nr3D9N35UVHIOekKmk3PU2XhmV0B5CeM7dm/CMVxKdVWcJx6AnZCoptEZDw0sUYJRnxW7Z3xN4NTXKy18srxNlCcegJ2QqDYfrox4UYBQ5mfqmPrxEdVFoLSl6TlZwDHpCptKAhpxRhsZnjXNo4x3VhtBLOVzSyBqOQU/IVBqe3G1OrqLsP1Y2znlg2ylYG/LLqSnjnKzgGPSETKXhttdb7/sS0TX/kOsvs1fw3o/LL+2s4Rj0hEylhR4zKEhC7nqFdJ9svVvW6l9csoBj0BMylRb0vz8E7WbJfd+QVrtqBG38o3OygGPQEzLlEhyDnpApl+AY9IRMuQTHoCdkyiU4Bj0hUy7BMegJmXIJjkFPyJRLcAx6QqZcgmPQEzLlEhyDnpApl+AY9IRMuQTHoCdkyiU4Bj0hUy7BMegJmXIJjkFPyJRLcAx6QqZcgmPQEzLlEhyDnpApl+AY9IRMuQTHoCdkyiU4Bi8vLy8vLy8vrxjq6PgPzAIMVkA4H6kAAAAASUVORK5CYII=';\
var TXT_ICN = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAALJSURBVHhe7ZVBihRBFAX7Gl7UrVfwOJ7BpReQOcSAgjgy8AaazlDzD1W8n/UyIDa9qZfxF33bbDabzWaz2byHz19/vqzlj0+afg34kd290BH4gSt4kSPw4/r55fsv+P0CRxgf1dOn59/XPML4oJ6+HuCSRxgf09O3A1zuCONDenp/gEsdYXxETx8PcJkjjA/oKR3g1eWPMI7vKcV/c+kjjMN7SuHvXfYI4+ieUvRHlzzCOLinFJxc7gjj2J5S7L+51BHGoT2l0P9ymSOMI3tKkf/nEkcYB/aUAs/Y/gjjuJ5S3FlbH2Ec1lMKW7HtEcZRPaWoVekIyuDjcVBXKeh7fDyCMvi4H5OoMvigUUkqgw8alaQy+KBRSSqDDxqVpDL4oFFJKoMPGpWkMvigUUkqgw8alaQy+KBRSSqDDxqVpDL4oFFJKoMPGpWkMvigUUkqgw8aVfHDx28tpG0zKoMPGlWRYjikbTMqgw8aVZFiOKRtMyqDDxpVkWI4pG0zKoMPGpWkMvigUUkqgw8alaQy+KBRSSqDDxpVkf4Qz5C+fYTK4INGVaRYZ0jfPkJl8EGjKlKsM6RvH6Ey+KBRFSnWGdK3j1AZfNCoJJXBB41KUhl80KgklcEHjUpSGXzQqIr0h+mQts2oDD5oVEWK4ZC2zagMPmhURYrhkLbNqAw+aFRFiuGQts2oDD5oVJLK4INGJakMPmhUksrgg0YlqQw+aFRF+kM8Q/r2ESqDDxpVkWKdIX37CJXBB42qSLHOkL59hMrgg0ZVpFhnSN8+QmXwQaOSVAYfNCpJZfBBo5JUBh80Kkll8EGjklQGHzQqSWXwQaOSVAYfNCpJZfBBo5JUBh80Kkll8EGjklQGHzQqSWXwQaOSVAYfNCpJZfBBo5JUBh80Kkll8EGjklQGHzQqSWXwQaOSVAYfNCpJZdhsNpvNZrPZFLjd/gDpGNILnJriKAAAAABJRU5ErkJggg==';\
var PDF_ICN = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAASFSURBVHhe7Znbbw1RFMb7t7jEo4T4A/Aq8YTiQRAePFCCeGiibiEkLlEhLk2lIYg04lL3xJ24BOEBQUmIu39AWM7OWZOZvc4350wbtfbM2l/ye+na6/Sb72s7c07boqKioqKioqKihiOaNYrKxJ+Zo9ay9WoIXWToVKoEdIFloDIloIsLkd+9Gxu+VokS5EWFyq8vn6pZgrygUHEFVLIEeTGhkhRQuRLkhYRKtoBKlSAvIlRkAZUpQV5AqKACHKUvQZoPFRR+QqlLkMZDBQWfpbQlSNOhgkKXlLIEaThUUOCI0pUgzYYKCjuPUpUgjYYKCroZpSlBmgwVFHIrSlGCNBgqKOAiBF+CNBcqKNyiBF2CNBYqKNihEGwJ0lSooFCHCiqBY9CTNBQqKNDhIEvgGPSUNWMRjkFPyJQlOAY9IVOW4Bj0hExZgmPQEzJlCY5BT8iUJTgGPSFTluAY9IRMWYJj0BMyZQmOQU/IlCU4Bj0hU5bgGPSETFmCY9ATMmUJjkFPyJQlOAY9IVOW4Bj0hExZgmPQEzJlCY5BT8iUJTgGPSFTuezsIHr/DvP6JdHju0T9B4hWT8P7+zob9wYHiZ4/Jrp9kahnA9GiSXjXcepQ434emxfh1xBwDHpCpnLpXk307Wdrvv4gOrmXaPZYf//Qenw+y4ePRHvW+HsJ54/iHcS2Jfg1BByDnpCpXIoWkHBsl79fpICEnk3+riMWIAq4f53o4Lo6vZuJHt3y51+/Ey2dku7LAu5cru8e3kJ094o/+/KNaM10//vLAi4cS7+/pGOqv5sDx6AnZCoXWUD/fn8+dxzRQ1HC0R3pXBZwZLu/L+fXz/pzWUDBn/JmcAx6QqZyaVWAY/sy/8ztS+msVQFzavcMd1NO5u63YP74dB4LKFBA5wz/zNP76axVAY4bA/6ZrrnpLBZQoIBN8/0zD26msyIFnOvzz+xcns5iAQUKGDjinznTm86KFHCi2z9zsCudFb0Jd83xX7MJHIOekKlcZAHuz8WWxXV21N6kXTzuzx0b5qX7RQpwX8uecTvJTBaQB/rByIFj0BMylYssoBU3LxC1j073YwGNQqZyGUoB964SLZjg7w+ngGZ/ggZfE7141kjfVv81m8Ax6AmZyqVZAZ9rj4xva4FcO12/ObpHSrlfpIDTtXtG9syuFeks3oQL3ISbUaQA+Ri6sfZUlcxiASNcQPsYojev/DMLJ6bzWMAIF9C9yp+7z4ey81jAPy7gSn/9EXb3yvozvfvwLjvPvgt2xAL+cQHNcP9PkPuxgP9QgHua6tvmv39IiAWMUAHvBome3Kt/DLF0Mt51mC+ggnAMekKmLMEx6AmZsgTHoCdkyhIcg56QKUtwDHpCpizBMegJmbIEx6AnZMoSHIOekClLcAx6QqYswTHoCZmyBMegJ2TKEhyDnpApS3AMekKmLMEx6AmZsgTHoCdkyhIcg56QKUtwDHpCpizBMegJmbIEx6AnZMoSHIOekClLcAx6QqYswTHoCZmyBMegJ2TKEhxDVFRUVFRUVFTUENTW9heitENzHeQHbgAAAABJRU5ErkJggg==';\
var TICK = '<svg viewBox="0 0 16 15" width="16" height="15" style="margin-bottom: -4px; margin-right: 4px;"><path fill="CUSTOM_COLOR" d="M15.01 3.316l-.478-.372a.365.365 0 0 0-.51.063L8.666 9.879a.32.32 0 0 1-.484.033l-.358-.325a.319.319 0 0 0-.484.032l-.378.483a.418.418 0 0 0 .036.541l1.32 1.266c.143.14.361.125.484-.033l6.272-8.048a.366.366 0 0 0-.064-.512zm-4.1 0l-.478-.372a.365.365 0 0 0-.51.063L4.566 9.879a.32.32 0 0 1-.484.033L1.891 7.769a.366.366 0 0 0-.515.006l-.423.433a.364.364 0 0 0 .006.514l3.258 3.185c.143.14.361.125.484-.033l6.272-8.048a.365.365 0 0 0-.063-.51z"></path></svg>';\
var CROSS_ICN = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAADcSURBVDhP1ZJJDoJAFAWJS8/gxsQruFNv5RTuoh7E4UQuXZgY2vr4GiEg3eBGK3kB/lBhSv4L59yMDHQZhNlhlmVTXVahMScPsouRSnYhNzJS+Y1JJHMhqZfZLGxUrkMzKKUWJ/Mw9FHKeTeZh+GalJjsbDWIl3lYKqRw+ErmYdmk+5cnv9tUrX7gKD9m8Ou3wmIh47iVrJ+UBZOdTAD5O+MY/KUaYdBkRy2uVc4xSScpA2XZSuUKJomS0gjKPCYJSmksyJ0sVWrFS8mVjFWuQmOi0ygkbZb9KEnyBNkeoTVSzi/YAAAAAElFTkSuQmCC'\
var CROSS_ICN_BLACK = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAACgSURBVDhP1ZQxDsIwEAQtytRQUNCTF8AD4PGQKhIPyq6tk5zIHGu7ISOtdNeMbJ/OYVeckWsqq7ghQyrXUDYjY+w0nsgLOcauAGWq1GSn2Dko0gciyQxPStkbkWVGSdosM3Jpt8yg7INMSLeM8GSUqdN3ya+ZX7+J0ps1S70BVEuVacpSeZ3AT+kdqVonYNJL7DbwC/r6azhQdkjl/xPCAlyuH9KJE1FwAAAAAElFTkSuQmCC';\
var TEMPLATE_ARRAY = \{\};\
var TEMPLATE_ARRAY = [];\
var ct, totalWidth = 0;\
var IS_SUGGESTED_REPLY = 0;\
var IF_SELLER_REPLIED = false;\
var IF_SELLER_REPLIED_TWICE = false;\
var ML_ARRAY = [];\
var ATTACH_IFRAME1 = "<i class='fa fa-chevron-circle-left' style='user-select:none;-moz-user-select: none;color: rgb(90, 192, 165);' id='attach_left_navigate' onclick='navigatePreview1(\\"prev\\")'></i>" + "<iframe id='attach_preview01' current_idx='0' src='' type='application/pdf' width='80%' height='100%' style='background:url(https://pubs.rsna.org/ux3/widgets/publication-content/images/spinner.gif) center center no-repeat;background-size: 23%;overflow: auto;z-index: 3;border: none;position:absolute;left:10%;bottom:-4%;'></iframe>" + '<a class="link01" target="_blank" href="#" style="visibility:hidden;z-index:3;text-decoration:none;width: 121px; height: 41px; text-align: center; background-color: rgb(90, 192, 165); position: absolute; left: 46%; top: 106%; border-radius: 5px; cursor: pointer; ">' + '<span style="font-size: 15px;position: relative; top: 34%; font-weight: bold; border-radius: 2px; color: white;">Download</span></a>' + "<iframe id='attach_preview02' current_idx='1' src='' type='application/pdf' width='80%' height='100%' style='background:url(https://pubs.rsna.org/ux3/widgets/publication-content/images/spinner.gif) center center no-repeat;background-size: 23%;overflow: auto;z-index: 3;border: none;position:absolute;left:10%;bottom:-4%;'></iframe>" + '<a class="link02" target="_blank" href="#" style="visibility:hidden;z-index:3;text-decoration:none;width: 121px; height: 41px; text-align: center; background-color: rgb(90, 192, 165); position: absolute; left: 46%; top: 106%; border-radius: 5px; cursor: pointer; ">' + '<span style=" font-size: 15px;position: relative; top: 34%; font-weight: bold; border-radius: 2px; color: white;">Download</span></a>' + "<iframe id='attach_preview03' current_idx='2' src='' type='application/pdf' width='80%' height='100%' style='background:url(https://pubs.rsna.org/ux3/widgets/publication-content/images/spinner.gif) center center no-repeat;background-size: 23%;overflow: auto;z-index: 3;border: none;position:absolute;left:10%;bottom:-4%;'></iframe>" + '<a class="link03" target="_blank" href="#" style="visibility:hidden;z-index:3;text-decoration:none;width: 121px; height: 41px; text-align: center; background-color: rgb(90, 192, 165); position: absolute; left: 46%; top: 106%; border-radius: 5px; cursor: pointer; ">' + '<span style=" font-size: 15px;position: relative; top: 34%; font-weight: bold; border-radius: 2px; color: white;">Download</span></a>' + "<iframe id='attach_preview04' current_idx='3' src='' type='application/pdf' width='80%' height='100%' style='background:url(https://pubs.rsna.org/ux3/widgets/publication-content/images/spinner.gif) center center no-repeat;background-size: 23%;overflow: auto;z-index: 3;border: none;position:absolute;left:10%;bottom:-4%;'></iframe>" + '<a class="link04" target="_blank" href="#" style="visibility:hidden;z-index:3;text-decoration:none;width: 121px; height: 41px; text-align: center; background-color: rgb(90, 192, 165); position: absolute; left: 46%; top: 106%; border-radius: 5px; cursor: pointer; ">' + '<span style=" font-size: 15px;position: relative; top: 34%; font-weight: bold; border-radius: 2px; color: white;">Download</span></a>' + "<iframe id='attach_preview05' current_idx='0' src='' type='application/pdf' width='80%' height='100%' style='background:url(https://pubs.rsna.org/ux3/widgets/publication-content/images/spinner.gif) center center no-repeat;background-size: 23%;overflow: auto;z-index: 3;border: none;position:absolute;left:10%;bottom:-4%;'></iframe>" + '<a class="link05" target="_blank" href="#" style="visibility:hidden;z-index:3;text-decoration:none;width: 121px; height: 41px; text-align: center; background-color: rgb(90, 192, 165); position: absolute; left: 46%; top: 106%; border-radius: 5px; cursor: pointer; ">' + '<span style="font-size: 15px;position: relative; top: 34%; font-weight: bold; border-radius: 2px; color: white;">Download</span></a>' + "<iframe id='attach_preview06' current_idx='0' src='' type='application/pdf' width='80%' height='100%' style='background:url(https://pubs.rsna.org/ux3/widgets/publication-content/images/spinner.gif) center center no-repeat;background-size: 23%;overflow: auto;z-index: 3;border: none;position:absolute;left:10%;bottom:-4%;'></iframe>" + '<a class="link06" target="_blank" href="#" style="visibility:hidden;z-index:3;text-decoration:none;width: 121px; height: 41px; text-align: center; background-color: rgb(90, 192, 165); position: absolute; left: 46%; top: 106%; border-radius: 5px; cursor: pointer; ">' + '<span style="font-size: 15px;position: relative; top: 34%; font-weight: bold; border-radius: 2px; color: white;">Download</span></a>' + "<iframe id='attach_preview07' current_idx='0' src='' type='application/pdf' width='80%' height='100%' style='background:url(https://pubs.rsna.org/ux3/widgets/publication-content/images/spinner.gif) center center no-repeat;background-size: 23%;overflow: auto;z-index: 3;border: none;position:absolute;left:10%;bottom:-4%;'></iframe>" + '<a class="link07" target="_blank" href="#" style="visibility:hidden;z-index:3;text-decoration:none;width: 121px; height: 41px; text-align: center; background-color: rgb(90, 192, 165); position: absolute; left: 46%; top: 106%; border-radius: 5px; cursor: pointer; ">' + '<span style="font-size: 15px;position: relative; top: 34%; font-weight: bold; border-radius: 2px; color: white;">Download</span></a>' + "<iframe id='attach_preview08' current_idx='0' src='' type='application/pdf' width='80%' height='100%' style='background:url(https://pubs.rsna.org/ux3/widgets/publication-content/images/spinner.gif) center center no-repeat;background-size: 23%;overflow: auto;z-index: 3;border: none;position:absolute;left:10%;bottom:-4%;'></iframe>" + '<a class="link08" target="_blank" href="#" style="visibility:hidden;z-index:3;text-decoration:none;width: 121px; height: 41px; text-align: center; background-color: rgb(90, 192, 165); position: absolute; left: 46%; top: 106%; border-radius: 5px; cursor: pointer; ">' + '<span style="font-size: 15px;position: relative; top: 34%; font-weight: bold; border-radius: 2px; color: white;">Download</span></a>' + "<iframe id='attach_preview09' current_idx='0' src='' type='application/pdf' width='80%' height='100%' style='background:url(https://pubs.rsna.org/ux3/widgets/publication-content/images/spinner.gif) center center no-repeat;background-size: 23%;overflow: auto;z-index: 3;border: none;position:absolute;left:10%;bottom:-4%;'></iframe>" + '<a class="link09" target="_blank" href="#" style="visibility:hidden;z-index:3;text-decoration:none;width: 121px; height: 41px; text-align: center; background-color: rgb(90, 192, 165); position: absolute; left: 46%; top: 106%; border-radius: 5px; cursor: pointer; ">' + '<span style="font-size: 15px;position: relative; top: 34%; font-weight: bold; border-radius: 2px; color: white;">Download</span></a>' + "<iframe id='attach_preview010' current_idx='0' src='' type='application/pdf' width='80%' height='100%' style='background:url(https://pubs.rsna.org/ux3/widgets/publication-content/images/spinner.gif) center center no-repeat;background-size: 23%;overflow: auto;z-index: 3;border: none;position:absolute;left:10%;bottom:-4%;'></iframe>" + '<a class="link010" target="_blank" href="#" style="visibility:hidden;z-index:3;text-decoration:none;width: 121px; height: 41px; text-align: center; background-color: rgb(90, 192, 165); position: absolute; left: 46%; top: 106%; border-radius: 5px; cursor: pointer; ">' + '<span style="font-size: 15px;position: relative; top: 34%; font-weight: bold; border-radius: 2px; color: white;">Download</span></a>' + "<iframe id='attach_preview011' current_idx='0' src='' type='application/pdf' width='80%' height='100%' style='background:url(https://pubs.rsna.org/ux3/widgets/publication-content/images/spinner.gif) center center no-repeat;background-size: 23%;overflow: auto;z-index: 3;border: none;position:absolute;left:10%;bottom:-4%;'></iframe>" + '<a class="link011" target="_blank" href="#" style="visibility:hidden;z-index:3;text-decoration:none;width: 121px; height: 41px; text-align: center; background-color: rgb(90, 192, 165); position: absolute; left: 46%; top: 106%; border-radius: 5px; cursor: pointer; ">' + '<span style="font-size: 15px;position: relative; top: 34%; font-weight: bold; border-radius: 2px; color: white;">Download</span></a>' + "<iframe id='attach_preview012' current_idx='0' src='' type='application/pdf' width='80%' height='100%' style='background:url(https://pubs.rsna.org/ux3/widgets/publication-content/images/spinner.gif) center center no-repeat;background-size: 23%;overflow: auto;z-index: 3;border: none;position:absolute;left:10%;bottom:-4%;'></iframe>" + '<a class="link012" target="_blank" href="#" style="visibility:hidden;z-index:3;text-decoration:none;width: 121px; height: 41px; text-align: center; background-color: rgb(90, 192, 165); position: absolute; left: 46%; top: 106%; border-radius: 5px; cursor: pointer; ">' + '<span style="font-size: 15px;position: relative; top: 34%; font-weight: bold; border-radius: 2px; color: white;">Download</span></a>' + "<iframe id='attach_preview013' current_idx='0' src='' type='application/pdf' width='80%' height='100%' style='background:url(https://pubs.rsna.org/ux3/widgets/publication-content/images/spinner.gif) center center no-repeat;background-size: 23%;overflow: auto;z-index: 3;border: none;position:absolute;left:10%;bottom:-4%;'></iframe>" + '<a class="link013" target="_blank" href="#" style="visibility:hidden;z-index:3;text-decoration:none;width: 121px; height: 41px; text-align: center; background-color: rgb(90, 192, 165); position: absolute; left: 46%; top: 106%; border-radius: 5px; cursor: pointer; ">' + '<span style="font-size: 15px;position: relative; top: 34%; font-weight: bold; border-radius: 2px; color: white;">Download</span></a>' + "<iframe id='attach_preview014' current_idx='0' src='' type='application/pdf' width='80%' height='100%' style='background:url(https://pubs.rsna.org/ux3/widgets/publication-content/images/spinner.gif) center center no-repeat;background-size: 23%;overflow: auto;z-index: 3;border: none;position:absolute;left:10%;bottom:-4%;'></iframe>" + '<a class="link014" target="_blank" href="#" style="visibility:hidden;z-index:3;text-decoration:none;width: 121px; height: 41px; text-align: center; background-color: rgb(90, 192, 165); position: absolute; left: 46%; top: 106%; border-radius: 5px; cursor: pointer; ">' + '<span style="font-size: 15px;position: relative; top: 34%; font-weight: bold; border-radius: 2px; color: white;">Download</span></a>' + "<iframe id='attach_preview015' current_idx='0' src='' type='application/pdf' width='80%' height='100%' style='background:url(https://pubs.rsna.org/ux3/widgets/publication-content/images/spinner.gif) center center no-repeat;background-size: 23%;overflow: auto;z-index: 3;border: none;position:absolute;left:10%;bottom:-4%;'></iframe>" + '<a class="link015" target="_blank" href="#" style="visibility:hidden;z-index:3;text-decoration:none;width: 121px; height: 41px; text-align: center; background-color: rgb(90, 192, 165); position: absolute; left: 46%; top: 106%; border-radius: 5px; cursor: pointer; ">' + '<span style="font-size: 15px;position: relative; top: 34%; font-weight: bold; border-radius: 2px; color: white;">Download</span></a>' + "<iframe id='attach_preview016' current_idx='0' src='' type='application/pdf' width='80%' height='100%' style='background:url(https://pubs.rsna.org/ux3/widgets/publication-content/images/spinner.gif) center center no-repeat;background-size: 23%;overflow: auto;z-index: 3;border: none;position:absolute;left:10%;bottom:-4%;'></iframe>" + '<a class="link016" target="_blank" href="#" style="visibility:hidden;z-index:3;text-decoration:none;width: 121px; height: 41px; text-align: center; background-color: rgb(90, 192, 165); position: absolute; left: 46%; top: 106%; border-radius: 5px; cursor: pointer; ">' + '<span style="font-size: 15px;position: relative; top: 34%; font-weight: bold; border-radius: 2px; color: white;">Download</span></a>' + "<iframe id='attach_preview017' current_idx='0' src='' type='application/pdf' width='80%' height='100%' style='background:url(https://pubs.rsna.org/ux3/widgets/publication-content/images/spinner.gif) center center no-repeat;background-size: 23%;overflow: auto;z-index: 3;border: none;position:absolute;left:10%;bottom:-4%;'></iframe>" + '<a class="link017" target="_blank" href="#" style="visibility:hidden;z-index:3;text-decoration:none;width: 121px; height: 41px; text-align: center; background-color: rgb(90, 192, 165); position: absolute; left: 46%; top: 106%; border-radius: 5px; cursor: pointer; ">' + '<span style="font-size: 15px;position: relative; top: 34%; font-weight: bold; border-radius: 2px; color: white;">Download</span></a>' + "<iframe id='attach_preview018' current_idx='0' src='' type='application/pdf' width='80%' height='100%' style='background:url(https://pubs.rsna.org/ux3/widgets/publication-content/images/spinner.gif) center center no-repeat;background-size: 23%;overflow: auto;z-index: 3;border: none;position:absolute;left:10%;bottom:-4%;'></iframe>" + '<a class="link018" target="_blank" href="#" style="visibility:hidden;z-index:3;text-decoration:none;width: 121px; height: 41px; text-align: center; background-color: rgb(90, 192, 165); position: absolute; left: 46%; top: 106%; border-radius: 5px; cursor: pointer; ">' + '<span style="font-size: 15px;position: relative; top: 34%; font-weight: bold; border-radius: 2px; color: white;">Download</span></a>' + "<iframe id='attach_preview019' current_idx='0' src='' type='application/pdf' width='80%' height='100%' style='background:url(https://pubs.rsna.org/ux3/widgets/publication-content/images/spinner.gif) center center no-repeat;background-size: 23%;overflow: auto;z-index: 3;border: none;position:absolute;left:10%;bottom:-4%;'></iframe>" + '<a class="link019" target="_blank" href="#" style="visibility:hidden;z-index:3;text-decoration:none;width: 121px; height: 41px; text-align: center; background-color: rgb(90, 192, 165); position: absolute; left: 46%; top: 106%; border-radius: 5px; cursor: pointer; ">' + '<span style="font-size: 15px;position: relative; top: 34%; font-weight: bold; border-radius: 2px; color: white;">Download</span></a>' + "<iframe id='attach_preview020' current_idx='0' src='' type='application/pdf' width='80%' height='100%' style='background:url(https://pubs.rsna.org/ux3/widgets/publication-content/images/spinner.gif) center center no-repeat;background-size: 23%;overflow: auto;z-index: 3;border: none;position:absolute;left:10%;bottom:-4%;'></iframe>" + '<a class="link020" target="_blank" href="#" style="visibility:hidden;z-index:3;text-decoration:none;width: 121px; height: 41px; text-align: center; background-color: rgb(90, 192, 165); position: absolute; left: 46%; top: 106%; border-radius: 5px; cursor: pointer; ">' + '<span style="font-size: 15px;position: relative; top: 34%; font-weight: bold; border-radius: 2px; color: white;">Download</span></a>' + "<iframe id='attach_preview021' current_idx='0' src='' type='application/pdf' width='80%' height='100%' style='background:url(https://pubs.rsna.org/ux3/widgets/publication-content/images/spinner.gif) center center no-repeat;background-size: 23%;overflow: auto;z-index: 3;border: none;position:absolute;left:10%;bottom:-4%;'></iframe>" + '<a class="link021" target="_blank" href="#" style="visibility:hidden;z-index:3;text-decoration:none;width: 121px; height: 41px; text-align: center; background-color: rgb(90, 192, 165); position: absolute; left: 46%; top: 106%; border-radius: 5px; cursor: pointer; ">' + '<span style="font-size: 15px;position: relative; top: 34%; font-weight: bold; border-radius: 2px; color: white;">Download</span></a>' + "<i class='fa fa-chevron-circle-right' style='user-select:none;-moz-user-select: none;color: rgb(90, 192, 165);' id='attach_right_navigate' onclick='navigatePreview1(\\"next\\")'></i>";\
/*list of auto send message in suggestive reply*/\
var auto_msg_list = ["Waiting for your reply", "Please send some product images.", "Is the product currently in stock?", "Let us discuss on call.", "Need more details of the requirement.", "I need to see some samples before placing the order", "What will be the minimum quantity and best price?", "What is the Approximate Order Value?", "Please share time to talk.", "Sure I will let you know"];\
//  $(window).load(onWindowLoadFunction);    	//On Window load\
$(document).ready(onDOMLoadFunction); //On Dom load\
/*\
    Write all the functions which are needed to be executed on WINDOW load.\
*/\
function getparam(key) \{\
	/*if( cookie = readCookie("v4iilex")  > "")   \
	\{\
	        var val = "|"+cookie+"|";\
	        var pattern = new RegExp(".*?\\\\|"+key+"=([^|]*).*|.*");\
	        return val.replace(pattern, "$1");\
	\}*/\
	return '';\
\}\
/*\
    Write all the functions which are needed to be executed on DOM load.\
*/\
\
function updateNetworkSpeed()\{\
      try\{\
            if (navigator.onLine)\{\
                  if (networkspeedvar.downlink<1)\{\
                      document.getElementById('ntconnected').style.display = 'block';    \
                  \}else\{\
                      document.getElementById('ntconnected').style.display = 'none';\
                  \}\
                  document.getElementById('ntconnectedText').innerText = 'Slow network connection detected.';\
//                   document.getElementsByClassName('active user-name1')[0].click();\
            \}\
      \}catch(err)\{\}\
\}\
\
function onDOMLoadFunction() \{\
	var cookie = readCookie('ImeshVisitor');\
	var glusr = getparamVal(cookie, "glid");\
	var host_name   = location.host == 'my.indiamart.com' ? "https://my.imimg.com/" : "https://dev-my.imimg.com/";\
	var s = '';\
	if(typeof(SharedWorker)=="function" && typeof(BroadcastChannel)=="function")\{\
		s = document.createElement("script");\
		s.type = "text/javascript";\
		s.src = host_name + "js-new/messagecentre_chat_sw-v-12.js";\
		document.head.appendChild(s);\
	\}else\{\
		s = document.createElement("script");\
		s.type = "text/javascript";\
		s.src = host_name + "js-new/messagecentre_chat-v-30.js";\
		document.head.appendChild(s);\
		\
		s = document.createElement("script");\
		s.type = "text/javascript";\
		s.src = host_name + "js-new/messagecentre_strophe_new-v-4.js";\
		document.head.appendChild(s);\
	\}\
	if($('.chat-section').length > 0) $('.chat-section').scrollTop($('.chat-section')[0].scrollHeight);\
	hideScroller();\
	onclickFocus();\
	//     $('.chat-section').bind('mousewheel', function()\{\
	// //         $("#Hdr-details").css("display","none");\
	// //         $(".nav-toggle").html('<i class="fa fa-sort-desc" aria-hidden="true"></i>');\
	//     \});\
	bindTextBoxWithPlaceholder();\
	limitCharacterForTextBox();\
	var cookie = readCookie('ImeshVisitor');\
	var glusr = getparamVal(cookie, "glid");\
	if(glusr) \{\
		isSuggestiveRepliesEnabled();\
	\}\
	 setTimeout(function()\{\
                  window.addEventListener('online', function(e) \{document.getElementById('ntconnected').style.display = 'none'; updateNetworkSpeed(); \});\
                  window.addEventListener('offline', function(e) \{ document.getElementById('ntconnectedText').innerText = 'Not connected to the Internet.'; document.getElementById('ntconnected').style.display = 'block';\
                 $('.bottom-send-section').css("pointer-events", "none");\
                \});\
                  try\{\
                        networkspeedvar = navigator.connection || navigator.mozConnection || navigator.webkitConnection;\
                        updateNetworkSpeed();\
                        networkspeedvar.addEventListener('change', updateNetworkSpeed);\
                  \}catch(err)\{\}\
            \}, 2000);\
\}\
\
function bindTextBoxWithPlaceholder() \{\
	$("#massage-text").unbind('blur');\
	$("#massage-text").unbind('focus');\
	$('#massage-text').blur(function() \{\
		if($('#massage-text').val().trim() === '') \{\
			$(".msg-placeholder").show();\
		\}\
	\});\
	$('#massage-text').focus(function() \{\
		$(".msg-placeholder").hide();\
	\});\
\}\
\
function limitCharacterForTextBox(e) \{\
	$("#massage-text").unbind("keydown");\
	$("#massage-text").keydown(function(e) \{\
		if(e.which != 8 && $("#massage-text").val().length > 3500) // Limit is 3500\
		\{\
			e.preventDefault();\
		\}\
	\});\
	$("#massage-text").keyup(function(e) \{\
		if (e.keyCode == 13 || e.keyCode == 8)\{\
			toggleScrollDisplay();             \
		\}\
	\});\
\}\
/*\
  Function to attach the scroll event on the Left Contact view\
  So we could fetch more contacts when the scroll would reach the end !\
*/\
function addScrollEventOnContact() \{\
	$('#scrollerdiv').unbind('scroll');\
	var loginglid = parseInt($('#trackid').val());\
	$('#scrollerdiv').on('scroll', function() \{\
		if($(".action-div")[0]) \{\
			$(".action-div").remove();\
		\}\
		var checkBox = document.getElementById("cb-unrd");\
		if(checkBox == null) return false;\
		if(checkBox.checked == true) return false;\
		var el_scroll_top = $(this).scrollTop();\
		var el_scroll_h = $(this).innerHeight();\
		var search_text = byId("searchauto").value;\
		// var checkBox = document.getElementById("cb-unrd");\
		// if(checkBox.checked || byId('lbl_fltr_header').offsetParent !== null || byId('contact_fltr_header').offsetParent || search_text.length > 0)\{\
		//     return;\
		// \}\
		if(el_scroll_top + el_scroll_h + 500 >= $(this)[0].scrollHeight) \{\
			var start_1 = parseInt(byId("start").value);\
			var end_1 = parseInt(byId("end").value);\
			var loginglid = parseInt($('#trackid').val());\
			var contactcount = parseInt(byId("contactcount").value);\
			if(!search_paused) \{\
				search_paused = true;\
				start = end_1 + 1;\
				end = start + 49;\
				getMoreContacts(start, end, contactcount, loginglid, start_1, end_1);\
			\}\
		\}\
	\});\
	onclickFocus();\
\}\
\
function getMoreContacts(start, end, contactcount, loginglid, start_old, end_old) \{\
	var filtered_list = list.slice(start_old - 1, end_old);\
	if(list === undefined || list === null || list.length === undefined || list.length === 0) \{\
		search_paused = false;\
		return;\
	\}\
\
       var lastcontactdate = '';\
       try\{\
        		var els = document.getElementsByClassName('contact_date');\
             	lastcontactdate = els[els.length-1].value;\
       \}catch(err)\{\
             lastcontactdate = '';\
       \}\
	url = '/phpajax/enquiry/messagecentre/GetMoreContacts';\
	$.ajax(\{\
		url: url,\
		data: \{\
			"logingid": loginglid,\
			"start": start,\
			"end": end,\
			"last_contact_date": lastcontactdate\
		\},\
		dataType: "html",\
		type: "GET",\
		success: function(jsonResult) \{\
            if(jsonResult == "")\{\
                SEARCH_PAUSED = true;\
                return;\
            \}\
			$('#end').val(end);\
			$('#start').val(start);\
            if(end>contactcount)\{\
            $('#contact_count').text("(" + end + " contacts)");  \
            \}\
			var filtered_list = list.slice(start, end);\
			var search_text = byId("searchauto").value;\
			if(search_text !== undefined && search_text !== null && search_text.trim() !== '') \{\
				filtered_list = getSearchContactsFromList(end, search_text);\
				//filtered_list = filtered_list.slice(start, end); \
				createContactDynamicHTML(filtered_list, false)\
				if(search_text !== undefined && search_text !== null && search_text.trim() !== '') \{\
					highlightSearchText(byId("searchauto"));\
					byId("srh-cross").style.display = "block";\
				\} else \{\
					byId("srh-cross").style.display = "none";\
				\}\
			\} else \{\
				$('#fetch_list').append(jsonResult);\
			\}\
			search_paused = false;\
			if(typeof displayContactsAsOnline === "function") \{\
				displayContactsAsOnline();\
			\} //XMPP code will be implemented again later\
		\}\
	\});\
	onclickFocus();\
\}\
\
function GetSearchContacts() \{\
	var url_w = window.location.href;\
	if(url_w.match('enquiry/messagecentre')) \{\
		if($('#trackid').val() !== undefined && $('#trackid').val() !== null) \{\
			var glid = trim($('#trackid').val());\
			var start_req = "";\
			var end_req = "";\
			var date_req = '';\
			var url = '/phpajax/enquiry/messagecentre/GetSearchContacts';\
			$.ajax(\{\
				url: url,\
				data: \{\
					"glid": glid,\
					"start": start_req,\
					"end": end_req,\
					"last_contact_date": date_req\
				\},\
				type: "POST",\
				success: function(jsonResult) \{\
					list = JSON.parse(jsonResult);\
					if(!check_OneDayPassed_for_presence()) return false;\
					else setTimeout(function() \{\
						if (typeof(add_List_Presence)=="function")\
						add_List_Presence(list);\
					\}, 6000); //function to add the contact list in roaster bucket daily once\
				\},\
				error: function(err) \{\
					console.log("GetSearchContacts error = "+err);\
				\}\
			\});\
		\}\
	\}\
\}\
\
function showadd() \{\
	$("#error_nme").hide();\
	$("#error_mob").hide();\
	$('#alrexist').hide();\
	$('#success').hide();\
	$('#add-contact-error').html("");\
	$('#addContactName').val("");\
	$('#addContactMobile').val("");\
	$('#pop_show_hide').toggle();\
	return false;\
\}\
\
function showedit() \{\
	$('#edit_adbook').toggle();\
	$('#overlay_s').toggle();\
	$('#edit_adbook:first *:input[type!=hidden]:first').focus(); // Focus on the first non-hidden input field of #edit_adbook form.\
	return false;\
\}\
\
function enableButton() \{\
	$("#ad_cont_btn").removeClass("disabled_btn");\
	$("#ad_cont_btn").addClass("ad_save_btn");\
	$("#ad_cont_btn").val("Save");\
\}\
\
function hideedit() \{\
	$('#overlay_s').css("display", "none");\
	$('#edit_adbook').css("display", "none");\
\}\
$('.ad_edit_tabs nav a').on('click', function() \{\
	show_content($(this).index());\
\});\
show_content(0);\
\
function show_content(index) \{\
	$('.ad_edit_tabs .content.visible').removeClass('visible');\
	$('.ad_edit_tabs .content:nth-of-type(' + (index + 1) + ')').addClass('visible');\
	$('.butnss').addClass('visible');\
	$('.ad_edit_tabs nav a.selected').removeClass('selected');\
	$('.ad_edit_tabs nav a:nth-of-type(' + (index + 1) + ')').addClass('selected');\
\}\
\
function showDetails() \{\
	$('.search-click-hide').show();\
	$('.user-name1 .name h2').css(\{\
		"font-size": "16px",\
		"margin": "0 0 10px"\
	\});\
\}\
\
\
function hideDetails() \{\
	$('.search-click-hide').hide();\
	$('.user-name1 .name h2').css(\{\
		"font-size": "14px",\
		"margin": "0px"\
	\});\
\}\
$(document).keyup(function(e) \{\
	if(e.keyCode == 27) \{ // escape key maps to keycode `27`\
		$('.search-click-hide').show();\
		$('.user-name1 .name h2').css(\{\
			"font-size": "16px",\
			"margin": "0 0 10px"\
		\});\
		$('#crossZoom').click();\
		$('.popup-close').click();\
	\}\
\});\
var rating_popup =0;\
function contactDetail(contact_dom_id, loginglid, mobile, type, contactglid, imcontactid, name) \{\
	document.getElementById('topsection_container').style.display = 'block';\
	document.getElementById('quotedRplyDiv').style.display='none';\
	document.getElementById('preload_img').style.display = 'none';\
	document.getElementById('bottom-send-section').style.visibility = 'visible';\
	rating_ppop = 0;\
	// document.getElementById('paynow').style.display = 'none';\
	$('.bottom-send-section').css("pointer-events", "auto");\
	\
	$('.popup-wrapper').css(\{\
		"top": "0em !important"\
	\});\
	IF_SELLER_REPLIED = false;\
	IF_SELLER_REPLIED_TWICE = false;\
	var b_w = $('#b_n').width();\
	$('#s_n_s').html(name + "  ");\
	var s_w = $('#s_n').width();\
	$(".bottom-send-section").show();\
	$(".action-div").remove();\
	// removeReminderTooltip();\
	$(".last-seen-span").html("");\
	$('li').removeClass('active');\
	$('li#' + contact_dom_id).addClass('active');\
	var bname = $("#bn").val();\
	$(".cname-msg").html("");\
	$("#intro_name").val(bname);\
	$("#contactglid").val(contactglid);\
	$("#massage-text").val('');\
	$("#fraud_div").remove();\
	if($('#buyer_profile_details1').css("display") == "flex") \{\
		if($('.slidbox').is(":visible")) \{\
			slideUpProfileInformation();\
		\}\
		else slideDownProfileInformation();\
		$('#mslft').html('');\
		$('#mslrt1').html('');\
		$('#buyer_profile_details1').css("display", "none");\
		chatSectionHeight();\
	\}\
	if(contact_dom_id !== -20) \{\
		var current_glid = $('#contactglid').val();\
		if(contactglid.toString().trim() !== current_glid.toString().trim()) \{\
			// If we are not refreshing the same chat.          \
			$(".last-seen-span").html("");\
			$(".label-breadcrumb").html('');\
		\}\
		if(($('#ntconnected').css("display") == "block") && (document.getElementById("ntconnectedText").innerText == 'Not connected to the Internet.'))\{\
        document.getElementById('myenqtab').innerHTML = '<span style="margin:0 auto;text-align:center;width: 43%;display:block;margin-top: 21%;color: #000;"> <i class="fa fa-exclamation-triangle" aria-hidden="true" style="color: #999;font-size: 71px;"></i><br> <b style=" font-size: 15px; color: #333; ">Not connected to the Internet.</b><br></span>';\
        getGAEventTrackingJS("Network_Error_Messagecentre","No internet",'MY');\
        $('#supp_rat').css("display","none");\
        $('.get_sup_rat').css("display", "none");\
        $('.bottom-send-section').css("pointer-events", "none");\
        \}else\{\
		addloader();\
        \}\
		if(contact_dom_id === -30)\
            displaycontact(contact_dom_id);\
        else\
		displaycontact_new(contactglid);\
		$(".msg_footer").show();\
		$(".msg-placeholder").show();\
		//$('#sr1').html('');       \
	\}\
	var params_raw = window.location.search.substr(1, window.location.search.length);\
	var contactYear = "";\
	if(params_raw.indexOf("sup_glid=") > -1) \{\
		/* Single Contact View */\
		var val1 = extractContactGlidFromUrl('sup_type=');\
		if(val1 != "") type = val1;\
	\} else \{\
		if(document.getElementsByClassName('user-name1 active')[0].getElementsByClassName('lst_contact_year')[0] != undefined) \{\
			var contactYear = document.getElementsByClassName('user-name1 active')[0].getElementsByClassName('lst_contact_year')[0].innerText;\
		\}\
	\}\
	//$('#seller_profile_sec').css("display","none");\
	$('.chat-section').css("width", "100%");\
	$('.bottom-send-section').css("width", "100%");\
	var nm = document.getElementById('bn').value;\
	var usr_cmp_name = $('.user-name1.active .c-div .c_addr c_company').text();\
	$.when($.ajax(\{\
		url: "/phpajax/enquiry/messagecentre/ContactDetail",\
		data: \{\
			"logingid": loginglid,\
			"contactglid": contactglid,\
			"mobile": mobile,\
			"type": type,\
			"imcontactid": imcontactid,\
			"contact_year": contactYear\
		\},\
		dataType: "html",\
		type: "GET",\
		success: function(jsonResult) \{\
			$('#testing').html(jsonResult);\
			$('#contactglid').val(contactglid);\
		\}\
	\}), $.ajax(\{\
		url: "/phpajax/enquiry/messagecentre/enquiryListing",\
		data: \{\
			"logingid": loginglid,\
			"contactglid": contactglid,\
			"type": type,\
			"name": name,\
			"mobile": mobile,\
			"bname": bname,\
			"usr_cmp_name": usr_cmp_name\
		\},\
		dataType: "html",\
		type: "GET",\
		success: function(jsonResult) \{\
			getMessageCounter(contactglid);\
			$('#contactglid').val(contactglid);\
			$('#enqdet').html(jsonResult);\
			k = $('#k').val() ? $('#k').val() : '1';\
			if(typeof showTypingInConvArea === "function") \{\
				showTypingInConvArea();\
			\}\
\
\
			bindChatScrollEvent();\
			lazyLoadChatImages();\
			resetSuggestedRepliesNavBar();\
			\
			if(IS_SUGGESTED_REPLY) getSuggestedReplies(1);\
		\}\
	\})).then(function() \{\
		if(k !== "1") \{\
			$.ajax(\{\
				url: '/phpajax/enquiry/messagecentre/buyerProfile_new',\
				data: \{\
					"k": k\
				\},\
				dataType: "json",\
				type: "GET",\
				success: function(jsonResult1) \{\
					jsonResult = JSON.parse(jsonResult1);\
					if(jsonResult['Response'] && jsonResult['Response']['Data']) \{\
						var contactData = jsonResult['Response']['Data'];\
						$('#buyer_pr_dt_new').val(JSON.stringify(jsonResult1));\
						var ImeshVisitorcookie = readCookie("ImeshVisitor");\
		                var phcc_val = getparamVal(ImeshVisitorcookie, "phcc");\
						if(contactData['contact_country_iso']== "IN" && phcc_val == 91 )\{\
							var glid = document.getElementById('contactglid').value;\
							pemail = contactData['contacts_email1'];\
							identifySupplierwithglid(glid)	\
						\}\
						UpdateHeaderNew();\
					\}\
				\},\
				error: function(err) \{\
					console.log(err);\
				\}\
			\});\
		\}\
		// UpdateHeaderNew();\
		// updateContactNameHeader();\
		showContactTypeOnChat($('#recv_type_rmrk').val());\
		var params_raw = window.location.search.substr(1, window.location.search.length);\
		if(params_raw.indexOf("isLandingFromEmail=") > -1 && params_raw.indexOf("starRating=") > -1) \{\
			$('#toSaveRatingFromEmail').val(1);\
			// console.log('HERE i AM going to SAVE RATING');\
			/* Single Contact View */\
			var val1 = extractContactGlidFromUrl('starRating=');\
			var val_isLandingFromEmail = extractContactGlidFromUrl('isLandingFromEmail=');\
			if (val_isLandingFromEmail==1) \{\
				/*vinay*/yandex_impression_my('rating_landing_from_email');\
				if(val1 > 0) //SaveRating \
			    \{\
				    var rating_value = val1;\
				    var buyer_glid = parseInt($('#trackid').val());\
				    var supplier_glid = trim(document.getElementById('contactglid').value);\
				\
				    var location_obj = getLocationDetailOfUser();\
				    if(location_obj.IP_COUNTRY === '' || location_obj.GEOIP_COUNTRY_ISO === '' ||     location_obj.IPADDRESS === '') \{\
				    	console.log("LOCATION DETAILS NOT PRESENT !!\\nCannot Rate the Supplier");\
				    	return;\
				    \}\
				\
				    // $.ajax(\{\
				    // 	url: '/enquiry/messagecentre/supplierRating', //priya\
				    // 	data: \{\
				    // 		"RATING_MODID": 'MY',\
				    // 		"BUYER_ID": buyer_glid,\
				    // 		"SUPPLIER_ID": supplier_glid,\
				    // 		"RATING_VAL": rating_value,\
				    // 		"UPDATEDBY": 'USER',\
				    // 		"UPDATEDUSING": 'BUYER MY',\
				    // 		"IP_COUNTRY": location_obj.IP_COUNTRY,\
				    // 		"IP": location_obj.IPADDRESS,\
				    // 		// 			"RATING_COMMENTS": rating_comment,\
				    // 		"RATING_TYPE": 4,\
				    // 		"RATING_SOURCE": -111,\
				    // 		"RATING_PARAMETER": '',\
				    // 		"MODREF_ID": '',\
				    // 		"DISPLAY_STATUS": 0,\
				    // 		"VALIDATION_KEY": "5cca91f15b8c8ddd91c0fc7abfebc0c7",\
				    // 		// 			"FK_GLUSR_RATING_INFLU_PARAM_ID": rating_param_id,\
				    // 		// 			"RATING_IMGS": rating_img_json\
				    // 	\},\
				    // 	dataType: "JSON",\
				    // 	type: "POST",\
				    // 	success: function(result) \{\
				    // 		if(result.failure != "" && result.failure == "Authorization Fail") \{\
				    // 			console.log(result);\
				    // 			window.location.reload();\
				    // 		\}\
				    // 		if(result == 1) \{\
							// 				$('#oldImg').html('');\
							$('box1').css("display", "none");\
							$('box2').css('display', 'block');\
							if (rating_value >= 1 && rating_value <= 5) $("#star-"+rating_value).click();\
							get_rateSupplier_via_email(rating_value);\
							$('.get_sup_rat').css("display", "none"); //pop1 \
							$('#supp_rat').css("display", "block"); //pop2\
							$("#confirmSpan").children().css('display', 'block'); //pop3-Submit\
							$("#satisfaction_box").css('display', 'inline-block'); //pop3\
							$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight + 80);\
							// get_rateSupplier_via_email(rating_value);//get_rateSupplier();// \
							setTimeout(function()\{\
								rateSupplier_from_email();\
						    \}, 2000);\
				    // 		\}\
				    // 					//  $("#confirmSpan").children().prop("disabled", false); \
				    // 	\}\
				    // \});\
				    /*category = 'messagecentre';  \
				    trackEvent(category, 'rateSupplier');*/\
				    // getGAEventTrackingJS("supplier_rating","click_submit",'MY');\
				    // 	yandex_impression_pers('supplier_rating_click_submit_MY');\
			    \}\
			\}\
		\} else \{\
			get_rateSupplier();\
		\}\
		// if(contact_dom_id === -30) \{\
		// 	showSingleContactOnLeft(contact_dom_id, loginglid, contactglid);\
		// 	contact_dom_id = 0;\
		// 	displaycontact(contact_dom_id);\
		// \}\
		get_avg_rat(contactglid);\
		updateLastSeenAJAX(contactglid);\
		// get_user_company_detail(loginglid,contactglid);\
		$(".last-seen-span").show();\
		$("#rgtmst").css('display', 'block');\
		// XMPP code will be implemented again later\
		if(ACTIVE_GLID !== undefined && typeof ACTIVE_GLID['array'] !== "undefined" && ACTIVE_GLID['array'] !== undefined && ACTIVE_GLID['array'] !== null && ACTIVE_GLID['array'] !== '') \{\
			// For checking of the user is Active or not.\
			if(ACTIVE_GLID['array'].indexOf(contactglid) == -1) \{\
				var e = contactglid + "@chat.indiamart.com";\
				getPresence(e);\
			\}\
		\}\
		// When both of the above stated AJAX call would return sucessful result the this would execute !\
		// createReminderIcons();\
	\});\
	category = 'messagecentre';\
	//   trackEvent(category, 'detailContact');\
	scrollable();\
	$("#massage-text").focus();\
	onclickFocus();\
	$('#massage-text').css('height','30px');\
	chatSectionHeight();\
\
	setTimeout(function() \{ // to scroll back to bottom\
		if( document.getElementById("box1").display=="block")\{\
			$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight);	\
		\}\
\
	\},5000);\
\
	$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight);\
\
\
\}\
\
function get_avg_rat(contactglid) \{\
	var cookie = readCookie('ImeshVisitor');\
	var glusr = getparamVal(cookie, "glid");\
	$.ajax(\{\
		url: "/phpajax/enquiry/messagecentre/getavgrating",\
		data: \{\
			"glid": contactglid,\
			"user_glid" : glusr\
		\},\
		dataType: "json",\
		type: "GET",\
		success: function(data) \{\
			var rating = parseFloat(data.r);\
			var is_display = data.is_display;\
			var total_count = data.total_count;\
			var one_star_count = data.one_star_count;\
			var two_star_count = data.two_star_count;\
			var three_star_count = data.three_star_count;\
			var four_star_count = data.four_star_count;\
			var five_star_count = data.five_star_count;\
			\
			// for showing percentages\
			var in_percentage = data.in_percentage;\
			var one_star_percentage = data.one_star_percentage;\
			var two_star_percentage = data.two_star_percentage;\
			var three_star_percentage = data.three_star_percentage;\
			var four_star_percentage = data.four_star_percentage;\
			var five_star_percentage = data.five_star_percentage;\
\
			rating = rating.toFixed(1);\
			rating = rating.replace('.0', '');\
\
			if(is_display == 1) \{\
				//if (glusr == '59063812')\{\
					var influ_param_names = data.rating_influ_params_name;\
					var Delivery_percent = -1;\
					var Response_percent = -1;\
					var Quality_percent = -1;\
					if (influ_param_names != undefined)\{\
						if (influ_param_names.Delivery != undefined)\{\
							var x = influ_param_names.Delivery.split(',');\
							Delivery_percent = x[0];\
						\}\
						if (influ_param_names.Quality != undefined)\{\
							var x = influ_param_names.Quality.split(',');\
							Quality_percent = x[0];\
						\}\
						if (influ_param_names.Response != undefined)\{\
							var x = influ_param_names.Response.split(',');\
							Response_percent = x[0];\
						\}\
					\}\
						//Comments variables\
						var buyer_name1 = '', buyer_name2 = '';\
						var buyer_comment1 = '', buyer_comment2 = '';\
						var buyer_rating_date1 = '', buyer_rating_date2 = '';\
						var rating_val1 = '', rating_val2 = '';\
						var rating_influ1 = '', rating_influ2 = '';\
						var buyer1_company_name = '', buyer2_company_name = ''; \
						var buyer1_company_name_full = '', buyer2_company_name_full = ''; \
						var buyer1_location = '', buyer2_location = '';\
						var buyer1_rating_modref_name = '', buyer2_rating_modref_name = '';\
						var buyer1_rating_mcat_name = '', buyer2_rating_mcat_name = '';\
						var buyer1_product_name = '', buyer2_product_name = '';\
						var buyer1_product_name_full = '', buyer2_product_name_full = '';\
						let date_top1 = '0.1ex', date_top2 = '0.1ex';\
\
						//Buyer 1\
						if (data.comment1 != '' && data.comment1 != undefined && data.comment1 != null)\{\
							buyer_name1 = data.comment1.BUYER_NAME;\
							buyer_comment1 = data.comment1.GLUSR_RATING_COMMENTS;\
							buyer_rating_date1 = avgRatingDate(data.comment1.GLUSR_RATING_DATE);\
							rating_val1 = data.comment1.GLUSR_RATING_VALUE;\
							rating_influ1 = textToInfluRating(data.comment1.RATING_INFLU_PARAMS);\
							if(rating_influ1 == '') date_top1 = '1.1ex';\
\
							// company name\
							buyer1_company_name = data.comment1.BUYER_COMPANY_NAME; \
							buyer1_company_name = buyer1_company_name != '' ? ` | $\{buyer1_company_name\}` : '';\
\
							// product name \
							buyer1_rating_modref_name = data.comment1.RATING_MODREF_NAME;\
							buyer1_rating_mcat_name = data.comment1.RATING_MCAT_NAME;\
							buyer1_product_name = buyer1_rating_modref_name != '' ? buyer1_rating_modref_name : buyer1_rating_mcat_name;\
\
							if(data.comment1.BUYER_COUNTRY_NAME != 'India') // foreign buyer\
							\{\
								buyer1_location = data.comment1.BUYER_COUNTRY_NAME;\
							\}\
							else \
							\{\
								let buyer1_city = data.comment1.BUYER_CITY_NAME;\
								let buyer1_state = data.comment1.BUYER_STATE_NAME;\
								let buyer1_country = data.comment1.BUYER_COUNTRY_NAME;\
\
								// deciding priority logic\
								let stack = new Array();\
								if(buyer1_country != '') stack.push(buyer1_country);\
								if(buyer1_state != '') stack.push(buyer1_state);\
								if(buyer1_city != '') stack.push(buyer1_city);\
\
								if(stack.length > 0) buyer1_location += stack.pop();\
								if(stack.length > 0) buyer1_location += `, $\{stack.pop()\}`;\
							\}\
\
							let review_title_string = `$\{buyer_name1\} | $\{buyer1_company_name\} | $\{buyer1_location\}`;\
							if(review_title_string.length > 70)\
							\{\
								buyer1_company_name_full = buyer1_company_name;\
								buyer1_company_name = buyer1_company_name.substring(0,30) + '..';\
							\}\
							if(buyer1_product_name.length > 30)\
							\{\
								buyer1_product_name_full = buyer1_product_name;\
								buyer1_product_name = buyer1_product_name.substring(0,30) + '..';\
							\}\
						\}\
\
						//Buyer 2\
						if (data.comment2 != '' && data.comment2 != undefined && data.comment2 != null)\{\
							buyer_name2 = data.comment2.BUYER_NAME;\
							buyer_comment2 = data.comment2.GLUSR_RATING_COMMENTS;\
							buyer_rating_date2 = avgRatingDate(data.comment2.GLUSR_RATING_DATE);\
							rating_val2 = data.comment2.GLUSR_RATING_VALUE;\
							rating_influ2 = textToInfluRating(data.comment2.RATING_INFLU_PARAMS);\
							if(rating_influ2 == '') date_top2 = '1.1ex';\
							\
							// company name\
							buyer2_company_name = data.comment2.BUYER_COMPANY_NAME; \
							buyer2_company_name = buyer2_company_name != '' ? ` | $\{buyer2_company_name\}` : '';\
\
							// product name \
							buyer2_rating_modref_name = data.comment2.RATING_MODREF_NAME;\
							buyer2_rating_mcat_name = data.comment2.RATING_MCAT_NAME;\
							buyer2_product_name = buyer2_rating_modref_name != '' ? buyer2_rating_modref_name : buyer2_rating_mcat_name;\
\
							if(data.comment2.BUYER_COUNTRY_NAME != 'India') // foreign buyer\
							\{\
								buyer2_location = data.comment2.BUYER_COUNTRY_NAME;\
							\}\
							else \
							\{\
								let buyer2_city = data.comment2.BUYER_CITY_NAME;\
								let buyer2_state = data.comment2.BUYER_STATE_NAME;\
								let buyer2_country = data.comment2.BUYER_COUNTRY_NAME;\
\
								// deciding priority logic\
								let stack = new Array();\
								if(buyer2_country != '') stack.push(buyer2_country);\
								if(buyer2_state != '') stack.push(buyer2_state);\
								if(buyer2_city != '') stack.push(buyer2_city);\
\
								if(stack.length > 0) buyer2_location += stack.pop();\
								if(stack.length > 0) buyer2_location += `, $\{stack.pop()\}`;\
							\}\
\
							let review_title_string = `$\{buyer_name2\} | $\{buyer2_company_name\} | $\{buyer2_location\}`;\
							if(review_title_string.length > 70)\
							\{\
								buyer1_company_name_full = buyer1_company_name;\
								buyer2_company_name = buyer2_company_name.substring(0,30) + '..';\
							\}\
							if(buyer2_product_name.length > 30)\
							\{\
								buyer2_product_name_full = buyer2_product_name;\
								buyer2_product_name = buyer2_product_name.substring(0,30) + '..';\
							\}\
						\}\
\
						var star_temp = `\
					   	<span style="position: relative;top: 2px;">\
						    <span style="width: 100px;font-size: 20px;">\
								<span class="FM_flsRt FM_pa" style="width: `+rating*20+`%;top: -3px;">
\f4 \'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef
\f0 </span>\
					   			<span class="FM_emsRt" style="color: #c5c4c3;">
\f4 \'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef
\f0 </span>\
							</span>\
						</span>\
						<span class="FM_ds1 FM_slr_rtng FM_pr">`;\
\
						if(Response_percent == -1 && Quality_percent == -1 && Delivery_percent == -1)\{\
							star_temp += `<span class="FM_bg0 FM_pa FM_p22 FM_br5 FM_ds5 FM_jcSb FM_ds7 FM_bs FM_c2 FM_sRtHvr" style="/*display:flex;*/left: -171px;width:630px;flex-direction: column;box-shadow: 0 0 5px #ccc;top:10px">`;\
						\} \
						else \{\
							star_temp += \
							`<span class="FM_bg0 FM_pa FM_p22 FM_br5 FM_ds5 FM_jcSb FM_ds7 FM_bs FM_c2 FM_sRtHvr" style="/*display:flex;*/left: -171px;width:630px;flex-direction: column;box-shadow: 0 0 5px #ccc;top:10px">`\
						\}\
						star_temp+=\
								`<div id="upperRatingDiv" style="">\
									<div class="FM_sRtHvrLft">`+\
										`<span class="FM_f24 slr_rate" title="` + rating + ` out of 5 stars"> `+ rating + `</span><span style="font-size:16px">/5</span> \
											<span class="FM_sRt  FM_pr FM_f18 FM_ds1"> \
											<span class="FM_flsRt FM_pa" style="width: ` + (rating * 100) / 5 + `%;margin-left:-1px;">
\f4 \'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef
\f0 </span> \
											<span class="FM_emsRt">
\f4 \'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef
\f0 </span> \
										</span> \
										<span class="FM_f14 FM_Db FM_mt5 colorLight" id="tot_rat">Reviewed by ` + total_count + ` Users</span> \
									</div>`;\
						if(Response_percent == -1 && Quality_percent == -1 && Delivery_percent == -1)\{\
							star_temp += `<div class="FM_sRtHvrRyt" style="border-left:none;display: flex;flex-direction: row;align-items: center;padding-left: 250px;">`;\
						\} \
						else \{ \
							star_temp += `<div class="FM_sRtHvrRyt" style="border-left:none;padding-left:0px;display: flex;flex-direction: row;align-items: center;padding-left:10px;">`;\
						\}\
						star_temp+= \
\
						`<div class="rHover_starCount">\
							<div class="FM_pbarS colorLight rHover_f14 rHover_starMB5" style="width:48px;">5 stars</div> \
							<div class="FM_pbarS colorLight rHover_f14 rHover_starMB5 ">4 stars</div> \
							<div class="FM_pbarS colorLight rHover_f14 rHover_starMB5 ">3 stars</div> \
							<div class="FM_pbarS colorLight rHover_f14 rHover_starMB5 ">2 stars</div> \
							<div class="FM_pbarS colorLight rHover_f14 rHover_starMB5 ">1 star</div> \
						</div>\
						\
						<div class="rHover_StarsBars" style="width:120px">\
							<div class="FM_pbarC FM_pr rHoverbars" style=""> \
								<span class="FM_pbarL FM_pbarTeal5 FM_pa Str_5 rHoverbars" style="width: ` + (five_star_count * 100) / total_count + `%;background-color:#72ae44;"></span> \
							</div>\
							<div class="FM_pbarC FM_pr rHoverbars" style=""> \
								<span class="FM_pbarL FM_pbarTeal5 FM_pa Str_5 rHoverbars" style="width: ` + (four_star_count * 100) / total_count + `%;background-color:#72ae44;"></span> \
							</div>\
							<div class="FM_pbarC FM_pr rHoverbars" style=""> \
								<span class="FM_pbarL FM_pbarTeal5 FM_pa Str_5 rHoverbars" style="width: ` + (three_star_count * 100) / total_count + `%;background-color:#72ae44;"></span> \
							</div>\
							<div class="FM_pbarC FM_pr rHoverbars" style=""> \
								<span class="FM_pbarL FM_pbarTeal5 FM_pa Str_5 rHoverbars" style="width: ` + (two_star_count * 100) / total_count + `%;background-color:#72ae44;"></span> \
							</div>\
							<div class="FM_pbarC FM_pr rHoverbars" style="margin-bottom:0px;"> \
								<span class="FM_pbarL FM_pbarTeal5 FM_pa Str_5 rHoverbars" style="width: ` + (one_star_count * 100) / total_count + `%;background-color:#72ae44;"></span> \
							</div>\
						</div>`;\
						if(in_percentage == 1)\
						\{\
							star_temp += `<div class="rHover_ratingsCount" style="margin-right: 1.5ex">\
								<div class="FM_f12 colorLight rHover_f14 rHover_starMB5 ">` + five_star_percentage + `</div> \
								<div class="FM_f12 colorLight rHover_f14 rHover_starMB5 ">` + four_star_percentage + `</div> \
								<div class="FM_f12 colorLight rHover_f14 rHover_starMB5 ">` + three_star_percentage + `</div> \
								<div class="FM_f12 colorLight rHover_f14 rHover_starMB5 ">` + two_star_percentage + `</div> \
								<div class="FM_f12 colorLight rHover_f14 rHover_starMB5 ">` + one_star_percentage + `</div> \
							</div>`;\
						\}\
						else\
						\{\
							star_temp += `<div class="rHover_ratingsCount">\
								<div class="FM_f12 colorLight rHover_f14 rHover_starMB5 ">` + five_star_count + `</div> \
								<div class="FM_f12 colorLight rHover_f14 rHover_starMB5 ">` + four_star_count + `</div> \
								<div class="FM_f12 colorLight rHover_f14 rHover_starMB5 ">` + three_star_count + `</div> \
								<div class="FM_f12 colorLight rHover_f14 rHover_starMB5 ">` + two_star_count + `</div> \
								<div class="FM_f12 colorLight rHover_f14 rHover_starMB5 ">` + one_star_count + `</div> \
							</div>`;\
						\}\
\
						star_temp += `</div>`;\
						if(Response_percent == -1 && Quality_percent == -1 && Delivery_percent == -1)\{\
							//Don't display the User Satisfaction part\
						\}\
						else\{\
							star_temp += `<div class="FM_sRtHvrThumbs" style="border-left: 1px solid #dcdcdc;">\
								<span class style="font-size:15px; font-weight:700;">User Satisfaction</span>\
								<div style="display:flex;font-size:14px;padding-top: 10px;">\
									<div style="display: flex;flex-direction: column;">`;\
										if (Response_percent != -1) star_temp+= `<span class="rHover_influNames colorLight rHover_f14">Response</span>`;\
										if (Quality_percent != -1) star_temp+= `<span class="rHover_influNames colorLight rHover_f14">Quality</span>`;\
										if (Delivery_percent != -1) star_temp+= `<span class="rHover_influNames colorLight rHover_f14">Delivery</span>`;\
								star_temp += `</div>\
									<div style="display: flex;flex-direction: column;padding-top:2px">`;\
									if (Response_percent != -1) star_temp+= `\
										<span class="FM_pbarC FM_pr rHoverbars" style="margin-bottom:11px"> \
											<span class="FM_pbarL FM_pbarTeal5 FM_pa Str_5 rHover_influBars" style="width: ` + Response_percent + `%;"></span> \
										</span>`;\
									if (Quality_percent != -1) star_temp+= `\
										<span class="FM_pbarC FM_pr rHoverbars" style="margin-bottom:11px"> \
											<span class="FM_pbarL FM_pbarTeal5 FM_pa Str_5 rHover_influBars" style="width: ` + Quality_percent + `%;"></span> \
										</span>`;\
									if (Delivery_percent != -1) star_temp+= `\
										<span class="FM_pbarC FM_pr rHoverbars" style=""> \
											<span class="FM_pbarL FM_pbarTeal5 FM_pa Str_5 rHover_influBars" style="width: ` + Delivery_percent + `%;"></span> \
										</span>`; \
									star_temp += `</div>\
									<div style="display: flex;flex-direction: column;">`;\
									if (Response_percent != -1) star_temp+= `<span class="rHover_influNames colorLight rHover_f14">` + Response_percent + `%</span>`;\
									if (Quality_percent != -1) star_temp+= `<span class="rHover_influNames colorLight rHover_f14">` + Quality_percent + `%</span>`;\
									if (Delivery_percent != -1) star_temp+= `<span class="rHover_influNames colorLight rHover_f14">` + Delivery_percent + `%</span>`;\
									star_temp+=`</div>\
								</div></div>`;\
						\}\
							star_temp+=	`						\
							</div><div id="LowerRatingsDiv" style="">`;\
								if (data.comment1 != '' && data.comment1 != undefined && data.comment1 != null)\{ star_temp +=\
									`<div class="RatingComment_div" id="RatingComment1" style="padding-bottom:10px; position: relative;">\
										<div class="rHover_commentIcon">`+buyer_name1.substring(0,1)+`</div>`;\
										if (/*(buyer_comment1 == '' || buyer_comment1 == undefined || buyer_comment1 == null) &&*/ rating_influ1 == '')\{\
											star_temp += `<div class="rHover_commentInfo colorLight rHover_f14" id="comment1_info" style="margin-top:8px;">`;\
										\}\
										else \{\
											star_temp += `<div class="rHover_commentInfo colorLight rHover_f14" id="comment1_info" style="">`;\
										\}\
										star_temp +=\
											`<p class="rHover_nameRating" style="">\
												<span class="rHover_buyerName" style="">`+buyer_name1+`</span><span title="$\{buyer1_company_name_full\}">`+buyer1_company_name+`</span>$\{buyer1_location != '' ? `<span> | $\{buyer1_location\}</span>` : ``\}\
											</p>\
											<div class="rHover_stars_product_name_date" style="display: flex; margin-top: 0.7ex">\
												<span class="sRt pdinb fs18 pd_tal pr" style="text-align: left;position: relative;unicode-bidi: bidi-override;font-size: 18px;display: block; color: #ccc;margin: 0;padding: 0;">\
													<span class="flsRt pd_l0 abslt rHover_gStars" style="width:`+20*rating_val1+`%;"><span>
\f4 \'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef
\f0 </span></span>\
													<span class="emsRt" style="padding: 0;display: block;z-index: 0;"><span>
\f4 \'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef
\f0 </span></span>\
												</span>\
												$\{buyer1_product_name != '' ? `<span style="margin-left: 1ex;"> | Product Name: <span style="color: #2c2b2b;" title="$\{buyer1_product_name_full\}">$\{buyer1_product_name\}</span></span>` : ``\}\
												<span class="rHover_commentDate" style="position: absolute; right: 0.1ex; top: $\{date_top1\};">`+buyer_rating_date1+`</span>\
											</div>`;\
									if (rating_influ1 != '') star_temp += `<div class="rHover_commentInflu"id="rating_influ1" style="">`+rating_influ1+`</div>`;\
									if (buyer_comment1 != '')\
									\{\
										if(buyer_comment1.length > 251) buyer_comment1 = buyer_comment1.substring(0, 251);\
									 	star_temp += `<p class="rHover_commentText"style="word-break: break-all;">`+buyer_comment1+`</p>`;\
									\}\
									star_temp +=	`</div>\
									</div>`;  \
								\}\
								if (data.comment2 != '' && data.comment2 != undefined && data.comment2 != null)\{ star_temp += \
									`<div class="RatingComment_div" id="RatingComment2" style="position: relative;">\
										<div class="rHover_commentIcon">`+buyer_name2.substring(0,1)+`</div>\
										`;\
										if (/*(buyer_comment2 == '' || buyer_comment2 == undefined || buyer_comment2 == null) &&*/ rating_influ2 == '')\{\
											star_temp += `<div class="rHover_commentInfo colorLight rHover_f14" id="comment2_info" style="margin-top:8px;">`;\
										\}\
										else \{\
											star_temp += `<div class="rHover_commentInfo colorLight rHover_f14" id="comment2_info" style="">`;\
										\}\
										star_temp +=\
											`<p class="rHover_nameRating" style="">\
												<span class="rHover_buyerName" style="">`+buyer_name2+`</span><span title="$\{buyer2_company_name_full\}"">`+buyer2_company_name+`</span>$\{buyer2_location != '' ? `<span> | $\{buyer2_location\}</span>` : ``\}\
											</p>\
											<div class="rHover_stars_product_name_date" style="display: flex; margin-top: 0.7ex">\
												<span class="sRt pdinb fs18 pd_tal pr" style="text-align: left;position: relative;unicode-bidi: bidi-override;font-size: 18px;display: block;color: #ccc;margin: 0;padding: 0;">\
													<span class="flsRt pd_l0 abslt rHover_gStars" style="width:`+20*rating_val2+`%;"><span>
\f4 \'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef
\f0 </span></span>\
													<span class="emsRt" style="padding: 0;display: block;z-index: 0;"><span>
\f4 \'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef
\f0 </span></span>\
												</span>\
												$\{buyer2_product_name != '' ? `<span style="margin-left: 1ex;"> | Product Name: <span style="color: #2c2b2b;" title="$\{buyer2_product_name_full\}">$\{buyer2_product_name\}</span></span>` : ``\}\
												<span class="rHover_commentDate"style="position: absolute; right: 0.1ex; top: $\{date_top2\}">`+buyer_rating_date2+`</span>\
											</div>`; \
										if (rating_influ2 != '') star_temp += `<div class="rHover_commentInflu"id="rating_influ2" style="">` +rating_influ2+`</div>`;\
										if (buyer_comment2 != '')\
										\{\
											if(buyer_comment2.length > 251) buyer_comment2 = buyer_comment2.substring(0, 251);\
											star_temp += `<p class="rHover_commentText"style="word-break: break-all;">`+buyer_comment2+`</p>`;\
										\} \
									star_temp +=	`</div>\
									</div>`;\
									star_temp += `<p class="p_txtr" id ="p_txtr"></p>`;\
								\
								\
								\}\
								star_temp +=\
								`</div>\
						</span> \
					</span>`;\
							// \}\
							// else\{\
							// 	star_temp = '<span class="bg-msg-1 ico Msg-star FM_ds1 FM_slr_rtng FM_pr"> <span class="FM_bg0 FM_pa FM_p22 FM_br5 FM_ds5 FM_jcSb FM_ds7 FM_bs FM_c2 FM_sRtHvr"> <span class="FM_sRtHvrLft"> <span class="FM_f24 slr_rate" title="' + rating + ' out of 5 stars">' + rating + '</span>/5 <span class="FM_sRt  FM_pr FM_f18 FM_ds1"> <span class="FM_flsRt FM_pa" style="width: ' + (rating * 100) / 5 + '%;">
\f4 \'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef
\f0 </span> <span class="FM_emsRt">
\f4 \'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef\'a1\'ef
\f0 </span> </span> <span class="FM_f14 FM_Db FM_mt5" id="tot_rat">Rated by ' + total_count + ' Buyers</span> </span> <span class="FM_sRtHvrRyt FM_ml15"> <span class="FM_ds7 FM_f14 FM_ds5 FM_m13"> <span class="FM_pbarS ">5
\f4 \'a1\'ef
\f0 </span> <span class="FM_pbarC FM_pr"> <span class="FM_pbarL FM_pbarTeal5 FM_pa Str_5" style="width: ' + (five_star_count * 100) / total_count + '%;"></span> </span> <span class="FM_f12">' + five_star_count + '</span> </span> <span class="FM_ds7 FM_f14 FM_ds5 FM_m13"> <span class="FM_pbarS ">4
\f4 \'a1\'ef
\f0 </span> <span class="FM_pbarC FM_pr"> <span class="FM_pbarL FM_pbarTeal4 FM_pa Str_4" style="width: ' + (four_star_count * 100) / total_count + '%;"> </span></span><span class="FM_f12">' + four_star_count + '</span></span> <span class="FM_ds7 FM_f14 FM_ds5 FM_m13"><span class="FM_pbarS ">3
\f4 \'a1\'ef
\f0 </span><span class="FM_pbarC FM_pr"><span class="FM_pbarL FM_pbarTealL FM_pa Str_3" style="width: ' + (three_star_count * 100) / total_count + '%;"></span></span><span class="FM_f12">' + three_star_count + '</span></span> <span class="FM_ds7 FM_f14 FM_ds5 FM_m13"><span class="FM_pbarS ">2
\f4 \'a1\'ef
\f0 </span><span class="FM_pbarC FM_pr"><span class="FM_pbarL FM_pbarOrng FM_pa Str_2" style="width: ' + (two_star_count * 100) / total_count + '%;"></span></span><span class="FM_f12">' + two_star_count + '</span></span> <span class="FM_ds7 FM_f14 FM_ds5 FM_m13"><span class="FM_pbarS ">1
\f4 \'a1\'ef
\f0 </span><span class="FM_pbarC FM_pr"><span class="FM_pbarL  FM_pbarRed FM_pa Str_1" style="width: ' + (one_star_count * 100) / total_count + '%;"></span></span><span class="FM_f12">' + one_star_count + '</span></span> </span> </span> </span>';\
							// \}\
				try\{\
				$('#rating_count').html(rating + ' / 5' + star_temp);\
				addviewmore(total_count);\
				\}\
				catch(err)\{\
					console.log('Handled error = ' + err);\
					document.getElementById('rating_count').innerHTML = rating + ' / 5' + star_temp; \
				\}\
				$('#rating_count').css(\{\
					display: "block",\
					fontWeight: "bold"\
				\});\
\
				document.getElementById('rating_count').addEventListener('mouseenter', e => \{\
					\
					getGAEventTrackingJS("Messages","Rating_Hover",'Buyer_My');\
				  \});\
\
				if (document.getElementById("website") == null || $("#website").length == 0 || document.getElementById("website").innerHTML == "")\{\
					$("#left-name").css("margin-top", "8px");\
				\}\
			\}\
		\}\
	\});\
\}\
\
function enqDetail(loginglid, type, contactglid, name, mobile) \{\
	var bname = $("#bn").val();\
	var b_w = $('#b_n').width();\
	$('#s_n_s').html(name + "  ");\
	var s_w = $('#s_n').width();\
	$.ajax(\{\
		url: "/phpajax/enquiry/messagecentre/enquiryListing",\
		data: \{\
			"logingid": loginglid,\
			"contactglid": contactglid,\
			"type": type,\
			"name": name,\
			"bname": bname,\
			"b_w": b_w,\
			"s_w": s_w,\
			"mobile": mobile\
		\},\
		dataType: "html",\
		type: "GET",\
		success: function(jsonResult) \{\
			//                         getMessageCounter(contactglid);\
			$('#contactglid').val(contactglid);\
			$('#enqdet').html(jsonResult);\
			// bindClickFunctionToReminders();\
		\}\
	\});\
	get_rateSupplier();\
\}\
\
function scrollable() \{\
	$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight);\
\}\
\
function addContact(glid) \{\
	var name = $('#addContactName').val();\
	var mobile = $('#addContactMobile').val();\
	var contact_type = "1";\
	var country_code = $('#cntry_code').html();\
	var bar_flag = 0;\
	var country_code = country_code.replace('+', '');\
	var c_count = parseInt($('#contactcount').val())\
	$('#add-contact-error').html("");\
	name = name.trim();\
	if(name.trim() == '') \{\
		$("#error_nme").show();\
		$("#error_mob").hide();\
		$("#error_nme").html('Please enter your name');\
		return false;\
	\} else if(!name.match('^[a-zA-Z][a-zA-Z ]+[0-9]*$')) \{\
		$("#error_nme").show();\
		$("#error_mob").hide();\
		$("#error_nme").html('Please enter a valid name ');\
		return false;\
	\} else if(name.length > 30) \{\
		$("#error_nme").show();\
		$("#error_mob").hide();\
		$("#error_nme").html('Name should not exceed 30 characters ');\
		return false;\
	\} else if(mobile == '') \{\
		$("#error_nme").hide();\
		$("#error_mob").show();\
		return false;\
	\} else if(country_code == '91' && !mobile.match('^[6-9][0-9]\{9\}$')) \{\
		if(!mobile.match('[0-9]\{10\}')) \{\
			if(mobile.length < 10) \{\
				$("#error_mob").show();\
				$("#error_nme").hide();\
				$("#error_mob").html('Please enter 10 digits mobile number.');\
			\} else \{\
				$("#error_mob").show();\
				$("#error_nme").hide();\
				$("#error_mob").html('Please enter digits only');\
			\}\
		\} else if(!mobile.match('^[6-9]')) \{\
			$("#error_mob").show();\
			$("#error_nme").hide();\
			$("#error_mob").html('Mobile Number should start with 6,7,8 or 9.');\
		\}\
	\} else if(country_code != '91' && !mobile.match('^[0-9]\{5,16\}$')) \{\
		$("#error_mob").show();\
		$("#error_nme").hide();\
		$("#error_mob").html('Please enter valid mobile number');\
	\} else if($('#addContactNote').val().trim().length > 200) \{\
		$("#add-contact-error").show();\
		$("#add-contact-error").html('*Note length should not be more than 200 characters.');\
		byId('add-contact-error').style.display = "block";\
	\} else \{\
		$("#error_nme").hide();\
		$("#error_mob").hide();\
		var location_obj = getLocationDetailOfUser();\
		if(location_obj.IP_COUNTRY === '' || location_obj.GEOIP_COUNTRY_ISO === '' || location_obj.IPADDRESS === '') \{\
			console.log("LOCATION DETAILS NOT PRESENT !!\\nCannot add the contact.");\
			$('#add-contact-error').html("* Location error, Try again.");\
			return;\
		\}\
		$("#add-icnload").show();\
		$.ajax(\{\
			url: '/phpajax/enquiry/messagecentre/addContact',\
			data: \{\
				"gluserid": glid,\
				"mobile": mobile,\
				"phcode": country_code,\
				"name": name,\
				"ip_country": location_obj.IP_COUNTRY,\
				"geoip_country_iso": location_obj.GEOIP_COUNTRY_ISO,\
				"ip_address": location_obj.IPADDRESS\
			\},\
			dataType: "JSON",\
			type: "GET",\
			success: function(result) \{\
				var res = result.split(':');\
				var code = res[0];\
				var id = res[1];\
				$('#contactcount').val(c_count);\
				$('#contact_count').text("(" + c_count + " contacts)");\
				var changename = name.split(" ", 1);\
				if(code == 1) \{\
					setTimeout(function() \{\
						if($('#addContactNote') !== undefined && $('#addContactNote') !== null && $('#addContactNote').val().trim() !== "") \{\
							setNote(1, 'C', $('#addContactNote').val(), glid, id); // Set Note\
						\}\
						// defaultListing(glid,bar_flag);\
						var searched_contact = \{\
							"contacts_glid": glid,\
							"contacts_name": name,\
							"contacts_mobile1": mobile\
						\};\
						list.unshift(searched_contact);\
						var dom_id = parseInt(document.getElementById('end').value);\
						var li_elem = createSingleContactHtml(dom_id, searched_contact);\
						var fetchList = document.getElementById("fetch_list");\
						fetchList.insertBefore(li_elem["li"], fetchList.childNodes[0]);\
						document.getElementById(dom_id).innerHTML = li_elem['skeleton'];\
						document.getElementById('end').value = dom_id + 1;\
						//displaycontact(0);\
						$("#intro_page").hide();\
						//rightDetails(glid,mobile,id,contact_type);\
						setTimeout(function() \{\
							$('#success').fadeOut('slow', function() \{\});\
						\}, 1000);\
						setTimeout(function() \{\
							$($("#fetch_list li")[0]).click();\
						\}, 3000);\
						$('#pop_show_hide').hide();\
						$('#alrexist').hide();\
						$("#intro_page").hide();\
						$("#add-icnload").hide();\
						$('#success').show();\
						$('#addContactName').val('');\
						$('#addContactMobile').val('');\
					\}, 2000);\
					c_count++;\
				\} else if(code == 2) \{\
					var existing_name = res[2];\
					$('#pop_show_hide').hide();\
					$('#loadingadd').hide();\
					$('#alreadyExist').html("You already have a contact <span style='font-weight:bold'>" + existing_name + " </span> with the same mobile number.");\
					$('#alrexist').show();\
					$('#success').hide();\
					$('#addContactName').val('');\
					$('#addContactMobile').val('');\
					$("#add-icnload").hide();\
				\} else if(code == 0) \{\
					$('#add-contact-error').html("*User cannot be created. Please try again later.");\
					$("#add-icnload").hide();\
				\}\
			\},\
			error: function() \{\
				$("#add-icnload").hide();\
				$('#add-contact-error').html("*User cannot be created. Please try again later.");\
			\}\
		\});\
	\}\
	category = 'messagecentre';\
	trackEvent(category, 'addContact');\
\}\
\
function addcontactShow() \{\
	$('#alrexist').hide();\
	$('#success').hide();\
	$('#pop_show_hide').toggle();\
	$("#addContactName").focus();\
	var glid = $("#trackid").val();\
	$(document).keypress(function(e) \{\
		if(e.which == 13) \{\
			addContact(glid);\
		\}\
	\});\
	category = 'addressbook'\
	trackEvent(category, 'addClick');\
\}\
\
function addContactNewUser(glid) \{\
	var name = $('#addContactName').val();\
	var mobile = $('#addContactMobile').val();\
	contact_type = "1";\
	var country_code = $('#cntry_code').html();\
	country_code = country_code.replace('+', '');\
	if(name.trim() == '') \{\
		$("#error_nme").show();\
		$("#error_mob").hide();\
		$("#error_nme").html('Please enter your name');\
		return false;\
	\} else if(!name.match('^[a-zA-Z][a-zA-Z ]+[0-9]*$')) \{\
		$("#error_nme").show();\
		$("#error_mob").hide();\
		$("#error_nme").html('Please enter a valid name ');\
		return false;\
	\} else if(name.length > 30) \{\
		$("#error_nme").show();\
		$("#error_mob").hide();\
		$("#error_nme").html('Name should not exceed 30 characters ');\
		return false;\
	\} else if(mobile == '') \{\
		$("#error_nme").hide();\
		$("#error_mob").show();\
		return false;\
	\} else if(country_code == '91' && !mobile.match('^[6-9][0-9]\{9\}$')) \{\
		if(!mobile.match('[0-9]\{10\}')) \{\
			if(mobile.length < 10) \{\
				$("#error_mob").show();\
				$("#error_nme").hide();\
				$("#error_mob").html('Please enter 10 digits mobile number.');\
			\} else \{\
				$("#error_mob").show();\
				$("#error_nme").hide();\
				$("#error_mob").html('Please enter digits only');\
			\}\
		\} else if(!mobile.match('^[6-9]')) \{\
			$("#error_mob").show();\
			$("#error_nme").hide();\
			$("#error_mob").html('Mobile Number should start with 6,7,8 or 9.');\
		\}\
	\} else if(country_code != '91' && !mobile.match('^[0-9]\{5,16\}$')) \{\
		$("#error_mob").show();\
		$("#error_nme").hide();\
		$("#error_mob").html('Please enter valid mobile number');\
	\} else \{\
		$("#error_nme").hide();\
		$("#error_mob").hide();\
		var location_obj = getLocationDetailOfUser();\
		if(location_obj.IP_COUNTRY === '' || location_obj.GEOIP_COUNTRY_ISO === '' || location_obj.IPADDRESS === '') \{\
			console.log("LOCATION DETAILS NOT PRESENT !!\\nCannot add the contact.");\
			$('#add-contact-error').html("** Location error, Try again.");\
			return;\
		\}\
		var url = '/phpajax/enquiry/messagecentre/addContactNewUser';\
		$(".add_contact_pop").hide();\
		$(".cntnw_process").show();\
		$.ajax(\{\
			url: url,\
			data: \{\
				"gluserid": glid,\
				"mobile": mobile,\
				"phcode": country_code,\
				"name": name,\
				"ip_country": location_obj.IP_COUNTRY,\
				"geoip_country_iso": location_obj.GEOIP_COUNTRY_ISO,\
				"ip_address": location_obj.IPADDRESS\
			\},\
			dataType: "html",\
			type: "GET",\
			success: function(result) \{\
				window.location = window.location.href;\
			\},\
			failure: function() \{\
				alert('something went wrong here');\
			\}\
		\});\
	\}\
	category = 'messagecentre';\
	trackEvent(category, 'addContactNewUser');\
\}\
\
function defaultListing(loginglid, bar_flag) \{\
	var start = 1;\
	var end = 50;\
	var url = '/phpajax/enquiry/messagecentre/DefaultListing';\
	$('#start').val(start);\
	$('#end').val(end);\
	$("#infinitescroll").val('1');\
	$.ajax(\{\
		url: url,\
		data: \{\
			"logingid": loginglid,\
		\},\
		dataType: "html",\
		type: "GET",\
		success: function(jsonResult) \{\
			$('#left_list').html(jsonResult);\
			$("#left_ad_listng").height(screen.height - 350 + "px");\
			if(bar_flag == 1) \{\
				$('#myProgress').html("");\
			\}\
			addScrollEventOnContact();\
			onclickFocus();\
			hideScroller();\
			if(typeof displayContactsAsOnline === "function") \{\
				displayContactsAsOnline();\
			\} //XMPP code will be implemented again later\
		\}\
	\});\
\}\
\
function rightDetails(loginglid, mobile, contactglid, contact_type) \{\
	$("#massage-text").val('');\
	$(".msg-placeholder").show();\
	addajax_url = "/phpajax/enquiry/messagecentre/ContactDetail";\
	var edit = 1;\
	$.ajax(\{\
		url: addajax_url,\
		data: \{\
			"logingid": loginglid,\
			"mobile": mobile,\
			"action": edit,\
			"contactglid": contactglid,\
			"type": contact_type\
		\},\
		dataType: "html",\
		type: "GET",\
		success: function(jsonResult) \{\
			$('#testing').html(jsonResult);\
			//                 updateContactNameHeader();\
			UpdateHeaderNew();\
			tab_higlight_conv = 0;\
		\},\
		error: function(err) \{\
			if(err.status == '400' || err.status == '401' || err.status == '402' || err.status == '403') \{\
				window.location.reload(true);\
			\}\
		\}\
	\});\
\}\
\
function editDetails(loginglid, contact_glid, im_contactid, contact_type) \{\
	var name = $("#ed_name").val() ? htmlEscape($("#ed_name").val()) : '';\
	var mobile = $("#ed_mob").val();\
	var email1 = $("#ed_email").val();\
	var phone1 = $("#ed_ph_number").val() ? $("#ed_ph_number").val() : '';\
	var company = $("#ed_company").val() ? htmlEscape($("#ed_company").val()) : '';\
	var website = $("#ed_website").val() ? $("#ed_website").val() : '';\
	var address = $("#ed_address").val() ? htmlEscape($("#ed_address").val()) : '';\
	var email2 = $("#ed_email_sec").val();\
	var phone2 = $("#ed_ph_number_sec").val() ? $("#ed_ph_number_sec").val() : '';\
	var mobile2 = $("#ed_mob_sec").val();\
	var designation = $("#edit_desig").val() ? htmlEscape($("#edit_desig").val()) : '';\
	var phcountry = $("#countrycode").html();\
	var phcountry = phcountry.replace('+', '');\
	var phonearea = $("#ph_area").val() ? $("#ph_area").val() : '';\
	var ph_area_sec = $("#ph_area_sec").val() ? $("#ph_area_sec").val() : '';\
	var city = $("#ed_city").val();\
	var state = $("#ed_state").val();\
	var pincode = $("#ed_pincode").val();\
	$('#edit_adbook input').removeClass('err-active');\
	$("#edt_error").show();\
	$("#edt_error").html("");\
	if(name == '') \{\
		$("#edt_error").html('Name cannot be blank.');\
		$("#ed_name").addClass('err-active');\
		return false;\
	\} else if(mobile == '') \{\
		$("#edt_error").html('Mobile cannot be blank.');\
		$("#ed_mob").addClass('err-active');\
		return false;\
	\} else if(phcountry == '91' && mobile.slice(0, 1) == 0 && !mobile.match('^[0-9]\{11\}$')) \{\
		$("#edt_error").html('Please enter valid mobile number.');\
		$("#ed_mob").addClass('err-active');\
	\} else if(phcountry == '91' && mobile.slice(0, 1) != 0 && !mobile.match('^[0-9]\{10\}$')) \{\
		$("#edt_error").html('Please enter valid mobile number.');\
		$("#ed_mob").addClass('err-active');\
	\} else if(phcountry != '91' && !mobile.match('^[0-9]\{5,16\}$')) \{\
		$("#edt_error").html('Please enter valid mobile number.');\
		$("#ed_mob").addClass('err-active');\
	\}\
	/*else if(email1 != ""  &&  !validateEmail(email1))\{\
	    $("#edt_error").html('Please enter valid Email ID.');  \
	    $("#ed_email").addClass('err-active');\
	\}\
	else if(email1.trim() !== '' && email2.trim() !== '' && email1.trim().toLowerCase() === email2.trim().toLowerCase())\{\
	    $("#edt_error").html('Primary and Secondary Email ID should be different.');  \
	    $("#ed_email").addClass('err-active');\
	\}\
	else if(mobile.trim().toLowerCase() === mobile2.trim().toLowerCase())\{\
	    $("#edt_error").html('Primary and Secondary mobile number should be different.');  \
	    $("#ed_mob").addClass('err-active');\
	\}*/\
	else if((phone1) != "" && !phone1.match('^[0-9]\{5,10\}$')) \{\
		$("#edt_error").html('Please enter valid primary phone.');\
		$("#ed_ph_number").addClass('err-active');\
	\}\
	/*else if(mobile2 != '' && (phcountry) == '91' && !mobile2.match('^[0-9]\{10\}$')) \{\
	    $("#edt_error").html('Please enter valid alternate mobile number.');  \
	    $("#ed_mob_sec").addClass('err-active');\
	\}\
	else if(mobile2 != '' && phcountry != '91' && !mobile2.match('^[0-9]\{5,16\}$')) \{\
	    $("#edt_error").html('Please enter valid alternate mobile number.');  \
	    $("#ed_mob_sec").addClass('err-active');\
	\}\
	else if( email2 != "" && (!validateEmail(email2)))\{\
	    $("#edt_error").html('Please enter valid alternate Email ID.');  \
	    $("#ed_email_sec").addClass('err-active');\
	\}*/\
	else if(phonearea != '' && (!phonearea.match('^[0-9]\{2,4\}$'))) \{\
		$("#edt_error").html('Please enter a valid phone area.');\
		$("#ph_area").addClass('err-active');\
	\} else if(ph_area_sec != "" && ph_area_sec != phonearea) \{\
		$("#edt_error").html('Alternate phone area should be same as primary.');\
		$("#ph_area_sec").addClass('err-active');\
	\} else if(phone1 == '' && phone2 != "") \{\
		$("#edt_error").html('Please enter primary phone first.');\
		$("#ed_ph_number").addClass('err-active');\
	\} else if(phone2 != "" && (!phone2.match('^[0-9]\{5,10\}$'))) \{\
		$("#edt_error").html('Please enter valid alternate phone.');\
		$("#ed_ph_number_sec").addClass('err-active');\
	\} else if(website != '' && !validateUrl(website)) \{\
		$("#edt_error").html('Please enter valid Website URL.');\
		$("#ed_website").addClass('err-active');\
	\} else if(city != '' && !city.match(/^[A-Za-z . ,'-]+$/)) \{\
		$("#edt_error").html('Please enter valid City.');\
		$("#ed_city").addClass('err-active');\
	\} else if(state != '' && !state.match(/^[A-Za-z . ,'-]+$/)) \{\
		$("#edt_error").html('Please enter valid State.');\
		$("#ed_state").addClass('err-active');\
	\} else if(pincode != '' && !pincode.match('^[0-9]\{6\}$')) \{\
		$("#edt_error").html('Please enter valid pincode.');\
		$("#ed_pincode").addClass('err-active');\
	\} else \{\
		$("#edt_error").hide();\
		$.ajax(\{\
			url: '/phpajax/enquiry/messagecentre/EditContact',\
			data: \{\
				"glusrid": loginglid,\
				"contacts_name": name,\
				"contacts_mobile": mobile,\
				"contacts_email1": email1,\
				"contacts_phone1": phone1,\
				"contacts_company": company,\
				"contacts_website": website,\
				"contacts_address": address,\
				"contacts_mobile2": mobile2,\
				"contacts_email2": email2,\
				"contacts_phone2": phone2,\
				"contact_ph_country": phcountry,\
				"contact_ph_area": phonearea,\
				"contact_city": city,\
				"contact_state": state,\
				"contact_pincode": pincode,\
				"im_contactid": im_contactid,\
				"contacts_title": designation,\
				"contact_type": contact_type\
			\},\
			dataType: "html",\
			type: "GET",\
			success: function(result) \{\
				if(result == 1) \{\
					// Close the Detail section of contact.\
					// toggleContactPersonalDetails();\
					// For changing the header text of right section.\
					//                         updateContactNameHeader();\
					UpdateHeaderNew();\
					// Re-initialize the Contact list, Contact Detals and Right section details.\
					refreshContactList();\
					// Close the modal pop up.\
					closeEdit(loginglid, mobile, contact_glid, im_contactid, contact_type);\
					// Update the global "list" variable with the updated data.\
				\} else \{\
					console.log("some error occured try again");\
				\}\
			\}\
		\});\
	\}\
	category = 'messagecentre';\
	trackEvent(category, 'editContact');\
\}\
/* To update the contact name on header */\
function updateContactNameHeader() \{\
	var c_name = $("#ed_name").val() ? htmlEscape($("#ed_name").val()) : "Buyer";\
	var c_company = $("#ed_company").val() ? htmlEscape($("#ed_company").val()) : '';\
	var c_city = $("#ed_city").val() ? htmlEscape($("#ed_city").val()) : '';\
	var c_state = $("#ed_state").val() ? htmlEscape($("#ed_state").val()) : '';\
	var c_country = $("#recv_country").val() ? htmlEscape($("#recv_country").val()) : '';\
	var c_mob = $('#recv_mob').val() ? htmlEscape($('#recv_mob').val()) : '';\
	var is_fraud = $('#fraud').val() ? $('#fraud').val() : '';\
	var c_url = $("#ed_website").val() ? htmlEscape($("#ed_company").val()) : '';\
	//var mob_icn         = '<i class="bg-msg ico Msg-phn" aria-hidden="true" style="font-size:12px; margin:0px 2px 0px 10px;"></i>';\
	//var mob_icn         = '<i class="fa fa-phone" aria-hidden="true" style="font-size:12px; margin:0px 2px 0px 10px; transform:rotate(44deg);"></i>';\
	//c_mob               = c_mob !== ""  ? mob_icn + '<span style="font-size:14px;font-weight: normal;">' + c_mob + '</span>' : '';\
	//var ratingspan = '<div id="sr1" class="porel"> </div>'; \
	/*if(c_country !== '' && c_country.toLowerCase() !== 'india')\{\
	    c_city = c_city  !== '' ? c_city + ", " + c_country : c_country ;\
	\}*/\
	if(is_fraud == 1) \{\
		openFraudAlert();\
		$(".send_button").css(\{\
			"background-color": "#999",\
			"cursor": "not-allowed"\
		\});\
		$("#msg-attch-send").css(\{\
			"background-color": "#999",\
			"cursor": "not-allowed"\
		\});\
		$(".bg-msg.ico.Msg-atc").css("cursor", "not-allowed");\
		//$(".sendbox-left-icn, .snd_quot, .quot_txt").css("cursor", "not-allowed");\
		$("#error_no_enq").remove();\
		//document.getElementById("rsrc_first_attch").disabled = true;\
		disabled_send_reply = true;\
		//verified_icn = '<span title="Fraud User" class="warning16" onclick="event.stopPropagation();openFraudAlert();"></span>'; //fraud icon instead of verified icon\
	\} else \{\
		disabled_send_reply = false;\
		$(".bg-msg.ico.Msg-atc").css("cursor", "pointer");\
		//$(".sendbox-left-icn, .snd_quot, .quot_txt").css("cursor", "pointer");\
		$(".send_button").css(\{\
			"cursor": "pointer"\
		\});\
		$("#msg-attch-send").css(\{\
			"background-color": "#999",\
			"cursor": "not-allowed"\
		\});\
		//document.getElementById("rsrc_first_attch").disabled = false;\
	\}\
	if(c_state !== '') \{\
		c_city = c_city !== '' ? c_city + ', ' + c_state : c_state;\
	\}\
	/*if(c_company !=="")\
	    var c_cmpny_city = c_city !== '' ? c_company + ', ' + c_city : c_company ;\
	else\
	    var c_cmpny_city = c_city ;*/\
	if(c_company !== "" && c_city !== '') \{\
		var head_c_cmpny_city = '<div><span style="font-weight: bold;float: left;margin-right: 5px;margin-top: 5px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;max-width: 575px;margin-left: 10px;" >' + c_company + '<span style="font-weight:100;"> ( ' + c_city + ' ) </span></span>';\
	\} else if(c_company !== "" || c_city !== '') \{\
		var c_cm_cty = c_company != '' ? c_company : c_city;\
		var head_c_cmpny_city = '<div><span style="font-weight: bold;float: left;margin-right:5px;margin-top:5px;white-space:nowrap;overflow: hidden;text-overflow:ellipsis;max-width: 575px;margin-left: 10px;" >' + c_cm_cty + '</span>';\
	\} else \{\
		var head_c_cmpny_city = '<div>';\
	\}\
	//var head_c_cmpny_city = c_cmpny_city !== "" ? '<div><i class="bg-msg msg_nvT" style = "background-position: -776px 104px;"></i><span style="font-weight: bold;float: left;margin-right: 10px;margin-top: 5px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;max-width: 575px;" >' + c_cmpny_city + '</span>' : '<div>';\
	var mob_icn = '<i class="bg-msg-1 ico Msg-phn" aria-hidden="true" style="font-size:12px; margin:0px 2px 0px 10px;width: 22px;"></i>';\
	c_mob = c_mob !== "" ? '<div style="float: right;">' + mob_icn + '<span style="font-size:17px;font-weight: bold;color: #02887D;line-height: 20px;">' + c_mob + '</span></div></div>' : '</div>';\
	//var header_name     = '<span style="font-weight: bold;float: left;margin-right: 5px;">' + c_name;\
	var header_name = c_name !== "" ? '<i class="bg-msg-1 msg_nvT" style = "background-position: -48px 0px;"></i><span style="float: left;margin-right: 15px;margin-top: 6px;font-weight: normal;font-size: 14px;line-height: 16px;" >' + c_name + '</span>' : '';\
	var ratingspan = '<span class="usRt" id= "rating_count" style="display:none;"></span>';\
	var c_cmpny_url = $('#Hdr-details').html();\
	c_cmpny_url = (c_cmpny_url != '' && c_cmpny_url != undefined) ? c_cmpny_url.trim() : '';\
	c_cmpny_url = '<div style="font-size: 14px;font-weight: normal;float: left;display: flex;padding-top: 4px;margin-right: 15px;line-height: 16px;">' + c_cmpny_url + '</div>';\
	var edit_option = '';\
	/*$('#edit_box').html();\
	         edit_option = (edit_option != '' && edit_option != undefined) ? edit_option.trim() : '';*/\
	var last_seen_span = $('#last_seen_span').html();\
	last_seen_span = (last_seen_span != '' && last_seen_span != undefined) ? last_seen_span.trim() : '';\
	last_seen_span = '<span id="last_seen_span" >' + last_seen_span + '</span>';\
	$('#newonline').html(last_seen_span);\
	var view_detail_icn = '';\
	if(c_company != '') \{\
		view_detail_icn = '<span id="view_detail_icn" onclick="show_prfile();">...view details</span>';\
	\}\
	var head_name_line_details = '<div id="name_sec" style="margin-top: 14px;margin-left: 5px;">' + header_name + c_cmpny_url + last_seen_span + view_detail_icn + '</div>';\
	/*if(c_company == '')\
	    $('#seller_profile').css("display","none");*/\
	//edit_option = '<div>'+edit_option+'</div>';\
	/*var header_company  = '';\
	if (c_company.trim() !== '' && c_city.trim() !== '')\
	    header_company =  c_company.trim()+', '+c_city.trim()  ;\
	else if (c_company.trim() === '' && c_city.trim() !== '')\
	    header_company =  c_city.trim()  ;\
	else if (c_company.trim() !== '' && c_city.trim() === '')\
	    header_company =  c_company.trim() ;\
	else\
	    header_company =  '' ;\
	 var header_company_span=''\
	    if(header_company!='')\
	  \
	 \{  header_company_span     = '<span class="cname-msg">' + header_company + '</span>'; \}*/\
	// $('#left-name').html(header_name + c_mob + '</span>' + view_detail_icn);\
	//$('#left-name').html("");\
	$('#left-name').html(head_c_cmpny_city + ratingspan + edit_option + c_mob + '<br>' + head_name_line_details);\
	if(c_company == "" && c_city == '') \{\
		$('#left-name').html(head_name_line_details);\
		$('#name_sec').append(ratingspan);\
		$('#name_sec').append(edit_option);\
		$('#name_sec').append(c_mob);\
		$('#name_sec').css("margin-top", "2px");\
	\}\
	//code to add company logo from the left list\
	var cmp_img = $(".user-name1.active div img").attr('src');\
	if(cmp_img == "") \{\
		/*var x = $(".user-name1.active div").css("background-image").slice(5,-2);\
		$(".cmp_logo_header").attr('src',x);*/\
		var nm_txt = '';\
		if(c_company != '') nm_txt = c_company.charAt(0).toUpperCase();\
		else nm_txt = c_name.charAt(0).toUpperCase();\
		$("#hdr_img").addClass('no_cmp_logo');\
		$("#hdr_img").addClass('no_cmp_logo_hdr');\
		$(".cmp_logo_header").css("display", "none");\
		$("#nm_txt").text(nm_txt);\
	\} else \{\
		$(".cmp_logo_header").attr('src', cmp_img);\
		$(".cmp_logo_header").css("display", "block");\
	\}\
	$(".right-section .header .left-name-details").css("width", "92%");\
	//$(".last-seen-span").html("99999999999999999");\
	//$(".last-seen-span").css("display","block");\
	//$('#Hdr-details').html("");\
	//$('#left-name').html(header_name + c_mob + ratingspan);\
	//$('#left-name').html(ratingspan);\
	/*$("#intro_name").html(c_name);\
	$("#sup_nam").html(c_name);\
	$("#left-name-details").html(header_company_span);*/\
\}\
\
function rediredtDetail(id) \{\
	category = 'messagecentre';\
	trackEvent(category, 'clickenquiry');\
	var url = '/enquiry/enquiryajax/openmail?mail=' + id;\
	window.open(url, '_blank');\
\}\
\
function reloadContactListAndContactDetails(loginglid, mobile, contactglid, im_contact_id, contact_type, name) \{\
	var bar_flag = 0;\
	mobile = $("#ed_mob").val();\
	contact_type = $("#contacttype").val();\
	$('#searchauto').val('');\
	defaultListing(loginglid, bar_flag);\
	setTimeout(function() \{\
		enqDetail(loginglid, contact_type, contactglid, name, mobile);\
	\}, 600);\
\}\
\
function closeEdit(loginglid, mobile, contactglid, im_contact_id, contact_type) \{\
	//rightDetails(loginglid, mobile, contactglid, contact_type);\
	category = 'messagecentre';\
	trackEvent(category, 'closeEdit');\
	$('#edit_adbook').hide();\
	$('#overlay_s').hide();\
\}\
//for Event and VPV track\
function trackVPV(category, event) \{\}\
\
function trackEvent(category, event) \{\
	lable = document.getElementById('trackid').value;\
	_gaq.push(['_trackEvent', category, event, lable]);\
\}\
\
function getshows(id) \{\
	document.getElementById(id).style.visibility = "visible";\
\}\
\
function gethide(id) \{\
	document.getElementById(id).style.visibility = "hidden";\
\}\
$(function() \{\
	$('#firstmail').live('click', function() \{\
		pagenav_event = 'First';\
	\});\
	$('#prevmail').live('click', function() \{\
		pagenav_event = 'Prev';\
	\});\
	$('#nextmail').live('click', function() \{\
		pagenav_event = 'Next';\
	\});\
	$('#lastmail').live('click', function() \{\
		pagenav_event = 'Last';\
	\});\
\});\
\
function trim(str) \{\
	if(str != undefined) return str.replace(/^\\s+|\\s+$/g, "");\
\}\
\
function validateEmail(sEmail) \{\
	var filter = /^([\\w-\\.]+)@((\\[[0-9]\{1,3\}\\.[0-9]\{1,3\}\\.[0-9]\{1,3\}\\.)|(([\\w-]+\\.)+))([a-zA-Z]\{2,4\}|[0-9]\{1,3\})(\\]?)$/;\
	if(filter.test(sEmail)) \{\
		return true;\
	\} else \{\
		return false;\
	\}\
\}\
\
function validateUrl(value) \{\
	var filter = /^(http:\\/\\/|https:\\/\\/)?(?:(?:(?:[a-z0-9]-*)*[a-z0-9]+)(?:\\.(?:[a-z0-9]-*)*[a-z0-9]+)*(?:\\.(?:[a-z]\{2,\})))(?::\\d\{2,5\})?(?:[/?#]\\S*)?$/i;\
	return filter.test(value);\
\}\
\
function toProperCase(name) \{\
	return name.replace(/\\w\\S*/g, function(txt) \{\
		return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();\
	\});\
\};\
\
function displaycontact_new(id) \{\
var li = document.getElementById('online-'+id).parentElement.parentElement.parentElement;\
if(li !== undefined && li !== null && li !== '') \{\
		var c_name = li.querySelector("span#c_name").innerText;\
		c_name = c_name !== undefined && c_name !== null && c_name !== '' ? c_name : 'Buyer';\
		pname = c_name;\
		var c_number = li.querySelector("span.c_num").innerText;\
		\
		c_number = c_number !== undefined && c_number !== null && c_number !== '' ? c_number.trim() : '';\
		\
		c_number = c_number != '' ? htmlEscape(c_number.slice(1, c_number.length - 1)) : '';\
		pphone_no = c_number;\
		var SB_flag = "";\
		if(document.getElementsByClassName('user-name1 active')[0].getElementsByClassName('init_flag')[0] != undefined) \{\
			var SB_flag = document.getElementsByClassName('user-name1 active')[0].getElementsByClassName('init_flag')[0].innerText;\
		\}\
		var c_company = li.querySelector("p.c_addr c_company").innerText;\
		var c_city = li.querySelector("p.c_addr c_city").innerText;\
		c_temp = c_city;\
		var c_state = li.querySelector("p.c_addr c_state").innerText;\
		var c_country = li.querySelector("p.c_addr c_country").innerText;\
		var c_cmpny_url = $('#recv_business_URL').val() ? $('#recv_business_URL').val() : '';\
		var c_email = $("#recv_email").val();\
		\
		c_number = c_number.replace(',', `&nbsp<b>Ext</b>&nbsp`); // &nbsp for white spaces\
		\
		if(c_state !== '' && c_state !== c_city) \{\
			c_city = c_city !== '' ? c_city + ', ' + c_state : c_state;\
		\}\
		if(c_name === 'Buyer' && c_company === '') \{\
			Comp_name_city = '';\
		\} else \{\
			//  c_company = c_company !== '' ? c_company : 'IndiaMART Seller' ;\
			if(c_company !== '') c_company = c_company;\
			else if(SB_flag == 0 && c_company == '') c_company = c_name;\
			else c_company = 'IndiaMART Seller';\
			Comp_name_city = '<div id = "tgts"><p class="fs18">' + c_company ;\
			comname = 'To:'+c_company+',' +c_temp;\
			//document.getElementById("compname").appendChild(document.createTextNode(c_company));\
			//console.log(c_company);\
\
           \
			\
		\}\
		var ratingspan = '<div class="mbt8 aic dflx fs13"  style="position: relative;top: 5px;"><span class="usRt" id= "rating_count" style="display:none;"></span> <span class="vline" id = "msgvline" style="display: none;position: relative;top: 2px; right:4px;">|</span>';\
		var mob_icon = '<span id = "tst"><svg class="mr5" width="26px" height="25px" style="position: relative;top: 2px;" viewBox="0 0 26 25" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Mobile Verified</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="option-8" transform="translate(-1099.000000, -181.000000)"><g id="Group-2" transform="translate(1099.000000, 181.000000)"><g id="Group-4-Copy" fill-rule="nonzero"><circle id="Oval" fill="#F4F4F4" cx="12.3157895" cy="12.3157895" r="12.3157895"></circle><g id="phone_android-24px" transform="translate(6.000000, 3.000000)" fill="#666666"><path d="M8.84210526,0 L2.41148325,0 C1.07712918,0 0,1.07712918 0,2.41148325 L0,15.2727272 C0,16.6070814 1.07712918,17.6842105 2.41148325,17.6842105 L8.84210526,17.6842105 C10.1764593,17.6842105 11.2535886,16.6070814 11.2535886,15.2727272 L11.2535886,2.41148325 C11.2535886,1.07712918 10.1764593,0 8.84210526,0 Z M7.23444976,16.076555 L4.01913876,16.076555 L4.01913876,15.2727272 L7.23444976,15.2727272 L7.23444976,16.076555 Z M9.84688994,13.6650718 L1.40669856,13.6650718 L1.40669856,2.41148325 L9.84688994,2.41148325 L9.84688994,13.6650718 Z" id="Shape"></path></g></g><g id="Layer_x0020_1" transform="translate(15.000000, 8.000000)">    <polyline id="Path-4" stroke="#FFFFFF" stroke-width="1.2" points="2.85185185 6.6 4.56296296 8.31111111 7.98518519 4.88888889"></polyline></g></g></g></g></svg></span>';\
		if(c_number != '' && c_company != '') var fourth_div = '<p class="aic dflx" id = "web_em" style="position: relative;left: 3%;">' + mob_icon + ' </p>';\
		else if(c_number != '' && c_company == '') var fourth_div = '<p class="aic dflx" id = "web_em" style="position: relative;left: 3%;">' + mob_icon + '</p>';\
		else if(c_number == '' && c_company != '') var fourth_div = '<p class="aic dflx" id = "web_em" style="position: relative;left: 3%;"></p>';\
		else var fourth_div = ratingspan;\
		\
\
\
		if(c_city !== '') Comp_name_city += '<span class="fs14"><svg class="mr5" style="margin-left:10px;" width="12px" height="16px" viewBox="0 0 12 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Group 10</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="option-8" transform="translate(-725.000000, -155.000000)"><g id="Group-6" transform="translate(428.000000, 139.000000)"><g id="Group-10" transform="translate(293.000000, 14.000000)"><g id="location_on-24px" transform="translate(0.921905, 0.921905)"><polygon id="Path" points="0 0 18.2638596 0 18.2638596 18.2638596 0 18.2638596"></polygon><path d="M9.13192983,1.52198831 C6.18688245,1.52198831 3.80497076,3.9039 3.80497076,6.84894737 C3.80497076,10.8441667 9.13192983,16.7418713 9.13192983,16.7418713 C9.13192983,16.7418713 14.4588889,10.8441667 14.4588889,6.84894737 C14.4588889,3.9039 12.0769772,1.52198831 9.13192983,1.52198831 Z M5.32695907,6.84894737 C5.32695907,4.74860351 7.03158596,3.04397661 9.13192983,3.04397661 C11.2322737,3.04397661 12.9369005,4.74860351 12.9369005,6.84894737 C12.9369005,9.04061052 10.7452375,12.3204953 9.13192983,14.3675696 C7.54906199,12.3357152 5.32695907,9.01778071 5.32695907,6.84894737 Z" id="Shape" fill="#666666" fill-rule="nonzero"></path><circle id="Oval" fill="#666666" fill-rule="nonzero" cx="9.13192983" cy="6.84894737" r="1.90248538"></circle></g></g></g></g></g></svg>' + c_city + '</span></p>';\
		\
		var last_seen_span = $('#last_seen_span').html();\
		last_seen_span = (last_seen_span != '' && last_seen_span != undefined) ? last_seen_span.trim() : '';\
		last_seen_span = '<span id="last_seen_span" >' +  last_seen_span + '</span>';\
		var num_dv = '<svg class="mr5" width="12px" height="15px" viewBox="0 0 12 15" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>call-answer</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="option-8" transform="translate(-486.000000, -219.000000)" fill="#02887D" fill-rule="nonzero"><g id="Group-6" transform="translate(428.000000, 139.000000)"><g id="call-answer" transform="translate(64.039844, 87.500000) rotate(16.000000) translate(-64.039844, -87.500000) translate(57.539844, 81.000000)"><path d="M12.7085637,9.65284048 L10.7009165,7.7636291 C10.3010304,7.38888626 9.63881118,7.40027192 9.2249942,7.78977395 L8.2135329,8.74124969 C8.1496303,8.7081118 8.08348681,8.67349799 8.01394465,8.63677572 C7.3752174,8.30378029 6.50101038,7.84736993 5.58108928,6.98118122 C4.65844176,6.11316519 4.17291643,5.28935643 3.81792272,4.68798975 C3.78046258,4.62427925 3.74457105,4.56285291 3.7091277,4.50451897 L4.38796681,3.86674629 L4.72170945,3.55234041 C5.13616134,3.16227612 5.14758985,2.53936805 4.74863743,2.16353584 L2.7409902,0.274113613 C2.34203777,-0.101191487 1.67951979,-0.0898058266 1.2650679,0.300258463 L0.699244155,0.835700768 L0.714706269,0.850143689 C0.524977911,1.07792718 0.366435217,1.34064075 0.248452563,1.6239469 C0.139694889,1.89361838 0.0719827802,2.15095538 0.0410212036,2.40881951 C-0.224075625,4.47665222 0.78021484,6.36649613 3.50572994,8.93097556 C7.27321974,12.4755706 10.3093217,12.2077967 10.4403014,12.1947243 C10.7255663,12.1626406 10.9989544,12.0985084 11.2767869,11.9969863 C11.5752729,11.8872763 11.8543006,11.7383139 12.0962416,11.5601846 L12.1086038,11.570516 L12.6818225,11.042383 C13.0954154,10.652389 13.1073294,10.0292701 12.7085637,9.65284048 Z" id="Path"></path></g></g></g></g></svg> ' + c_number;\
		var nm_dv = '<svg class="mr5 ml5" width="13px" height="15px" viewBox="0 0 13 15" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>user (8)</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="option-8" transform="translate(-632.000000, -218.000000)" fill-rule="nonzero" stroke="#666666" stroke-width="1.3"><g id="Group-6" transform="translate(428.000000, 139.000000)"><g id="user-(8)" transform="translate(205.000000, 80.000000)"><path d="M5.5,0 C3.68038,0 2.2,1.48038 2.2,3.3 C2.2,5.11962 3.68038,6.6 5.5,6.6 C7.31962,6.6 8.8,5.11962 8.8,3.3 C8.8,1.48038 7.31962,0 5.5,0 Z" id="Shape"></path><path d="M6.52258444,7.35777778 L4.47739111,7.35777778 C2.78578667,7.35777778 1.11635333,8.13880222 0,9.81341778 L0,12.5155556 L11,12.5155556 L11,9.81341778 C9.88526,8.14122222 8.21629111,7.35777778 6.52258444,7.35777778 Z" id="Shape"></path></g></g></g></g></svg> ' + c_name;\
		var last_dv = '<svg class="mr5" width="15px" height="15px" viewBox="0 0 15 15" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>clock (1)</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="option-8" transform="translate(-752.000000, -218.000000)" fill-rule="nonzero"><g id="Group-6" transform="translate(428.000000, 139.000000)"><g id="clock-(1)" transform="translate(325.000000, 80.000000)"><path d="M6.5,0 C2.91596322,0 0,2.91596322 0,6.5 C0,10.0840368 2.91596322,13 6.5,13 C10.0840368,13 13,10.0840368 13,6.5 C13,2.91596322 10.0840368,0 6.5,0 Z" id="Shape" stroke="#666666" stroke-width="1.3"></path><polygon id="Path" fill="#666666" points="6.90625183 2.437511 6.09374817 2.437511 6.09374817 6.66821342 8.65026371 9.22472896 9.22472896 8.65026371 6.90625183 6.33178658"></polygon></g></g></g></g></svg>' + last_seen_span;\
		\
		if(c_number != '' && c_name != '' && last_seen_span != '') \{\
			if(c_name != c_company) var third_div = '<div id="ins" style="display: flex;"> <p class="dflx aic " style="margin-top: 5px;">' + num_dv + '<span class="vline">|</span>' + nm_dv +  '</p> </div> ';\
			else var third_div = '<div id="ins" style="display: flex;"> <p  class="dflx aic " style="margin-top: 5px;">' + num_dv + '</p> </div>';\
		\} else if(c_number == '' && c_name != '' && last_seen_span != '') \{\
			if(c_name != c_company) var third_div = '<div id="ins" style="display: flex;"> <p  class="dflx aic " style="margin-top: 5px;">' + nm_dv + '</p> </div>';\
			else var third_div = '<div id="ins" style="display: flex;"> <p  class="dflx aic " style="margin-top: 5px;"> </p> </div> ';\
		\} else if(c_number != '' && c_name == '' && last_seen_span != '') var third_div = '<div id="ins" style="display: flex;"> <p  class="dflx aic " style="margin-top: 5px;">' + num_dv + '</p> </div> ';\
		else if(c_number != '' && c_name != '' && last_seen_span == '') \{\
			if(c_name != c_company) var third_div = '<div id="ins" style="display: flex;"> <p  class="dflx aic " style="margin-top: 5px;">' + num_dv + '<span class="vline">|</span>' + nm_dv + '</p> </div> ';\
			else var third_div = '<div id="ins" style="display: flex;"> <p  class="dflx aic " style="margin-top: 5px;">' + num_dv + '</p> </div> ';\
		\} else if(c_number == '' && c_name == '' && last_seen_span != '') var third_div = '<div id="ins" style="display: flex;"> <p  class="dflx aic " style="margin-top: 5px;">  </p> </div> ';\
		else if(c_number == '' && c_name != '' && last_seen_span == '') \{\
			if(c_name != c_company) var third_div = '<div id="ins" style="display: flex;"> <p  class="dflx aic " style="margin-top: 5px;">' + nm_dv + '</p> </div> ';\
			else var third_div = '';\
		\} else if(c_number != '' && c_name == '' && last_seen_span == '') var third_div = '<div id="ins" style="display: flex;"> <p  class="dflx aic " style="margin-top: 5px;">' + num_dv + '</p> </div>';\
		else var third_div = '';\
\
		third_div += ' <div id="website_and_rating" style=" position:relative ; right:1ex; display: flex;"> <div id="rating2"></div> <p id="website" style="position: relative;top: 1ex;"></p> <div id="paynow" style="top: 9px ; right:24px ; position: relative; display:none ;"> <div id ="intxt" title="Pay securely via Paywith IndiaMART" style="left:3ex; display:flex ;position: relative;"> <span class="vline" id="msgvline" style="display: block; position: relative;  right: 4px;">|</span> <span id="rupee" style=" position: relative;cursor: pointer;" onclick="clk(),showPayModal(\\'myModal3\\', \\'\\', \\'\\', \\'\\'),getGAEventTrackingJS(\\'Message_Center\\',\\'Payments_click_button\\',\\'Payment_popup\\');">
\f1 \uc0\u8377 
\f0 </span><span id="teext" style="color: #0620c4; top:2px; font-size: 14px;position: relative;z-index: 1;cursor: pointer;" onclick="clk(),showPayModal(\\'myModal3\\', \\'\\', \\'\\', \\'\\'),getGAEventTrackingJS(\\'Message_Center\\',\\'Payments_click_button\\',\\'Payment_popup\\'); ">Send Payment</span> </div> </div> </div> </div>';\
		\
		$('#left-name').html(Comp_name_city + third_div);\
		$('#mslrt').html(fourth_div);\
		$('#rating2').html(ratingspan);\
\
		\
		\
		var nm_txt = '';\
		if(c_company != 'IndiaMART Seller' && c_company != '') nm_txt = c_company.charAt(0).toUpperCase();\
		else nm_txt = c_name.charAt(0).toUpperCase();\
		$(".cmp_logo_header").attr('src', '');\
		$("#hdr_img").addClass('no_cmp_logo');\
		$("#hdr_img").addClass('no_cmp_logo_hdr');\
		$(".cmp_logo_header").css("display", "none");\
		$("#nm_txt").text(nm_txt);\
		$(".dflx .left-name-details").css("width", "100%");\
	\}\
\}\
\
function UpdateHeaderNew() \{\
	mob_icon = '';\
	var value = $('#buyer_pr_dt_new').val() ? $("#buyer_pr_dt_new").val() : '';\
	var contactData = '';\
	if(value !== '') \{\
		value1 = JSON.parse(value);\
		value2 = JSON.parse(value1);\
		contactData = value2['Response']['Data'];\
	\}\
	if(contactData !== '') \{\
	/*if(contactData == undefined)\
        contactData = '';changes commented by vinay*/\
	//          var SB_flag = "";\
	//          if(document.getElementsByClassName('user-name1 active')[0].getElementsByClassName('init_flag')[0]!=undefined)\{\
	//          var SB_flag = document.getElementsByClassName('user-name1 active')[0].getElementsByClassName('init_flag')[0].innerText;\
	//          \}\
\
	\
	var gst_code = contactData['gst'] ? contactData['gst'] : '';\
	var c_email = contactData['contacts_email1'] ? contactData['contacts_email1'] : '';\
    var c_company = contactData['contacts_company'] ? contactData['contacts_company'] : '';\
    var c_name = contactData['contacts_name'] ? contactData['contacts_name'] : '';\
 	var c_cmpny_url = contactData['contacts_website'] ? contactData['contacts_website'] : '';\
	 cataloglnk = c_cmpny_url;\
	 var cont_mob = contactData['contacts_mobile1'] ? contactData['contacts_mobile1'] : '';\
	if(gst_code !== "" && gst_code !== undefined && gst_code !== null) \{\
		var gst_icon = '<span class="vline">|</span> <span style="background: #f4f4f4;border-radius: 100px;font-size: 11px;margin-left: 5px;padding: 2px;">GST</span> <svg width="11px" height="13px" viewBox="0 0 11 13" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Layer_x0020_1</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="option-8" transform="translate(-1114.000000, -189.000000)"><g id="Layer_x0020_1" transform="translate(1114.000000, 189.000000)"><polyline id="Path-4" stroke="#FFFFFF" stroke-width="1.2" points="2.85185185 6.6 4.56296296 8.31111111 7.98518519 4.88888889"></polyline></g></g></g></svg>';\
	\} else var gst_icon = '';\
	if(contactData['is_gst_verified'] == 1 && gst_icon != '') var gst_icon = gst_icon + '<span class="dtl_verified_icn gts"></span>';\
	c_cmpny_url = (c_cmpny_url != '' && c_cmpny_url != undefined) ? c_cmpny_url.trim() : '';\
	var is_fraud = $('#fraud').val() ? $('#fraud').val() : '';\
	if(is_fraud == 1) \{\
		openFraudAlert();\
		$(".send_button").css(\{\
			"background-color": "#999",\
			"cursor": "not-allowed"\
		\});\
		$("#msg-attch-send").css(\{\
			"background-color": "#999",\
			"cursor": "not-allowed"\
		\});\
		$(".bg-msg.ico.Msg-atc").css("cursor", "not-allowed");\
		//$(".sendbox-left-icn, .snd_quot, .quot_txt").css("cursor", "not-allowed");\
		$("#error_no_enq").remove();\
		//document.getElementById("rsrc_first_attch").disabled = true;\
		disabled_send_reply = true;\
	\} else \{\
		disabled_send_reply = false;\
		$(".bg-msg.ico.Msg-atc").css("cursor", "pointer");\
		//$(".sendbox-left-icn, .snd_quot, .quot_txt").css("cursor", "pointer");\
		$(".send_button").css(\{\
			"cursor": "pointer"\
		\});\
		$("#msg-attch-send").css(\{\
			"background-color": "#999",\
			"cursor": "not-allowed"\
		\});\
		//document.getElementById("rsrc_first_attch").disabled = false;\
	\}\
	if(c_cmpny_url !== '') \{\
		$("#left-name").css("margin-top", "-3px");\
	 	$("#pd15_0").css("padding","15px 5px 10px 5px");\
		var Comp_url = '<svg class="mr5" width="16px" height="16px" viewBox="0 0 16 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="position: relative; right: 2%; top: 1px; vertical-align: middle;"><title>Shape</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="option-8" transform="translate(-484.000000, -188.000000)" fill="#02887D" fill-rule="nonzero" stroke="#02887D" stroke-width="0.5"><g id="Group-6" transform="translate(428.000000, 139.000000)"><path d="M64,50 C60.1340495,50 57,53.1340495 57,57 C57,60.8659505 60.1340495,64 64,64 C67.8659505,64 71,60.8659505 71,57 C70.9956706,53.1358724 67.8641276,50.0043294 64,50 Z M70.0540202,59.4522786 L68.0632813,59.7957845 C68.2911458,58.9600911 68.4141927,58.0993327 68.4295736,57.2333333 L70.5275228,57.2333333 C70.5012044,57.9950846 70.3409017,58.7462402 70.0540202,59.4522786 L70.0540202,59.4522786 Z M57.4724772,57.2333333 L59.5704264,57.2333333 C59.5858073,58.0993327 59.7088542,58.9600911 59.9367187,59.7957845 L57.9459798,59.4522786 C57.6590983,58.7462402 57.4987956,57.9950847 57.4724772,57.2333333 Z M57.9459798,54.5477214 L59.9367187,54.2042155 C59.7088542,55.0399089 59.5858073,55.9006673 59.5704264,56.7666667 L57.4724772,56.7666667 C57.4987956,56.0049154 57.6590983,55.2537598 57.9459798,54.5477214 Z M64.2333333,53.7464356 C65.0717611,53.7571452 65.908138,53.8334798 66.7347168,53.9748698 L67.5583333,54.1169434 C67.8113769,54.9780436 67.947526,55.869222 67.9631348,56.7666667 L64.2333333,56.7666667 L64.2333333,53.7464356 Z M66.8142415,53.5149251 C65.9614583,53.3692057 65.0984212,53.2904785 64.2333333,53.2797689 L64.2333333,50.4797689 C65.5710124,50.6082845 66.7330078,51.8330566 67.3915365,53.6155274 L66.8142415,53.5149251 Z M63.7666667,53.2797689 C62.9015788,53.2904785 62.0387695,53.3692057 61.1859863,53.5149251 L60.6084635,53.6148437 C61.2669922,51.8319173 62.4289876,50.6066894 63.7666667,50.4787435 L63.7666667,53.2797689 Z M61.2655111,53.9748698 C62.0919759,53.8334798 62.9282389,53.7571452 63.7666667,53.7464356 L63.7666667,56.7666667 L60.0368652,56.7666667 C60.052474,55.869222 60.1886231,54.9780436 60.4416667,54.1169434 L61.2655111,53.9748698 Z M60.0368652,57.2333333 L63.7666667,57.2333333 L63.7666667,60.2535644 C62.9282389,60.2428548 62.091862,60.1665202 61.2652832,60.0251302 L60.4416667,59.8830566 C60.1886231,59.0219564 60.052474,58.130778 60.0368652,57.2333333 L60.0368652,57.2333333 Z M61.1857585,60.4850749 C62.0385417,60.6310222 62.9014649,60.7100911 63.7666667,60.7214844 L63.7666667,63.5214844 C62.4289876,63.3928548 61.2669922,62.1680827 60.6084635,60.385612 L61.1857585,60.4850749 Z M64.2333333,60.7214844 C65.0984212,60.7100911 65.9612305,60.6310221 66.8140137,60.4850749 L67.3915365,60.3851563 C66.7330078,62.1680827 65.5710124,63.3933106 64.2333333,63.5212565 L64.2333333,60.7214844 Z M66.7344889,60.0251302 C65.9080241,60.1665202 65.0717611,60.2428548 64.2333333,60.2535644 L64.2333333,57.2333333 L67.9631348,57.2333333 C67.947526,58.130778 67.8113769,59.0219564 67.5583333,59.8830566 L66.7344889,60.0251302 Z M68.4295736,56.7666667 C68.4141927,55.9006673 68.2911458,55.0399089 68.0632813,54.2042155 L70.0540202,54.5477214 C70.3409017,55.2537598 70.5012044,56.0049154 70.5275228,56.7666667 L68.4295736,56.7666667 Z M69.8179525,54.033431 L67.9097005,53.7041667 C67.5666504,52.5850098 66.9248698,51.5805827 66.0532878,50.7991211 C67.6830892,51.3430339 69.034668,52.5041178 69.8179525,54.033431 Z M61.9467122,50.7991211 C61.0751302,51.5805827 60.4333496,52.5850098 60.0902995,53.7041667 L58.1820475,54.033431 C58.965332,52.5041178 60.3169108,51.3430339 61.9467122,50.7991211 Z M58.1820475,59.966569 L60.0902995,60.2958333 C60.4333496,61.4149902 61.0751302,62.4194173 61.9467122,63.2008789 C60.3169108,62.6569661 58.965332,61.4958822 58.1820475,59.966569 Z M66.0532878,63.2008789 C66.9248698,62.4194173 67.5666504,61.4149902 67.9097005,60.2958333 L69.8179525,59.966569 C69.034668,61.4958822 67.6830892,62.6569661 66.0532878,63.2008789 Z" id="Shape"></path></g></g></g></svg><a href="' + c_cmpny_url + '" target = "_blank" onclick=\\'getGAEventTrackingJS("messagecentre", "catalog_link", "my")\\' style="position: relative;top: 3px;right: 8px;"> View Catalog </a> </p>';\
	\}\
	else var Comp_url = '';\
	if(c_email !== "" && c_email !== undefined && c_email !== null) var email_icon = '<span class="vline">|</span><svg class="mr5 ml5" width="28px" height="25px" viewBox="0 0 28 25" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Email Verified</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="option-8" transform="translate(-1183.000000, -181.000000)"><g id="Group-7" transform="translate(1183.000000, 181.000000)"><g id="Group-5" fill-rule="nonzero"><circle id="Oval-Copy" fill="#F4F4F4" cx="12.3157895" cy="12.3157895" r="12.3157895"></circle><g id="mail-24px-(1)" transform="translate(4.000000, 6.000000)" fill="#666666"><path d="M16.2842105,1.62842105 C16.2842105,0.732789474 15.5514211,0 14.6557895,0 L1.62842105,0 C0.732789474,0 0,0.732789474 0,1.62842105 L0,11.3989474 C0,12.2945789 0.732789474,13.0273684 1.62842105,13.0273684 L14.6557895,13.0273684 C15.5514211,13.0273684 16.2842105,12.2945789 16.2842105,11.3989474 L16.2842105,1.62842105 Z M14.6557895,1.62842105 L8.14210526,5.69133158 L1.62842105,1.62842105 L14.6557895,1.62842105 Z M14.6557895,11.3989474 L1.62842105,11.3989474 L1.62842105,3.25684211 L8.14210526,7.32789474 L14.6557895,3.25684211 L14.6557895,11.3989474 Z" id="Shape"></path></g></g><g id="Layer_x0020_1" transform="translate(17.000000, 9.000000)"><polyline id="Path-4" stroke="#FFFFFF" stroke-width="1.2" points="2.85185185 6.6 4.56296296 8.31111111 7.98518519 4.88888889"></polyline></g></g></g></g></svg>';\
	else var email_icon = "";\
	if(email_icon != '' && contactData['is_email_verified'] == 1) \{\
		var email_icon = email_icon + '<span class="dtl_verified_icn emi" style=""></span>';\
	\}\
	else if(email_icon != '' && contactData['is_email_verified'] == null)\
        var email_icon = email_icon + '<span class="emi" style=""></span>';\
\
     else\
        var email_icon = "";\
    \
	if(contactData['verification_status'] == 1) mob_icon = '<span class="dtl_verified_icn SP_tk"></span>';\
	var last_seen_span = $('#last_seen_span').html();\
	last_seen_span = (last_seen_span != '' && last_seen_span != undefined) ? last_seen_span.trim() : '';\
	last_seen_span = '<span id="last_seen_span" >' + last_seen_span + '</span>';\
	$('#newonline').html(last_seen_span);\
	var ratingspan = '<div class="mbt8 aic dflx fs13" style="position: relative;top: 5px;"><span class="usRt" id= "rating_count" style="display:none;"></span><span class="vline" id = "msgvline" style="display: none;position: relative;top: 2px; right:4px;">|</span></p>';\
	Comp_url1 = Comp_url;\
	if(Comp_url)\{\
		document.getElementById('msgvline').style.display ="block";\
	\}\
	\
	\
	if(contactData['glusr_usr_membersince']) \{\
			membersince = contactData['glusr_usr_membersince'];\
        \}\
        else\
            membersince = '';  \
    var view_detail_icn = '';\
		if(membersince != '') \{\
			view_detail_icn = '<button class="vewbtn" id="view_detail_icn" onclick="show_profile();" > View Details <span class="arrow-down" ><img src="https://my.imimg.com/gifs-new/down-arrow.png" style="width: 19px;" alt="ImLogo"/></span></button> ';\
		\}\
    $(".emi").css("left", "110px");       \
	$('#website').html(Comp_url);\
    $('#left-name').append(view_detail_icn);\
\
	if($('#web_em').find('.emi').length == 0) $('#web_em').append(email_icon + gst_icon);\
	$('#tst').append(mob_icon);\
     if(cont_mob == '')\
    \{\
        $(".vline").hide(); \
        $(".emi").css("left", "22px");\
    \}\
	var cmp_img = $(".user-name1.active div img").attr('src');\
    chatSectionHeight();\
	if(cmp_img == "") \{\
		var nm_txt = '';\
		if(c_company != '' && c_company != 'undefined') nm_txt = c_company.charAt(0).toUpperCase();\
		else nm_txt = c_name.charAt(0).toUpperCase();\
		if(nm_txt == '')\
		nm_txt = $("#nm_txt").text();\
		$("#hdr_img").addClass('no_cmp_logo');\
		$("#hdr_img").addClass('no_cmp_logo_hdr');\
		$(".cmp_logo_header").css("display", "none");\
		$("#nm_txt").text(nm_txt);\
	\} else \{\
		$(".cmp_logo_header").attr('src', cmp_img);\
		$("#hdr_img").removeClass('no_cmp_logo');\
		$("#hdr_img").removeClass('no_cmp_logo_hdr');\
		$(".cmp_logo_header").css("display", "block");\
		$("#nm_txt").text('');\
	\}\
    \}\
	//Code to scroll to the bottom of the page\
	$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight);\
	chatSectionHeight();\
\}\
\
function show_profile() \{\
	getGAEventTrackingJS("messagecentre", "user_click_view_detail", glid);\
	if($('.slidbox').is(":visible")) \{\
		slideUpProfileInformation();\
		return;\
	\} else \{\
		slideDownProfileInformation();\
	\}\
	var value = $('#buyer_pr_dt_new').val() ? $("#buyer_pr_dt_new").val() : '';\
	var contactData1 = '';\
	if(value !== '') \{\
		value1 = JSON.parse(value);\
		value2 = JSON.parse(value1);\
		contactData1 = value2['Response']['Data'];\
	\}\
	if(contactData1 !== '') \{\
	if(contactData1['gst']) gst_code = contactData1['gst'];\
		else gst_code = '';\
        \
		if(contactData1['iec_code']) iec_code = contactData1['iec_code'];\
		else iec_code = '';\
        \
     if(contactData1['glusr_usr_membersince']) \{\
			membersince = contactData1['glusr_usr_membersince'];\
        \}\
        else\
            membersince = '';   \
	if(contactData1['business_type']) business_type = contactData1['business_type'];\
		else business_type = '';\
		\
		if(contactData1['buyer_product_sold']) Sells = contactData1['buyer_product_sold'];\
		else Sells = '';\
		var poi = '';\
		var Products_of_interest = contactData1['products_of_interest'];\
            if(contactData1['products_of_interest']) \{\
			for(var i = 0; i < Products_of_interest.length; i++) \{\
				poi += Products_of_interest[i]['glcat_mcat_name'];\
				if(i != (Products_of_interest.length - 1)) poi += ', ';\
			\}\
		\} else poi = '';\
\
		let pns_number = contactData1['glusr_usr_im_gsm'] !== null ? contactData1['glusr_usr_im_gsm'] : '';\
		let secondary_number = contactData1['contacts_mobile2'];\
		\
		let business_info = ''; // we populate this string \
		if(secondary_number !== '' && secondary_number !== null && pns_number.includes(',') == false) // if alternate contact exists and primary number is not a pns number, we show it\
		\{\
			// to detect if the user is a foreign user or not\
			var ImeshVisitorcookie = readCookie("ImeshVisitor");\
			var phcc_val = getparamVal(ImeshVisitorcookie, "phcc");\
			if(phcc_val !== '91')\
			\{\
				business_info += '<p class="fs13 mbt5">  <b>Alternate Number </b> :  +91-' + secondary_number + ' </p>'; // we display alternate number with country code\
			\}\
			else business_info += '<p class="fs13 mbt5">  <b>Alternate Number </b> :  ' + secondary_number + ' </p>'; \
		\} \
		if(membersince !== '') business_info += '<p class="fs13 mbt5">  <b>Member Since </b> :  ' + membersince + ' </p>';\
		if(Sells !== '' && business_type !== '') business_info += '<p class="fs13 mbt5">  <b> ' + business_type + '   </b> : ' + Sells + ' </p>';\
		else if(Sells !== '' && business_type === '') business_info += '<p class="fs13 mbt5">  <b> Sells </b> : ' + Sells + ' </p>';\
		else if(Sells === '' && business_type !== '') business_info += '<p class="fs13 mbt5">  <b> ' + business_type + ' </b></p>';\
		else business_info = business_info;\
		if(poi !== 'undefined' && Products_of_interest.length > 0) business_info += '<p class="fs13 mbt5">  <b> Product of Interest </b> : ' + poi + '</p>';\
		var Gst_byr_icn = '<p class="fs13 bv mbt5"> GST : ' + gst_code + '</p>';\
		if(contactData1['is_gst_verified'] == 1) Gst_byr_icn = '<p class="fs13 bv mbt5"> GST : ' + gst_code + ' <span class="dtl_verified_icn byr_gts" style="top:16px"></span></p>';\
		var iec_byr_icn = '<p class="fs13 bv mbt5">IE Code : ' + iec_code + '<svg width="11px" height="13px" viewBox="0 0 11 13" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Layer_x0020_1</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="option-8" transform="translate(-1114.000000, -189.000000)"><g id="Layer_x0020_1" transform="translate(1114.000000, 189.000000)"><polyline id="Path-4" stroke="#FFFFFF" stroke-width="1.2" points="2.85185185 6.6 4.56296296 8.31111111 7.98518519 4.88888889"></polyline></g></g></g></svg> </p>';\
		if(gst_code !== '' && iec_code !== '') \{\
			var view_more_bottom = Gst_byr_icn + iec_byr_icn;\
		\} else if(gst_code !== '' && iec_code === '') \{\
			var view_more_bottom = Gst_byr_icn;\
		\} else if(gst_code === '' && iec_code !== '') \{\
			var view_more_bottom = iec_byr_icn;\
		\} else \{\
			var view_more_bottom = '';\
		\}\
		$('#mslft').html(business_info);\
		$('#mslrt1').html(view_more_bottom);\
	//	$(".chat-section").scrollTop(90000); \
		//             if($("#hdr_img img").attr("src") )\
		//                           $('#buyer_profile_details').css("margin-left","77px");\
	\}\
	//chatSectionHeight();\
\}\
\
function displaycontact(id) \{\
	var li = byId("fetch_list").getElementsByTagName("li");\
	if(li !== undefined && li !== null && li !== '' && li[id] !== undefined && li[id] !== null && li[id] !== '') \{\
		var c_name = li[id].querySelector("span#c_name").innerText;\
		c_name = c_name !== undefined && c_name !== null && c_name !== '' ? c_name : 'Buyer';\
		var c_number = li[id].querySelector("span.c_num").innerText;\
		c_number = c_number !== undefined && c_number !== null && c_number !== '' ? c_number.trim() : '';\
		c_number = c_number != '' ? htmlEscape(c_number.slice(1, c_number.length - 1)) : '';\
		var SB_flag = "";\
		if(document.getElementsByClassName('user-name1 active')[0].getElementsByClassName('init_flag')[0] != undefined) \{\
			var SB_flag = document.getElementsByClassName('user-name1 active')[0].getElementsByClassName('init_flag')[0].innerText;\
		\}\
		var c_company = li[id].querySelector("p.c_addr c_company").innerText;\
		var c_city = li[id].querySelector("p.c_addr c_city").innerText;\
		var c_state = li[id].querySelector("p.c_addr c_state").innerText;\
		var c_country = li[id].querySelector("p.c_addr c_country").innerText;\
		var c_cmpny_url = $('#recv_business_URL').val() ? $('#recv_business_URL').val() : '';\
		var c_email = $("#recv_email").val();\
		if(c_state !== '' && c_state !== c_city) \{\
			c_city = c_city !== '' ? c_city + ', ' + c_state : c_state;\
		\}\
		if(c_name === 'Buyer' && c_company === '') \{\
			Comp_name_city = '';\
		\} else \{\
			//  c_company = c_company !== '' ? c_company : 'IndiaMART Seller' ;\
			if(c_company !== '') c_company = c_company;\
			else if(SB_flag == 0 && c_company == '') c_company = c_name;\
			else c_company = 'IndiaMART Seller';\
			Comp_name_city = '<p class="fs18">' + c_company;\
\
			\
		\}\
		if(c_city !== '') Comp_name_city += '<span class="fs14"><svg class="mr5" style="margin-left:10px;" width="12px" height="16px" viewBox="0 0 12 16" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Group 10</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="option-8" transform="translate(-725.000000, -155.000000)"><g id="Group-6" transform="translate(428.000000, 139.000000)"><g id="Group-10" transform="translate(293.000000, 14.000000)"><g id="location_on-24px" transform="translate(0.921905, 0.921905)"><polygon id="Path" points="0 0 18.2638596 0 18.2638596 18.2638596 0 18.2638596"></polygon><path d="M9.13192983,1.52198831 C6.18688245,1.52198831 3.80497076,3.9039 3.80497076,6.84894737 C3.80497076,10.8441667 9.13192983,16.7418713 9.13192983,16.7418713 C9.13192983,16.7418713 14.4588889,10.8441667 14.4588889,6.84894737 C14.4588889,3.9039 12.0769772,1.52198831 9.13192983,1.52198831 Z M5.32695907,6.84894737 C5.32695907,4.74860351 7.03158596,3.04397661 9.13192983,3.04397661 C11.2322737,3.04397661 12.9369005,4.74860351 12.9369005,6.84894737 C12.9369005,9.04061052 10.7452375,12.3204953 9.13192983,14.3675696 C7.54906199,12.3357152 5.32695907,9.01778071 5.32695907,6.84894737 Z" id="Shape" fill="#666666" fill-rule="nonzero"></path><circle id="Oval" fill="#666666" fill-rule="nonzero" cx="9.13192983" cy="6.84894737" r="1.90248538"></circle></g></g></g></g></g></svg>' + c_city + '</span></p>';\
		\
		var last_seen_span = $('#last_seen_span').html();\
		last_seen_span = (last_seen_span != '' && last_seen_span != undefined) ? last_seen_span.trim() : '';\
		last_seen_span = '<span id="last_seen_span" style="position: relative;" >' + last_seen_span + '</span>';\
		$('#newonline').html(last_seen_span);\
		var num_dv = '<svg class="mr5" width="12px" height="15px" viewBox="0 0 12 15" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>call-answer</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="option-8" transform="translate(-486.000000, -219.000000)" fill="#02887D" fill-rule="nonzero"><g id="Group-6" transform="translate(428.000000, 139.000000)"><g id="call-answer" transform="translate(64.039844, 87.500000) rotate(16.000000) translate(-64.039844, -87.500000) translate(57.539844, 81.000000)"><path d="M12.7085637,9.65284048 L10.7009165,7.7636291 C10.3010304,7.38888626 9.63881118,7.40027192 9.2249942,7.78977395 L8.2135329,8.74124969 C8.1496303,8.7081118 8.08348681,8.67349799 8.01394465,8.63677572 C7.3752174,8.30378029 6.50101038,7.84736993 5.58108928,6.98118122 C4.65844176,6.11316519 4.17291643,5.28935643 3.81792272,4.68798975 C3.78046258,4.62427925 3.74457105,4.56285291 3.7091277,4.50451897 L4.38796681,3.86674629 L4.72170945,3.55234041 C5.13616134,3.16227612 5.14758985,2.53936805 4.74863743,2.16353584 L2.7409902,0.274113613 C2.34203777,-0.101191487 1.67951979,-0.0898058266 1.2650679,0.300258463 L0.699244155,0.835700768 L0.714706269,0.850143689 C0.524977911,1.07792718 0.366435217,1.34064075 0.248452563,1.6239469 C0.139694889,1.89361838 0.0719827802,2.15095538 0.0410212036,2.40881951 C-0.224075625,4.47665222 0.78021484,6.36649613 3.50572994,8.93097556 C7.27321974,12.4755706 10.3093217,12.2077967 10.4403014,12.1947243 C10.7255663,12.1626406 10.9989544,12.0985084 11.2767869,11.9969863 C11.5752729,11.8872763 11.8543006,11.7383139 12.0962416,11.5601846 L12.1086038,11.570516 L12.6818225,11.042383 C13.0954154,10.652389 13.1073294,10.0292701 12.7085637,9.65284048 Z" id="Path"></path></g></g></g></g></svg> ' + c_number;\
		var nm_dv = '<svg class="mr5 ml5" width="13px" height="15px" viewBox="0 0 13 15" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>user (8)</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="option-8" transform="translate(-632.000000, -218.000000)" fill-rule="nonzero" stroke="#666666" stroke-width="1.3"><g id="Group-6" transform="translate(428.000000, 139.000000)"><g id="user-(8)" transform="translate(205.000000, 80.000000)"><path d="M5.5,0 C3.68038,0 2.2,1.48038 2.2,3.3 C2.2,5.11962 3.68038,6.6 5.5,6.6 C7.31962,6.6 8.8,5.11962 8.8,3.3 C8.8,1.48038 7.31962,0 5.5,0 Z" id="Shape"></path><path d="M6.52258444,7.35777778 L4.47739111,7.35777778 C2.78578667,7.35777778 1.11635333,8.13880222 0,9.81341778 L0,12.5155556 L11,12.5155556 L11,9.81341778 C9.88526,8.14122222 8.21629111,7.35777778 6.52258444,7.35777778 Z" id="Shape"></path></g></g></g></g></svg> ' + c_name;\
\
\
		var last_dv = '<svg class="mr5" style="position: relative;top: 1px;" width="15px" height="15px" viewBox="0 0 15 15" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>clock (1)</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="option-8" transform="translate(-752.000000, -218.000000)" fill-rule="nonzero"><g id="Group-6" transform="translate(428.000000, 139.000000)"><g id="clock-(1)" transform="translate(325.000000, 80.000000)"><path d="M6.5,0 C2.91596322,0 0,2.91596322 0,6.5 C0,10.0840368 2.91596322,13 6.5,13 C10.0840368,13 13,10.0840368 13,6.5 C13,2.91596322 10.0840368,0 6.5,0 Z" id="Shape" stroke="#666666" stroke-width="1.3"></path><polygon id="Path" fill="#666666" points="6.90625183 2.437511 6.09374817 2.437511 6.09374817 6.66821342 8.65026371 9.22472896 9.22472896 8.65026371 6.90625183 6.33178658"></polygon></g></g></g></g></svg>' + last_seen_span;\
		var ratingspan = '<div class="mbt8 aic dflx fs13" style="position: relative;top: 5px;"><span class="usRt" id= "rating_count" style="display:none;"></span><span class="vline" id = "msgvline" style="display: none;position: relative;top: 2px; right:4px;">|</span>';\
		var mob_icon = '<span id = "tst"><svg class="mr5" width="26px" position: relative; top:1px;height="25px" viewBox="0 0 26 25" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>Mobile Verified</title><desc>Created with Sketch.</desc><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="option-8" transform="translate(-1099.000000, -181.000000)"><g id="Group-2" transform="translate(1099.000000, 181.000000)"><g id="Group-4-Copy" fill-rule="nonzero"><circle id="Oval" fill="#F4F4F4" cx="12.3157895" cy="12.3157895" r="12.3157895"></circle><g id="phone_android-24px" transform="translate(6.000000, 3.000000)" fill="#666666"><path d="M8.84210526,0 L2.41148325,0 C1.07712918,0 0,1.07712918 0,2.41148325 L0,15.2727272 C0,16.6070814 1.07712918,17.6842105 2.41148325,17.6842105 L8.84210526,17.6842105 C10.1764593,17.6842105 11.2535886,16.6070814 11.2535886,15.2727272 L11.2535886,2.41148325 C11.2535886,1.07712918 10.1764593,0 8.84210526,0 Z M7.23444976,16.076555 L4.01913876,16.076555 L4.01913876,15.2727272 L7.23444976,15.2727272 L7.23444976,16.076555 Z M9.84688994,13.6650718 L1.40669856,13.6650718 L1.40669856,2.41148325 L9.84688994,2.41148325 L9.84688994,13.6650718 Z" id="Shape"></path></g></g><g id="Layer_x0020_1" transform="translate(15.000000, 8.000000)">    <polyline id="Path-4" stroke="#FFFFFF" stroke-width="1.2" points="2.85185185 6.6 4.56296296 8.31111111 7.98518519 4.88888889"></polyline></g></g></g></g></svg></span>';\
		if(c_number != '' && c_company != '') var fourth_div = '<p class="aic dflx" id = "web_em" style="position: relative;left: 3%;">' + mob_icon + ' </p>';\
		else if(c_number != '' && c_company == '') var fourth_div = '<p class="aic dflx" id = "web_em" style="position: relative;left: 3%;">' + mob_icon + '</p>';\
		else if(c_number == '' && c_company != '') var fourth_div = '';\
		else var fourth_div = '';\
		var view_detail_icn = '';\
// 		if(c_company != 'IndiaMART Seller' && c_company != '') \{\
// 			view_detail_icn = '<button class="vewbtn" id="view_detail_icn" onclick="show_profile();"> View More <span class="arrow-down"></span></button> ';\
// 		\}\
\
\
if(c_number != '' && c_name != '' && last_seen_span != '') \{\
	if(c_name != c_company) var third_div = '<div id="ins" style="display: flex;"> <p  class="dflx aic " style="margin-top: 5px;">' + num_dv + '<span class="vline">|</span>' + nm_dv + '</p> </div> ';\
	else var third_div = '<div id="ins" style="display: flex;"> <p  class="dflx aic " style="margin-top: 5px;">' + num_dv + '<span class="vline">|</span></p> </div> ';\
\} else if(c_number == '' && c_name != '' && last_seen_span != '') \{\
	if(c_name != c_company) var third_div = '<div id="ins" style="display: flex;"> <p  class="dflx aic " style="margin-top: 5px;">' + nm_dv + '<span class="vline">|</span></p> </div> ';\
	else var third_div = '<div id="ins" style="display: flex;"> <p  class="dflx aic " style="margin-top: 5px;"></p> </div> ';\
\} else if(c_number != '' && c_name == '' && last_seen_span != '') var third_div = '<div id="ins" style="display: flex;"> <p  class="dflx aic " style="margin-top: 5px;">' + num_dv + '<span class="vline">|</span> </p> </div> ';\
else if(c_number != '' && c_name != '' && last_seen_span == '') \{\
	if(c_name != c_company) var third_div = '<div id="ins" style="display: flex;"> <p  class="dflx aic " style="margin-top: 5px;">' + num_dv + '<span class="vline">|</span>' + nm_dv + '</p> </div> ';\
	else var third_div = '<div id="ins" style="display: flex;"> <p  class="dflx aic " style="margin-top: 5px;">' + num_dv + '</p> </div> ';\
\} else if(c_number == '' && c_name == '' && last_seen_span != '') var third_div = '<div id="ins" style="display: flex;"> <p  class="dflx aic " style="margin-top: 5px;"></p> </div> ';\
else if(c_number == '' && c_name != '' && last_seen_span == '') \{\
	if(c_name != c_company) var third_div = '<div id="ins" style="display: flex;"> <p  class="dflx aic " style="margin-top: 5px;">' + nm_dv + '</p> </div>  ';\
	else var third_div = '';\
\} else if(c_number != '' && c_name == '' && last_seen_span == '') var third_div = '<div id="ins" style="display: flex;"> <p  class="dflx aic " style="margin-top: 5px;">' + num_dv + '</p> </div> ';\
else var third_div = '';\
\
third_div += ' <div id="website_and_rating" style="position:relative; right:1ex; display: flex;"> <div id="rating2"></div> <p id="website" style="position: relative;top: 1ex;"></p> <div id="paynow" title="Pay securely via Paywith IndiaMART" style="top: 9px ; right:24px ; position: relative; display:none ;"> <div id ="intxt" style="left:3ex; display:flex ;position: relative;"> <span class="vline" id="msgvline" style="display: block; position: relative;  right: 4px;">|</span> <span id="rupee" style=" position: relative;cursor: pointer;" onclick="clk(),showPayModal(\\'myModal3\\', \\'\\', \\'\\', \\'\\'),getGAEventTrackingJS(\\'Message_Center\\',\\'Payments_click_button\\',\\'Payment_popup\\');">
\f1 \uc0\u8377 
\f0 </span><span id="teext" style="top:2px; color: #0660D5; font-size: 14px;position: relative;z-index: 1;cursor: pointer;" onclick="clk(),showPayModal(\\'myModal3\\', \\'\\', \\'\\', \\'\\'),getGAEventTrackingJS(\\'Message_Center\\',\\'Payments_click_button\\',\\'Payment_popup\\'); ">Send Payment</span> </div> </div> </div> </div>';\
		\
$('#left-name').html(Comp_name_city + third_div);\
		$('#mslrt').html(fourth_div);\
		$('#rating2').html(ratingspan);\
		\
		if(document.getElementById('website').innerHTML.length !=0 && document.getElementById('rating2').innerHTML.length !=0)\{\
			document.getElementById('msgvline').style.display ="block";\
		\}\
		var nm_txt = '';\
		if(c_company != 'IndiaMART Seller' && c_company != '') nm_txt = c_company.charAt(0).toUpperCase();\
		else nm_txt = c_name.charAt(0).toUpperCase();\
		$(".cmp_logo_header").attr('src', '');\
		$("#hdr_img").addClass('no_cmp_logo');\
		$("#hdr_img").addClass('no_cmp_logo_hdr');\
		$(".cmp_logo_header").css("display", "none");\
		$("#nm_txt").text(nm_txt);\
		$(".dflx .left-name-details").css("width", "100%");\
	\}\
\}\
\
function addloader() \{\
	var img_host_name = "https://dev-my.imimg.com";\
	if(location.host == 'my.indiamart.com') img_host_name = "https://my.imimg.com";\
	else if(location.host == 'stg-my.indiamart.com') img_host_name = "https://stg-my.imimg.com";\
	var jsonResult = '<div class="preloader" id="list"><img src="' + img_host_name + '/gifs_new/messagecentre/100IM.png" alt="ImLogo"/><div></div></div>'\
	$('#enqdet').html(jsonResult);\
\}\
\
function getCookieValue(a) \{\
	var b = document.cookie.match('(^|;)\\\\s*' + a + '\\\\s*=\\\\s*([^;]+)');\
	return b ? b.pop() : '';\
\}\
\
function getLocationDetailOfUser() \{\
	var ip_addressccokie = readCookie('iploc');\
	//var ip_loc_val 			= getCookieValue('iploc');\
	var storage_loc_obj = sessionStorage.getItem("location_obj");\
	var ip_address = '';\
	var geoip_country_iso = '';\
	var ip_country = '';\
	if(ip_addressccokie) \{\
		ip_address = getparamVal(ip_addressccokie, "gip");\
		geoip_country_iso = getparamVal(ip_addressccokie, "gcniso");\
		ip_country = getparamVal(ip_addressccokie, "gcnnm");\
	\}\
	// if(ip_loc_val.trim() !== '' && ip_loc_val.split('|').length > 1)\{\
	// 	ip_loc_val.split('|').map(function(data)\{\
	// 		var key = data.split('=')[0].toString().toLowerCase().trim();\
	// 		if(key === "gip")\{\
	// 			ip_address = data.split('=')[1].toString().trim();\
	// 		\}\
	// 		if(key === "gcniso")\{\
	// 			geoip_country_iso = data.split('=')[1].toString().trim();\
	// 		\}\
	// 		if(key === "gcnnm")\{\
	// 			ip_country = data.split('=')[1].toString().trim();\
	// 		\}\
	// 	\});\
	// \}\
	else if(storage_loc_obj && storage_loc_obj !== null && storage_loc_obj !== '') \{\
		var location_obj = JSON.parse(storage_loc_obj);\
		return location_obj;\
	\} else \{\
		$.ajax(\{\
			url: "https://stg-geoip.imimg.com/api/location.php",\
			data: \{\
				"modid": "MY",\
				"token": "imobile@15061981"\
			\},\
			dataType: "html",\
			type: "POST",\
			success: function(jsonResult) \{\
				var location_obj = JSON.parse(jsonResult);\
				if(location_obj.Response && location_obj.Response.Data) \{\
					var geoip_country_iso = location_obj.Response.Data.geoip_countryiso;\
					var ip_country = location_obj.Response.Data.geoip_countryname;\
					var ip_address = location_obj.Response.Data.geoip_ipaddress;\
					var data_arr = \{\
						"IP_COUNTRY": ip_country,\
						"GEOIP_COUNTRY_ISO": geoip_country_iso,\
						"IPADDRESS": ip_address\
					\};\
					sessionStorage.setItem("location_obj", JSON.stringify(data_arr));\
				\}\
			\},\
			error: function(err) \{\
				console.log("ERROR");\
				console.log(err);\
			\}\
		\});\
	\}\
	return \{\
		"IP_COUNTRY": ip_country,\
		"GEOIP_COUNTRY_ISO": geoip_country_iso,\
		"IPADDRESS": ip_address\
	\};\
\}\
// to send reply or quotation\
function sendreply() \{\
\
	var quote ='';\
	if(document.getElementById('quotedRplyDiv').style.display=='block')\
	\{\
		quote ='```'+document.getElementById('quotedRplyTxtOriginal').innerText+'```';\
	\}\
	var reply_msg = trim(document.getElementById('massage-text').value);\
	reply_msg = reply_msg.replace(/\\u200B/g, "");\
	reply_msg = reply_msg.replace(/<(?:.|\\n)*?>/gm, ' ');\
	var found = 0;\
	if(saved_template_code==21)\{\
		if(TEMPLATE_ARRAY == undefined) TEMPLATE_ARRAY = [];\
\
		else\{\
\
			\
			for(var i = 0; i < TEMPLATE_ARRAY.length; i++) \{\
				temp1 = i;\
				if(TEMPLATE_ARRAY[i].template_desc != null && sim_chk(TEMPLATE_ARRAY[i].template_desc,reply_msg)==1) \{\
	                found =1;\
					break;\
				\}\
			\}\
			if(found==0)\{\
				saved_template_code= 80;	\
			\}\
\
		\}\
\
	\}\
\
   var matched = 0;\
\
	if(saved_template_code==11)\{\
		if(ML_ARRAY == undefined) ML_ARRAY = [];\
	else\{\
       var temp =0;\
		for(var i = 0; i < ML_ARRAY.length; i++) \{\
			temp = i;\
			if(ML_ARRAY[i].response != null && sim_chk(ML_ARRAY[i].response,reply_msg)==1) \{\
               matched=1;\
				break;\
			\
				\
			\}\
		\}\
		if(matched == 0)\{\
			saved_template_code= 80;	\
		\}\
\
	\}\
\}\
	\
if(saved_template_code == null)\
\{saved_template_code= 80;\}\
\
\
	$('#temp_main').hide();\
	$('#massage-text').css('height','30px');\
	$('.send_button').css(\{\
		'background':'#999',\
		'cursor': 'not-allowed'\
	\});\
	$('#send-action-div, #send-action-div-point').hide('fast');\
	if(disabled_send_reply) return;\
	var ScrollFromBottom = $(document).height() - $(window).scrollTop();\
	var reply_msg = trim(document.getElementById('massage-text').value);\
	reply_msg = reply_msg.replace(/\\u200B/g, "");\
	$('#messageErr').hide('fast');\
	if($('#showattachment').css('display') == 'block' && reply_msg.length == 0) \{\
		reply_msg = "Please find the Attachment";\
	\}\
	if(reply_msg.length == 0) \{\
		$('#massage-text').val('');\
		return false;\
	\} else \{\
		$('#blankErr').hide('fast');\
	\}\
	disabled_send_reply = true;\
	reply_msg = reply_msg.replace(/<(?:.|\\n)*?>/gm, ' '); //code to replace html tags from the send reply\
	var contactYear = "";\
	if(document.getElementsByClassName('user-name1 active')[0].getElementsByClassName('lst_contact_year')[0] != undefined) \{\
		var contactYear = document.getElementsByClassName('user-name1 active')[0].getElementsByClassName('lst_contact_year')[0].innerText;\
	\}\
	var glid = byId('trackid').value;\
	let msg_stored_in_template = ''; // this will be main message placed in the bubble\
	msg_stored_in_template = reply_msg;\
	reply_msg= quote+reply_msg;\
	var msg_query_type = $('#msg_query_type').val();\
	var msg_query_id = $('#msg_query_id').val();\
	var msg_prod_name = $('#msg_prod_name').val();\
	var msg_ref_id = $('#msg_ref_id').val();\
	var query_id = msg_query_id ? msg_query_id : 1;\
	var query_type = msg_query_type ? msg_query_type : 'C';\
	var recv_id = trim(document.getElementById('contactglid').value);\
	var location_obj = getLocationDetailOfUser();\
	var data_param = \{\
		"subject": 'Message Centre',\
		"msg": reply_msg,\
		"qid": query_id,\
		"recv_id": recv_id,\
		"IIL_RFQ_SOURCE_ID": 28,\
		"qtype": query_type,\
		"attachments": '',\
		"glid": glid,\
		"ETO_OFR_ID": msg_ref_id,\
		"ETO_OFR_TITLE": msg_prod_name,\
		"contact_year": contactYear,\
		"dir_query_reply_template_flag": saved_template_code,\
		"suggestive_reply_position": position_flag,\
		"sender_ip":location_obj.IPADDRESS\
	\};\
	if(recv_id == '' || recv_id == undefined || recv_id == null) \{\
		$.ajax(\{\
			url: '/enquiry/messagecentre/blankrecvLog',\
			data: \{\
				"data_param": JSON.stringify(data_param),\
				"glid": byId('trackid').value,\
				"button": "send_button",\
				"referrer": document.referrer,\
				"cur_page_url": window.location.href\
			\},\
			dataType: "Json",\
			type: "POST",\
		\});\
	\}\
	$.ajax(\{\
		url: "/enquiry/messagecentre/SaveReply",\
		data: data_param,\
		dataType: "json",\
		type: "POST",\
		success: function(jsonResponse) \{\
			try \{\
				saved_template_code = null;\
				position_flag = null;\
				var params_raw = window.location.search.substr(1, window.location.search.length);\
				if(params_raw.indexOf("msg_widget=") > -1) \{\
					/* Single Contact View */\
					var val1 = extractContactGlidFromUrl('msg_widget=');\
					if(val1 == 1) getGAEventTrackingJS("messagecentre", "reply_sent_widget", glid);\
				\}\
				/*code to not hide the instant bl reply after clicking first sugg*/\
				if(hid_inst != 1) \{\
					$('.inst_enq_msg').css("display", "none"); //to hide the instant bl reply after sending message from chat\
					hid_inst = 0;\
				\} else hid_inst = 0;\
				if(IS_SUGGESTED_REPLY) updateMLResponse(reply_msg, glid);\
				disabled_send_reply = false;\
				// trackEvent('messagecentre','reply_sent');\
				if(TEMPLATE_ARRAY[0] == null) \{\
					msg_stored_in_template = msg_stored_in_template.split('```').pop().split('```')[0];\
					addTemplate(0, msg_stored_in_template);\
				\} else if(TEMPLATE_ARRAY[0] != null) \{\
					msg_stored_in_template = msg_stored_in_template.split('```').pop().split('```')[0];\
					updateTemplate('0', '', msg_stored_in_template);\
				\}\
				//XMPP code will be implemented again later\
				var unq_msg_id = jsonResponse.UNIQUE_MSG_ID != undefined && jsonResponse.UNIQUE_MSG_ID != '' ? jsonResponse.UNIQUE_MSG_ID : '';\
				if(typeof connection !== "undefined" && connection !== undefined && connection !== null && connection !== '' && connection.connected) \{\
					sendMessageRealTime(data_param, 'txt', unq_msg_id);\
				\} else \{\
					initiateRealTimeChatJourney();\
					setTimeout(function(data_param) \{\
						sendMessageRealTime(data_param, 'txt', unq_msg_id);\
					\}, 1500, data_param);\
				\}\
			\} catch(err) \{\}\
		\},\
		error: function(err) \{\
			disabled_send_reply = false;\
			if(err.status == '403') \{\
				return false;\
			\}\
			console.log("Message not sent : " + err);\
			$('#messageErr').css('display', 'block');\
		\}\
	\});\
	displayreply();\
\}\
\
function displayreply(rep_msg, rep_file, desk_drive_check, is_real_time, carbonglid) \{\
\
	if(is_real_time === undefined || is_real_time === null || is_real_time === '') \{\
		is_real_time = false;\
	\}\
	if(desk_drive_check === undefined || desk_drive_check === null || desk_drive_check === '') \{\
		desk_drive_check = 1;\
	\}\
	var err_el = byId("error_no_enq");\
	if(err_el) \{\
		err_el.style.display = 'none';\
	\}\
	var reply_msg = rep_msg ? rep_msg.replace(/\\u200B/g, "") : trim(document.getElementById("massage-text").value).replace(/\\u200B/g, "");\
	reply_msg = reply_msg == '' ? "Please find the Attachment" : reply_msg;\
	reply_msg = reply_msg.replace(/<(?:.|\\n)*?>/gm, ' '); //code to replace html tags from the send reply\
	var today = new Date();\
	var bname = $("#bn").val();\
	var msg_date = today.toLocaleDateString("en-US", \{\
		month: 'short'\
	\}) + ' ' + today.toLocaleDateString("en-US", \{\
		day: 'numeric',\
		hour: 'numeric',\
		minute: 'numeric'\
	\}).toLowerCase();\
	var dte_frmt = today.getDate() + '-' + (today.getMonth() + 1) + '-' + today.getFullYear() + ',' + today.getHours() + ':' + today.getMinutes();\
	var dsply_msg = reply_msg.replace(/</g, '&lt;');\
	dsply_msg = dsply_msg.replace(/>/g, '&gt;');\
	dsply_msg = dsply_msg.replace(/\\n/g, '<br>');\
	dsply_msg = dsply_msg.replace(/&lt;\\s*\\/?\\s*br\\s*&gt;/g, "<br>");\
	var regex = /((http\\:\\/\\/|ftp\\:\\/\\/|https\\:\\/\\/)|www\\.)([-a-zA-Z0-9\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)_\\-\\=\\+\\\\\\/\\?\\.\\:\\;\\'\\,]*)/;\
	var main_cls = is_real_time ? "user-message-send" : "message-send";\
	if(rep_file && rep_file.split(',').length >= 3 && main_cls == 'message-send') \{\
		main_cls = main_cls + ' msg_send_4attch'\
	\} else if(rep_file && rep_file.split(',').length == 21) \{\
		main_cls = main_cls + ' msg_send_4attch msg_send_5attch'\
	\}\
	var gray_tick = is_real_time ? "" : TICK.replace('CUSTOM_COLOR', '#999999');\
	var match_reply = dsply_msg.match(regex);\
	var has_attach = "";\
	var tick_icon = "";\
	//dsply_msg       = match_reply ? dsply_msg.replace(match_reply[0],'<a href="http:"'+match_reply[0]+'" target="_blank" style="color:#0072bc;">'+match_reply[0]+'</a>') : dsply_msg;\
	if(match_reply) \{\
		if(match_reply[0].indexOf('http') > -1 || match_reply[0].indexOf('ftp') > -1) dsply_msg = dsply_msg.replace(match_reply[0], '<a href=' + match_reply[0] + ' target="_blank" style="color:#0072bc;">' + match_reply[0] + '</a>');\
		else dsply_msg = dsply_msg.replace(match_reply[0], '<a href=https://' + match_reply[0] + ' target="_blank" style="color:#0072bc;">' + match_reply[0] + '</a>');\
	\}\
\
	// Text Formatting Rules\
\
	// we are checking for bold first\
	// let first_occ = -1;\
	// let second_occ = -1;\
	// for(let i = 0; i < dsply_msg.length; i++)\
	// \{\
	// 	if(dsply_msg[i] == '*' && first_occ == -1)\
	// 	\{\
	// 		first_occ = i; \
	// 	\}\
	// 	else if(dsply_msg[i] == '*' && first_occ != -1 && second_occ == -1)\
	// 	\{\
	// 		second_occ = i;\
	// 		dsply_msg = dsply_msg.substring(0, first_occ) + '<b>' + dsply_msg.substring(first_occ + 1);\
	// 		dsply_msg = dsply_msg.substring(0, second_occ + 2) + '</b>' + dsply_msg.substring(second_occ + 1 + 2);\
	// 		// reset\
	// 		first_occ = -1;\
	// 		second_occ = -1;\
	// 	\}\
	// \}\
	\
	// // then, we are checking for italic\
	// first_occ = -1;\
	// second_occ = -1;\
	// for(let i = 0; i < dsply_msg.length; i++)\
	// \{\
	// 	if(dsply_msg[i] == '_' && first_occ == -1)\
	// 	\{\
	// 		first_occ = i;\
	// 	\}\
	// 	else if(dsply_msg[i] == '_' && first_occ != -1 && second_occ == -1)\
	// 	\{\
	// 		second_occ = i;\
	// 		dsply_msg = dsply_msg.substring(0, first_occ) + '<i>' + dsply_msg.substring(first_occ + 1);\
	// 		dsply_msg = dsply_msg.substring(0, second_occ + 2) + '</i>' + dsply_msg.substring(second_occ + 1 + 2);\
	// 		// reset\
	// 		first_occ = -1;\
	// 		second_occ = -1;\
	// 	\}\
	// \}\
\
	\
	var rply_html = '<div class="' + main_cls + '"><div class="inner_msg_div" style="padding: 17px 9px 9px 11px"><div class="arrow1" style=" top :-17px"></div><div style="position: absolute;right: 13px;display:flex; cursor: pointer; top: 0px;" onclick="openQuotedDiv(event);"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="15" height="15"><g fill="none" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 6 L3 14 10 22 M3 14 L18 14 C26 14 30 18 30 26" style="fill: none !important;"></path></g></svg></div>' + '<h2 style="position: relative;top: 2px;">' + dsply_msg + '</h2>';\
	if(document.getElementById('quotedRplyDiv').style.display=='block')\{\
		document.getElementById('quotedRplyDiv').style.display='none';\
		var quoted =document.getElementById('quotedRplyTxtOriginal').innerText;\
		\
		rply_html =	'<div class="' + main_cls + '"><div class="inner_msg_div" style="padding: 17px 9px 9px 11px"><div class="arrow1" style=" top:-17px"></div><div style="position: absolute;display:flex ; cursor: pointer; right: 13px;top: 0px;" onclick="openQuotedDiv(event);"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="15" height="15"><g fill="none" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 6 L3 14 10 22 M3 14 L18 14 C26 14 30 18 30 26" style="fill: none !important;"></path></g></svg></div><div><h2 style="display:none;position: relative;top: 11px;">' + dsply_msg+ '</h2></div> <div style="background: #a6e6e3;border-radius: 5px;position: relative;text-align: left; border-left:4px solid #00a699; padding: 5px;"><span class="a-tag" style="color: #333;padding:0 5px;cursor: default;">'+quoted +'</span></div> <h2 style=" padding: 8px 0px 8px 0px;position: relative;top: 11px;">' + dsply_msg+ '</h2>';	\
	\}\
\
\
	\
\
	\
	if(dsply_msg.substr(0, 3) == '```' && !rep_file )\{  \
		document.getElementById('quotedRplyDiv').style.display='none';\
		var tempdisp = dsply_msg.substr(3);\
	if(tempdisp.indexOf('```')!=-1)\{\
		var msgparts = tempdisp.split('```');\
		if(msgparts.length>1)\{\
			var quoted = msgparts[0];\
			var temp =dsply_msg;\
			var ms =temp.replace(msgparts[0],'');\
			ms=ms.replace('``````','');\
			\
			if(quoted !== '')\{     \
				var trimmedQuoteVal = '';  \
				if(quoted.length > 250)\{   \
					quoted = quoted.substr(0,250)+'...'; \
				\}   \
			\}\
			if(main_cls == 'message-send')\
			\{rply_html =	'<div class="' + main_cls + '"><div class="inner_msg_div" style="padding: 17px 9px 9px 11px"><div class="arrow1" style= "top:-17px"></div><div style="position: absolute;display:flex ; cursor: pointer; right: 13px;top: 0px;" onclick="openQuotedDiv(event);"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="15" height="15"><g fill="none" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 6 L3 14 10 22 M3 14 L18 14 C26 14 30 18 30 26" style="fill: none !important;"></path></g></svg></div><div><h2 style="display:none;position: relative;top: 11px;">' + ms + '</h2></div> <div style="background:#a6e6e3;  border-radius: 5px;position: relative;text-align: left; border-left:4px solid #00a699; padding: 5px;"><span class="a-tag" style="color: #333;padding:0 5px;cursor: default;">'+quoted +'</span></div> <h2 style=" padding: 8px 0px 8px 0px;position: relative;top: 11px;">' + ms+ '</h2>';\}\
		   \
			else if(main_cls == 'user-message-send')\
			\{rply_html =	'<div class="' + main_cls + '"><div class="inner_msg_div" style="padding: 17px 9px 9px 11px"><div class="arrow1" style= "top:-17px"></div><div style="position: absolute;display:flex ; cursor: pointer; right: 13px;top: 0px;" onclick="openQuotedDiv(event);"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" width="15" height="15"><g fill="none" stroke="#000" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 6 L3 14 10 22 M3 14 L18 14 C26 14 30 18 30 26" style="fill: none !important;"></path></g></svg></div><div><h2 style="display:none;position: relative;top: 11px;">' + ms + '</h2></div> <div style="background:#f5f0f0; border-radius: 5px;position: relative;text-align: left; border-left:4px solid #d6c2c2 ; padding: 5px;"><span class="a-tag" style="color: #333;padding:0 5px;cursor: default;">'+quoted +'</span></div> <h2 style=" padding: 8px 0px 8px 0px;position: relative;top: 11px;">' + ms+ '</h2>';\}\
		\
		\}\
\
	\}\
\
	\
	\}\
\
	\
	\
\
	//for add review button in real time\
	var reply_html_add_review = '<div class="' + main_cls + '"><div class="inner_msg_div"><div class="arrow"></div>' + '<h2>' + dsply_msg + '</h2> <div class="inst_enq_msg23" id="rate_me_now" onclick="getGAEventTrackingJS("review_popup_CTA","message_center","buyermy");"><div id="rating_button" style="position: relative;"onclick="detaching();">Review this Seller<span class="bg-msg ico Msg-snd_btn" id="rating_now"></span></div></div>';\
	if(rep_file) \{\
		var link_str = '';\
		var count1 = 0;\
		var link_arr = new Array();\
		var type_arr = new Array();\
		rep_file = rep_file.split(',');\
		for(var i = 0, len = rep_file.length; i < len; i++) \{\
			if(rep_file[i] !== '') \{\
				if(desk_drive_check === 2 || is_real_time == true) var link1 = rep_file[i];\
				else var link1 = 'https://documents.imimg.com/' + rep_file[i];\
				var file_type1 = rep_file[i].substr((rep_file[i].lastIndexOf('.') + 1));\
				file_type1 = file_type1.toLowerCase();\
				var file_image = ['png', 'gif', 'jpg', 'jpeg'];\
				var file_word = ['doc', 'docx'];\
				var file_ppt = ['ppt', 'pptx'];\
				var file_xls = ['xls', 'xlsx'];\
				var type_txt = ['txt', 'rtf'];\
				var type_pdf = ['pdf'];\
				var file_csv = ['csv'];\
				if(file_image.indexOf(file_type1) != -1) file_type1 = 'jpeg';\
				else if(file_word.indexOf(file_type1) != -1) file_type1 = 'doc';\
				else if(file_ppt.indexOf(file_type1) != -1) file_type1 = 'ppt';\
				else if(file_xls.indexOf(file_type1) != -1) file_type1 = 'xls';\
				else if(file_csv.indexOf(file_type) != -1) file_type1 = 'csv';\
				else if(type_txt.indexOf(file_type1) != -1) file_type1 = 'txt';\
				else if(type_pdf.indexOf(file_type1) != -1) file_type1 = 'pdf';\
				else var m = 0;\
				if(i != len - 1) link_str = link_str + link1 + ',';\
				else link_str = link_str + link1;\
				link_arr[count1] = link1;\
				type_arr[count1] = file_type1;\
				count1++;\
			\}\
		\}\
		for(var i = 0, len = rep_file.length; i < len; i++) \{\
			if(rep_file[i] !== '') \{\
				if(!(rep_file.length > 4 && i >= 3)) \{\
					has_attach = "style=\\"max-width: 350px;\\"";\
					if(desk_drive_check === 2 || is_real_time == true) var link = rep_file[i];\
					else var link = 'https://documents.imimg.com/' + rep_file[i];\
					var whr = "jav"\
					var file_type = rep_file[i].substr((rep_file[i].lastIndexOf('.') + 1));\
					file_type = file_type.toLowerCase();\
					var name = rep_file[i].substr((rep_file[i].lastIndexOf('/') + 1));\
					var name_trimmed = name.substr(0, name.lastIndexOf('.'));\
					name_trimmed = name_trimmed.length > 14 ? name_trimmed.substring(0, 11) + "..." : name_trimmed;\
					name_trimmed = name_trimmed + '.' + file_type;\
					var file_image = ['png', 'gif', 'jpg', 'jpeg'];\
					var file_word = ['doc', 'docx'];\
					var file_ppt = ['ppt', 'pptx'];\
					var file_xls = ['xls', 'xlsx'];\
					var file_csv = ['csv'];\
					var type_txt = ['txt', 'rtf'];\
					var type_pdf = ['pdf'];\
					var type = 'txt';\
					if(file_image.indexOf(file_type) != -1) type = 'jpeg';\
					else if(file_word.indexOf(file_type) != -1) type = 'doc';\
					else if(file_ppt.indexOf(file_type) != -1) type = 'ppt';\
					else if(file_xls.indexOf(file_type) != -1) type = 'xls';\
					else if(file_csv.indexOf(file_type) != -1) type = 'csv';\
					else if(type_txt.indexOf(file_type) != -1) type = 'txt';\
					else if(type_pdf.indexOf(file_type) != -1) type = 'pdf';\
					if(i == 21) \{\
						rply_html = rply_html + '<div class="img_cont msg_send_5attch_quot" value="' + link_str + '">';\
					\}\
					if(i <= 3) \{\
						rply_html = rply_html + '<div class="img_cont" value="' + link_str + '">';\
					\}\
					if(i <= 3 && rep_file.length >= 3 && (main_cls == 'message-send msg_send_4attch' || main_cls == 'message-send msg_send_4attch msg_send_5attch')) \{\
						rply_html = rply_html + '<div class="atch_img_dv">';\
					\}\
					if(i <= 3) \{\
						if(type == 'jpeg' || type == 'png') \{\
							rply_html = rply_html + '<i class="fa fa-spinner fa-pulse" id="prev-icnload" style=""></i>' +\
								// '<a onclick = "onImageClick()" class="a-tag" href="'+ link +'" target="_blank" style="color:#0072bc;">'+\
								//'<div onclick = "onImageClick()" class="a-tag" style="color:#0072bc;">'+\
								'<a onclick="test(\\'' + link_arr + '\\',\\'' + rep_file.length + '\\',\\'' + (i + 1) + '\\',\\'' + type_arr + '\\',\\'' + whr + '\\');frameToTheTop1(\\'' + (i + 1) + '\\');createLeftRightIcon1(\\'' + (i + 1) + '\\',\\'' + rep_file.length + '\\');" class="a-tag" style="color:#0072bc;cursor:pointer;">' + '<img src="' + link + '" style="z-index:1;position:relative;"></a>';\
						\} else \{\
							rply_html = rply_html + '<a class="a-tag" onclick="test(\\'' + link_arr + '\\',\\'' + rep_file.length + '\\',\\'' + (i + 1) + '\\',\\'' + type_arr + '\\',\\'' + whr + '\\');frameToTheTop1(\\'' + (i + 1) + '\\');createLeftRightIcon1(\\'' + (i + 1) + '\\',\\'' + rep_file.length + '\\');" style="cursor:pointer;color:#0072bc;">';\
							if(type == 'doc') rply_html = rply_html + '<img src="https://img.icons8.com/nolan/64/000000/ms-word.png" style="max-width: 40%; max-height: 40%;"></a>';\
							if(type == 'ppt') rply_html = rply_html + '<img src="https://img.icons8.com/nolan/64/000000/ms-powerpoint.png" style="max-width: 40%; max-height: 40%;"></a>';\
							if(type == 'xls' || type == 'csv') rply_html = rply_html + '<img src="https://img.icons8.com/nolan/64/000000/ms-excel.png" style="max-width: 40%; max-height: 40%;"></a>';\
							if(type == 'pdf') rply_html = rply_html + '<img src="https://img.icons8.com/nolan/64/000000/pdf.png" style="max-width: 40%; max-height: 40%;"></a>';\
							if(type == 'txt') rply_html = rply_html + '<img src="https://img.icons8.com/nolan/64/000000/txt.png" style="max-width: 40%; max-height: 40%;"></a>';\
						\}\
					\}\
					if(i <= 3 && rep_file.length >= 3 && (main_cls == 'message-send msg_send_4attch') || main_cls == 'message-send msg_send_4attch msg_send_5attch') \{\
						rply_html = rply_html + '</div>';\
					\}\
					if(i <= 3) \{\
						if(rep_file.length >= 3 && (main_cls == 'message-send msg_send_4attch') || main_cls == 'message-send msg_send_4attch msg_send_5attch') \{\
							rply_html = rply_html + '<a class="a-tag" onclick="test(\\'' + link_arr + '\\',\\'' + rep_file.length + '\\',\\'' + (i + 1) + '\\',\\'' + type_arr + '\\',\\'' + whr + '\\');frameToTheTop1(\\'' + (i + 1) + '\\');createLeftRightIcon1(\\'' + (i + 1) + '\\',\\'' + rep_file.length + '\\');" style="cursor:pointer;color:#0072bc;position:absolute;bottom:0px;width:130px;" title="' + name + '">' + name_trimmed + '</a>';\
						\} else \{\
							rply_html = rply_html + '<a class="a-tag" onclick="test(\\'' + link_arr + '\\',\\'' + rep_file.length + '\\',\\'' + (i + 1) + '\\',\\'' + type_arr + '\\',\\'' + whr + '\\');frameToTheTop1(\\'' + (i + 1) + '\\');createLeftRightIcon1(\\'' + (i + 1) + '\\',\\'' + rep_file.length + '\\');" style="cursor:pointer;color:#0072bc;">' + name + '</a>';\
						\}\
						rply_html = rply_html + '</div>';\
					\}\
				\}\
			\}\
		\}\
		if(rep_file.length == 3) \{\
			rply_html = rply_html + '<div class="img_cont" value="' + link_str + '" onclick = "test(\\'' + link_arr + '\\',\\'' + '3' + '\\',\\'' + '1' + '\\',\\'' + type_arr + '\\',\\'' + whr + '\\');frameToTheTop1(\\'' + '1' + '\\');createLeftRightIcon1(\\'' + '1' + '\\',\\'' + '3' + '\\');" style="background:#f5f0f0;cursor:pointer"> <span class="clk_view"> Click to View </span> </div>';\
			//rply_html = rply_html + '<div class="img_cont" onclick = "onImageClick()" style="background:#f5f0f0;cursor:pointer"> <span class="clk_view"> Click to View </span> </div>';\
		\}\
		if(rep_file.length > 4) \{\
			var show_url = link_arr[3];\
			if(type_arr[3] == 'doc') show_url = 'https://img.icons8.com/nolan/64/000000/ms-word.png';\
			if(type_arr[3] == 'ppt') show_url = 'https://img.icons8.com/nolan/64/000000/ms-powerpoint.png';\
			if(type_arr[3] == 'xls' || type_arr[3] == 'csv') show_url = 'https://img.icons8.com/nolan/64/000000/ms-excel.png';\
			if(type_arr[3] == 'pdf') show_url = 'https://img.icons8.com/nolan/64/000000/pdf.png';\
			if(type_arr[3] == 'txt') show_url = 'https://img.icons8.com/nolan/64/000000/txt.png';\
			rply_html = rply_html + '<div class="img_cont" value="' + link_str + '" onclick = "test(\\'' + link_arr + '\\',' + '\\'' + rep_file.length + '\\'' + ',\\'' + '4' + '\\',\\'' + type_arr + '\\',\\'' + whr + '\\');frameToTheTop1(\\'' + '4' + '\\');createLeftRightIcon1(\\'' + '4' + '\\',\\'' + rep_file.length + '\\');" style="background-image: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.5)), url(\\'' + show_url + '\\');background-repeat: no-repeat;background-position: center;cursor:pointer"> <span class="clk_view" id="plus_four_attach_text">+ ' + (rep_file.length - 3) + ' more</span> </div>';\
			//rply_html = rply_html + '<div class="img_cont" onclick = "onImageClick()" style="background:#f5f0f0;cursor:pointer"> <span class="clk_view"> Click to View </span> </div>';\
		\}\
	\}\
	if(main_cls == "message-send")\{ tick_icon = '<span style="float: right;margin-left: 3px;height: 10px;margin-top: -1px;padding-bottom:20px"><span>' + gray_tick + '</span> </span>'\
	rply_html = rply_html + '</div><div class="time">' + msg_date + tick_icon + '</div></div><span class="msg-full-time" style="display: none;">' + dte_frmt + '</span><div class="clr"></div></div>';\}\
    else\{\
\
		\
		var nwstr = dsply_msg.replace(/[^A-Z0-9]+/ig, "");\
		tick_icon = '<span style="float: right;margin-left: 3px;height: 10px;margin-top: -1px;padding-bottom:20px"><span>' + gray_tick + '</span> </span>'\
		var is_rating_display1 = document.getElementById("is_rating_display").value;\
		var feedback = document.getElementById("feedback").value;\
		if((nwstr == "WehopeyouhadanamazingexperiencewithusDontforgettoprovideaquickreview"||nwstr == "WehopeyouhadanamazingexperiencewithusDontforgettoleaveareview")&& (( feedback == "1" && is_rating_display1== "1")|| is_rating_display1 == "0" ))\{\
			reply_html_add_review = reply_html_add_review + '</div><div class="time" style="float: left;margin: -6px 0px 0px 0px;padding: 10px 10px 4px 10px;clear: both;font-size:12px;color:#626262;">' + msg_date + tick_icon + '</div></div><span class="msg-full-time" style="display: none;">' + dte_frmt + '</span><div class="clr"></div></div>';\
			rply_html=reply_html_add_review;\
		\}\
         else\
		 rply_html = rply_html + '</div><div class="time" style="float: left;margin: -6px 0px 0px 0px;padding: 10px 10px 4px 10px;clear: both;font-size:12px;color:#626262;">' + msg_date + tick_icon + '</div></div><span class="msg-full-time" style="display: none;">' + dte_frmt + '</span><div class="clr"></div></div>';\
    \}\
    \
    var changedHeight = $('.chat-section').height();\
    $('.chat-section').css('height',changedHeight);\
//	$(".chat-section").css("height", "");\
	isSavedReplyUsed(reply_msg);\
	$('.slr-chatSgtnBlk').removeClass('msgctr_svrep_clkd');\
	$(rply_html).insertBefore('#reply_text');\
	$(".msg-placeholder").show();\
	if($('.chat-section').length > 0) $('.chat-section').scrollTop($('.chat-section')[0].scrollHeight);\
	$(".chat-section").scrollTop(90000);\
	/*code to update the last reply to contact list and color coding*/\
	var a1 = $('.user-name1.active .last-msg-snippet').text() ? $('.user-name1.active .last-msg-snippet').text().trim() : '';\
	var b1 = $('.user-name1.active .no-prdct-snippet').text() ? $('.user-name1.active .no-prdct-snippet').text().trim() : '';\
	$('.user-name1.active .last-msg-snippet').removeClass('ast_msg_cnct');\
	$('.user-name1.active .no-prdct-snippet').removeClass('ast_msg_cnct');\
\
	// for not displaying *, _, ``` in contact listing screen..\
	let reply_msg_temp = reply_msg;\
	reply_msg_temp = reply_msg_temp.replaceAll('*', '');\
	reply_msg_temp = reply_msg_temp.replaceAll('_', '');\
	reply_msg_temp = reply_msg_temp.split('```').pop().split('```')[0];\
	if(reply_msg_temp == '') // edge case\
	\{\
		reply_msg_temp = reply_msg.replaceAll('```', '');\
	\}\
\
	$('.user-name1.active .last-msg-snippet').text(reply_msg_temp);\
	$('.user-name1.active .no-prdct-snippet').text(reply_msg);\
	if(!is_real_time) \{\
		if(!carbonglid)\{\
                  $("#massage-text").val('');\
                  $("#massage-text").focus();\
            \}\
		if(document.getElementsByClassName('user-name1 active')[0].getElementsByTagName('path')[0]) \{\
			document.getElementsByClassName('user-name1 active')[0].getElementsByTagName('path')[0].style.fill = '#626262';\
		\} else \{\
			if(document.getElementsByClassName('user-name1 active')[0].querySelector('.last-msg-snippet')) \{\
				document.getElementsByClassName('user-name1 active')[0].querySelector('.last-msg-snippet').innerHTML = '<span class="contact-blue-tick">' + TICK.replace('CUSTOM_COLOR', '#626262') + '</span>' + document.getElementsByClassName('user-name1 active')[0].querySelector('.last-msg-snippet').innerHTML;\
			\} else if(document.getElementsByClassName('user-name1 active')[0].querySelector('.no-prdct-snippet')) \{\
				document.getElementsByClassName('user-name1 active')[0].querySelector('.no-prdct-snippet').innerHTML = '<span class="contact-blue-tick">' + TICK.replace('CUSTOM_COLOR', '#626262') + '</span>' + document.getElementsByClassName('user-name1 active')[0].querySelector('.no-prdct-snippet').innerHTML;\
			\}\
		\}\
	\}\
	if(reply_msg == 'IndiaMART connected you with this seller') \{\
		$('.user-name1.active .last-msg-snippet').addClass('ast_msg_cnct');\
		$('.user-name1.active .no-prdct-snippet').addClass('ast_msg_cnct');\
	\}\
	/*show rating option instant if user reply on msg and there is no rating box available*/\
	var is_rating_display = $("#is_rating_display").val();\
	var buyer_glid = parseInt($('#trackid').val());\
	var supplier_glid = trim(document.getElementById('contactglid').value);\
	if(is_rating_display != undefined) \{\
		$('#oldImg').html('');\
		$.ajax(\{\
			url: '/phpajax/enquiry/messagecentre/getRatingInChat',\
			data: \{\
				"sup_glid": supplier_glid,\
				"buy_glid": buyer_glid,\
			\},\
			dataType: "JSON",\
			type: "POST",\
			success: function(result) \{\
				if(result == null) return;\
				if(result.failure != "" && result.failure == "Authorization Fail") \{\
					console.log(result);\
					window.location.replace('https://my.indiamart.com');\
                    return;\
				\}\
			\}\
		\});\
	\}\
\}\
/*code to check if suggestive ml used*/\
function isSavedReplyUsed(reply_txt) \{\
	try \{\
		var is_saved_reply_used = false;\
		reply_txt = reply_txt !== undefined && reply_txt !== null && reply_txt.trim() !== '' ? reply_txt.trim().toLowerCase() : '';\
		if(reply_txt !== "") \{\
			for(var idx = 0, len = TEMPLATE_ARRAY.length; idx < len; idx++) \{\
				if(TEMPLATE_ARRAY[idx]) \{\
					var svd_rply = TEMPLATE_ARRAY[idx].template_desc;\
					svd_rply = svd_rply !== undefined && svd_rply !== null && svd_rply.trim() !== '' ? svd_rply.trim().toLowerCase() : '';\
					if(svd_rply !== '') \{\
						var similarity_perc = getSimilarityPercent(svd_rply, reply_txt);\
						if(similarity_perc > 70) \{\
							getGAEventTrackingJS('msg_centre_template_reply_used');\
							break;\
						\}\
					\}\
				\}\
			\}\
			for(var idx1 = 0, len1 = ML_ARRAY.length; idx1 < len1; idx1++) \{\
				if(ML_ARRAY[idx1]) \{\
					var suggst_rply = ML_ARRAY[idx1].response;\
					suggst_rply = suggst_rply !== undefined && suggst_rply !== null && suggst_rply.trim() !== '' ? suggst_rply.trim().toLowerCase() : '';\
					if(suggst_rply !== '') \{\
						var similarity_perc = getSimilarityPercent(suggst_rply, reply_txt);\
						if(similarity_perc > 70) \{\
							getGAEventTrackingJS('msg_centre_ml_reply_used');\
							break;\
						\}\
					\}\
				\}\
			\}\
		\}\
	\} catch(err) \{\}\
\}\
/*Functions to view the more images in pop up on click*/\
function handleImageFile1(num, data_link, show_url) \{\
	show_url = (show_url != undefined || show_url != null) ? show_url : 'temp';\
	setTimeout(function() \{\
		var iframe = document.getElementById('attach_preview0' + (num));\
		var iframedoc = iframe.contentDocument || iframe.contentWindow.document;\
		if(show_url == 'temp') \{\
			var html_txt = ' <div style="width:100%; height:100%; text-align: center;">' + '<span style="display: inline-block;height: 100%;vertical-align: middle;"></span>' + '<img style="max-height: 100%;max-width: 100%;vertical-align: middle;" src="' + data_link + '">' + '</div>';\
		\} else \{\
			var html_txt = ' <div style="width:100%; height:100%; text-align: center;">' + '<span style="display: inline-block;height: 100%;vertical-align: middle;"></span>' + '<img style="max-height: 100%;max-width: 100%;vertical-align: middle;" src="' + show_url + '">' + '</div>';\
		\}\
		iframedoc.body.innerHTML = html_txt;\
	\}, 250);\
	$('.link0' + (num)).attr('href', data_link);\
\}\
\
function frameToTheTop1(idx) \{\
	$('#attach_preview0' + idx).css('z-index', '4');\
	$('#attach_preview0' + idx).css('visibility', 'visible');\
	$('.link0' + (idx)).css('visibility', 'visible');\
	$('.link0' + (idx)).css('z-index', '4');\
	for(var i = 1; i < idx; i++) \{\
		$('#attach_preview0' + i).css('z-index', '3');\
		$('#attach_preview0' + i).css('visibility', 'hidden');\
		$('.link0' + (i)).css('visibility', 'hidden');\
		$('.link0' + (i)).css('z-index', '3');\
	\}\
	var j = 0;\
	for(j = parseInt(idx) + 1; j < 21; j++) \{\
		$('#attach_preview0' + j).css('z-index', '3');\
		$('#attach_preview0' + j).css('visibility', 'hidden');\
		$('.link0' + (j)).css('visibility', 'hidden');\
		$('.link0' + (j)).css('z-index', '3');\
	\}\
\}\
\
function createLeftRightIcon1(idx, tot) \{\
	$('#attach_right_navigate, #attach_left_navigate').hide();\
	if(idx == 1 && tot == 1) \{\
		// Don't show any ICON\
	\} else if(idx == 1 && tot > 1) \{\
		// Only print Right ICON\
		$('#attach_right_navigate').css('display', 'inline-block');\
	\} else if(idx > 1 && tot > 1 && idx != tot) \{\
		// Show both ICONS\
		$('#attach_right_navigate, #attach_left_navigate').css('display', 'inline-block');\
	\} else if(idx == tot) \{\
		// Only display Left ICON\
		$('#attach_left_navigate').css('display', 'inline-block');\
	\}\
\}\
\
function navigatePreview1(where) \{\
	for(var i = 1; i <= 21; i++) \{\
		if($('#attach_preview0' + i).css('z-index') == '4') var cur_index = i;\
	\}\
	if(where === 'prev') \{\
		var idx = cur_index;\
		if($('#attach_preview0' + (idx - 1)).attr('src') != '' && $('#attach_preview0' + (idx - 1)).attr('type') == 'application/pdf')\
		\{\
			var iframe = document.getElementById('attach_preview0'+(idx - 1));\
			iframe.src = iframe.src;\
		\}\
		$('#attach_preview0' + (idx - 1)).css('z-index', '4');\
		$('#attach_preview0' + (idx - 1)).css('visibility', 'visible');\
		$('.link0' + (idx - 1)).css('visibility', 'visible');\
		$('.link0' + (idx - 1)).css('z-index', '4');\
		for(var i = 1; i < idx - 1; i++) \{\
			$('#attach_preview0' + i).css('z-index', '3');\
			$('#attach_preview0' + i).css('visibility', 'hidden');\
			$('.link0' + (i)).css('visibility', 'hidden');\
			$('.link0' + (i)).css('z-index', '3');\
		\}\
		for(var i = idx; i <= 21; i++) \{\
			$('#attach_preview0' + i).css('z-index', '3');\
			$('#attach_preview0' + i).css('visibility', 'hidden');\
			$('.link0' + (i)).css('visibility', 'hidden');\
			$('.link0' + (i)).css('z-index', '3');\
		\}\
		createLeftRightIcon1(idx - 1, tot1);\
	\} else if(where === 'next') \{\
		var idx = cur_index;\
		if($('#attach_preview0' + (idx + 1)).attr('src') != '' && $('#attach_preview0' + (idx + 1)).attr('type') == 'application/pdf')\
		\{\
			var iframe = document.getElementById('attach_preview0'+(idx + 1));\
			iframe.src = iframe.src;\
		\}\
		$('#attach_preview0' + (idx + 1)).css('z-index', '4');\
		$('#attach_preview0' + (idx + 1)).css('visibility', 'visible');\
		$('.link0' + (idx + 1)).css('visibility', 'visible');\
		$('.link0' + (idx + 1)).css('z-index', '4');\
		for(var i = 1; i <= idx; i++) \{\
			$('#attach_preview0' + i).css('z-index', '3');\
			$('#attach_preview0' + i).css('visibility', 'hidden');\
			$('.link0' + (i)).css('visibility', 'hidden');\
			$('.link0' + (i)).css('z-index', '3');\
		\}\
		for(var i = idx + 2; i <= 21; i++) \{\
			$('#attach_preview0' + i).css('z-index', '3');\
			$('#attach_preview0' + i).css('visibility', 'hidden');\
			$('.link0' + (i)).css('visibility', 'hidden');\
			$('.link0' + (i)).css('z-index', '3');\
		\}\
		createLeftRightIcon1(idx + 1, tot1);\
	\}\
\}\
\
function test(abc, tot, seq, types, whr) \{\
	whr = (whr != undefined || whr != null) ? whr : 'php';\
	tot1 = tot;\
	if(whr != "jav") \{\
		var seqarr = abc.split("--abc123--123abc--");\
		var type1 = types.split("--abc123--123abc--");\
	\} else \{\
		var seqarr = abc.split(",");\
		var type1 = types.split(",");\
	\}\
	var header1 = "<div style='font-size: 19px; font-weight: 500;'>" + "<i class='fa fa-times-circle' onclick='closeAttachmentDiv1();' style='float:right;cursor:pointer;font-size: 40px;color: white;margin: 20px 20px 0px 0px;'></i>" + "</div>";\
	var body1 = "<div class='attach-preview-div1'>" + ATTACH_IFRAME1 + "</div>";\
	var skeleton1 = "<div class='blk-upld-container'>" + "<div class='attachment-div1' auth='RSRC'>" + "<div class='attachment-header1'>" + header1 + "</div>" + "<div class='attachment-body'>" + body1 + "</div>"\
	"</div>" + "</div>";\
	var num = 0;\
	var data_link = '';\
	var data_type = '';\
	$('body').append(skeleton1);\
	for(var i = 0; i < tot; i++) \{\
		num = i + 1;\
		data_link = seqarr[i];\
        type1[i] = type1[i].trim(); //to chk\
		data_type = type1[i];\
		if(data_type == 'jpeg') \{\
			handleImageFile1(num, data_link);\
		\} else if(data_type == 'pdf') \{\
			$('#attach_preview0' + (num)).attr('src', data_link);\
			$('.link0' + (num)).attr('href', data_link);\
		\} else if(data_type == 'doc' || data_type == 'docx' || data_type == 'ppt' || data_type == 'pptx' || data_type == 'xls' || data_type == 'xlsx' || data_type == 'txt' || data_type == 'csv') \{\
			handleOtherFiles(num, data_link, data_type);\
		\} else \{\
			console.log("Ooops!!!");\
		\}\
	\}\
	$('#send-action-div, #send-action-div-point').hide('fast');\
\}\
\
function handleOtherFiles(num, data_link, data_type) \{\
	var pos = data_link.indexOf('?');\
	if(pos == -1) pos = data_link.length;\
	var data_link1 = data_link.substr(28, pos - 28);\
	retry();\
\
	function retry() \{\
		if(data_type == 'ppt' || data_type == 'pptx' || data_type == 'docx') \{\
			setTimeout(function() \{\
				$('#attach_preview0' + (num)).attr('src', 'https://view.officeapps.live.com/op/embed.aspx?src=' + data_link);\
			\}, 1500);\
		\} else if(data_type == 'txt') \{\
			var str_new = "Preview of this file is not supported";\
			setTimeout(function() \{\
				$('#attach_preview0' + (num)).css("background-color", "#fff");\
				$('#attach_preview0' + (num)).append("<span>" + str_new + "</span>");\
				handleImageFile1(num, data_link, 'https://my.imimg.com/gifs_new/messagecentre/text_preview.jpg');\
			\}, 250);\
		\} else if(data_type == 'csv') \{\
			var str_new = "Preview of this file is not supported";\
			setTimeout(function() \{\
				$('#attach_preview0' + (num)).css("background-color", "#fff");\
				$('#attach_preview0' + (num)).append("<span>" + str_new + "</span>");\
				handleImageFile1(num, data_link, 'https://my.imimg.com/gifs_new/messagecentre/csv_preview.jpg');\
			\}, 250);\
		\} else \{\
			setTimeout(function() \{\
				$('#attach_preview0' + (num)).attr('src', 'https://view.officeapps.live.com/op/embed.aspx?src=' + data_link);\
			\}, 1000);\
		\}\
	\}\
	$('.link0' + (num)).attr('href', data_link);\
\}\
\
function closeAttachmentDiv1() \{\
	$(".attachment-div1").slideToggle("fast", function() \{\
		$(".blk-upld-container").remove();\
	\});\
\}\
/*\
    Function does a comparison and returns a percentage based on equivalency\
*/\
function getSimilarityPercent(s1, s2) \{\
	function editDistance(s1, s2) \{\
		s1 = s1.toLowerCase();\
		s2 = s2.toLowerCase();\
		var costs = new Array();\
		for(var i = 0; i <= s1.length; i++) \{\
			var lastValue = i;\
			for(var j = 0; j <= s2.length; j++) \{\
				if(i == 0) costs[j] = j;\
				else \{\
					if(j > 0) \{\
						var newValue = costs[j - 1];\
						if(s1.charAt(i - 1) != s2.charAt(j - 1)) newValue = Math.min(Math.min(newValue, lastValue), costs[j]) + 1;\
						costs[j - 1] = lastValue;\
						lastValue = newValue;\
					\}\
				\}\
			\}\
			if(i > 0) costs[s2.length] = lastValue;\
		\}\
		return costs[s2.length];\
	\}\
	try \{\
		var longer = s1;\
		var shorter = s2;\
		if(s1.length < s2.length) \{\
			longer = s2;\
			shorter = s1;\
		\}\
		var longerLength = longer.length;\
		if(longerLength == 0) \{\
			return 1.0;\
		\}\
		return parseInt((longerLength - editDistance(longer, shorter)) / parseFloat(longerLength) * 100);\
	\} catch(err) \{\
		return 0\
	\}\
\}\
//XMPP code will be implemented again later\
function sendMessageRealTime(reply_msg, type, unq_msg_id) \{\
	try \{\
		var sender_name = document.getElementById("glusr_fl_name").value;\
		var ImeshVisitorcookie = readCookie("ImeshVisitor");\
		var sender_no = getparamVal(ImeshVisitorcookie, "mb1");\
		var data_param = \{\
			"msg_alignment": "left",\
			"msg_query_id": reply_msg["qid"],\
			"msg_query_type": reply_msg["qtype"],\
			"msg_read_status": "",\
			"msg_receiver_id": reply_msg["recv_id"],\
			"msg_ref_type": "REPLY",\
			"msg_sender_id": reply_msg["glid"],\
			"msg_text": reply_msg["msg"],\
			"message_id": unq_msg_id,\
			"msg_sender_name": sender_name,\
			"msg_sender_contact_number": sender_no\
		\}\
		if(typeof sendMessage === "function" && connection.connected == true) \{\
			if(type === 'attach') \{\
				data_param["msg_attach"] = []\
				var attach_arr = reply_msg["attachments"];\
				attach_arr = attach_arr.split(',');\
				if(attach_arr[0].includes("https://") === true) \{ //case drive\
					for(var idx = 0; idx < attach_arr.length; idx++) \{\
						var l = attach_arr[idx].lastIndexOf('/');\
						var obj = \{\
							"key": attach_arr[idx].substring(l + 1, attach_arr[idx].length),\
							"value": attach_arr[idx]\
						\}\
						data_param["msg_attach"].push(obj);\
					\}\
				\} else \{\
					for(var idx = 0; idx < attach_arr.length; idx++) \{\
						var l = attach_arr[idx].lastIndexOf('/');\
						var obj = \{\
							"key": attach_arr[idx].substring(l + 1, attach_arr[idx].length),\
							"value": 'https://documents.imimg.com/' + attach_arr[idx]\
						\}\
						data_param["msg_attach"].push(obj);\
					\}\
				\}\
				sendMessage(data_param);\
			\} else if(type === 'txt') \{\
				sendMessage(data_param);\
			\} else \{\
				// Unknown case.\
			\}\
		\}\
	\} catch(err) \{\
		// Error while creating real time reply.\
	\}\
\}\
\
function createContactDynamicHTML(filtered_list, is_append) \{\
	is_append = is_append !== undefined && is_append !== null && is_append !== '' ? is_append : false;\
	var f_lst = jQuery.extend(true, [], filtered_list);\
	var c_len = filtered_list.length;\
	var glid = $("#trackid").val();\
	var ul = byId("fetch_list");\
	var j = 0;\
	var back_el = byId("back_to_unarchive");\
	var dom_id = 0;\
	if(is_append == false) \{\
		while(fetch_list.firstChild) fetch_list.removeChild(fetch_list.firstChild);\
	\} else \{\
		var strt_el = byId("start").value;\
		dom_id = strt_el !== undefined && strt_el !== null && strt_el !== '' ? parseInt(strt_el) : 0;\
	\}\
	if(back_el !== undefined && back_el !== null && back_el !== '') \{\
		back_el.remove();\
	\}\
	while(j < c_len) \{\
		var single_contact = createSingleContactHtml(dom_id, f_lst[j]);\
		ul.appendChild(single_contact['li']);\
		byId("fetch_list").querySelectorAll("li")[dom_id].innerHTML = single_contact['skeleton'];\
		j++;\
		dom_id++;\
	\}\
	if(typeof displayContactsAsOnline === "function") \{\
		displayContactsAsOnline();\
	\} //XMPP code will be implemented again later\
	byId("srh-cross").style.display = "none";\
\}\
/* \
    Creates single contacts.\
    Needs all the details of the contact and the DOM ID to create.\
    Returns HTML element of <LI> and String form of its indside data.\
*/\
function createSingleContactHtml(dom_id, c) \{\
	var c_name = c.contacts_name === undefined || c.contacts_name === null || c.contacts_name === '' ? 'Buyer' : htmlEscape(c.contacts_name);\
	var c_company = c.contacts_company === undefined || c.contacts_company === null || c.contacts_company === '' ? '' : htmlEscape(c.contacts_company);\
	var c_mobile = c.contacts_mobile1 === undefined || c.contacts_mobile1 === null || c.contacts_mobile1 === '' ? '' : htmlEscape(c.contacts_mobile1);\
	var c_city = c.contact_city === undefined || c.contact_city === null || c.contact_city === '' ? '' : htmlEscape(c.contact_city);\
	var last_time = c.last_contact_date_view === undefined || c.last_contact_date_view === null || c.last_contact_date_view === '' ? '' : c.last_contact_date_view;\
	var unrd_msg_cnt = c.unread_message_cnt === undefined || c.unread_message_cnt === null || c.unread_message_cnt === '' ? '' : c.unread_message_cnt;\
	var contacts_glid = c.contacts_glid === undefined || c.contacts_glid === null || c.contacts_glid === '' ? '' : c.contacts_glid;\
	var c_country = c.country_name === undefined || c.country_name === null || c.country_name === '' ? '' : htmlEscape(c.country_name);\
	var contacts_type = c.contacts_type === undefined || c.contacts_type === null || c.contacts_type === '' ? '' : c.contacts_type;\
    var contacts_date = c.last_contact_date === undefined || c.last_contact_date === null || c.last_contact_date === '' ? '' : c.last_contact_date;\
	var im_contact_id = c.im_contact_id === undefined || c.im_contact_id === null || c.im_contact_id === '' ? '' : c.im_contact_id;\
	var msg_read_status = c.msg_read_status === undefined || c.msg_read_status === null || c.msg_read_status === '' ? '' : c.msg_read_status;\
	var product = c.contact_last_product === undefined || c.contact_last_product === null || c.contact_last_product === '' ? '' : c.contact_last_product;\
	var c_state = c.contact_state === undefined || c.contact_state === null || c.contact_state === '' ? '' : c.contact_state;\
	var last_message = c.last_message === undefined || c.last_message === null || c.last_message === '' ? '' : c.last_message;\
	var company_logo = c.glusr_usr_logo_img_90x90 === undefined || c.glusr_usr_logo_img_90x90 === null || c.glusr_usr_logo_img_90x90 === '' ? '' : c.glusr_usr_logo_img_90x90;\
	var cmp_logo_class = '',\
		cmp_logo_txt = '',\
		nm_txt = '';\
	if(c_company != '') nm_txt = c_company.charAt(0).toUpperCase();\
	else nm_txt = c_name.charAt(0).toUpperCase();\
	if(company_logo == '') \{\
		cmp_logo_class = "no_cmp_logo";\
		cmp_logo_txt = '<span>' + nm_txt + '</span>';\
	\}\
	else\{\
        $('.cmp_logo').css("display", "block");\
    \}\
	last_message = last_message.replace('<', '&lt;');\
	last_message = last_message.replace('>', '&gt;');\
	last_message = last_message.length === 60 ? last_message + "..." : last_message;\
	var blue_tick = TICK.replace('CUSTOM_COLOR', '#272BF7');\
	var glid = byId('trackid').value;\
	//var disp_company = c_company != '' ? ' (<c_company>' + c_company + '</c_company>)' : '<c_company></c_company>';\
	var disp_company = c_company != '' ? ' <c_company>' + c_company + '</c_company>' : '<c_company></c_company>';\
	//var nm_disp      = '<p class="contname wrd_elip">'+c_name+'</p>';\
	//var num_disp     = '<p id="c_number'+dom_id+'" class="dib c_num">';\
	var add_bold_cls = "",\
		add_marg_top_cls = "";\
	if(c_company == '' && c_city == '' && c_state == '') \{\
		add_bold_cls = "font-size:15px; line-height:21px; font-weight:bold; color: #262626;";\
		add_marg_top_cls = "margin-top:3px;";\
	\}\
	var nm_disp = '<span id="c_name" style="' + add_bold_cls + '">' + c_name + '</span>';\
	var num_disp = '<span id="c_number' + dom_id + '" class="dib c_num">';\
	num_disp = c_mobile !== '' ? ' ' + num_disp + '(' + c_mobile + ')' + '</span>' : num_disp + '</span>';\
	var unread_class = unrd_msg_cnt != '' ? 'unread' : '';\
	var lst_snipt = (msg_read_status !== undefined && msg_read_status !== null && msg_read_status.toString() == "1") ? blue_tick + last_message : last_message;\
	var unrd_disp = (unrd_msg_cnt != '' && unrd_msg_cnt > 0) ? '<span id="' + contacts_glid + '" class="msg_unrd_cnt">' + unrd_msg_cnt + '</span>' : '';\
	var addr_display = '';\
	var prdct_dsply = '';\
	var ast_msg_cnct = '';\
	var lst_snpt_cls = 'last-msg-snippet';\
	if(product != '') \{\
		//prdct_dsply = '<p class="clr wrd_elip prod-p-cls"><span class="prd_icn_green"></span><span class="prdct_dsply" onclick="showParticularProduct(\\'' + product + '\\')">' + product + '</span></p>';\
		prdct_dsply = '<p class="clr wrd_elip prod-p-cls"><span class="prd_icn_green"></span><span class="prdct_dsply">' + product + '</span></p>';\
	\} else \{\
		prdct_dsply = '<p class="clr wrd_elip"></p>';\
		lst_snpt_cls = 'no-prdct-snippet'\
	\}\
	if(c_state != '') \{\
		c_state = '<c_state>' + c_state + '</c_state>';\
		if(c_country != '' && c_country.toLowerCase(0) != 'india') \{\
			addr_display = c_state + ', <c_country>' + c_country + '</c_country>';\
		\} else \{\
			addr_display = c_state + '<c_country></c_country>';\
		\}\
	\} else \{\
		if(c_country != '' && c_country.toLowerCase(0) != 'india') \{\
			addr_display = '<c_state></c_state><c_country>' + c_country + '</c_country>';\
		\} else \{\
			addr_display = '<c_state></c_state><c_country></c_country>';\
		\}\
	\}\
	if(c_city != '') \{\
		addr_display = '<c_city>' + c_city + '</c_city>, ' + addr_display;\
	\} else \{\
		addr_display = '<c_city></c_city>' + addr_display;\
	\}\
	if(lst_snipt == 'IndiaMART connected you with this seller') ast_msg_cnct = 'ast_msg_cnct';\
	/*var c_skeleton  =   '<div class="c-div">' + nm_disp + num_disp +  '</div>' +\
	                    '<i class="fa fa-circle c-onln-icn"></i>'+\
	                    '<div class="wrd_elip c_addr">' + addr_display + disp_company + '</div>' +\
	                    prdct_dsply +\
	                    '<p class="'+lst_snpt_cls+' wrd_elip">' + lst_snipt + '</p>' +\
	                    '<div class="c-onln-div">'+\
	                        '<p class="lst-msg-date ' + unread_class + ' ">' + last_time + '</p>' +\
	                        '<i class="fa fa-circle c-onln-icn" id="online-'+contacts_glid+'"></i>'+\
	                    '</div>' +\
	                    unrd_disp  ;*/\
	var coma_val = '',\
		space_brk = '';\
	if(c_company !== '' && (c_city != '' || c_state != '' || (c_country != '' && c_country.toLowerCase() != 'india'))) coma_val = ', ';\
	if(c_company !== '' || c_city != '' || c_state != '' || (c_country != '' && c_country.toLowerCase() != 'india')) space_brk = '<br>';\
	var c_skeleton = '<input type="hidden" class="contact_date" value="'+contacts_date+'"><div class="' + cmp_logo_class + '"><img src="' + company_logo + '" class="cmp_logo" style="' + add_marg_top_cls + '">' + cmp_logo_txt + '</div>' + '<div class="left_det_show"><div class="c-div"><p class="wrd_elip c_addr">' + disp_company + coma_val + addr_display + '</p>' + space_brk + '</div>' + '<i class="fa fa-circle c-onln-icn"></i>' + '<div class="wrd_elip contname c_addr">' + nm_disp + num_disp + '</div>' + prdct_dsply + '<p class="' + lst_snpt_cls + ' wrd_elip ' + ast_msg_cnct + '">' + lst_snipt + '</p>' + '<div class="c-onln-div">' + '<p class="lst-msg-date ' + unread_class + ' ">' + last_time + '</p>' + '<i class="fa fa-circle c-onln-icn" id="online-' + contacts_glid + '"></i>' + '</div>' + unrd_disp + '</div>';\
	var main_li = document.createElement("li");\
	main_li.setAttribute("class", "user-name1");\
	main_li.setAttribute("id", dom_id);\
	main_li.setAttribute("onclick", "contactDetail('" + dom_id + "', '" + glid + "', '" + c_mobile + "', '" + contacts_type + "', '" + contacts_glid + "', '" + im_contact_id + "', '" + c_name + "');");\
	return \{\
		'li': main_li,\
		'skeleton': c_skeleton\
	\}\
\}\
/*\
    Highlights the searched text in the contacts cards.\
*/\
function highlightSearchText(input) \{\
	var filter = input.value;\
	var ul = byId("fetch_list");\
	var li = ul.getElementsByTagName("li");\
	for(var i = 0, len = li.length; i < len; i++) \{\
		var c_name = li[i].querySelector("p.contname");\
		var c_num = li[i].querySelector("p.c_num");\
		var c_city = li[i].getElementsByTagName("c_city")[0];\
		var c_state = li[i].getElementsByTagName("c_state")[0];\
		var c_country = li[i].getElementsByTagName("c_country")[0];\
		var c_cmpny = li[i].getElementsByTagName("c_company")[0];\
		var c_prdct = li[i].querySelector("span.prdct_dsply");\
		var search_elems = [c_name, c_num, c_city, c_state, c_country, c_cmpny, c_prdct];\
		for(var idx = 0, li_len = search_elems.length; idx < li_len; idx++) \{\
			var elem = search_elems[idx];\
			if(elem !== undefined && elem !== null && elem !== '') \{\
				var elem_text = elem.innerText;\
				if(elem_text !== undefined && elem_text !== null && elem_text !== '') \{\
					if(elem_text.toUpperCase().indexOf(filter.toUpperCase()) > -1) \{\
						var reg_filter = filter;\
						reg_filter = reg_filter.replace(/\\+/g, '\\\\+');\
						reg_filter = reg_filter.replace(/\\?/g, '\\\\?');\
						reg_filter = reg_filter.replace(/\\*/g, '\\\\*');\
						reg_filter = reg_filter.replace(/\\)/g, '\\\\)');\
						reg_filter = reg_filter.replace(/\\(/g, '\\\\(');\
						var matched_text = elem_text.match(new RegExp(reg_filter, "i"))[0];\
						matched_text = htmlEscape(matched_text);\
						elem.innerHTML = htmlEscape(elem_text);\
						elem.innerHTML = elem.innerHTML.replace(matched_text, matched_text.bold().fontcolor("#00a699"));\
					\}\
				\}\
			\}\
		\}\
	\}\
\}\
\
function hideScroller() \{\
	var non_hidden_contacts = $(".user-name1").filter(function() \{\
		return this.getAttribute("style") === null;\
	\});\
	var shownContacts = non_hidden_contacts.length;\
	var toShow = 0;\
	toShow = ($(".cs_scrollable").height() / $(".user-name1").outerHeight());\
	toShow = Math.ceil(toShow);\
	if(shownContacts > toShow) \{\
		$('.cs_position').css("display", "block");\
		document.getElementById('scrollerdiv').scrollTop = 0 // For scrolling the contact div back to top.\
	\} else \{\
		$('.cs_position').css("display", "none");\
	\}\
\}\
\
function startSearch() \{\
	if(list === undefined || list === null || list.length === undefined || list.length === 0) \{\
		$('#searchauto').val('');\
		return;\
	\}\
	var len = list.length;\
	var input = document.getElementById("searchauto");\
	var textlen = input.value.length;\
	var result_show_count = 20;\
	var filtered_list = getSearchContactsFromList(result_show_count, input.value);\
	$(".action-div").remove();\
	if(textlen > 0) \{\
		var len = filtered_list.length > result_show_count ? result_show_count : filtered_list.length;\
		createContactDynamicHTML(filtered_list.slice(0, len), false); // Display only few searched contacts.\
		byId("start").value = 0;\
		byId("end").value = len;\
		highlightSearchText(input);\
		byId("srh-cross").style.display = "block";\
	\} else \{\
		var len = list.length > 50 ? 50 : list.length;\
		createContactDynamicHTML(list.slice(0, 50), false);\
		byId("start").value = 0;\
		byId("end").value = len;\
		if(byId('0')) \{\
			byId('0').click();\
			$('#searchauto').focus();\
		\}\
		byId("srh-cross").style.display = "none";\
	\}\
	hideScroller();\
\}\
\
function showParticularProduct(p_name) \{\
	byId("searchauto").value = p_name;\
	startSearch();\
\}\
\
function search_ga() \{\
	var srch_name = document.getElementById('searchauto').value;\
	if(srch_name != undefined && srch_name != null && srch_name.length > 0) \{\
		trackEvent('messagecentre', 'message_searchauto');\
		$.ajax(\{\
			url: '/phpajax/enquiry/messagecentre/searchLog',\
			data: \{\
				"searchText": srch_name,\
				"glid": byId('trackid').value\
			\},\
			dataType: "Json",\
			type: "GET",\
		\});\
	\}\
\}\
/*\
    Code to filter out the data from global variable list\
*/\
function getSearchContactsFromList(result_show_count, search_text) \{\
	var iter = 0;\
	var filtered_list = [];\
	for(var idx = 0, len = list.length; idx < len; idx++) \{\
		var data = jQuery.extend(true, [], list[idx]);\
		if(iter > result_show_count) \{\
			break\
		\}\
		if(data.contacts_name === undefined || data.contacts_name === null) \{\
			data.contacts_name = "Buyer";\
		\}\
		if(data.contacts_name.trim() === "") \{\
			data.contacts_name = "Buyer";\
		\}\
		var c_name = data.contacts_name ? data.contacts_name.toUpperCase() : '';\
		var c_mobile = data.contacts_mobile1 ? data.contacts_mobile1.toUpperCase() : '';\
		var c_company = data.contacts_company ? data.contacts_company.toUpperCase() : '';\
		var c_city = data.contact_city ? data.contact_city.toUpperCase() : '';\
		var c_state = data.contact_state ? data.contact_state.toUpperCase() : '';\
		var c_country = data.country_name ? data.country_name.toUpperCase() : '';\
		var c_product = data.contact_last_product ? data.contact_last_product.toUpperCase() : 'DYNAMIC PRODUCT';\
		var fil = search_text.toUpperCase();\
		if((c_name.indexOf(fil) !== -1) || (c_mobile.indexOf(fil) !== -1) || (c_company.indexOf(fil) !== -1) || (c_city.indexOf(fil) !== -1) || (c_country.indexOf(fil) !== -1) || (c_product.indexOf(fil) !== -1) || (c_state.indexOf(fil) !== -1)) \{\
			iter = iter + 1;\
			filtered_list.push(data);\
		\}\
	\}\
	return filtered_list;\
\}\
//Convert 24 hr time to 12 hr format\
function convertTime(time) \{\
	var hours = Number(time.match(/^(\\d+)/)[1]);\
	var min = Number(time.match(/:(\\d+)/)[1]);\
	if(min < 10) min = "0" + min;\
	if(hours < 12) \{\
		return hours + ':' + min + ' AM';\
	\} else if(hours == 12) \{\
		return hours + ':' + min + ' PM';\
	\} else \{\
		hours = hours - 12;\
		hours = (hours < 10) ? '0' + hours : hours;\
		return hours + ':' + min + ' PM';\
	\}\
\}\
/*function editContactReminder(rem_data)\{\
    openAddReminder();\
    var rem_type_icn 	= \{'2': '#rem_tab1', '3': '#rem_tab2', '4': '#rem_tab3'\};\
    var time_obj 		= \{\
                            "09:00": "09:00 AM", "09:30": "09:30 AM", "10:00": "10:00 AM", "10:30": "10:30 AM", "11:00": "11:00 AM",\
                            "11:30": "11:30 AM", "12:00": "12:00 PM", "12:30": "12:30 PM", "13:00": "01:00 PM", "13:30": "01:30 PM",\
                            "14:00": "02:00 PM", "14:30": "02:30 PM", "15:00": "03:00 PM", "15:30": "03:30 PM", "16:00": "04:00 PM",\
                            "16:30": "04:30 PM", "17:00": "05:00 PM", "17:30": "05:30 PM", "18:00": "06:00 PM", "18:30": "06:30 PM",\
                            "19:00": "07:00 PM", "19:30": "07:30 PM", "20:00": "08:00 PM", "20:30": "08:30 PM", "21:00": "09:00 PM"\
                          \};\
    var selected_tab_id = rem_data.REMIND_TYPE in  rem_type_icn ? rem_type_icn[rem_data.REMIND_TYPE] : '#rem_tab1';\
    var rem_time 		= rem_data.REMIND_DATETIME.split(' ')[1];\
    var hr_part 		= rem_time.split(':')[0];\
    var min_part 		= rem_time.split(':')[1];\
    var rem_date_raw 	= rem_data.REMIND_DATETIME.split(' ')[0].split('-');\
    \
    // Calculating difference in DAYS bewteen reminder date and todays date\
    var rem_date 		= new Date(new Date(rem_date_raw[2], parseInt(rem_date_raw[1]) - 1, rem_date_raw[0]));\
    var todays_date 	= new Date();\
    var time_diff 		= rem_date.getTime() - todays_date.getTime();\
    var diff_days 		= time_diff > 0 ? Math.ceil(time_diff / (1000 * 3600 * 24)) : 0;\
    \
    if (diff_days > 0)\{\
        $('select#time').html('');\
        $.each(time_obj, function(key, value) \{$('select#time').append('<option value=\\"'+key+'\\">' + value + '</option>');\});\
    \}\
    $(".mark-as-done").css('display', 'inline');\
    // Select the corresponding reminder type tab\
    $('#rem_tab1, #rem_tab2, #rem_tab3').removeClass('selected');\
    $(selected_tab_id).addClass('selected');\
    // Updating Submit button text\
    $('#set_rem_btn').val('Update Reminder')\
    $('input#set_rem_btn').css('padding-left', '26px')\
    // Updating Time select\
    $('#time option[value="'+hr_part+':'+min_part+'"]').attr('selected', 'selected');\
    // Updating date picker if the date is not past yet\
    $("#call-datepick").datepicker('setDate', String(diff_days));\
    // Updating Notes\
    $('#note').val(rem_data.REMIND_NOTE);\
    // Changing Button action\
    $("#set_rem_btn").attr("onclick","updateReminder('"+rem_data.REMINDER_ID+"', '"+rem_data.FK_QUERY_ID+"')");\
    handleGrammarlyIssueHack();\
\}\
    \
function createReminderListHTML(jsonResponse)\{\
    var rem_html = "<div class='remList' onclick=''>No Reminder.</div>";\
    if(jsonResponse.status == 'Success')\{\
        rem_html 		= '';\
        var rem_list 	= jsonResponse.response;\
        if(rem_list.length > 0)\{\
            var m_names 		= ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];\
            var rem_type_icn 	= \{'2': 'fa fa-phone', '3': 'fa fa-user', '4': 'fa fa-thumb-tack'\};\
            for (var idx=0; idx<rem_list.length; idx++)\{\
                var rem_item 	= rem_list[idx];\
                var icon 		= '';\
                var color 		= '';\
                var type_icon 	= '';\
                var rdate 		= rem_item.REMIND_DATETIME;\
                var note_click 	= 'editContactReminder('+JSON.stringify(rem_item)+')';\
                var raw_note 	= rem_item.REMIND_NOTE;\
                var note 		= (raw_note !== undefined && raw_note !== null && raw_note.trim() !== "") ? raw_note : "Reminder Set";\
                note 			= note.length > 30 ? note.substr(0,27) + "..." : note;	// Trim the note to 34 characters.\
                note 			= note.charAt(0).toUpperCase() + note.slice(1);			// Upper case the first character.\
                if(rem_item.STATUS == 1)\{\
                    color 		= "black;";\
                    icon 		= "<i class='fa fa-check' aria-hidden='true' style='margin-top:10px; float:right; color:green; font-size:17px;'></i>";\
                    note_click 	= ''\
                \}else\{\
                    color 	= (rem_item.dueFlagValue == 1 || rem_item.dueFlagValue == 0) ? "green;" : "red;";\
                    icon 	= "<i class='fa fa-pencil' aria-hidden='true' style='margin-top:10px; float:right; color: #666; font-size:17px;'></i>";\
                \}\
    \
                if (rem_item.REMIND_TYPE in rem_type_icn)\
                    type_icon = "<div class='reminder_icn'><i class='"+ rem_type_icn[rem_item.REMIND_TYPE] +"' aria-hidden='true'></i></div>";\
                else\
                    type_icon = "<div class='reminder_icn' style='margin-right: 20px;'><i class='' aria-hidden='true'></i></div>";\
    \
                rdate 			= rdate.split(" ");\
                var rdate_list 	= rdate[0].split("-");\
                rdate_list 		= rdate_list[2]+"-"+rdate_list[1]+"-"+rdate_list[0];\
                var d 			= new Date(rdate_list);\
                var curr_date 	= d.getDate();\
                var curr_month 	= d.getMonth();\
                var curr_year 	= d.getFullYear();\
                curr_year 		= curr_year.toString();\
                curr_year 		= curr_year.slice(2, 4);\
                rdate[0] 		= curr_date +"-"+ m_names[curr_month]+"-"+curr_year;\
                rtime 			= convertTime(rdate[1]);\
                rem_html		= rem_html + "<div class='remList' onclick='"+note_click+"'>"+type_icon+"<div class='f1' style='width: 239px;'><span style='font-size:14px;color:#26292c;'>"+note+"</span><br><span style='font-size:12px;color:"+color+"'>"+rdate[0]+"  &nbsp;&nbsp  "+rtime+"</span></div><div class='f2'>"+icon+"</div></div>";\
            \}\
        \}\
    \}\
    return rem_html;\
\}\
    \
function createReminderIcons()\{\
    var glid 		= $('#trackid').val();\
    var query_id 	= $('#msg_query_id').val() ? $('#msg_query_id').val() : 1;\
    $.ajax(\{\
        url 		: '/enquiry/enquiryajax/ReminderList',\
        data 		: \{ "qid": query_id, "glid": glid\},\
        type 		: "POST",\
        dataType 	: "json",\
        success 	: function(jsonResponse)\{\
            var green_clock = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAIeSURBVEhLtVVNqE1RFF5Fkp+SiZTETMpPKUwMRDJTSinExFCmysAIJTNy1j738XTv3ft4Z+aNpPRSioGMKAMD+U1KKYU8P9/ae71797139c59A1993bP3+tZ31tlnnXVpBNNuGXV4ra6aEVpraHJyqa4MdHkLeX5Awf0G/+L6PXXKdRodhXf7ofuStO4HBa5GC/JuEwRfoyiZzlLlTsTYxMRKqso90BzFzQ/jZruprpfEmOdLvZyU9wrVr4qxCO/uD5gGPk6+2In1dKomS06UIm5Ru9w4Yh7clWQqZ9p//FnqlqdgfA3XfzKxTc8/oT0zZP4yGcvhJ5FUehK/dzNRRpyh5yd2zF3sm/OHZCwI/BbE4/PVoYQ+vTuHuDdjQl8ei+ZyrD3IWXWKzdj8ZSYJm4yD+5RedLFBXRXyMuyExGZj0ZxVN0VdL8JRfDbFcxzPeEYdFVK+Jcw5jrG04QAC7zJEYHkahkeU+IjQGaYuo7RvD3eKbabI83OYPc343dTNUVp25sJidQWmWqux2fxBNNG7N+qYIVZkiBdCzzfVLYO0iiVeCLu8V90yyEwN/NpMGIt8T50MyEiMg8VKnI+YD/PNbmq3l1O3OAThN9vAIuaMb+0YbLMctVsP4Yv0sbS24vrRoMEQpYs8T8V/jYoPYO8h1ddXqFsG727j7gd1lVDxPuzdQOwZ+BF8h/Vj8DLm9nZVJcS57M7r6n+B6B9qf++n5vt8XgAAAABJRU5ErkJggg==';\
            var gray_clock = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJHSURBVEhLtZU/iBNBFMYXlEPUA7ERQUQ7EfwDgtpYiCJ2giAIKtpYiu2BtQpiJ9gpNnKYzqsul92MO7OZGTCIRQQLC/H0DhGEA0EPo+f3Zl/cye0jiYUffCSz+80vb9/OTJL1mut2N+f5y508HKvUuR1KqU08rGvhhT2QGptl2v7KjFvLtPuklN/Ft2tqGXs61e5ryBr3IzN2tlaQ6nT2AbjCIXI/0/4K3SuKYjot/AlALuL6eWX88UavN0X3cO1ONGcN43eofhvdCwJ0IQr0Ebic5vYoqp7DGNVUk4NRBJ7ucTP3e2tw4+4FKPX07+MTNHfXAHyQavs7niBa21X4RgzH97cBTM3ni3307SqAzwehYdtZVOnle+72AI7MUgCTMFikx8ev3183IfYMMk+F68Gtwl4KcLSVsUlS9srvR39+SpPYI8Fo32d60Uq5PYwtRS9DnFB5NBhGYTcZV6rRaGwA+IsUjjwWjDYoRpai8sXgsCcBrzCyVFu7Y3LQXcdquEAOmwgrQ8xFpuXLWGwQ4w9JISy9HlrUrey+S7nIfey8jYxNknlrt0+0IcbafmBkJapIDk9uvINHjKtES0UK/4txWJ1kXCU6U/GL76UJkxiFzTOqLjoSsWRWpYmjjDYujTq7k2bz9ZZ27s/hJXyTAJIBXWwbf2RomcVqGbMbwDe0WdCSg3i0QgINTKsIuWf0r5EV/gzyOdq5lXGVsBmetLQ9y8Ogtu6cQkUPAXqFz2VkPgLo4LuqKA5zLAgtpHP5Fg//l5LkD2BwaHsGExkrAAAAAElFTkSuQmCC';\
            if(jsonResponse.response.length === 0)\{\
                $('#contact_add_reminder').attr('src', gray_clock);\
                $('#contact_add_reminder').attr('title', "Reminders");\
            \}\
            else\{\
                $('#contact_add_reminder').attr('src', green_clock);\
                $('#contact_add_reminder').attr('title', "Reminders("+jsonResponse.response.length+")");\
            \}\
        \}\
    \});\
\}\
    \
function getReminderList()\{\
    if($('#Remindmodal').is(':visible'))\{\
        closeRemList();\
        return false;\
    \}\
    $('#contact_add_reminder').css('cursor', 'progress');\
    var glid 		= $('#trackid').val();\
    var query_id 	= $('#msg_query_id').val() ? $('#msg_query_id').val() : 1;\
    $.ajax(\{\
        url 		: '/enquiry/enquiryajax/ReminderList',\
        data 		: \{ "qid": query_id, "glid": glid\},\
        type 		: "POST",\
        dataType 	: "json",\
        success 	: function(jsonResponse)\{\
            var green_clock = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAIeSURBVEhLtVVNqE1RFF5Fkp+SiZTETMpPKUwMRDJTSinExFCmysAIJTNy1j738XTv3ft4Z+aNpPRSioGMKAMD+U1KKYU8P9/ae71797139c59A1993bP3+tZ31tlnnXVpBNNuGXV4ra6aEVpraHJyqa4MdHkLeX5Awf0G/+L6PXXKdRodhXf7ofuStO4HBa5GC/JuEwRfoyiZzlLlTsTYxMRKqso90BzFzQ/jZruprpfEmOdLvZyU9wrVr4qxCO/uD5gGPk6+2In1dKomS06UIm5Ru9w4Yh7clWQqZ9p//FnqlqdgfA3XfzKxTc8/oT0zZP4yGcvhJ5FUehK/dzNRRpyh5yd2zF3sm/OHZCwI/BbE4/PVoYQ+vTuHuDdjQl8ei+ZyrD3IWXWKzdj8ZSYJm4yD+5RedLFBXRXyMuyExGZj0ZxVN0VdL8JRfDbFcxzPeEYdFVK+Jcw5jrG04QAC7zJEYHkahkeU+IjQGaYuo7RvD3eKbabI83OYPc343dTNUVp25sJidQWmWqux2fxBNNG7N+qYIVZkiBdCzzfVLYO0iiVeCLu8V90yyEwN/NpMGIt8T50MyEiMg8VKnI+YD/PNbmq3l1O3OAThN9vAIuaMb+0YbLMctVsP4Yv0sbS24vrRoMEQpYs8T8V/jYoPYO8h1ddXqFsG727j7gd1lVDxPuzdQOwZ+BF8h/Vj8DLm9nZVJcS57M7r6n+B6B9qf++n5vt8XgAAAABJRU5ErkJggg==';\
            var gray_clock = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJHSURBVEhLtZU/iBNBFMYXlEPUA7ERQUQ7EfwDgtpYiCJ2giAIKtpYiu2BtQpiJ9gpNnKYzqsul92MO7OZGTCIRQQLC/H0DhGEA0EPo+f3Zl/cye0jiYUffCSz+80vb9/OTJL1mut2N+f5y508HKvUuR1KqU08rGvhhT2QGptl2v7KjFvLtPuklN/Ft2tqGXs61e5ryBr3IzN2tlaQ6nT2AbjCIXI/0/4K3SuKYjot/AlALuL6eWX88UavN0X3cO1ONGcN43eofhvdCwJ0IQr0Ebic5vYoqp7DGNVUk4NRBJ7ucTP3e2tw4+4FKPX07+MTNHfXAHyQavs7niBa21X4RgzH97cBTM3ni3307SqAzwehYdtZVOnle+72AI7MUgCTMFikx8ev3183IfYMMk+F68Gtwl4KcLSVsUlS9srvR39+SpPYI8Fo32d60Uq5PYwtRS9DnFB5NBhGYTcZV6rRaGwA+IsUjjwWjDYoRpai8sXgsCcBrzCyVFu7Y3LQXcdquEAOmwgrQ8xFpuXLWGwQ4w9JISy9HlrUrey+S7nIfey8jYxNknlrt0+0IcbafmBkJapIDk9uvINHjKtES0UK/4txWJ1kXCU6U/GL76UJkxiFzTOqLjoSsWRWpYmjjDYujTq7k2bz9ZZ27s/hJXyTAJIBXWwbf2RomcVqGbMbwDe0WdCSg3i0QgINTKsIuWf0r5EV/gzyOdq5lXGVsBmetLQ9y8Ogtu6cQkUPAXqFz2VkPgLo4LuqKA5zLAgtpHP5Fg//l5LkD2BwaHsGExkrAAAAAElFTkSuQmCC';\
            if(jsonResponse.response.length === 0)\{\
                $('#contact_add_reminder').attr('src', gray_clock);\
                $('#contact_add_reminder').attr('title', "Reminders");\
                openAddReminder();\
            \}\
            else\{\
                $('#contact_add_reminder').attr('src', green_clock);\
                $('#contact_add_reminder').attr('title', "Reminders("+jsonResponse.response.length+")");\
                var rem_lst_html 		= createReminderListHTML(jsonResponse);\
                var list_header 		= '<span class="rem_hd_listing"><b>Reminders</b><i class="fa fa-times" id="closeRemList" onclick="closeRemList()" aria-hidden="true" style="float:right;cursor:pointer;"></i></span>'\
                var create_new_button	= '<div class="contact-create-rem" onclick="openAddReminder();handleGrammarlyIssueHack();">+ Set a new Reminder</div>'\
                var list_skeleton 		= '<div id="rem_pop">'+list_header+'<div class="contact-rem-list">'+rem_lst_html+'</div>'+create_new_button+'</div>';\
                while ($("#Remindmodal").firstChild)\
                    $("#Remindmodal").removeChild($("#Remindmodal").firstChild);\
                $("#Remindmodal").html(list_skeleton);\
            \}\
            $("#Remindmodal").show();\
            $('#rem_arw').show();\
            $('#contact_add_reminder').css('cursor', 'pointer');\
            handleGrammarlyIssueHack();\
        \}\
    \});\
\}\
    \
    \
function closeRemList()\{\
    $('#Remindmodal').hide();\
    $('#rem_arw').hide();\
\}\
    \
function openAddReminder()\{\
    var queryid 		= $('#msg_query_id').val() 		? $('#msg_query_id').val() 		: 1;\
    var qtype 			= $('#msg_query_type').val() 	? $('#msg_query_type').val() 	: 'C';\
    var recv_name_rem 	= $('#left-name').text().trim() !== '' ? $('#left-name').text().split('-')[0].trim() : 'Buyer';\
    var rem_html 		= "<div id='rem_pop'><div class='dwn_bnr' id='rem_popup'><i class='fa fa-times' aria-hidden='true' style='padding:6px 4px 4px;cursor:pointer;font-size: 14px;color:#000;float: right;margin: 4px 8px 0 0;' onclick=\\"closeRemList();\\"></i><span id='rem_hd_new'>Remind me for</span><div class='rem_main' id='rem_main'><div id='rem_tabs' ><input type='hidden' value='2' id='rem_type'><span class='reminder_tab selected' onclick='showCall(); trackEvent(\\"reminder_messages\\",\\"call_type_rem_messages\\");' id='rem_tab1'>Call</span><span class='reminder_tab' onclick='showMeeting();trackEvent(\\"reminder_messages\\",\\"meeting_type_rem_messages\\");' id='rem_tab2'>Meeting</span><span class='reminder_tab' onclick='showToDo();trackEvent(\\"reminder_messages\\",\\"todo_type_rem_messages\\");' id='rem_tab3'>To Do</span>  <p style='width: 100%; height: 2px; margin-top: 33px;'></p> </div><div id='rem_tab' class='calltab' style='cursor:auto;'><ul><li class='w170' title='Select Date' style='padding-left: 0;'> <input readonly='' onchange='updateTimeList();' name='Select_date' type='text' placeholder='Select Date' class='' id='call-datepick'><input type='hidden' id='alt-start-date' value=''></li><li style='padding-right:0;position: relative;'><select id='time' style='padding:3px;width: 170px;position:absolute;min-height:36px;background: #fff;border: 1px solid #c0c0c0;color: black;font-size: 14px;z-index:1;'></select></li><li style='padding-left: 0;'><textarea id='note' placeholder='Remarks (Optional)' style='width:360px;margin-top:10px;padding:4px;border:1px solid #c0c0c0;font-size: 14px;font-family: arial;height:64px;resize:none;' maxlength='200' value='Remind me to call "+ recv_name_rem+"'>Remind me to call "+recv_name_rem+"</textarea></li><li style='padding: 0px;'><label class='mark-as-done'><span style='font-size: 12px;'><input type='checkbox' style='cursor: pointer;' id='checkdone'>Mark this as done</span></label><div class='set_reminder_btn'> <input onclick='addReminderList(\\""+queryid+"\\",\\""+qtype+"\\");' type='submit' value='Set Reminder' id='set_rem_btn' class='set_rem'><i class='fa fa-spinner fa-pulse' id='icnload'></i></div></li></ul></div><div id='bothErr'>*Select date and time both</div><div id='timeErr'>*Select time</div><div id='dateErr'>*Select date</div></div><div id='notification' style='float: left;display:none;'><table style='cursor: default;margin-top:35px;'><tbody style='cursor: default;'><tr><td style='text-align: center;'><i class='fa fa-check-square-o' aria-hidden='true' style='color: green;font-size: 40px;'></i></td></tr> <tr style='cursor: default;'><td style='text-align: center;font-size: 17px;color: green;cursor: default;padding: 0 20px;'><b style='font-size:21px;margin-bottom: 5px;display: block;'>Reminder Set.</b>We will remind you 15 minutes before the scheduled time.</td></tr></tbody></table></div>"\
    while ($("#Remindmodal").firstChild)\
        $("#Remindmodal").removeChild($("#Remindmodal").firstChild);\
    $("#Remindmodal").html(rem_html);\
    $("#call-datepick").datepicker(\{\
        minDate 	: '0',\
        altFormat 	: 'dd-mm-yy',\
        altField 	: '#alt-start-date',\
        dateFormat 	: 'dd-M-y',\
        beforeShow 	: function() \{\
            setTimeout(function()\{ $('.ui-datepicker').css('z-index', 10); \}, 0);\
        \}\
    \});\
    $("#call-datepick").datepicker('setDate', '0');\
    updateTimeList();\
\}\
    \
function updateTimeList()\{\
    $('select#time').html('');\
    var today 		= new Date();\
    var month 		= (today.getMonth()+1) <= 9 	? "0" + (today.getMonth()+1) 	: today.getMonth() + 1;\
    var day 		= today.getDate() <= 9 			? "0" + today.getDate() 		: today.getDate();\
    var date 		= day + '/' + month + '/' + today.getFullYear();\
    var time_obj 	= \{\
                        "09:00": "09:00 AM", "09:30": "09:30 AM", "10:00": "10:00 AM", "10:30": "10:30 AM", "11:00": "11:00 AM",\
                        "11:30": "11:30 AM", "12:00": "12:00 PM", "12:30": "12:30 PM", "13:00": "01:00 PM", "13:30": "01:30 PM",\
                        "14:00": "02:00 PM", "14:30": "02:30 PM", "15:00": "03:00 PM", "15:30": "03:30 PM", "16:00": "04:00 PM",\
                        "16:30": "04:30 PM", "17:00": "05:00 PM", "17:30": "05:30 PM", "18:00": "06:00 PM", "18:30": "06:30 PM",\
                        "19:00": "07:00 PM", "19:30": "07:30 PM", "20:00": "08:00 PM", "20:30": "08:30 PM", "21:00": "09:00 PM"\
                    \};\
    var rem_date 	= $('input#alt-start-date').val().split("-");\
    rem_date 		= rem_date[0] + '/' + rem_date[1] + '/' + rem_date[2];\
    if(date == rem_date)\{\
        var d_obj 		= new Date(today);\
        d_obj.setMinutes(today.getMinutes() + 30);\
        var hour_prefix 	= d_obj.getHours() == 9 	? "0" : "";\
        var min_prefix 		= d_obj.getMinutes() < 10 	? "0" : "";\
        var time 			= hour_prefix + d_obj.getHours() + ":" + min_prefix + d_obj.getMinutes()\
        $.each(time_obj, function(key, value) \{\
            if(key.localeCompare(time) == 1 || key.localeCompare(time) == 0)\
                $('select#time').append('<option value=\\"'+key+'\\">' + value + '</option>');\
        \});\
    \}\
    else\{\
        $.each(time_obj, function(key, value) \{\
            $('select#time').append('<option value=\\"'+key+'\\">' + value + '</option>');\
        \});\
    \}\
\}\
    \
function toggleReminderTabs(rem_type)\{\
    var rem_type_obj 	= \{'2': '#rem_tab1', '3': '#rem_tab2', '4': '#rem_tab3'\};\
    var recv_name 		= $('#left-name').text().trim() !== '' ? $('#left-name').text().split('-')[0].trim() : 'Buyer';\
    var note_prefix 	= rem_type === '2' ? 'Remind me to call ' : 'Remind me to meet ' ;\
    var note 			= rem_type === '4' ? "" : note_prefix + recv_name;\
    \
    $('#rem_type').val(rem_type);\
    $('#note').val(note);\
    $('#rem_tab1, #rem_tab2, #rem_tab3').removeClass('selected');\
    $(rem_type_obj[rem_type]).addClass('selected');\
    $('#note').focus();\
\}\
    \
function showCall()\{\
    toggleReminderTabs('2');\
\}\
    \
function showMeeting()\{\
    toggleReminderTabs('3');\
\}\
    \
function showToDo()\{\
    toggleReminderTabs('4');\
\}\
    \
function addReminderList(queryid, qtype)\{\
    var rem_date 	= $('input#alt-start-date').val();\
    var glid 		= $('#trackid').val();\
    var rem_time 	= $('#time').val();\
    var rem_note 	= $('#note').val();\
    var rem_type 	= $('#rem_type').val();\
    var data_obj 	= \{"date": rem_date + " " + rem_time, "qid": queryid, "remnote": rem_note.trim(), "enqtype": qtype, "glid": glid, "remtype": rem_type, "rem_source": 6\}\
    var ajax_url 	= '/enquiry/enquiryajax/SetReminder';\
    if(queryid == 1 && qtype == 'C')\{\
        data_obj["remind_contact_glid"] = $('#contactglid').val();\
    \}\
    validateAndSaveReminder(ajax_url, data_obj, rem_date, rem_time,2); //Passing 2 for tracking for Add Reminder\
    showReminderOnReply(data_obj);\
\}\
    \
function updateReminder(rem_id, query_id)\{\
    var rem_date 	= $('input#alt-start-date').val();\
    var rem_time 	= $('#time').val();\
    var rem_note 	= $('#note').val();\
    var rem_status 	= $("#checkdone").prop("checked") ? '1' : '0';\
    var data_obj 	= \{"date": rem_date + ' ' + rem_time, "qid": query_id, "remnote": rem_note.trim(), "remid": rem_id, "remstatus": rem_status, "rem_source": 6\};\
    var ajax_url 	= '/enquiry/enquiryajax/UpdateReminder';\
    validateAndSaveReminder(ajax_url, data_obj, rem_date, rem_time,rem_status);\
\}\
    \
function showReminderOnReply(rem_data)\{\
    var month_arr 			= ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];\
    var type_obj 			= \{'2': 'Call', '3': 'Meeting', '4': 'Task'\};\
    var rem_type_icn 		= \{'Call': 'fa fa-phone', 'Meeting': 'fa fa-user', 'Task': 'fa fa-thumb-tack'\};\
    var todays_date 		= new Date();\
    var cur_time_in_12hr 	= todays_date.toLocaleString('en-US', \{ hour: 'numeric', minute : 'numeric',  hour12: true \});\
    var rem_set_time 		= todays_date.getDate() + ' ' + month_arr[todays_date.getMonth()].substr(0,3) + ', ' + cur_time_in_12hr;\
    var reminder_type 		= (rem_data["remtype"] in type_obj) ? type_obj[rem_data["remtype"]] : 'Task'\
    var rem_remind_time 	= rem_data['date'];\
    var date_raw 			= rem_remind_time.trim().split(' ')[0];\
    var time_raw 			= rem_remind_time.trim().split(' ')[1];\
    var date_obj 			= new Date(date_raw.split('-')[2], parseInt(date_raw.split('-')[1]) -1 , date_raw.split('-')[0], time_raw.split(':')[0], time_raw.split(':')[1]);\
    var rem_time_in_12hr 	= date_obj.toLocaleString('en-US', \{ hour: 'numeric', minute : 'numeric',  hour12: true \});\
    var rem_time_final 		= rem_time_in_12hr + ', ' + month_arr[parseInt(date_obj.getMonth())].substr(0,3) + ' ' + date_obj.getDate() ;\
    var rem_sub 			= reminder_type + ' Reminder set for ' +  rem_time_final;\
    var reminder_html		= '<div class="reminder-on-thread">\\\
                                    <div class="reminder-text-head">\\\
                                        <div class="rem-div-text-main">	\\\
                                            <i class="'+rem_type_icn[reminder_type]+'"></i>\\\
                                        </div>\\\
                                        <div class="rem-div-time">\\\
                                            <span tooltip-text="'+rem_data['remnote']+'" set-time="'+rem_set_time+'" tooltip-type="reminder" class="show-rem-text">'+rem_sub+'</span>\\\
                                            <i class="fa fa-angle-down tooltip-plus" style="right: 8px; top: 3px; position: absolute; color: gray;"></i>\\\
                                            <i class="fa fa-angle-up tooltip-minus" style="display: none; right: 8px; top: 3px; position: absolute; color: gray;"></i>\\\
                                        </div>\\\
                                    </div>\\\
                                    <span class="rem-thread-time">'+rem_set_time+'</span>\\\
                                </div>';\
    \
    $("#error_no_enq").html('');\
    $(reminder_html).insertBefore('#reply_text');\
    bindClickFunctionToReminders();\
\}\
    \
function bindClickFunctionToReminders()\{\
    $(".reminder-text-head").unbind('click');\
    $(".reminder-text-head").click(function()\{		\
        getGAEventTrackingJS('thread_notification_clicked');\
        if ($(".reminder-tooltip-div")[0])\{\
            removeReminderTooltip();\
        \} else \{\
            var tooltip_data 		= fetchTooltipData(this);\
            var tooltip_text 		= tooltip_data['rem_text'];\
            var tooltip_set_time 	= tooltip_data['set_time'];\
            var tooltip_type 		= tooltip_data['type'];\
            if(tooltip_type === 'note' && tooltip_text.length <= 40)\{\
                // Don't show the tooltip if the whole content of notes is visible on the DIV itself.\
            \}\
            else\{\
                createDynamicToolTipForReminders(this, tooltip_text, tooltip_set_time);\
            \}\
        \}\
    \});\
    // code to remove tooltip on scroll\
    $( ".chat-section" ).unbind('scroll');\
    $( ".chat-section" ).scroll(function() \{\
        removeReminderTooltip();\
    \});\
    $(".chat-section").scrollTop(90000)\
\}\
    \
function fetchTooltipData(elem)\{\
    var rem_main_div 	= $(elem).attr('class') == 'reminder-text-head' ? $(elem) : elem.parent("div.reminder-text-head");\
    var rem_text 		= rem_main_div.find('span.show-rem-text').attr('tooltip-text');\
    var rem_set_time 	= rem_main_div.find('span.show-rem-text').attr('set-time');\
    var type 			= rem_main_div.find('span.show-rem-text').attr('tooltip-type');	\
    rem_text 			= rem_text.trim() == '' ? "Follow up reminder." : rem_text;\
    return \{"rem_text": rem_text, "set_time": rem_set_time, "type": type\};\
\}\
    \
function removeReminderTooltip()\{\
    if ($(".reminder-tooltip-div")[0])\{\
        $("i.tooltip-plus").css('display', 'block');\
        $("i.tooltip-minus").css('display', 'none');\
        $(".reminder-tooltip-div").remove();\
        $(".reminder-text-head").css('border-radius', '20px');\
    \}\
\}\
    \
function createDynamicToolTipForReminders(elem, tooltip_text, tooltip_set_time)\{\
    var rem_main_div 	= $(elem).attr('class') == 'reminder-text-head' ? $(elem) : elem.parent("div.reminder-text-head");\
    var up_arrow 		= '<div><i style="font-size:20px;" id="reminder-up-arrow" class="fa fa-caret-up"></i></div>';\
    var down_arrow 		= '<div><i style="font-size:20px;" id="reminder-down-arrow" class="fa fa-caret-down"></i></div>';\
    var sep_above 		= '<div class="sep-above" style=" width: 100%; text-align: center;"><p style="height: 1px;background: #dedede;"></p></div>';\
    var sep_below 		= '<div class="sep-below" style=" width: 100%; text-align: center;"><p style="height: 1px;background: #dedede;"></p></div>';\
    // var text_alignment 	= tooltip_text.length < 34 ? 'center' : 'left';\
    var text_alignment 	= 'center';\
    var tooltip_msg 	= "<div style='padding: 5px 15px 5px 15px; text-align: "+text_alignment+"; line-height: 1.5;'><span font-size:13px;>"+tooltip_text+"</spna></div>";\
    // var tooltip_time 	= "<div style='font-size:10px; text-align:right; padding: 5px;'><span>"+tooltip_set_time+"<span></div>";\
    var tooltip_time 	= "";\
    var tooltip_content = "<div class='rem-tooltip-content'>" + tooltip_msg + tooltip_time + "</div>";\
    var tooltip_div 	= document.createElement('div');\
    var is_above 		= $(rem_main_div).offset().top - $(".chat-section").offset().top > $(".chat-section").height() / 2 ;\
    tooltip_div.setAttribute("class", "reminder-tooltip-div");\
    document.body.appendChild(tooltip_div);\
    $(rem_main_div).find("i.tooltip-minus").css('display', 'block');\
    $(rem_main_div).find("i.tooltip-plus").css('display', 'none');\
    // $(".reminder-tooltip-div").html(down_arrow + tooltip_content + up_arrow);\
    $(".reminder-tooltip-div").html(sep_above + tooltip_content + sep_below);\
    // $(".reminder-tooltip-div").html(tooltip_content);\
    $(".reminder-tooltip-div").css('left', $(rem_main_div).offset().left + 42 + 'px');\
    $(".reminder-tooltip-div").css('box-sizing','border-box');\
    $(".reminder-tooltip-div").css('font-size','13px');\
    if(is_above)\{								// Display tooltip above the reminder div\
        $("#reminder-down-arrow").css('display', 'none');\
        $(".sep-above").css('display', 'none');\
        $(".reminder-tooltip-div").css('top', $(rem_main_div).offset().top - $(".reminder-tooltip-div").outerHeight() + "px");\
        $(rem_main_div).css('border-radius', '20px 0px 20px 20px');\
        $(".rem-tooltip-content").css(\{'background': 'white', 'border-right': '1px solid #c7c2c2', 'border-left': '1px solid #c7c2c2', 'border-top': '1px solid #c7c2c2', 'border-radius': '10px 10px 0px 0px'\});\
    \}\
    else\{										// Display tooltip below the reminder div\
        $("#reminder-up-arrow").css('display', 'none');\
        $(".sep-below").css('display', 'none');\
        $(".reminder-tooltip-div").css('top', $(rem_main_div).offset().top + $(rem_main_div).outerHeight() - 1 +'px');\
        $(rem_main_div).css('border-radius', '20px 20px 0px 20px');\
        $(".rem-tooltip-content").css(\{'background': 'white', 'border-right': '1px solid #c7c2c2', 'border-left': '1px solid #c7c2c2', 'border-bottom': '1px solid #c7c2c2', 'border-radius': '0px 0px 10px 10px'\});\
    \}\
\}\
    \
function validateAndSaveReminder(ajax_url, data_obj, rem_date, rem_time,source)\{\
    $('#timeErr, #dateErr, #bothErr').css("display","none");\
    if(rem_date == '' && rem_time == 'Select Time')\{\
        $('#bothErr').css("display","block");\
        return false;\
    \}\
    if(rem_date == '')\{\
        $('#dateErr').css("display","block");\
        return false;\
    \}\
    if(rem_time == 'Select Time')\{\
        $('#timeErr').css("display","block");\
        return false;\
    \}\
    $('#set_rem_btn').attr('disabled', 'disabled');\
    $('#icnload').css("display", "block");\
    $.ajax(\{\
        url 		: ajax_url,\
        type 		: "POST",\
        dataType 	: "json",\
        data 		: data_obj,\
        success 	: function(jsonResponse) \{\
            if(source==2)\
                trackEvent('reminder_messages','add_reminder');\
            else if(source==1)\
                trackEvent('reminder_messages','update_done_reminder');\
            else\
                trackEvent('reminder_messages','edit_reminder');\
            $('#set_rem_btn').removeAttr('disabled');\
            $('#icnload').css("display","none");\
            if(jsonResponse.status == 'Success')\{\
                closeRemList();\
            \}else\{\
                console.log("Error in Reminder service.");\
            \}\
        \}\
    \});\
\}*/\
function updateLastSeenAJAX(contact_glid) \{\
	//XMPP code will be implemented again later\
	if(ACTIVE_GLID !== undefined && typeof ACTIVE_GLID['array'] !== "undefined" && ACTIVE_GLID['array'] !== undefined && ACTIVE_GLID['array'] !== null && ACTIVE_GLID['array'] !== '' && ACTIVE_GLID['array'].indexOf(contact_glid) > -1) \{\
		$(".last-seen-span").html('<i class="fa fa-circle" style="color:green;"></i> Online');\
		$('i.bg-msg-1.ico.Msg-time').css("visibility", "hidden");\
		$('i.bg-msg-1.ico.Msg-time').css("width", "0px");\
		$("#last_seen_span").css("font-size", "13px");\
		$("#last_seen_span").css("padding-top", "2px");\
	\} else \{\
		$.ajax(\{\
			url: '/phpajax/enquiry/messagecentre/getLastSeenUsingGLID',\
			data: \{\
				'gluser_id': contact_glid\
			\},\
			type: 'GET',\
			success: function(response) \{\
				response = response.trim();\
				if(response !== '') \{\
					var response_obj = JSON.parse(response);\
					if(response_obj === undefined || response_obj === null) \{\
						$(".last-seen-span").html("Active few days ago");\
						$('i.bg-msg-1.ico.Msg-time').css("visibility", "visible");\
						$('i.bg-msg-1.ico.Msg-time').css("width", "20px");\
					\} else \{\
\
						var date = '';\
						var time = '';\
						var lastseen = '';\
						if("Response" in response_obj && "Code" in response_obj["Response"]) \{\
							date = response_obj["Response"]["Data"]["latest_activity_data"][0]["date"];\
							time = response_obj["Response"]["Data"]["latest_activity_data"][0]["time"];\
							lastseen = response_obj["Response"]["Data"]["latest_activity_data"][0]["LastSeen"];\
							\
							time =timeConversion(time);\
							var zone=Intl.DateTimeFormat().resolvedOptions().timeZone;\
							if((zone!= "Asia/Calcutta") && (zone!= "Asia/Colombo"))\
							\{var d1 = date+time;\
							var zone=Intl.DateTimeFormat().resolvedOptions().timeZone;\
							var date =date.split('-');\
                            if(time.indexOf('AM')!=-1)\{\
								var tmz = 'AM';\
							\}\
							else\
							\{var tmz  = 'PM';\}\
							time = time.replace( /[a-zA-Z]/,'');\
							time = time.replace( /[a-zA-Z]/,'');\
							time = time.split(':');\
							console.log(d1);\
							console.log(zone);\
							d1= new Date(date[0],date[1]-1,date[2],time[0],time[1]);\
							// d1 = d1 +tmz;\
							d1 = new Date(d1);\
							var days = ['Sun','Mon','Tue','Wed','Thurs','Fri','Sat'];\
							console.log(days[d1.getDay()]);\
							console.log(d1.toLocaleString('en-IN',zone));\
							\
							d1=d1.toLocaleString('en-IN',zone,\{hour12:true\});\
							\
							 d1 = d1.toUpperCase();\
							 var dn = d1.split(',');\
							 var dn1 =dn[1];\
							 dn1 = dn1.replace( /[a-zA-Z]/,'');\
							dn1 = dn1.replace( /[a-zA-Z]/,'');\
							dn1 = dn1.split(':');\
							 dn = dn[0].split('/');\
							var d2 = new Date(dn[2],dn[1]-1,dn[0],dn1[0],dn1[1]);\
							d2.setDate(dn[0]);\
							d2.setMonth(dn[1]-1);\
							d2.setFullYear(dn[2]);\
							d2.setHours(dn1[0]);\
                            d2.setMinutes(dn1[1]);\
							var findday = days[d2.getDay()];\
							d1 = d1.toString();\
							d1 = d1.toLocaleUpperCase();\
\
							var date1 = d2;\
							var today = new Date();\
							var yesterday  = new Date();\
                            var lastweek =  new Date();\
							// subtract one day from current time                          \
						   yesterday.setDate(today.getDate() - 1);\
						   lastweek.setDate(today.getDate() - 7);\
                            var date = new Date (today.getFullYear(),today.getMonth()+1,today.getDate());\
							date.setHours(0);date.setMinutes(0);date.setSeconds(0, 0);\
							var timeDiff = date1.getTime() - date.getTime();\
							\
							if(dn[2]==today.getFullYear() && dn[1]-1==today.getMonth() && dn[0]==today.getDate())\{\
								findday = 'Today';\
							\}\
							\
							if(dn[2]==yesterday.getFullYear() && dn[1]-1 ==yesterday.getMonth() && dn[0]==yesterday.getDate())\{\
								findday = 'Yesterday';\
							\}\
\
			\
							\
\
\
\
							 d1 =d1.split(',');\
							 const timeZoneAbbreviated = () => \{\
								const \{ 1: tz \} = new Date().toString().match(/\\((.+)\\)/);\
							  \
							  \
								if (tz.includes(" ")) \{\
								  return tz\
									.split(" ")\
									.map(([first]) => first)\
									.join("");\
								\} else \{\
								  return tz;\
								\}\
							  \};\
							  \
							  var finaldate = d1[1];\
							  finaldate =finaldate.split(":");\
							  var temp = finaldate[2].split(" ");\
							  var nd1 = finaldate[0]+':'+finaldate[1]+" "+temp[1];\
							  \
\
var newlastseen = 'Last Seen '+ findday + ' at'+nd1+' '+ timeZoneAbbreviated();\
							\
							\
							if(date1<= Date.now()-((1000 * 60 * 60 * 24 * 7)))\{\
                               var month= ['Jan','Feb','Mar','Apr','June','Jul','Aug','Sept','Oct','Nov','Dec']\
							newlastseen  ='Last Seen '+ dn[0]+" "+ month[dn[1]-2]+","+dn[2]+" "+ timeZoneAbbreviated();\
							\}\
							\
							$(".last-seen-span").html(newlastseen);\
\
						\}\
\
                            else\{\
								if(zone == 'Asia/Colombo')\
								lastseen = response_obj["Response"]["Data"]["latest_activity_data"][0]["LastSeen"] +' SLST';\
								else\
							 \{lastseen = response_obj["Response"]["Data"]["latest_activity_data"][0]["LastSeen"];\}\
							$(".last-seen-span").html(lastseen);\}\
							$('.bg-msg-1.ico.Msg-time').css("visibility", "visible");\
							$('i.bg-msg-1.ico.Msg-time').css("width", "20px");\
							//XMPP code will be implemented again later\
							if(ACTIVE_GLID !== undefined && typeof ACTIVE_GLID['array'] !== "undefined" && ACTIVE_GLID['array'] !== undefined && ACTIVE_GLID['array'] !== null && ACTIVE_GLID['array'] !== '' && ACTIVE_GLID['array'].indexOf(contact_glid) > -1) \{\
								$(".last-seen-span").html('<i class="fa fa-circle" style="color:green;"></i> Online');\
								$('i.bg-msg-1.ico.Msg-time').css("visibility", "hidden");\
								$('i.bg-msg-1.ico.Msg-time').css("width", "0px");\
								$("#last_seen_span").css("font-size", "13px");\
								$("#last_seen_span").css("padding-top", "2px");\
							\}\
						\}\
						//		updateLastSeen(date, time, contact_glid);\
					\}\
				\}\
			\},\
			error: function() \{\
				console.log("ERROR While fetching Last seen date from server !!");\
				$(".last-seen-span").html("Active few days ago");\
				$('i.bg-msg-1.ico.Msg-time').css("visibility", "visible");\
				$('i.bg-msg-1.ico.Msg-time').css("width", "20px");\
			\}\
		\});\
	\}\
\}\
// This function would return the last seen date.\
function updateLastSeen(last_seen_date_str, last_seen_time_str, contact_glid) \{\
	var last_msg_date_obj = getLastLastReplyTime('contact');\
	var todays_date = new Date();\
	var offset = '+5.5';\
	var utc = todays_date.getTime() + (todays_date.getTimezoneOffset() * 60000);\
	todays_date = new Date(utc + (3600000 * offset));\
	var diff_using_last_msg = (last_msg_date_obj && last_msg_date_obj !== null) ? todays_date.getTime() - last_msg_date_obj.getTime() : null;\
	if(last_seen_date_str !== undefined && last_seen_date_str !== null && last_seen_date_str.trim() !== "") \{\
		var year_part = parseInt(last_seen_date_str.split('-')[0]);\
		var month_part = parseInt(last_seen_date_str.split('-')[1]);\
		var date_part = parseInt(last_seen_date_str.split('-')[2]);\
		var hour_part = parseInt(last_seen_time_str.split(':')[0]);\
		var min_part = parseInt(last_seen_time_str.split(':')[1]);\
		var time_slot = last_seen_time_str.toLowerCase().indexOf('am') !== -1 ? "AM" : "PM";\
		var hour_part_to_24hr = 0;\
		if(time_slot === "PM") \{\
			if(hour_part == 12) \{\
				hour_part_to_24hr = 12;\
			\} else if(hour_part < 12) \{\
				hour_part_to_24hr = hour_part + 12;\
			\}\
		\} else \{\
			if(hour_part == 12) \{\
				hour_part_to_24hr = 0;\
			\} else if(hour_part < 12) \{\
				hour_part_to_24hr = hour_part;\
			\}\
		\}\
		var last_seen_date_obj = new Date(year_part, month_part - 1, date_part, hour_part_to_24hr, min_part);\
		var diff_using_srvc = todays_date.getTime() - last_seen_date_obj.getTime();\
		var diff = diff_using_srvc;\
		if(last_msg_date_obj && last_msg_date_obj !== null && diff_using_last_msg < diff_using_srvc) \{\
			diff = diff_using_last_msg;\
		\}\
		$(".last-seen-span").html(timeConversion(diff));\
	\} else \{\
		if(last_msg_date_obj && last_msg_date_obj !== null) \{\
			$(".last-seen-span").html(timeConversion(diff_using_last_msg));\
		\} else \{\
			$(".last-seen-span").html("Active few days ago");\
		\}\
	\}\
	$('.bg-msg-1.ico.Msg-time').css("visibility", "visible");\
	$('i.bg-msg-1.ico.Msg-time').css("width", "20px");\
	//XMPP code will be implemented again later\
	if(ACTIVE_GLID !== undefined && typeof ACTIVE_GLID['array'] !== "undefined" && ACTIVE_GLID['array'] !== undefined && ACTIVE_GLID['array'] !== null && ACTIVE_GLID['array'] !== '' && ACTIVE_GLID['array'].indexOf(contact_glid) > -1) \{\
		$(".last-seen-span").html('<i class="fa fa-circle" style="color:green;"></i> Online');\
		$('i.bg-msg-1.ico.Msg-time').css("visibility", "hidden");\
		$('i.bg-msg-1.ico.Msg-time').css("width", "0px");\
		$("#last_seen_span").css("font-size", "13px");\
		$("#last_seen_span").css("padding-top", "2px");\
	\}\
\}\
\
function timeConversion(millisec) \{\
	var seconds = Math.round(millisec / 1000);\
	var minutes = Math.round(millisec / (1000 * 60));\
	var hours = Math.round(millisec / (1000 * 60 * 60));\
	var days = Math.round(millisec / (1000 * 60 * 60 * 24));\
	var months = Math.round(millisec / (1000 * 60 * 60 * 24 * 30));\
	if(seconds < 60) \{\
		var post_fix = seconds > 1 ? "Secs" : "Sec";\
		return "Active " + seconds + " " + post_fix + " ago";\
	\} else if(minutes < 60) \{\
		var post_fix = minutes > 1 ? "Mins" : "Min";\
		return "Active " + minutes + " " + post_fix + " ago";\
	\} else if(hours < 24) \{\
		var post_fix = hours > 1 ? "Hours" : "Hour";\
		return "Active " + hours + " " + post_fix + " ago";\
	\} else if(days < 30) \{\
		var post_fix = days > 1 ? "Days" : "Day";\
		return "Active " + days + " " + post_fix + " ago";\
	\} else \{\
		var txt = months < 2 ? "Active " + months + " Month ago" : "Active few Months ago";\
		return txt;\
	\}\
\}\
\
function toggleContactPersonalDetails() \{\
	getGAEventTrackingJS('view-detail_clicked');\
	if($("#Hdr-details").css('display') == 'none') \{\
		$("#Hdr-details").show(100);\
		$(".nav-toggle").html('<i class="fa fa-caret-up" aria-hidden="true"></i>');\
	\} else \{\
		$("#Hdr-details").hide(100);\
		$(".nav-toggle").html('<i class="fa fa-sort-desc" aria-hidden="true"></i>');\
	\}\
\}\
\
function getMessageCounter(contactglid) \{\
	if(!mr) \{\
		unreadcount(glusr, false);\
		mr = 1;\
	\}\
	var unread_count = 0,\
		id;\
	if(contactglid != '') id = $("span#" + contactglid);\
	if(id != undefined) \{\
		unread_count = parseInt(id.html());\
		if(unread_count > 0) id.remove();\
		// if(typeof sendAckReceipt === "function")\{ sendAckReceipt(contactglid); \}\
		if(typeof sendAckReceipt === "function") \{\
			let noOfReplies = document.getElementsByClassName('reply_msg_id').length;\
			if(noOfReplies) \{\
				let msg_reply_id = document.getElementsByClassName('reply_msg_id')[noOfReplies - 1].value;\
				sendAckReceipt(contactglid, msg_reply_id);\
			\} else \{\
				sendAckReceipt(contactglid);\
			\}\
		\}\
	\}\
	if(unread_count > 0) \{\
		var localvalue = localStorage.getItem("MessageRead");\
		if(localvalue) \{\
			var Messages = JSON.parse(localvalue);\
			var messagecount = Messages.count;\
			if(Messages.glId == glusr) \{\
				messagecount = messagecount - unread_count;\
				if(messagecount >= 0) \{\
					var displaycount = '';\
					if(messagecount > 99) \{\
						displaycount = "99+";\
					\} else \{\
						displaycount = messagecount;\
					\}\
					if(messagecount > 0) \{\
						$("#messageCount").html(displaycount);\
						$('#messageCount').css('display', 'inline-block');\
						document.title = '(' + displaycount + ') ' + $("#header_title").val();\
					\} else \{\
						$("#messageCount").html('');\
						$('#messageCount').css('display', 'none');\
						document.title = $("#header_title").val();\
					\}\
					localStorage.setItem('MessageRead', '\{"count":' + messagecount + ', "glId" : "' + glusr + '" \}');\
					update_msg_count(1, unread_count);\
				\}\
			\}\
		\}\
	\}\
\}\
\
function handleGrammarlyIssueHack() \{\
	var before_text = $("#note").val();\
	$("#note").val('');\
	$("#note").focus();\
	setTimeout(function() \{\
		$("#note").val(before_text);\
	\}, 1000);\
\}\
\
function setNote(query_id, enq_type, note, glid, contact_glid) \{\
	disabled_send_reply = true;\
	$.ajax(\{\
		url: '/phpajax/enquiry/messagecentre/AddNote',\
		data: \{\
			"qid": query_id,\
			"remnote": note,\
			"enqtype": enq_type,\
			"glid": glid,\
			"note_contact_glid": contact_glid\
		\},\
		type: "GET",\
		dataType: "json",\
		success: function(jsonResponse) \{\
			if(jsonResponse.status == 'Success') \{\
				disabled_send_reply = false;\
			\} else \{\
				disabled_send_reply = false;\
			\}\
		\}\
	\});\
\}\
\
function openMainAttachmentDiv() \{\
	closeAttachmentDiv();\
	var c_company = $('#recv_org').val() ? $('#recv_org').val() : 'Buyer';\
	//  var name 		= $('#left-name span')[0] ? $($('#left-name span')[0]).text().replace('-', '').trim() : "Buyer" ;\
	var header = "<div style='font-size: 19px; font-weight: 500;padding:10px;'>" + "Send Attachments to " + c_company + "<img onclick='closeAttachmentDiv();' style='float:right; cursor:pointer;' src='" + CROSS_ICN + "'>" + "</div>";\
	var img_0 = "<div id='attch_img_div0' style='display:none;'><i id='img_spinner_0' onclick='showPreviewOfAttachment(0)' class='fa fa-spinner fa-spin'></i><div onclick='showPreviewOfAttachment(0)' style='height:100%; background: #e5e5e5;'><span id='atch-img-span'></span><img id='attach-img0'/></div><div id='img_cross_0'><i id='atch-img-spin' onclick='removeMessageAttachment(0)' class='fa fa-times'></i></div></div>";\
	var img_1 = "<div id='attch_img_div1' style='display:none;'><i id='img_spinner_1' onclick='showPreviewOfAttachment(1)' class='fa fa-spinner fa-spin'></i><div onclick='showPreviewOfAttachment(1)' style='height:100%; background: #e5e5e5;'><span id='atch-img-span'></span><img id='attach-img1'/></div><div id='img_cross_1'><i id='atch-img-spin' onclick='removeMessageAttachment(1)' class='fa fa-times'></i></div></div>";\
	var img_2 = "<div id='attch_img_div2' style='display:none;'><i id='img_spinner_2' onclick='showPreviewOfAttachment(2)' class='fa fa-spinner fa-spin'></i><div onclick='showPreviewOfAttachment(2)' style='height:100%; background: #e5e5e5;'><span id='atch-img-span'></span><img id='attach-img2'/></div><div id='img_cross_2'><i id='atch-img-spin' onclick='removeMessageAttachment(2)' class='fa fa-times'></i></div></div>";\
	var img_3 = "<div id='attch_img_div3' style='display:none;'><i id='img_spinner_3' onclick='showPreviewOfAttachment(3)' class='fa fa-spinner fa-spin'></i><div onclick='showPreviewOfAttachment(3)' style='height:100%; background: #e5e5e5;'><span id='atch-img-span'></span><img id='attach-img3'/></div><div id='img_cross_3'><i id='atch-img-spin' onclick='removeMessageAttachment(3)' class='fa fa-times'></i></div></div>";\
	var file_slct = "<input type='file' id='attach_input' style='visibility: hidden; width: 0px; height: 0px;' />" + "<div id='attach-img_pick' onclick='$(\\"#attach_input\\").click();' style='vertical-align: middle;'>" + "<p><i class='fa fa-plus' style='font-size: 20px;'></i><br><br>ADD FILES (Max 4)</p>" + "</div>";\
	var footer = img_3 + img_2 + img_1 + img_0 + file_slct;\
	var body = "<div class='attach-preview-div'>" + ATTACH_IFRAME + "</div>" + "<div id='attch-txtarea-div' title='Type your Message (
\f5 \uc0\u2309 \u2346 \u2344 \u2366 
\f0  
\f5 \uc0\u2360 \u2306 \u2342 \u2375 \u2358 
\f0  
\f5 \uc0\u2354 \u2367 \u2326 \u2375 \u2306 
\f0 ...)'> " + "<textarea id='attch-message-txt' placeholder='Type your Message (
\f5 \uc0\u2309 \u2346 \u2344 \u2366 
\f0  
\f5 \uc0\u2360 \u2306 \u2342 \u2375 \u2358 
\f0  
\f5 \uc0\u2354 \u2367 \u2326 \u2375 \u2306 
\f0 ...)' maxlength='3500' style=''></textarea> " + '<div id="msg-attch-send" title="Send Attachments" onclick="sendMessageAttachments();trackEvent(\\'messagecentre\\',\\'reply_attachment_sent\\');">Send' + '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 24" width="28" height="24" style="padding-top:11px;margin-left: -4px;">' + '<path fill="#FFF" d="M5.101 21.757L27.8 12.028 5.101 2.3l.011 7.912 13.623 1.816-13.623 1.817-.011 7.912z"></path>' + '</svg>' + '</div>' + "</div>"\
		/*var send_icn 	= 	'<div id="msg-attch-send" title="Send Attachments" onclick="sendMessageAttachments()">Send'+\
		                        '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 24" width="28" height="24" style="float: left;margin: 17px;padding-top: 9px;">'+\
		                            '<path fill="#FFF" d="M5.101 21.757L27.8 12.028 5.101 2.3l.011 7.912 13.623 1.816-13.623 1.817-.011 7.912z"></path>'+\
		                        '</svg>'+\
		                    '</div>'*/\
	var skeleton = "<div class='blk-upld-container'>" + "<div auth='RSRC' class='attachment-div'>" + "<div class='attachment-header'>" + header + "</div>" + "<div class='attachment-body'>" + body + "</div>" + "<div class='attachment-footer'>" + footer + "</div>" +\
		/*send_icn+*/\
		"</div>" + "</div>";\
	$('body').append(skeleton);\
	$(".attachment-div").slideToggle("fast");\
	file_pick_element = document.getElementById('attach_input');\
	if(file_pick_element && file_pick_element.addEventListener) \{\
		file_pick_element.addEventListener('change', attachFilePicked, false);\
	\}\
	$('#attach_right_navigate, #attach_left_navigate').hide();\
	$('#attch-message-txt').val(document.getElementById("massage-text").value); // Copy the text from main text area to text area of attachment.\
\}\
\
function pickFirstFileForAttachment() \{\
	getGAEventTrackingJS('messages_attachment_clicked');\
	var attachment = document.getElementById("rsrc_first_attch");\
	var file = attachment.files[0];\
	if(file !== undefined && file !== null) \{\
		if(validateFileForAttachment(file)) \{\
			openMainAttachmentDiv();\
			ATTACH_FILE_ARR[ATTACH_FILE_COUNTER] = file;\
			createAttachmentThumbnail(ATTACH_FILE_COUNTER, file, 2);\
			ATTACH_FILE_COUNTER++;\
			toggleFilePickFunctionality();\
		\}\
		$('#rsrc_first_attch').val(''); // Remove the content from DOM FILE OBJECT so that it could be picked again.\
	\}\
\}\
\
function toggleFilePickFunctionality() \{\
	if(ATTACH_FILE_COUNTER == 4) \{\
		document.getElementById('attach-img_pick').style.pointerEvents = 'none';\
		$('#attach-img_pick').css('background', '#cccccc');\
	\} else \{\
		document.getElementById('attach-img_pick').style.pointerEvents = 'auto';\
		$('#attach-img_pick').css('background', 'white');\
	\}\
\}\
\
function createAttachmentThumbnail(idx, file_obj, req_type) \{\
	showPreviewOfAttachment(idx, file_obj);\
	attchFileUpload(idx, file_obj, req_type);\
\}\
\
function closeAttachmentDiv() \{\
	$(".attachment-div").slideToggle("fast", function() \{\
		$(".blk-upld-container").remove();\
		ATTACH_FILE_NAME_ARR = [];\
		ATTACH_FILE_ARR = [];\
		ATTACH_FILE_COUNTER = 0;\
	\});\
\}\
\
function attachFilePicked(oEvent) \{\
	if(ATTACH_FILE_ARR && ATTACH_FILE_ARR.length === 4) \{\
		alert('\\nYou cannot attach more than 4 Attachments.\\n\\n:(\\n');\
		return false;\
	\}\
	var oFile = oEvent.target.files[0]; // Get The File From The Input\
	var reader = new FileReader(); // Create A File Reader HTML5\
	$(oEvent.target).val('') // Remove the content from DOM FILE OBJECT so that it could be picked again.\
	reader.onload = (function(attch_file_obj) \{\
		return function(e) \{\
			if(validateFileForAttachment(attch_file_obj)) \{\
				if(oFile.type.match('image')) \{\
					if((attch_file_obj.type.match('gif') || attch_file_obj.type.match('svg')) && attch_file_obj.size < 1000000) \{\
						ATTACH_FILE_ARR[ATTACH_FILE_COUNTER] = attch_file_obj;\
						createAttachmentThumbnail(ATTACH_FILE_COUNTER, attch_file_obj, 1);\
						ATTACH_FILE_COUNTER++;\
						toggleFilePickFunctionality();\
						$('#rsrc_first_attch').val(''); // Remove the content from DOM FILE OBJECT so that it could be picked again.\
					\} else \{\
						window.URL = window.URL || window.webkitURL;\
						var blobURL = window.URL.createObjectURL(attch_file_obj);\
						var img = new Image();\
						img.src = blobURL;\
						img.onload = function() \{\
							var size = attch_file_obj.size;\
							var fileType = attch_file_obj.type;\
							var compression = 1.0;\
							var maxDimension = 1000;\
							var width = this.width;\
							var height = this.height;\
							if(width > maxDimension || height > maxDimension) \{\
								if(width > height) \{\
									var ratio = width / maxDimension;\
									var newWidth = maxDimension;\
									var newheight = height / ratio;\
								\} else \{\
									var ratio = height / maxDimension;\
									var newWidth = width / ratio;\
									var newheight = maxDimension;\
								\}\
							\} else \{\
								var newWidth = width;\
								var newheight = height;\
							\}\
							if(size > 10000000) \{\
								alert("Cannot upload file. Please upload a file less than 10MB");\
								return false;\
							\}\
							if(size > 1000000) \{\
								compression = (size - 1000000) / size;\
								compression = 1 - compression;\
							\}\
							var canvas = document.createElement("canvas");\
							var context = canvas.getContext("2d");\
							canvas.width = newWidth;\
							canvas.height = newheight;\
							context.drawImage(img, 0, 0, img.width, img.height, 0, 0, canvas.width, canvas.height);\
							var data_url = canvas.toDataURL(fileType, compression);\
							var fileblob = base64ToBlob(data_url.replace(/^data:image\\/(png|jpeg|jpg);base64,/, ''), attch_file_obj.type);\
							$('#imageBLOB').val(data_url);\
							if(fileblob.size < 1000000) \{\
								fileblob.name = attch_file_obj.name;\
								ATTACH_FILE_ARR[ATTACH_FILE_COUNTER] = fileblob;\
								createAttachmentThumbnail(ATTACH_FILE_COUNTER, fileblob, 1);\
							\} else \{\
								alert("Cannot upload file. Please upload a file less than 10MB");\
								return false;\
							\}\
							data_url = '';\
							$('#canvas_ele').remove();\
							ATTACH_FILE_COUNTER++;\
							toggleFilePickFunctionality();\
							$('#rsrc_first_attch').val(''); // Remove the content from DOM FILE OBJECT so that it could be picked again.\
						\}\
					\}\
				\} else \{\
					ATTACH_FILE_ARR[ATTACH_FILE_COUNTER] = attch_file_obj;\
					createAttachmentThumbnail(ATTACH_FILE_COUNTER, attch_file_obj, 1);\
					ATTACH_FILE_COUNTER++;\
					toggleFilePickFunctionality();\
					$('#rsrc_first_attch').val(''); // Remove the content from DOM FILE OBJECT so that it could be picked again.\
				\}\
			\}\
		\};\
	\})(oFile);\
	if(oFile) \{\
		reader.readAsDataURL(oFile); // Tell JS To Start Reading The File.\
	\}\
\}\
\
function removeMessageAttachment(id_to_remove) \{\
	ATTACH_FILE_COUNTER--;\
	ATTACH_FILE_ARR.splice(id_to_remove, 1);\
	ATTACH_FILE_NAME_ARR.splice(id_to_remove, 1);\
	toggleFilePickFunctionality();\
	$('#attach-img0, #attach-img1, #attach-img2, #attach-img3').attr('src', '');\
	$('#attach-img0, #attach-img1, #attach-img2, #attach-img3').attr('title', '');\
	$('#img_cross_0, #img_cross_1, #img_cross_2, #img_cross_3').hide();\
	$('#attach_preview').attr('src', '');\
	for(var idx = 0; idx < ATTACH_FILE_ARR.length; idx++) \{\
		showPreviewOfAttachment(idx, ATTACH_FILE_ARR[idx]);\
	\}\
	$('#attch_img_div' + ATTACH_FILE_ARR.length).css('display', 'none');\
\}\
\
function showPreviewOfAttachment(idx, file_obj) \{\
	$('#attch_img_div' + idx).css('display', 'inline-block');\
	if(file_obj === undefined || file_obj === null) \{\
		if(ATTACH_FILE_ARR && ATTACH_FILE_ARR.length > 0 && idx < ATTACH_FILE_ARR.length) \{\
			file_obj = ATTACH_FILE_ARR[idx];\
		\} else \{\
			return false;\
		\}\
	\}\
	if(file_obj['name']) \{\
		var file_extension = file_obj['name'].substr(file_obj['name'].lastIndexOf('.') + 1);\
		var file_type = file_extension.toLowerCase();\
		var thumb_css = \{\
			'max-width': '100%',\
			'max-height': '100%'\
		\};\
		if(file_type == 'png' || file_type == 'gif' || file_type == 'jpg' || file_type == 'jpeg' || file_type == 'svg') \{\
			handleImageFile(idx, file_obj);\
		\} else if(file_type == 'pdf') \{\
			$('#attach-img' + idx).attr('src', PDF_ICN);\
			$('#attach_preview').attr('src', window.URL.createObjectURL(file_obj));\
		\} else \{\
			handleNonPreviewFile(idx, file_obj, file_type);\
		\}\
		$('#attach-img' + idx).css(thumb_css);\
		$('#attach-img' + idx).attr('title', file_obj['name']);\
		$('#img_cross_' + idx).show();\
		highlightSelectedAttachImage(idx);\
		createLeftRightIcon(idx);\
		$('#attach_preview').attr('current_idx', idx);\
	\}\
\}\
// Show's Preview of Image and creates a thumbnail.\
function handleImageFile(idx, file_obj) \{\
	$('#attach-img' + idx).attr('src', window.URL.createObjectURL(file_obj));\
	$('.attach-preview-div').html(ATTACH_IFRAME);\
	setTimeout(function() \{\
		var iframe = document.getElementById('attach_preview');\
		var iframedoc = iframe.contentDocument || iframe.contentWindow.document;\
		var html_txt = '	<div style="width:100%; height:100%; text-align: center;">' + '<span style="display: inline-block;height: 100%;vertical-align: middle;"></span>' + '<img style="max-height: 100%;max-width: 100%;vertical-align: middle;" src="' + window.URL.createObjectURL(file_obj) + '">' + '</div>';\
		iframedoc.body.innerHTML = html_txt;\
	\}, 250)\
\}\
var glid_cookie;\
//To verify its the first time for any user on any particular day !\
function hasOneDayPassed() \{\
	var date = new Date().toLocaleDateString();\
	var cookie = readCookie('ImeshVisitor');\
	var glusr = getparamVal(cookie, "glid");\
	var date_glid = date + " " + glusr;\
	if(localStorage.date_glusid == date_glid) return false;\
	localStorage.date_glusid = date_glid;\
	return true;\
\}\
\
function check_OneDayPassed_for_presence() \{\
	var date = new Date().toLocaleDateString();\
	var cookie = readCookie('ImeshVisitor');\
	var glusr = getparamVal(cookie, "glid");\
	var date_glid = date + " " + glusr;\
	if(localStorage.date_glusid_presence == date_glid) return false;\
	localStorage.date_glusid_presence = date_glid;\
	return true;\
\}\
\
function runOncePerDay() \{\
	if(!hasOneDayPassed()) return false;\
	\
\}\
// Help for message centre\
function openMsgHelp() \{\
	// getGAEventTrackingJS('messagecentre','display_impression','messages_help');\
	//document.write("<img border='0' src='https://lh3.googleusercontent.com/-nzBb2qvWDwg/W3-XcW4Q2WI/AAAAAAAAALM/jsOYVJcsem4IHe8F7C_sq2iMO7EkoNdJgCL0BGAYYCw/h500/help.png' />");\
	$.ajax(\{\
		url: '/phpajax/enquiry/enquiryajax/getMsgHelp',\
		type: "GET",\
		dataType: "html",\
		success: function(html) \{\
			$('.overlay_s').css('display', 'block');\
			$('#helpmsg').append(html);\
		\}\
	\});\
\}\
// Show's File name and File type as Preview and creates a thumbnail.\
function handleNonPreviewFile(idx, file_obj, file_type) \{\
	var attach_class = "";\
	var file_name = file_obj['name'];\
	if(file_type == 'doc' || file_type == 'docx') \{\
		attach_class = "fa fa-file-word-o";\
		$('#attach-img' + idx).attr('src', DOC_ICN);\
	\} else if(file_type == 'ppt' || file_type == 'pptx') \{\
		attach_class = "fa fa-file-powerpoint-o";\
		$('#attach-img' + idx).attr('src', PPT_ICN);\
	\} else if(file_type == 'xls' || file_type == 'xlsx' || file_type == 'csv' || file_type == 'odf') \{\
		attach_class = "fa fa-file-excel-o";\
		$('#attach-img' + idx).attr('src', EXCEL_ICN);\
	\} else \{\
		attach_class = "fa fa-file-text-o";\
		$('#attach-img' + idx).attr('src', TXT_ICN);\
	\}\
	$('.attach-preview-div').html(ATTACH_IFRAME);\
	setTimeout(function() \{\
		var iframe = document.getElementById('attach_preview');\
		var iframedoc = iframe.contentDocument || iframe.contentWindow.document;\
		var html_txt = "<link href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css' rel='stylesheet'>" + "<div style='width: 100%; height: 100%; background: #fffafa; border-radius: 10px;'>" + "<div style='position: absolute; width: 150px; height: 150px; background: #4ea798; color: white; text-align: center; left: calc(50% - 75px); top: calc(50% - 75px); border-radius: 50%;'>" + "<i class='" + attach_class + "' style='font-size: 70px; margin-top: 40px;'></i>" + "</div>" + "<div style='text-align: center; position: absolute; height: 40px; width: 500px; left: calc(50% - 250px); top: calc(50% + 75px);color: #4ea798;font-size: 20px;'>" + file_name + "</div>" + "</div>";\
		iframedoc.body.innerHTML = html_txt;\
	\}, 250)\
\}\
// Highlights the thumbnail of the current preview.\
function highlightSelectedAttachImage(idx) \{\
	$('#attch_img_div0, #attch_img_div1, #attch_img_div2, #attch_img_div3').css('border', '1px solid #02887D');\
	$('#attch_img_div0, #attch_img_div1, #attch_img_div2, #attch_img_div3').css('margin', '20px 10px');\
	$('#attch_img_div0, #attch_img_div1, #attch_img_div2, #attch_img_div3').css('width', '100px');\
	$('#attch_img_div0, #attch_img_div1, #attch_img_div2, #attch_img_div3').css('height', '100px');\
	$('#attch_img_div' + idx).css('margin', '10px');\
	$('#attch_img_div' + idx).css('width', '120px');\
	$('#attch_img_div' + idx).css('height', '120px');\
	$('#attch_img_div' + idx).css('border', '4px solid #4ea798');\
\}\
\
function createLeftRightIcon(idx) \{\
	$('#attach_right_navigate, #attach_left_navigate').hide();\
	if(idx == 0 && ATTACH_FILE_ARR.length == 1) \{\
		// Don't show any ICON\
	\} else if(idx == 0 && ATTACH_FILE_ARR.length > 1) \{\
		// Only display Left ICON\
		$('#attach_left_navigate').css('display', 'inline-block');\
	\} else if(idx > 0 && ATTACH_FILE_ARR.length > 1 && idx != ATTACH_FILE_ARR.length - 1) \{\
		// Show both ICONS\
		$('#attach_right_navigate, #attach_left_navigate').css('display', 'inline-block');\
	\} else if(idx == 3 || idx == ATTACH_FILE_ARR.length - 1) \{\
		// Only print Right ICON\
		$('#attach_right_navigate').css('display', 'inline-block');\
	\}\
\}\
\
function navigatePreview(where) \{\
	var cur_index = parseInt($('#attach_preview').attr('current_idx'));\
	if(where === 'prev') \{\
		showPreviewOfAttachment(cur_index - 1);\
	\} else if(where === 'next') \{\
		showPreviewOfAttachment(cur_index + 1);\
	\}\
\}\
// Returns true only if file is valid for uploading else prompts a alert.\
function validateFileForAttachment(oFile) \{\
	var fileName = oFile.name;\
	var fileExtension = fileName.substring(fileName.lastIndexOf('.') + 1);\
	var checkfileExtension = fileExtension.toLowerCase();\
	var fileSize = oFile.size;\
	if(fileName.match(/,/g)) \{\
		alert('\\nFile name with "," is not accepted\\n');\
		return false;\
	\} else if(fileSize >= 10485760) \{\
		alert("\\nPlease upload file having size less than 10 MB\\n");\
		return false;\
	\} else if(fileSize == 0) \{\
		alert("\\nPlease upload file having size greater than 0 B\\n");\
		return false;\
	\} else if(checkfileExtension != "gif" && checkfileExtension != "jpg" && checkfileExtension != "jpeg" && checkfileExtension != "png" && checkfileExtension != "txt" && checkfileExtension != "pdf" && checkfileExtension != "rtf" && checkfileExtension != "ppt" && checkfileExtension != "pptx" && checkfileExtension != "doc" && checkfileExtension != "docx" && checkfileExtension != "xls" && checkfileExtension != "html" && checkfileExtension != "xlsx" && checkfileExtension != "svg" && checkfileExtension != "odf" && checkfileExtension != "csv" && checkfileExtension != "ods") \{\
		alert("\\nExtension : '" + checkfileExtension + "' is not allowed.\\nPlease upload a file with valid format.\\n\\nValid Formats : Doc, PDF, Excel, Image & PPT\\n");\
		return false;\
	\} else \{\
		return true;\
	\}\
\}\
\
function sendMessageAttachments() \{\
	if(disabled_send_reply) return;\
	if(ATTACH_FILE_NAME_ARR === undefined || ATTACH_FILE_NAME_ARR === null || ATTACH_FILE_NAME_ARR.length === 0) \{\
		alert("\\nPlease attach a file.\\n");\
		return false;\
	\}\
	$('#msg-attch-send').attr('onclick', '');\
	var glid = $('#trackid').val();\
	var msg_query_type = $('#msg_query_type').val();\
	var msg_query_id = $('#msg_query_id').val();\
	var msg_prod_name = $('#msg_prod_name').val();\
	var msg_ref_id = $('#msg_ref_id').val();\
	var query_id = msg_query_id ? msg_query_id : 1;\
	var query_type = msg_query_type ? msg_query_type : 'C';\
	var recv_id = trim(document.getElementById('contactglid').value);\
	var reply_msg = $('#attch-message-txt').val().trim() == '' ? "Please find the Attachment" : $('#attch-message-txt').val();\
	reply_msg = reply_msg.replace(/<(?:.|\\n)*?>/gm, ' '); //code to replace html tags from the send reply\
	var attch = (ATTACH_FILE_NAME_ARR && ATTACH_FILE_NAME_ARR.length > 0) ? ATTACH_FILE_NAME_ARR.join(',') : '';\
	var contactYear = "";\
	if(document.getElementsByClassName('user-name1 active')[0].getElementsByClassName('lst_contact_year')[0] != undefined) \{\
		var contactYear = document.getElementsByClassName('user-name1 active')[0].getElementsByClassName('lst_contact_year')[0].innerText;\
	\}\
	var location_obj = getLocationDetailOfUser();\
	var data_param = \{\
		"subject": 'Message Centre',\
		"msg": reply_msg,\
		"qid": query_id,\
		"recv_id": recv_id,\
		"IIL_RFQ_SOURCE_ID": 28,\
		"qtype": query_type,\
		"attachments": attch,\
		"glid": glid,\
		"ETO_OFR_ID": msg_ref_id,\
		"ETO_OFR_TITLE": msg_prod_name,\
		"contact_year": contactYear,\
		"dir_query_reply_template_flag": 85,\
		"sender_ip":location_obj.IPADDRESS\
	\};\
	displayreply(reply_msg, attch);\
	disabled_send_reply = true;\
	closeAttachmentDiv();\
	if(recv_id == '' || recv_id == undefined || recv_id == null) \{\
		$.ajax(\{\
			url: '/enquiry/messagecentre/blankrecvLog',\
			data: \{\
				"data_param": JSON.stringify(data_param),\
				"glid": byId('trackid').value,\
				"button": "send_attachment",\
				"referrer": document.referrer,\
				"cur_page_url": window.location.href\
			\},\
			dataType: "Json",\
			type: "POST",\
		\});\
	\}\
	$.ajax(\{\
		url: "/enquiry/messagecentre/SaveReply",\
		data: data_param,\
		dataType: "json",\
		type: "POST",\
		success: function(jsonResponse) \{\
			disabled_send_reply = false;\
			//XMPP code will be implemented again later\
			var unq_msg_id = jsonResponse.UNIQUE_MSG_ID != undefined && jsonResponse.UNIQUE_MSG_ID != '' ? jsonResponse.UNIQUE_MSG_ID : '';\
			if(typeof sendMessageRealTime === "function") \{\
				sendMessageRealTime(data_param, 'attach', unq_msg_id);\
			\}\
		\},\
		error: function(err) \{\
			disabled_send_reply = false;\
			if(err.status == '403') \{\
				return false;\
			\}\
			alert("\\nProblem While saving the attachments.\\n");\
			console.log(err);\
			closeAttachmentDiv();\
		\}\
	\});\
\}\
\
function htmlEscape(string) \{\
	// var htmlEscapes = \{'&': '&amp;','<': '&lt;','>': '&gt;','"': '&quot;',"'": '&#x27;','/': '&#x2F;'\};\
	// var htmlEscaper = /[&<>"'\\/]/g;\
	var htmlEscapes = \{\
		'<': '&lt;',\
		'>': '&gt;',\
		'"': '&quot;',\
		"'": '&#x27;',\
		'/': '&#x2F;'\
	\};\
	var htmlEscaper = /[<>"'\\/]/g;\
	return('' + string).replace(htmlEscaper, function(match) \{\
		return htmlEscapes[match];\
	\});\
\};\
\
function initiateAttachment() \{\
	$('#send-action-div, #send-action-div-point').hide('fast');\
	closeMessageNotes();\
	closeRemList();\
	$('#rsrc_first_attch').click();\
\}\
\
function closeMessageNotes() \{\
	$('#messages-notes-txt').val('');\
	$('#notes_caret, #message-notes').hide('fast');\
	$('#message-notes').html('');\
\}\
\
function closeRemList() \{\
	$('#Remindmodal').hide();\
	$('#rem_arw').hide();\
\}\
\
function attchFileUpload(idx, attach_file, req_type) \{\
	$('#img_cross_0, #img_cross_1, #img_cross_2, #img_cross_3').hide('fast')\
	$("#msg-attch-send").hide('fast');\
	$('#attach-img_pick').hide('fast')\
	$('#img_cross_' + idx).hide();\
	$('#img_spinner_' + idx).show();\
	if(req_type === 1) \{\
		var data = new FormData();\
		var fileName = attach_file.name;\
		var fileExtension = fileName.replace(/^.*\\./, '');\
		var fileNameNew = fileName.substr(0, fileName.lastIndexOf('.')) || fileName;\
		var newFileName = fileNameNew + '_' + $.now() + '.' + fileExtension;\
		data.append("IMAGE", attach_file, newFileName);\
		data.append("IMAGE_NAME", newFileName);\
		data.append("MODID", 'MY');\
		data.append("USR_ID", $('#trackid').val());\
		data.append("IMAGE_TYPE", 'EnquiryAttachment');\
		data.append("UPLOADED_BY", 'User');\
		var valid_key = readCookie('im_iss');\
		valid_key = valid_key.substr(2);\
		data.append("VALIDATION_KEY", valid_key);\
		$.ajax(\{\
			type: "POST",\
			url: "//uploading.imimg.com/uploadimage",\
			contentType: "application/x-www-form-urlencoded",\
			cache: false,\
			contentType: false,\
			processData: false,\
			data: data,\
			success: function(response) \{\
				// console.log(response);\
				if(response.Code == 200 && response.Status == 'Success') \{\
					$('#img_cross_0, #img_cross_1, #img_cross_2, #img_cross_3').show('fast')\
					$("#msg-attch-send").show('fast');\
					$('#attach-img_pick').show('fast');\
					var file_name = response.Data.AwsPath.Image_Original_Path.replace(/(\'c3\'a2\'e2\'80 \'c2\'b5)/gm, "");\
					file_name = file_name.trim();\
					ATTACH_FILE_NAME_ARR.push(file_name);\
					$('#img_cross_' + idx).show();\
					$('#img_spinner_' + idx).hide();\
				\} else \{\
					handleFileNotUploadIssue(response);\
				\}\
			\},\
			error: function(err) \{\
				handleFileNotUploadIssue();\
			\}\
		\});\
	\} else \{\
		IMMYImageUpload(idx);\
	\}\
\}\
\
function IMMYImageUpload(idx) \{\
	var fi = document.getElementById('rsrc_first_attch');\
	if(fi.files.length === 0) \{\
		var fi = document.getElementById('attach_input');\
	\}\
	if(fi.files.length > 0) \{ // FIRST CHECK IF ANY FILE IS SELECTED.\
		for(var i = 0; i <= fi.files.length - 1; i++) \{\
			var fileName, fileExtension, fileSize, fileType, dateModified;\
			// FILE NAME AND EXTENSION.\
			fileName = fi.files.item(i).name;\
			fileType = fi.files.item(i).type;\
			fileSize = fi.files.item(i).size;\
			fileExtension = fileName.replace(/^.*\\./, '');\
			var errorType = 0;\
			// CHECK IF ITS AN IMAGE FILE.\
			// TO GET THE IMAGE WIDTH AND HEIGHT, WE'LL USE fileReader().\
			if(fileExtension == 'png' || fileExtension == 'jpg' || fileExtension == 'jpeg' || fileExtension == 'gif') \{\
				readImageFile(fi.files.item(i), errorType, fileExtension); // GET IMAGE INFO USING fileReader().\
			\} else \{\
				$('#imageName').val(fileName);\
				sendAjaxRequest(errorType, fileExtension);\
			\}\
		\}\
		// GET THE IMAGE WIDTH AND HEIGHT USING fileReader() API.\
		function readImageFile(file, errorType, fileExtension) \{\
			var reader = new FileReader(); // CREATE AN NEW INSTANCE.\
			reader.onload = function(e) \{\
				var maxDimension = 1000;\
				var image = new Image();\
				image.src = e.target.result;\
				image.onload = function() \{\
					var width = this.width; // Current image width\
					var height = this.height; // Current image height\
					if(width > maxDimension || height > maxDimension) \{\
						if(width > height) \{\
							var ratio = width / maxDimension;\
							var newWidth = maxDimension;\
							var newheight = height / ratio;\
						\} else \{\
							var ratio = height / maxDimension;\
							var newWidth = width / ratio;\
							var newheight = maxDimension;\
						\}\
					\} else \{\
						var newWidth = width;\
						var newheight = height;\
					\}\
					var compression = 1.0;\
					if(fileSize > 1000000) \{\
						compression = (fileSize - 1000000) / fileSize;\
						compression = 1 - compression;\
					\}\
					var canvas = document.createElement("canvas");\
					var context = canvas.getContext("2d");\
					canvas.width = newWidth;\
					canvas.height = newheight;\
					context.drawImage(image, 0, 0, image.width, image.height, 0, 0, canvas.width, canvas.height);\
					$('#imageBLOB').val(canvas.toDataURL(fileType, compression));\
					$('#imageName').val(fileName);\
					sendAjaxRequest(errorType, fileExtension);\
				\}\
			\};\
			reader.readAsDataURL(file);\
		\}\
\
		function sendAjaxRequest(errorType, fileExtension) \{\
			var profile = $('#imageBLOB').val();\
			var profileBlob = base64ToBlob(profile.replace(/^data:image\\/(png|jpeg|jpg);base64,/, ''), fileType);\
			var ImeshVisitorcookie = readCookie("ImeshVisitor");\
			var gl_val = getparamVal(ImeshVisitorcookie, "glid");\
			var formdata = new FormData();\
			var imageName = $('#imageName').val();\
			imageName = imageName.replace(/( )+/g, '-');\
			fileNameNew = fileName.substr(0, fileName.lastIndexOf('.')) || fileName;\
			var newFileName = fileNameNew + '_' + $.now() + '.' + fileExtension;\
			if(fileExtension == 'png' || fileExtension == 'jpg' || fileExtension == 'jpeg' || fileExtension == 'gif') \{\
				formdata.append("IMAGE", profileBlob, newFileName);\
				formdata.append("IMAGE_NAME", newFileName);\
			\} else \{\
				formdata.append("IMAGE", fi.files.item(i), newFileName);\
				formdata.append("IMAGE_NAME", newFileName);\
			\}\
			formdata.append("MODID", 'MY');\
			formdata.append("USR_ID", gl_val);\
			formdata.append("IMAGE_TYPE", 'EnquiryAttachment');\
			formdata.append("UPLOADED_BY", 'User');\
			var JWT = readCookie('im_iss');\
			var im_iss = getparamVal(JWT, "t");\
			formdata.append("VALIDATION_KEY", im_iss);\
			var webAddress = location.hostname;\
			var UrlPri = webAddress.match(/^dev/) ? "dev-" : (webAddress.match(/^stg/)) ? "stg-" : "";\
			if(UrlPri === 'dev-') \{\
				var url = 'https://stg-uploading.imimg.com/uploadimage';\
			\} else if(UrlPri === 'stg-') \{\
				var url = 'https://stg-uploading.imimg.com/uploadimage';\
			\} else \{\
				var url = 'https://uploading.imimg.com/uploadimage';\
			\}\
			$.ajax(\{\
				type: "POST",\
				url: url,\
				contentType: "application/x-www-form-urlencoded",\
				cache: false,\
				contentType: false,\
				processData: false,\
				data: formdata,\
				success: function(response) \{\
					if(response.Code === 200 && response.Status === 'Success') \{\
						var AWSPath = response.Data.AwsPath.Image_Original_Path.replace(/(\'c3\'a2\'e2\'80 \'c2\'b5)/gm, "");\
						$('#img_cross_0, #img_cross_1, #img_cross_2, #img_cross_3').show('fast')\
						$("#msg-attch-send").show('fast');\
						$('#attach-img_pick').show('fast')\
						var file_name = AWSPath\
						file_name = file_name.trim();\
						ATTACH_FILE_NAME_ARR.push(file_name);\
						$('#img_cross_' + idx).show();\
						$('#img_spinner_' + idx).hide();\
					\} else \{\
						handleFileNotUploadIssue(response);\
					\}\
				\},\
				error: function(err) \{\
					handleFileNotUploadIssue();\
				\}\
			\});\
		\}\
	\}\
\}\
\
function handleFileNotUploadIssue(response) \{\
	response = (response != undefined || response != null) ? response : '';\
	var file_obj = ATTACH_FILE_ARR[ATTACH_FILE_ARR.length - 1];\
	var file_name = '';\
	if(file_obj !== undefined && file_obj !== null) \{\
		file_name = file_obj.name;\
	\}\
	var err_res = '';\
	if(response != '') \{\
		err_res = response.Reason;\
	\}\
	var err_msg = file_name.trim() !== '' ? "Problem in uploading '" + file_name.trim() + "'." : "Problem in uploading the File."\
	$('#img_cross_0, #img_cross_1, #img_cross_2, #img_cross_3').show('fast');\
	$("#msg-attch-send").show('fast');\
	$('#attach-img_pick').show('fast');\
	removeMessageAttachment(ATTACH_FILE_ARR.length - 1);\
	getGAEventTrackingJS('messages_upload_attachment_fail');\
	alert("\\n" + err_msg + "\\n" + err_res + "\\nPlease try again.\\n");\
\}\
\
function base64ToBlob(base64, mime) \{\
	mime = mime || '';\
	var sliceSize = 1024;\
	var byteChars = window.atob(base64);\
	var byteArrays = [];\
	for(var offset = 0, len = byteChars.length; offset < len; offset += sliceSize) \{\
		var slice = byteChars.slice(offset, offset + sliceSize);\
		var byteNumbers = new Array(slice.length);\
		for(var i = 0; i < slice.length; i++) \{\
			byteNumbers[i] = slice.charCodeAt(i);\
		\}\
		var byteArray = new Uint8Array(byteNumbers);\
		byteArrays.push(byteArray);\
	\}\
	return new Blob(byteArrays, \{\
		type: mime\
	\});\
\}\
\
function extractCatalogUrl() \{\
	var catalog_link = '';\
	var cookie = readCookie('ImeshVisitor');\
	var utyp = getparamVal(cookie, 'utyp');\
	if(utyp == 'F' || utyp == 'P') \{\
		catalog_link = 'https://www.indiamart.com/company/' + $('#trackid').val();\
	\}\
	return catalog_link;\
\}\
\
function sendCatalogLink() \{\
	var prefix_text = "Thank you for showing interest in our products and contacting us. Please find my Catalog Link: "\
	getGAEventTrackingJS('send_catalog_link_messages');\
	$(".msg-placeholder").hide();\
	var catalog_link = extractCatalogUrl();\
	var final_catalog_link = prefix_text + catalog_link;\
	$("#massage-text").val(final_catalog_link);\
\}\
// function showPaymentSendLink()\{\
// 	var is_paid = isPaidSupplier();\
// 	if(is_paid === undefined || is_paid === null)\{\
// 		setTimeout(function ()\{\
// 			showPaymentSendLink();\
// 		\}, 100);\
// 	\}\
// 	else\{\
// 		if(parseInt(is_paid) === 1)\{\
// 			$("#reply_pay_link").show();\
// 			$(".reply_pay_link_nav").show();\
// 		\}		\
// 		else if(parseInt(is_paid) === 0)\{\
// 			$("#reply_pay_link").hide();\
// 			$(".reply_pay_link_nav").hide();\
// 		\}\
// 		else\
// 			showPaymentSendLink();\
// 	\}\
// \}\
function getTemplates(temptype, fromRefresh) \{ //fromRefresh parameter to handle AI template case while refreshig page\
	var element = document.getElementById('trackid');\
	if(element != null) \{\
		var glid = element.value;\
	\} else \{\
		var glid = '';\
	\}\
	if(glid != '') \{\
		//glid = byId('trackid').value.trim();\
		glid = glid.trim();\
		$.ajax(\{\
			url: '/phpajax/enquiry/enquiryajax/getTemplate',\
			data: \{\
				"temptype": temptype,\
				"glid": glid\
			\},\
			type: "GET",\
			dataType: "json",\
			success: function(jsonResponse) \{\
				if(jsonResponse.status == 'Success') \{\
					pushTemplatesinArray(jsonResponse, fromRefresh);\
				\} else \{\
					pushTemplatesinArray('', fromRefresh);\
					console.log("No template list present.");\
				\}\
			\},\
			error: function(err) \{\
				pushTemplatesinArray('', fromRefresh);\
				console.log("Couldn't fetch templates.");\
			\}\
		\});\
	\}\
\}\
\
function pushTemplatesinArray(jsonResponse, fromRefresh) \{\
	TEMPLATE_ARRAY = [];\
	if(jsonResponse !== undefined) \{\
		var templates_data = jQuery.extend(true, [], jsonResponse.response);\
	\}\
	var last_reply_arr = null;\
	catalog_link = extractCatalogUrl();\
	if(typeof(catalog_link) != "undefined" && catalog_link != "") \{\
		var prefix_text = "Thank you for showing interest in our products and contacting us. Please find my";\
		var catalog_link = \{\
			'template_order': '-1',\
			'template_label': 'Catalog Link',\
			'template_desc': prefix_text + " Catalog Link: " + catalog_link,\
			'dir_query_reply_template_id': '-1'\
		\};\
	\}\
	// var payment_link 		= 	\{ 	\
	// 								'template_order' : '-1',\
	// 								'template_label' : 'Payment Link',\
	// 								'template_desc'	 : prefix_text + " Payment Link: " + 'https://paywith.indiamart.com/' + $('#trackid').val(),\
	// 								'dir_query_reply_template_id'	: '-1'\
	// 							\};\
	if(jsonResponse !== undefined && jsonResponse !== null) \{\
		for(var i = 0; i < templates_data.length; i++) \{\
			var counter = templates_data[i];\
			if(counter.template_order == '1') \{\
				TEMPLATE_ARRAY.push(counter);\
			\} else \{\
				last_reply_arr = counter;\
			\}\
		\}\
	\}\
	if(catalog_link != "") \{\
		TEMPLATE_ARRAY.splice(0, 0, last_reply_arr);\
		TEMPLATE_ARRAY.splice(1, 0, catalog_link);\
	\} else \{\
		TEMPLATE_ARRAY.splice(0, 0, last_reply_arr);\
		TEMPLATE_ARRAY.splice(1, 0, catalog_link);\
		//TEMPLATE_ARRAY.splice(0, 0, last_reply_arr);\
	\}\
	//TEMPLATE_ARRAY.splice(1, 0, payment_link);\
	createTemplateListNew();\
	createQuickReplyNav(fromRefresh);\
\}\
\
function createTemplateListNew() \{\
	var template_html = '';\
	$('#temp_div').html('');\
	for(i = 0; i < TEMPLATE_ARRAY.length; i++) \{\
		if(TEMPLATE_ARRAY[i] != null) \{\
			if(TEMPLATE_ARRAY[i].template_label && TEMPLATE_ARRAY[i].template_label.trim() != "") \{\
				var description = htmlEscape(TEMPLATE_ARRAY[i].template_desc);\
				if(description.length > 90) \{\
					description = description.substr(0, 85) + '...';\
				\}\
				var temp_id = '';\
				var temp_style = '';\
				var onclick = '';\
				var temp_delete = '';\
				var label = htmlEscape(TEMPLATE_ARRAY[i].template_label);\
				// if(TEMPLATE_ARRAY[i].template_order == '-1' && TEMPLATE_ARRAY[i].template_label == "Payment Link")\{\
				// 	temp_id 	= 	'reply_pay_link';\
				// 	temp_style 	= 	"display:none;"\
				// 	onclick 	= 	"getGAEventTrackingJS('Msgctr_payment_link_clicked');"; \}\
				if(TEMPLATE_ARRAY[i].template_order == '-1' && TEMPLATE_ARRAY[i].template_label == "Catalog Link") \{\
					onclick = "getGAEventTrackingJS('Msgctr_catalog_link_clicked'); sendtypeofcode('Catalog_Link')";\
				\} else if(TEMPLATE_ARRAY[i].template_order == '1') \{\
					onclick = "getGAEventTrackingJS('Msgctr_user_defined_temp_clicked'); sendtypeofcode('User_Defined')";\
					temp_delete = "<div class=\\"temp-action\\">" + "<i title=\\"Edit label\\" onclick=\\"openAddUpdateHtml('" + i + "',event);getGAEventTrackingJS('Msgctr_edit_icon_clkd')\\" class=\\"fa fa-pencil\\" style=\\"color: #656565; font-size: 15px;margin-right: 10px;\\"></i><i title=\\"Delete label\\" onclick=\\"checkDelete('" + i + "',event);getGAEventTrackingJS('Msgctr_delete_icon_clkd')\\" class=\\"fa fa-trash\\" style=\\"color: #656565; font-size: 17px;\\"></i>" + "</div>";\
				\} else if(TEMPLATE_ARRAY[i].template_order == '0') \{\
					label = 'Last Reply';\
					onclick = "sendtypeofcode('Last_Message'); getGAEventTrackingJS('Msgctr_last_reply_clicked');";\
				\}\
				template_html = template_html + "<div id=\\"" + temp_id + "\\" style=\\"" + temp_style + "\\" class=\\"templist\\" onclick=\\"fillTemplate('" + i + "',event);" + onclick + "\\">" + "<span class=\\"tmp_hd\\">" + label + "</span>" + "<span class=\\"tmp_cnt\\">" + description + "</span>" + temp_delete + "</div>";\
			\}\
		\}\
	\}\
	template_html = template_html + "<div style=\\"height:12px;float:left;width:100%;\\"></div>";\
	$('#temp_div').html(template_html);\
	$('#ad_rply').attr("onclick", "$('#temp_main').toggle();getGAEventTrackingJS('Msgctr_saved_reply_icon_clkd')");\
	//showPaymentSendLink();\
	var length = TEMPLATE_ARRAY.slice(2).length;\
	if(length >= 25) \{\
		$('#addreply').css("display", "none");\
	\} else $('#addreply').css("display", "block");\
\}\
\
function fillTemplate(msg_index, event) \{\
	// $('#supp_rat').css("display", "none");  //popup 2 //priya //commented //shikha \
	$('.send_button').css(\{\
		'background':'#02887d',\
		'cursor': 'pointer'\
	\});\
	$('.slr-chatSgtnBlk').removeClass('msgctr_svrep_clkd');\
	$(".msg-placeholder").hide();\
	var msg_desc = TEMPLATE_ARRAY[msg_index].template_desc;\
	msg_desc = htmlEscape(msg_desc);\
	msg_desc = decodeEntities(msg_desc);\
	$("#massage-text").val(msg_desc);\
	if(event.currentTarget.classList[0].trim() == 'slr-chatSgtnBlk') \{\
		$(event.currentTarget).addClass('msgctr_svrep_clkd');\
	\}\
	$("#massage-text").focus();\
	if($('#temp_main').css("display") == "none") \{\
		trackEvent('messagecentre', 'down_temp_auto_sug');\
		temp_display_msg();\
	\}\
	$('#temp_main').hide();\
\
	// for updating position_flag\
	let idx = $('#quick_reply_list_div').children().index(event.currentTarget);\
	position_flag = idx + 1;\
\}\
\
function decodeEntities(encodedString) \{\
	var textArea = document.createElement('textarea');\
	textArea.innerHTML = encodedString;\
	return textArea.value;\
\}\
// $(document).ready(function() \{ //commented // shikha\
// 	$("#massage-text").on('keyup', function() \{\
// 		$("#supp_rat").css('display', 'none'); //priya \
// 		var msgtext = $("#massage-text").val();\
// 		var msgdecode = decodeEntities(msgtext);\
// 		$("#massage-text").val(msgdecode);\
// 	\});\
// 	$("#massage-text").one('focus', function() \{ //priya\
// 		$("#supp_rat").css('display', 'none');\
// 	\});\
// \});\
\
function openAddUpdateHtml(msg_index, event) \{\
	event.stopPropagation();\
	$('.overlay_adrp').css("display", "block");\
	if(msg_index !== undefined && msg_index !== '') \{\
		var savrep_hd = 'Update Reply';\
	\} else \{\
		var savrep_hd = 'Save Reply';\
	\}\
	var html = '<div class="addreply_bx" style="display:block; margin-top:-130px;">' + '<span class="savrep_hd" style="padding: 10px;"><span class="fa-stack fa-lg ad_rply" style="margin: 0;width: 37px;height: 30px;"></span>' + savrep_hd + '<svg style="cursor:pointer;float: right;" onclick="$(\\'.addreply_bx\\').remove();$(\\'.overlay_adrp\\').hide();" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="16" height="16" viewBox="0 0 16 16" style="fill:#333333;margin-top: 2px;float: right;">' + '<g id="surface1"><path style=" " d="M 2.75 2.042969 L 2.042969 2.75 L 2.398438 3.101563 L 7.292969 8 L 2.042969 13.25 L 2.75 13.957031 L 8 8.707031 L 12.894531 13.605469 L 13.25 13.957031 L 13.957031 13.25 L 13.605469 12.894531 L 8.707031 8 L 13.957031 2.75 L 13.25 2.042969 L 8 7.292969 L 3.101563 2.398438 Z "></path></g>' + '</svg>' + '</span>' + '<div style="padding: 10px;float: left;width: 100%;">' + '<input type="text" id="temp_label" value="" maxlength="30" style="" class="w_1 f1 ttext" placeholder="Enter template title here ...">' + '<textarea value="" id="temp_desc" maxlength="3500" style="" placeholder="Enter template description here ..." class="tdesc"></textarea>' + '</div>' + '<span class="savrep_btn" style="padding:12px;">' + '<span id="qck_error" class="im_red" style="font-size:12px"></span>' + '<span class="svrpy" id="svrply" onclick=""></span></span>' + '</div>';\
	$(html).insertAfter('.overlay_adrp');\
	if(msg_index !== undefined && msg_index !== '') \{\
		$('#temp_label').val(TEMPLATE_ARRAY[msg_index].template_label);\
		$('#temp_desc').val(TEMPLATE_ARRAY[msg_index].template_desc);\
		$('#svrply').html("Update");\
		$('#svrply').attr("onclick", "updateTemplate('1'," + msg_index + ");getGAEventTrackingJS('Msgctr_update_template_clkd');");\
	\} else \{\
		$('#svrply').html("Save");\
		$('#svrply').attr("onclick", "addTemplate('1');getGAEventTrackingJS('Msgctr_add_template_clkd');");\
	\}\
\}\
\
function checkDelete(msg_index, event) \{\
	event.stopPropagation();\
	var lable_reply = TEMPLATE_ARRAY[msg_index].template_label;\
	//$("#edit-label-err").html('');\
	//$("#edit-label-err").hide();\
	var head = '<div class="dlt-lbl-confirm-head">' + '<div style="font-size: 16px;">' + 'Deleting Saved Reply <b>"' + lable_reply.trim() + '"</b>' + '<img onclick="$(\\'.blk-upld-container\\').remove();" style="float:right; cursor:pointer;" src="' + CROSS_ICN + '">' + '</div>' + '</div>';\
	var body = '<div class="dlt-lbl-confirm-body">Are you sure you want to continue? Saved Reply <b> "' + lable_reply.trim() + '"</b> will be removed.</div>';\
	var foot = '<div class="dlt-lbl-confirm-foot">' + '<button class="dlt-lbl-btn" onclick=" delQuickRply(\\'' + msg_index + '\\');getGAEventTrackingJS(\\'Msgctr_delete_template_clkd\\');">' + '<i class="fa fa-circle-o-notch fa-spin" id="dlt_lbl_spin" style="display:none;"></i>' + '&nbsp;Continue</button>' + '<button class="dlt-lbl-btn" onclick="$(\\'.blk-upld-container\\').remove();">Cancel</button>' + '</div>';\
	var skeleton = '<div class="dlt-lbl-confirm">' + head + body + foot + '</div>';\
	$('body').append('<div class="blk-upld-container">' + skeleton + '</div>');\
\}\
\
function delQuickRply(msg_index) \{\
	if(byId('trackid').value.trim()) \{\
		var glid = byId('trackid').value.trim();\
		var temp_id = TEMPLATE_ARRAY[msg_index].dir_query_reply_template_id;\
		$.ajax(\{\
			url: '/phpajax/enquiry/enquiryajax/deleteTemplate',\
			data: \{\
				"glid": glid,\
				"temp_id": temp_id\
			\},\
			type: "GET",\
			dataType: "json",\
			success: function(jsonResponse) \{\
				if(jsonResponse.status == 'Success') \{\
					console.log(TEMPLATE_ARRAY[msg_index].template_label + " Successfully deleted");\
				\}\
				TEMPLATE_ARRAY.splice(msg_index, 1);\
				createTemplateListNew();\
				createQuickReplyNav(0);\
				$('.blk-upld-container').remove();\
				$("#dlt_lbl_spin").hide();\
			\},\
			error: function(err) \{\
				//$("#edit-label-err").html("Unable to delete saved reply.");\
				//$("#edit-label-err").show();\
				$('.blk-upld-container').remove();\
				$("#dlt_lbl_spin").hide();\
			\}\
		\});\
	\}\
\}\
\
function updateTemplate(order, msg_index, message) \{\
	var glid = $('#trackid').val().trim();\
	if(order == '1') \{\
		var temp_label_edit = $('#temp_label').val().trim();\
		var temp_desc_edit = $('#temp_desc').val().trim();\
		temp_label_edit = temp_label_edit;\
		temp_desc_edit = temp_desc_edit;\
		var temp_id = TEMPLATE_ARRAY[msg_index].dir_query_reply_template_id;\
		if(temp_label_edit == '' && temp_desc_edit == '') \{\
			$('#qck_error').html("*Enter template title and description");\
			return false;\
		\}\
		/*else if(temp_label_edit != '' && !temp_label_edit.match(/^[A-Za-z0-9 . ,'-]+$/) &&  temp_desc_edit != '' && !temp_desc_edit.match(/^[A-Za-z0-9 . ,'-]+$/))\{\
            $("#qck_error").html('*Please enter valid template title and description ');   \
            return false;\
                   \} \
    \
                else if(temp_label_edit != '' && !temp_label_edit.match(/^[A-Za-z0-9 . ,'-]+$/))\{\
            $("#qck_error").html('*Please enter valid template title.');   \
            return false;\
                   \}   \
                   else if(temp_desc_edit != '' && !temp_desc_edit.match(/^[A-Za-z0-9 . ,'-]+$/))\{\
            $("#qck_error").html('*Please enter valid template description.');   \
            return false ;\
                   \}*/\
		else if(temp_label_edit == '') \{\
			$('#qck_error').html("*Enter template title");\
			return false;\
		\} else if(temp_desc_edit == '') \{\
			$('#qck_error').html("*Enter template description");\
			return false;\
		\}\
		//$("#svrply").css("pointer-events", "none");\
		$("#svrply").attr("onclick", "");\
		$('#svrply').css("cursor", "progress");\
	\} else if(order == '0') \{\
		var temp_desc_edit = message;\
		var temp_id = TEMPLATE_ARRAY[0].dir_query_reply_template_id;\
		var temp_label_edit = 'default';\
	\}\
	$.ajax(\{\
		url: '/enquiry/enquiryajax/UpdateTemplate',\
		data: \{\
			"templable": temp_label_edit,\
			"tempdesc": temp_desc_edit,\
			"temporder": order,\
			"tempid": temp_id,\
			"glid": glid\
		\},\
		type: "POST",\
		dataType: "json",\
		success: function(jsonResponse) \{\
			if(jsonResponse.status == 'Success') \{\
				if(order == '1') \{\
					TEMPLATE_ARRAY[msg_index].template_label = temp_label_edit;\
					TEMPLATE_ARRAY[msg_index].template_desc = temp_desc_edit;\
					$('#qck_error').html("");\
					//$("#svrply").css("pointer-events", "none");\
					$('#svrply').css("cursor", "pointer");\
					$('.addreply_bx').remove();\
					$('.overlay_adrp').hide();\
				\} else if(order == '0') \{\
					TEMPLATE_ARRAY[0].template_desc = temp_desc_edit;\
				\}\
				createTemplateListNew();\
				createQuickReplyNav();\
			\} else \{\
				if(order == '1') \{\
					$('#qck_error').html("Something went wrong. Try again.");\
					$('#svrply').attr("onclick", "updateTemplate('1'," + msg_index + ");getGAEventTrackingJS('Msgctr_update_template_clkd');");\
					$("#svrply").css("pointer-events", "none");\
				\} else \{\
					console.log("Last reply not updated");\
				\}\
			\}\
		\}\
	\});\
\}\
\
function addTemplate(order, message) \{\
	var glid = '';\
	if($('#trackid').val() !== undefined && $('#trackid').val() !== null) \{\
		glid = $('#trackid').val().trim();\
		if(order == 0) \{\
			temp_label = 'default';\
			temp_desc = message;\
			temp_order = order;\
		\} else if(order == 1) \{\
			var temp_label = $('#temp_label').val().trim();\
			var temp_desc = $('#temp_desc').val().trim();\
			temp_label = temp_label;\
			temp_desc = temp_desc;\
			var temp_order = order;\
			if(temp_order == '1') \{\
				if(temp_label == '' && temp_desc == '') \{\
					$('#qck_error').html("*Enter template title and description");\
					return false;\
				\}\
				/*else if(temp_label != '' && !temp_label.match(/^[A-Za-z0-9 . ,'-]+$/) &&  temp_desc != '' && !temp_desc.match(/^[A-Za-z0-9 . ,'-]+$/))\{\
            $("#qck_error").html('*Please enter valid template title and description ');   \
            return false;\
                   \} \
    \
                else if(temp_label != '' && !temp_label.match(/^[A-Za-z0-9 . ,'-]+$/))\{\
            $("#qck_error").html('*Please enter valid template title.');   \
            return false;\
                   \}   \
                   else if(temp_desc != '' && !temp_desc.match(/^[A-Za-z0-9 . ,'-]+$/))\{\
            $("#qck_error").html('*Please enter valid template description.');   \
            return false ;\
                   \}*/\
				else if(temp_label == '') \{\
					$('#qck_error').html("*Enter template title");\
					return false;\
				\} else if(temp_desc == '') \{\
					$('#qck_error').html("*Enter template description.");\
					return false;\
				\}\
			\}\
			$("#svrply").attr("onclick", "");\
			$('#svrply').css("cursor", "progress");\
		\}\
		$.ajax(\{\
			url: '/enquiry/enquiryajax/CreateTemplate',\
			data: \{\
				"templable": temp_label,\
				"tempdesc": temp_desc,\
				"temporder": temp_order,\
				"glid": glid\
			\},\
			type: "POST",\
			dataType: "json",\
			success: function(jsonResponse) \{\
				if(jsonResponse.status == 'Success') \{\
					if(temp_order == '1') \{\
						//$("#svrply").css("pointer-events", "none");\
						$('.addreply_bx').remove();\
						$('.overlay_adrp').hide();\
						getTemplates('', 0);\
						$('#qck_error').html("");\
						$('#svrply').css("cursor", "pointer");\
					\} else if(temp_order == '0') \{\
						console.log("Last reply created");\
						getTemplates('', 0);\
					\}\
				\} else \{\
					if(temp_order == '1') \{\
						//$("#svrply").css("pointer-events", "none");\
						$("#svrply").attr("onclick", "addTemplate('1');getGAEventTrackingJS('Msgctr_add_template_clkd');");\
						$('#svrply').css("cursor", "pointer");\
						$('#qck_error').html("Something went wrong. Try again.");\
					\} else if(temp_order == '0') \{\
						console.log("Last reply not created");\
					\}\
				\}\
			\}\
		\});\
	\}\
\}\
\
function createQuickReplyNav(fromRefresh) \{\
	var template_html = '';\
	$('#quick_reply_list_div').html('');\
	for(i = 0; i < TEMPLATE_ARRAY.length; i++) \{\
		if(TEMPLATE_ARRAY[i] != null && TEMPLATE_ARRAY[i].template_label && TEMPLATE_ARRAY[i].template_label.trim() != "") \{\
			var temp_id = 'sug_' + i;\
			var temp_class = '';\
			var temp_style = '';\
			var onclick = '';\
			var label = htmlEscape(TEMPLATE_ARRAY[i].template_label);\
			// if(TEMPLATE_ARRAY[i].template_order == '-1' && TEMPLATE_ARRAY[i].template_label == "Payment Link")\{\
			// 	temp_id 	= 	'reply_pay_link_nav';\
			// 	temp_style 	= 	"display:none;"\
			// 	onclick 	= 	"getGAEventTrackingJS('Msgctr_payment_link_clicked');"\
			// \}\
			if(TEMPLATE_ARRAY[i].template_order == '-1' && TEMPLATE_ARRAY[i].template_label == "Catalog Link") \{\
				onclick = "getGAEventTrackingJS('Msgctr_catalog_link_clicked'); sendtypeofcode('Catalog_Link')"\
				\
				temp_class = 'reply_cat_link_nav';\
			\} else if(TEMPLATE_ARRAY[i].template_order == '1') \{\
				onclick = "getGAEventTrackingJS('Msgctr_user_defined_temp_clicked'); sendtypeofcode('User_Defined')"\
				\
			\} else if(TEMPLATE_ARRAY[i].template_order == '0') \{\
				//label = 'Last Reply';\
				label = TEMPLATE_ARRAY[i].template_desc.length > 25 ? TEMPLATE_ARRAY[i].template_desc.substring(0, 22) + "..." : TEMPLATE_ARRAY[i].template_desc;\
				onclick = "getGAEventTrackingJS('Msgctr_last_reply_clicked'); sendtypeofcode('Last_Message');"\
				temp_class = "last_reply_nav";\
			\}\
			template_html = template_html + "<div style=\\"" + temp_style + "\\" class=\\"slr-chatSgtnBlk " + temp_class + "\\" id=\\"" + temp_id + "\\" onclick=\\"fillTemplate('" + i + "',event);" + onclick + "\\">" + label + "<span title=\\"Send\\" class=\\"bg-msg ico Msg-snd-auto\\" id=\\"down_temp_icon\\"></span></div>";\
		\}\
	\}\
	$("#quick_reply_list_div").css('left', '0px');\
	$('#quick_reply_list_div').html(template_html);\
	//showPaymentSendLink();\
	if(!IS_SUGGESTED_REPLY) \{\
		quickReplyNavigation();\
	\}\
	if(!fromRefresh && IS_SUGGESTED_REPLY == 1) createSuggestedReplyHtml();\
\}\
/*changes done for suggestive reply and shift the catalog link back and forth*/\
function getPercentage(num, per) \{\
	return(num / 100) * per;\
\}\
\
function changeCatalogLinkPos(flag) \{\
	if($('.reply_cat_link_nav').length > 0) \{\
		if(flag) \{\
			var rply_cat_link = $('.reply_cat_link_nav')[0].outerHTML\
			$('.reply_cat_link_nav').remove();\
			var lst_sugg_tmp = $('.suggested_reply_nav').last()[0];\
			$(rply_cat_link).insertAfter(lst_sugg_tmp);\
		\} else \{\
			var rply_cat_link = $('.reply_cat_link_nav')[0].outerHTML\
			$('.reply_cat_link_nav').remove();\
			var frst_sugg_tmp = $('.suggested_reply_nav').first()[0];\
			$(rply_cat_link).insertBefore(frst_sugg_tmp);\
		\}\
	\}\
\}\
\
function rightArrow() \{\
	var view = $("#quick_reply_list_div");\
	var quick_width = $("#quick_reply_main_div").width() - getPercentage($("#quick_reply_main_div").width(), 40);\
	var currentPosition = $("#quick_reply_main_div").width() + (parseInt(view.css("left")) * -1);\
	if(parseInt(totalWidth) - parseInt(currentPosition) < quick_width) \{\
		quick_width = parseInt(totalWidth) - parseInt(currentPosition) - 120;\
	\}\
	if(currentPosition < (totalWidth - 40)) \{\
		ct++;\
		var move = $("#quick_reply_list_div div:nth-child(" + ct + ")").width() + quick_width;\
		view.stop(false, true).animate(\{\
			left: "-=" + move\
		\}, \{\
			duration: 100\
		\});\
		$("#leftArrow").css('color', '#000');\
	\}\
	if((currentPosition + move) >= (totalWidth - 40)) \{\
		$("#rightArrow").css('color', '#999');\
	\}\
\}\
\
function leftArrow() \{\
	var view = $("#quick_reply_list_div");\
	var quick_width = $("#quick_reply_main_div").width() - getPercentage($("#quick_reply_main_div").width(), 40);\
	var currentPosition = parseInt(view.css("left"));\
	if(ct > 0) \{\
		var move = $("#quick_reply_list_div div:nth-child(" + ct + ")").width() + quick_width;\
		ct--;\
		if(-parseInt($("#quick_reply_list_div")[0].offsetLeft) < quick_width) \{\
			view.stop(false, true).animate(\{\
				left: "0"\
			\}, \{\
				duration: 100\
			\});\
			ct = 0;\
		\} else \{\
			view.stop(false, true).animate(\{\
				left: "+=" + move\
			\}, \{\
				duration: 100\
			\});\
		\}\
		$("#rightArrow").css('color', '#000');\
	\}\
	var currentPosition = (parseInt(view.css("left")));\
	if(ct <= 0) \{\
		$("#leftArrow").css('color', '#999');\
	\}\
\}\
\
function quickReplyNavigation() \{\
	ct = 0;\
	totalWidth = 0;\
	$('#quick_reply_list_div').width('3500');\
	var main_el = $('#quick_reply_list_div > div');\
	main_el.map(function(e) \{\
		var el = main_el[e];\
		if(el) \{\
			totalWidth = totalWidth + el.offsetWidth + 11;\
		\}\
	\});\
	$('#quick_reply_list_div').width(totalWidth);\
	if((($("#quick_reply_main_div").width()) + 40) <= totalWidth) \{\
		$("#quck_reply_nav").css('display', 'block');\
	\} else \{\
		$("#quck_reply_nav").css('display', 'none');\
	\}\
\}\
// Function to download a file from AWS server.\
function downloadAttachment(name) \{\
	if(name !== undefined && name !== null && name.trim() !== '') \{\
		var root_url = location.protocol + '//' + location.host;\
		window.open(root_url + '/enquiry/attachments/downloadattachment?name=' + name, '_blank');\
	\} else \{\
		alert("Please specify the name of the file to download.");\
	\}\
\}\
\
function showUnreadLeads() \{\
	if (!showUnreadLeadsFlag)\{\
		showUnreadLeadsFlag = true;\
		document.getElementById("cb-unrd").checked = true;\
		return;\
	\}\
	showUnreadLeadsFlag = false;\
 	var contactcount = parseInt($('#contactcount').val());\
	sessionStorage.setItem("countcontact", contactcount);\
	getGAEventTrackingJS('apply_unread_lead_filter');\
	if(list === undefined || list.length === undefined) \{\
		$('#searchauto').val('');\
		return;\
	\}\
	var checkBox = document.getElementById("cb-unrd");\
	if(checkBox === undefined || checkBox === null) \{\
		return;\
	\}\
	// document.getElementById("cb-unrd-div").setAttribute('onclick', '');\
	if(checkBox.checked) \{\
		checkBox.checked = false;\
		$(".contact-count").html('');\
		addContactListLoader();\
		setTimeout(function() \{\
			// body...\
			refreshContactList(true);\
		\}, 1000);\
	\} else \{\
		checkBox.checked = true;\
		extractUnreadLeadsOnly();\
		unreadcount(glusr, false);\
	\}\
\}\
/*\
    Function to Extract Unread Leads\
*/\
function extractUnreadLeadsOnly() \{\
	list = list.filter(function(contact) \{\
		var idx = contact.unread_message_cnt;\
		if(idx !== undefined && idx !== null && idx != 0 && idx.toString().trim() !== '') \{\
			return true;\
		\}\
	\});\
	if(list.length) \{\
		var start = 0;\
		var end = list.length;\
		//byId("start").value = start;\
		//byId("end").value   = end;\
		createContactDynamicHTML(list.slice(start, end), false);\
		// createContactDynamicHTML(list.slice(0, 500), false);\
		document.getElementById('scrollerdiv').scrollTop = 0;\
		$($("#fetch_list li")[0]).click();\
		onclickFocus();\
	\} else \{\
		handleEmptyContactPage('unarchive');\
	\}\
	var count_str = "(" + list.length + ")";\
	$('.contact-count').text(count_str + " contacts");\
	hideScroller();\
\}\
\
function addContactListLoader() \{\
	var contact_dom_id = $(".user-name1.active").attr('id');\
	while(fetch_list.firstChild) fetch_list.removeChild(fetch_list.firstChild);\
	var spinner = ' <li class="user-name1 active" style="text-align: center; background: white;" id="' + contact_dom_id + '"> \\\
                            <i class="fa fa-circle-o-notch fa-spin" style="margin: 100px;font-size: 40px;color: #89cdc5;"></i> \\\
                        </li> ';\
	$('.message-user-name-section').append(spinner);\
\}\
\
function refreshContactList(update_msg_count) \{\
	uncheckUnreadCheckBox();\
	$("#massage-text").val('');\
	// $('#refresh_img').addClass('fa-spin');\
	if(update_msg_count === true) \{\
		unreadcount(glusr, true);\
	\}\
	$('#msg_heading').show();\
	showUnArchiveContacts(false);\
	var count = sessionStorage.getItem("countcontact");\
	if(count !== undefined && count !== null && count !== '') \{\
		// var count_str = "("+count+")" ;\
		if(count > 1) $('.contact-count').text("(" + count + " contacts)");\
		else $('.contact-count').text("(" + count + " contact)");\
	\}\
\} // Bring all the contacts in the back ground\
function uncheckUnreadCheckBox() \{\
	var checkBox = document.getElementById("cb-unrd");\
	if(checkBox === undefined || checkBox === null) \{\
		return;\
	\}\
	checkBox.checked = false\
\}\
\
function handleEmptyContactPage(navigate_to, temp_test) \{\
	var navigation_function = navigate_to === 'unarchive' ? 'showUnArchiveContacts();' : '';\
	var img_text = navigate_to === 'unarchive' ? 'No Contacts' : 'No Contacts';\
	var btn_text = navigate_to === 'unarchive' ? 'View All Contacts' : 'View All Contacts';\
	list = [];\
	$("#rgtmst").css('display', 'none');\
	$(".contact-count,").html('(0)');\
	$(".bottom-send-section").css('display', 'none');\
	$("#myenqtab").css('display', 'none');\
	//making sup rate section hidden\
	$("#supp_rat").css('display', 'none');\
	$(".get_sup_rat").css('display', 'none');\
	// Empty Message on Right Section\
	$('#testing, #left-name, .label-breadcrumb, .vdtls, .chattbl, .mslrt').html('');\
	$(".last-seen-span, .msg_footer, #rem-note-icn-div").hide();\
	\
	//hiding header\
	$("#topsection_container").css('display', 'none');\
	// Empty Message on left section\
\
	if($('#fetch_list')[0]) \{\
		while($('#fetch_list')[0].firstChild) $('#fetch_list')[0].removeChild($('#fetch_list')[0].firstChild);\
	\}\
	$("#back_to_unarchive").remove();\
	$("#fraud_div").remove();\
	$('#add_contct').removeClass('disable');\
	if($('#buyer_profile_details1').css("display") == "flex") \{\
		if($('.slidbox').is(":visible")) \{\
			slideUpProfileInformation();\
		\}\
		else slideDownProfileInformation();\
		$('#mslft').html('');\
		$('#mslrt1').html('');\
		$('#buyer_profile_details1').css("display", "none");\
		chatSectionHeight();\
	\}\
	if(temp_test != 1) \{\
		var back_button = ' <li id="back_to_unarchive" class="user-name2" style="text-align: center; margin-top: 50px;"> \\\
                                    <div style="border-radius: 50%;background: #e0e7e9;width: 200px;height: 200px; margin-left: calc(50% - 100px); padding-top: 70px;">\\\
                                        <i class="fa fa-archive" style="color: white;font-size: 80px;"></i>\\\
                                    </div>\\\
                                    <p style=" padding: 10px; color: #929fa6; font-size: 16px;">' + img_text + '</p>\\\
                                    <button style="margin:30px 10px 10px 10px; border-radius:10px; color:white; background:#4ea798; border:0px; padding:10px; cursor:pointer;" onclick="' + navigation_function + '"> \\\
                                        ' + btn_text + ' \\\
                                    </button> \\\
                                </li> ';\
		$('.message-user-name-section').append(back_button);\
		$('#add_contct').addClass('disable');\
	\}\
	$("#hdr_img img").attr("src", "");\
	$("#hdr_img").removeClass('no_cmp_logo');\
	$("#hdr_img").removeClass('no_cmp_logo_hdr');\
	$("#nm_txt").text('');\
	$("#pns_response_rate").css("display", "none");\
	var count = sessionStorage.getItem("countcontact");\
	if(count !== undefined && count !== null && count !== '') \{\
		//  var count_str = "("+count+")" ;\
		if(count > 1) $('.contact-count').text("(" + count + " contacts)");\
		else $('.contact-count').text("(" + count + " contact)");\
	\}\
\}\
\
function showUnArchiveContacts(open_first_contact_detail) \{\
	var contact_dom_id = $(".user-name1.active").attr('id');\
	open_first_contact_detail = (open_first_contact_detail === undefined || open_first_contact_detail === true) ? true : false;\
	history.pushState("", document.title, window.location.pathname);\
	// hideAllHeaders();\
	uncheckUnreadCheckBox();\
	$('#add_contct').removeClass('disable');\
	$('#msg_heading').show();\
	getMoreContact('/phpajax/enquiry/messagecentre/GetMoreContacts', 1, 50, true);\
	// getMoreContacts(1, 100,contactcount,loginglid);    // Show first 100 contacts\
	$.when(GetSearchContacts()).then(function(result) \{\
		if(result) \{\
			var start = 1;\
			var end = 50;\
			byId("start").value = start;\
			byId("end").value = end;\
			createContactDynamicHTML(list.slice(start, end), false);\
			var count = sessionStorage.getItem("countcontact");\
			if(count !== undefined && count !== null && count !== '') \{\
				//    var count_str = "("+count+")" ;\
				if(count > 1) $('.contact-count').text("(" + count + " contacts)");\
				else $('.contact-count').text("(" + count + " contact)");\
			\}\
			if(open_first_contact_detail) \{\
				$($("#fetch_list li")[0]).click();\
				hideScroller();\
			\} else \{\
				scrollToPreviouslySelectedContact(contact_dom_id, false);\
			\}\
		\} else \{\
			handleEmptyContactPage('archive', 1);\
		\}\
		$('#refresh_img').removeClass('fa-spin');\
	\}, function(err) \{\
		list = jQuery.extend(true, [], result);\
	\});\
\}\
\
function scrollToPreviouslySelectedContact(contact_dom_id, prepare_data) \{\
	var search_text = $("#searchauto").val();\
	prepare_data = prepare_data === undefined || prepare_data === null ? true : prepare_data;\
	if(prepare_data) \{\
		if(search_text !== undefined && search_text !== null && search_text.trim() !== '') \{\
			startSearch();\
		\} else \{\
			var len = list.length > 1000 ? 1000 : list.length;\
			createContactDynamicHTML(list.slice(0, len), false);\
			byId("start").value = 0;\
			byId("end").value = len;\
		\}\
	\}\
	if(contact_dom_id !== undefined && contact_dom_id !== null && contact_dom_id.toString().trim() !== '') \{\
		var elem1 = byId("c_number" + contact_dom_id);\
		var dom_c_num1 = elem1 !== undefined && elem1 !== null ? elem1.innerHTML : '';\
		var elem2 = byId("recv_mob");\
		var dom_c_num2 = elem2 !== undefined && elem2 !== null ? elem2.value : '';\
		var my_element = byId('' + contact_dom_id);\
		if(my_element !== undefined && my_element !== null && dom_c_num1.substr(dom_c_num1.length - 8) === dom_c_num2.substr(dom_c_num2.length - 8)) \{\
			$(".user-name1").removeClass('active');\
			var topPos = my_element.offsetTop;\
			byId('scrollerdiv').scrollTop = topPos;\
			$("#" + contact_dom_id).click();\
		\} else \{\
			byId('scrollerdiv').scrollTop = 0;\
			$($(".user-name1")[0]).click();\
		\}\
	\} else if($(".user-name1")[0]) \{\
		byId('scrollerdiv').scrollTop = 0;\
		$($(".user-name1")[0]).click();\
	\}\
	$('.cs_position').css("display", "block");\
	$("#massage-text").focus();\
	onclickFocus();\
\}\
\
function getMoreContact(url, start, end, clear_previous) \{\
	var loginglid = $('#trackid').val();\
	$.ajax(\{\
		url: url,\
		data: \{\
			"logingid": loginglid,\
			"start": start,\
			"end": end\
		\},\
		dataType: "html",\
		type: "GET",\
		success: function(jsonResult) \{\
		    // if(jsonResult == "")\{\
		    // S\
		    // \}\
			$('#start').val(start);\
			$('#end').val(end);\
			var el = document.getElementById("fetch_list");\
			if(clear_previous) \{\
				var contact_dom_id = $(".user-name1.active").attr('id');\
				// $('#fetch_list').html(jsonResult);\
				el.innerHTML = jsonResult;\
				scrollToPreviouslySelectedContact(contact_dom_id, false);\
				$('#refresh_img').removeClass('fa-spin');\
			\} else \{\
				// $('#fetch_list').append(jsonResult);\
				el.innerHTML = el.innerHTML + jsonResult;\
			\}\
			SEARCH_PAUSED = false;\
			$('.cs_position').css("display", "block");\
		\},\
		error: function(err) \{\
			if(err.status == '400' || err.status == '401' || err.status == '402' || err.status == '403') \{\
				window.location.reload(true);\
                return;\
			\}\
		\}\
	\});\
	onclickFocus();\
\}\
/* Function to check of its landing from EMAIL or From Unread Count of Dashborad */\
function isLandingFromEmail() \{ //priya\
	console.log('Check ifLandingFromEmail');\
	var contactcount = parseInt($('#contactcount').val());\
	sessionStorage.setItem("countcontact", contactcount);\
	var params_raw = window.location.search.substr(1, window.location.search.length);\
	if(params_raw.indexOf("sup_glid=") > -1) \{\
         if(document.getElementById('code')&&document.getElementById('code').value=='408')\{\
                handleTimeoutListing(1);\
                return;\
            \}\
		/* Single Contact View */\
		// openSingleContactViewOnLoad();\
		handleSingleContactRequest();\
	\} else \{\
		/* Normal Page Landing */\
		if($("#back_to_unarchive")[0] || $("#fetch_list").children().length == 0) \{\
             if(document.getElementById('code')&&document.getElementById('code').value=='408')\{\
                handleTimeoutListing(1);\
                return;\
            \}\
			if($('#no_cntct_msg_page').html() == 1) return false;\
			handleEmptyContactPage('archive');\
		\} else \{\
			$(".user-name1.active").click();\
			GetSearchContacts();\
		\}\
	\}\
\}\
\
function handleSingleContactRequest() \{\
	var url_w = window.location.href;\
	if(url_w.match('enquiry/messagecentre')) \{\
		if($('#trackid').val() !== undefined && $('#trackid').val() !== null) \{\
			var glid = trim($('#trackid').val());\
			var start_req = "";\
			var end_req = "";\
			var date_req = '';\
			var url = '/phpajax/enquiry/messagecentre/GetSearchContacts';\
			$.ajax(\{\
				url: url,\
				data: \{\
					"glid": glid,\
					"start": start_req,\
					"end": end_req,\
					"last_contact_date": date_req\
				\},\
				type: "POST",\
				success: function(jsonResult) \{\
					list = JSON.parse(jsonResult);\
					var required_contact = atob(extractContactGlidFromUrl('sup_glid='));\
					var position=-1;\
					for(let i=0;i<list.length;i++)\{\
						if(list[i]['contacts_glid']==required_contact)\{\
							position = i;\
							break;\
						\}\
					\}\
					if(position!=-1)\{   //Contact is already present in the list variable\
						list.unshift(list[position]);   //Update local list variable\
						list.splice(position+1,1);\
					\}\
					var fetchList = document.getElementById("fetch_list");\
					if(document.getElementById('online-'+required_contact)!=null)\{  //Contact is in the list and is being displayed\
						var senderContactLI = document.getElementById('online-'+required_contact).parentElement.parentElement.parentElement;\
						document.getElementById('online-'+required_contact).parentElement.parentElement.parentElement.remove();\
						fetchList.insertBefore(senderContactLI,fetchList.childNodes[0]);\
					\}else\{  //Contact is in the list but not being displayed(Element will be created on scrolling down the list)\
						var dom_id = parseInt(document.getElementById('end').value);\
						var li_elem = createSingleContactHtml(dom_id,list[0]);\
						fetchList.insertBefore(li_elem["li"],fetchList.childNodes[0]);\
						document.getElementById(dom_id).innerHTML = li_elem['skeleton'];\
						document.getElementById('end').value = dom_id+1;\
					\}\
					document.getElementById('fetch_list').firstChild.classList.add('active');\
					$(".user-name1.active").click();\
					if(!check_OneDayPassed_for_presence()) return false;\
					else setTimeout(function() \{\
						if (typeof(add_List_Presence)=="function")\
						add_List_Presence(list);\
					\}, 6000); //function to add the contact list in roaster bucket daily once\
				\},\
				error: function(err) \{\
					console.log("GetSearchContacts error = "+err);\
				\}\
			\});\
		\}\
	\}\
\}\
\
/*\
  Function to find the particular contact based on his/her GLID and show his/her messages.\
*/\
function openSingleContactViewOnLoad() \{\
	var contact_glid_base64 = extractContactGlidFromUrl('sup_glid=');\
	if(contact_glid_base64.trim() !== '') \{\
		var contact_glid = '';\
		try \{\
			contact_glid = decodeURIComponent(escape(atob(contact_glid_base64)));\
		\} catch(err) \{\
			console.log("Error in decoding the GLID : " + err);\
			history.pushState("", document.title, window.location.pathname);\
			showUnArchiveContacts();\
			return;\
		\}\
		var login_glid = $("#trackid").val();\
		$(".user-name1").click();\
		contactDetail(-30, login_glid, '', '', contact_glid, '');\
	\} else \{\
		if($("#back_to_unarchive")[0] || $("#fetch_list").children().length == 0) \{\
// 			console.log('handleEmptyContactPage');\
			handleEmptyContactPage('archive');\
		\} else \{\
			$(".user-name1.active").click();\
// 			console.log('GetSearchContacts');\
			GetSearchContacts();\
		\}\
		history.pushState("", document.title, window.location.pathname);\
	\}\
\}\
\
function extractContactGlidFromUrl(extract_param) \{\
	if(extract_param === undefined || extract_param === null || extract_param === '') \{\
		return;\
	\}\
	if(extract_param.trim() === '') \{\
		return;\
	\}\
	var params_raw = window.location.search.substr(1, window.location.search.length);\
	var contact_glid_base64 = '';\
	if(params_raw.length > 0) \{\
		var params_obj = params_raw.split('&');\
		for(var idx = 0; idx < params_obj.length; idx++) \{\
			if(params_obj[idx].indexOf(extract_param) !== -1) \{\
				if(extract_param == "sup_glid=" && params_obj[idx].indexOf("autoidentify") !== -1) \{\
					var test = params_obj[idx].split('/?');\
					params_obj[idx] = test[0];\
				\}\
				contact_glid_base64 = params_obj[idx].replace(extract_param, '');\
				break;\
			\}\
		\}\
	\}\
// 	console.log('In extractContactGlidFromUrl  ' + extract_param + ' & value is ' + contact_glid_base64);\
	return contact_glid_base64;\
\}\
\
function showSingleContactOnLeft(contact_dom_id, loginglid, contactglid) \{\
// 	console.log('In showSingleContactOnLeft for loginglid ' + loginglid + '& contactglid = ' + contactglid);\
	// Landing from mail therefore creating single contact on the left list\
	var c_name = $('#receiver_name').val() ? $('#receiver_name').val() : 'Buyer';\
	var c_mobile = $('#recv_mob').val() ? $('#recv_mob').val() : '';\
	var c_city = $('#recv_city').val() ? $('#recv_city').val() : '';\
	var c_state = $('#recv_state').val() ? $('#recv_state').val() : '';\
	var c_company = $('#recv_org').val() ? $('#recv_org').val() : '';\
	var c_country = $('#recv_country').val() ? $('#recv_country').val() : '';\
	//var left_name_det = '<span style="font-weight: bold;float: left;margin-right: 5px;">' + c_name + '<i class="bg-msg ico Msg-phn" aria-hidden="true" style="font-size:12px; margin:0px 2px 0px 10px;"></i><span style="font-size:14px;font-weight: normal;">' + c_mobile + '</span><span class="usRt" id= "rating_count" style="display:block;"></span>';\
	//$('#left-name').html(left_name_det);\
	//$('#left-name').html('<span id="disp_name" style="font-weight: bold;cursor: pointer;">'+c_name+'&nbsp;&nbsp;</span><span style="font-size: 15px !important; cursor: pointer;">'+c_company+' '+c_city+'</span><span class="usRt" id= "rating_count" style="display:block;"></span>');\
	var c__name = c_name.split(' ');\
	//get_avg_rat(contactglid);\
	if(c_company != '') \{ //to show comany name in suplier rating for single contact\
		if(c_city != '') $('#sup_nam').html(c_company + ', ' + c_city);\
		else if(c_state != '') $('#sup_nam').html(c_company + ', ' + c_state);\
		else $('#sup_nam').html(c_company);\
	\} else $('#sup_nam').html(c__name[0]);\
	$('#intro_name').html(c__name[0]);\
	if(c_mobile.trim() === '' && c_name === "Buyer") \{\
		history.pushState("", document.title, window.location.pathname);\
		showUnArchiveContacts();\
		alert("Unable to find the Contact.");\
	\} else \{\
		var back_button = '<li class="user-name2" style="text-align: center;">' + '<button class="view-all-contact-btn" onclick="showUnArchiveContacts();"> View All Contacts </button>' + '</li> ';\
		var searched_contact = \{\
			"fk_glusr_usr_id": loginglid,\
			"contacts_glid": contactglid,\
			"contacts_company": c_company,\
			"contacts_name": c_name,\
			"contacts_mobile1": c_mobile,\
			"contact_city": c_city,\
			"contact_state": c_state,\
			"country_name": c_country,\
			"contact_ph_country": "",\
			"contacts_type": "",\
			"im_contact_id": "",\
			"contacts_add_date": "",\
			"last_contact_date": "",\
			"last_message": "",\
			"unread_message_cnt": "",\
			"last_contact_date_view": "",\
			"msg_read_status": ""\
		\};\
		list = [searched_contact];\
		//createContactDynamicHTML(1, list); \
		createContactDynamicHTML(list, false);\
		var cmp_img = $(".user-name1 div img").attr('src');\
		if(cmp_img == "") \{\
			/*var x = $(".user-name1.active div").css("background-image").slice(5,-2);\
			$(".cmp_logo_header").attr('src',x);*/\
			var nm_txt = '';\
			if(c_company != '') nm_txt = c_company.charAt(0).toUpperCase();\
			else nm_txt = c_name.charAt(0).toUpperCase();\
			$("#hdr_img").addClass('no_cmp_logo');\
			$("#hdr_img").addClass('no_cmp_logo_hdr');\
			$(".cmp_logo_header").css("display", "none");\
			$("#nm_txt").text(nm_txt);\
		\} else \{\
			$(".cmp_logo_header").attr('src', cmp_img);\
			$(".cmp_logo_header").css("display", "block");\
		\}\
		$('.message-user-name-section').append(back_button);\
		onclickFocus();\
		hideScroller();\
		$('#contact_count').text("(1 contact)");\
		$('#contact_count').css('display', 'inline-block');\
		if(c_company != '') \{\
			$('#intro_name').html(c_company);\
			$('#sup_nam_1').html(c_company);\
			$('#sup_nam_2').html(c_company);\
		\} else \{\
			$('#intro_name').html(c_name);\
			$('#sup_nam_1').html(c_name);\
			$('#sup_nam_2').html(c_name);\
		\}\
		byId("fetch_list").querySelector("li").classList.add("active");\
	\}\
\}\
/*\
    Function to Tell whether the elemnt is visible or not.\
*/\
function isElementInViewport(el) \{\
	el = typeof jQuery === "function" && el instanceof jQuery ? el[0] : el; //Code to handle if someone send jQuery element\
	var rect = el.getBoundingClientRect();\
	var chat_sec = byId("chat-section-main").getBoundingClientRect();\
	if(rect.top >= chat_sec.top && rect.left >= chat_sec.left && rect.bottom <= chat_sec.bottom && rect.right <= chat_sec.right) \{\
		return true; // Element completly visible.\
	\} else if(rect.top <= chat_sec.bottom && rect.bottom > chat_sec.bottom) \{\
		return true; // Emement partially visible from top\
	\} else if(rect.bottom >= chat_sec.top && rect.top < chat_sec.top) \{\
		return true; // Emement partially visible from bottom\
	\} else \{\
		return false;\
	\}\
\}\
/*\
    Function to extract all the visible images.\
*/\
function getAllCurrentVisibleImages() \{\
	var all_img = document.querySelectorAll("img");\
	var visible_img = [];\
	for(var idx = 0, len = all_img.length; idx < len; idx++) \{\
		var el = all_img[idx];\
		if(isElementInViewport(el)) \{\
			visible_img.push(el);\
		\}\
	\}\
	return visible_img;\
\}\
/*\
    Function to Lazy Load the images.\
*/\
function lazyLoadChatImages() \{\
	var all_img = getAllCurrentVisibleImages();\
	for(var idx = 0, len = all_img.length; idx < len; idx++) \{\
		var el = all_img[idx];\
		if(el === undefined || el === null || el === '') \{\
			continue;\
		\}\
		var cur_src = el.getAttribute('src');\
		if(cur_src !== undefined && cur_src !== null && cur_src !== '' && cur_src.length > 0) \{\
			continue; // SRC already set therefore exiting !\
		\}\
		var orignal_src = el.getAttribute('rsrc_img_data');\
		if(orignal_src === undefined || orignal_src === null || orignal_src === '') \{\
			continue;\
		\}\
		el.setAttribute('src', orignal_src);\
	\}\
\}\
\
function bindChatScrollEvent() \{\
	var el = byId("chat-section-main");\
	el.removeEventListener('scroll', chatScrollEvent, false);\
	el.addEventListener('scroll', chatScrollEvent, false);\
\
	function chatScrollEvent() \{\
		lazyLoadChatImages();\
		// addScrollConv();\
	\}\
\}\
\
function onclickFocus() \{\
	$('.user-name1').on('click', function() \{\
		$("#massage-text").focus();\
	\});\
\}\
/*\
    Function will return JS Element.\
*/\
function byId(id) \{\
	return document.getElementById(id);\
\};\
/*\
    Function will extract the last msg time.\
    whose =  contact (Last message time of Contact.)\
            my      (My Last message time.)\
*/\
function getLastLastReplyTime(whose) \{\
	var search_class = '';\
	whose = (whose === undefined || whose === null) ? 'contact' : whose.toString().toLowerCase().trim();\
	if(whose === 'contact') \{\
		search_class = ".user-message-send";\
	\} else if(whose === 'my') \{\
		search_class = ".message-send";\
	\} else \{\
		return null;\
	\}\
	if($(search_class).length > 0) \{\
		var last_rply = $(search_class)[$(search_class).length - 1];\
		var time_text = $(last_rply).find('span.msg-full-time').text().trim();\
		var date_raw = time_text.split(',')[0] ? time_text.split(',')[0].trim() : '';\
		var time_raw = time_text.split(',')[1] ? time_text.split(',')[1].trim() : '';\
		var day = date_raw.split('-')[0] ? date_raw.split('-')[0].trim() : '';\
		var mon = date_raw.split('-')[1] ? date_raw.split('-')[1].trim() : 1;\
		var year = date_raw.split('-')[2] ? date_raw.split('-')[2].trim() : '';\
		var hr = time_raw.split(':')[0] ? time_raw.split(':')[0].trim() : '';\
		var min = time_raw.split(':')[1] ? time_raw.split(':')[1].trim() : '';\
		var last_msg_date_obj = new Date(year, mon - 1, day, hr, min);\
		return last_msg_date_obj;\
	\} else \{\
		return null;\
	\}\
\}\
\
function showContactTypeOnChat(type_msg) \{\
    if ($('#conCode').length > 0 ) \{\
        return;\
    \}\
    /*\
        --------------+-----------------------------------------------------------------------\
        contacts_type |         Origin Of Contact\
        --------------+-----------------------------------------------------------------------\
          Null        |     When default contact are added having only gl_id (through ASTBUY)\
            1         |     Adding New Contact and Glusr_id does not exist in IM\
            2         |     Editing Contact of type = null | 50 | 51 | 52 | 53 | 54 | 55 | 56\
            3         |     Editing Contact of type = 1\
           11         |     Adding New Contact and Glusr_id exist in IM\
           12         |     Editing Contact of type = 11\
           50         |     Enquiry (ASTBuy)\
           51         |     Enquiry (Direct)\
           52         |     PNS\
           53         |     C2C\
           54         |     BuyLead purchased\
           55         |     Payment\
           56         |     Contact added via reply from Lead Manager\
        --------------+-----------------------------------------------------------------------\
    */\
    var first_chat          = $(".chatMain").children()[0];\
    var contact_origin_txt = type_msg;\
    if(contact_origin_txt)\
	\{if(contact_origin_txt.trim() !== '')\{\
\
        var skeleton = '<div class="s_c_type">'+\
                            '<div class="contact-source-div">'+\
                                '<p style="font-size: 13px; margin-top: 4px;">'+contact_origin_txt+'</p>'+\
                            '</div>'+\
                        '</div>';\
        if(first_chat === undefined || first_chat === null)\{\
            if($('#error_no_enq'))\
                $( skeleton ).insertBefore('#error_no_enq');\
            else\
                $( skeleton ).insertBefore('#reply_text');\
        \}\
        else\{\
            $( skeleton ).insertBefore($(first_chat));\
        \}\
    \}\
\}\
\}\
\
function getSuggestedReplies(flag, rcv_msg_arr) \{\
	var catlog_handling = 0;\
	if(flag) \{\
		resp_obj = \{\
			"enquiry_id": 1,\
			"product_id": 0,\
			"enquiry": "",\
			"initiated_by": ""\
		\};\
		var messages = [];\
		var th_sender = '';\
		var glid = parseInt(byId('trackid').value);\
		if(typeof CONV_DATA === "undefined") CONV_DATA = '';\
		for(var idx = 0, len = CONV_DATA.length; idx < len; idx++) \{\
			var itm = CONV_DATA[idx];\
			var msg_ref_type = itm.msg_ref_type.toLowerCase();\
			var filter_msg = stripHtml(itm.msg_text);\
			filter_msg = filter_msg.replace(/\\n/g, "\\\\\\\\n");\
			if(msg_ref_type == 'reply' || msg_ref_type == 'enq' || msg_ref_type == 'bl' || msg_ref_type == 'pns') \{\
				if(msg_ref_type == "enq" || msg_ref_type == 'pns' || msg_ref_type == 'bl') \{\
					var enq_sender = parseInt(itm.msg_sender_id);\
					//byId('msg_enq_sender_js').value = enq_sender;\
					$('#msg_enq_sender_js').val(enq_sender);\
					resp_obj["enquiry_id"] = itm.msg_query_id !== "" ? parseInt(itm.msg_query_id) : "";\
					resp_obj["initiated_by"] = 'B';\
					if(msg_ref_type == "enq" || msg_ref_type == 'bl') \{\
						resp_obj["product_id"] = itm.msg_mcat_id !== "" ? parseInt(itm.msg_mcat_id) : 0;\
						resp_obj["enquiry"] = filter_msg !== "" ? filter_msg : "";\
						break;\
					\}\
				\} else if(msg_ref_type == 'reply' && itm.msg_query_type != 'C' && itm.msg_query_type != 'V' && itm.msg_query_type != 'W') \{\
					if(itm.msg_alignment == 'right') catlog_handling++;\
					IF_SELLER_REPLIED = true;\
					if(catlog_handling >= 2) \{\
						IF_SELLER_REPLIED_TWICE = true;\
					\}\
					if(itm.msg_alignment == "left" || (messages.length > 0 && messages[0].msg_align == "left") /*&& messages.length <= 0 */ ) messages.push(\{\
						"message": filter_msg,\
						"person_id": parseInt(itm.msg_sender_id),\
						"msg_align": itm.msg_alignment\
					\});\
				\}\
				if(itm.msg_query_type == 'C' || itm.msg_query_type == 'V' || itm.msg_query_type == 'W') \{\
					if(idx == len - 1) \{\
						resp_obj["enquiry_id"] = 1;\
						resp_obj["product_id"] = 0;\
						resp_obj["enquiry"] = "";\
						var enq_sender = parseInt(itm.msg_sender_id);\
						if(enq_sender !== "" && enq_sender !== undefined && enq_sender !== null) $('#msg_enq_sender_js').val(enq_sender); //byId('msg_enq_sender_js').value = enq_sender;\
						if(enq_sender == glid) resp_obj["initiated_by"] = 'B';\
						else resp_obj["initiated_by"] = 'S';\
					\} else \{\
						if(itm.msg_alignment == 'right') catlog_handling++;\
						IF_SELLER_REPLIED = true;\
						if(catlog_handling >= 2) \{\
							IF_SELLER_REPLIED_TWICE = true;\
						\}\
						if(itm.msg_alignment == "left" || (messages.length > 0 && messages[0].msg_align == "left") /*&& messages.length <= 0*/ ) messages.push(\{\
							"message": filter_msg,\
							"person_id": parseInt(itm.msg_sender_id),\
							"msg_align": itm.msg_alignment\
						\});\
					\}\
				\}\
			\}\
		\}\
		/*if(resp_obj["enquiry_id"] == "" && resp_obj["product_id"] == "")\{\
		    ML_ARRAY    =   [];\
		    $('.suggested_reply_nav').remove();\
		    return false;\
		\}*/\
		messages.reverse();\
		for(var idx1 = 0, len = messages.length; idx1 < len; idx1++) \{\
			var itm = messages[idx1];\
			itm['seq'] = idx1 + 1;\
			if(enq_sender == parseInt(itm.person_id)) th_sender = 'B';\
			else th_sender = 'S';\
			itm['b_s'] = th_sender;\
		\}\
		if(messages.length > 0) resp_obj["messages"] = messages;\
	\} else \{\
		var enq_sender = '';\
		var msg_glid = rcv_msg_arr['person_id'];\
		if(byId('msg_enq_sender_js') != null) enq_sender = byId('msg_enq_sender_js').value;\
		if(enq_sender == parseInt(msg_glid)) var th_sender = 'B';\
		else var th_sender = 'S';\
		rcv_msg_arr['b_s'] = th_sender;\
		if(resp_obj["messages"] != undefined && resp_obj["messages"].length > 0) \{\
			var messages = resp_obj["messages"];\
			var resp_length = parseInt(messages.length) + 1;\
			rcv_msg_arr['seq'] = resp_length;\
		\} else \{\
			var messages = [];\
			rcv_msg_arr['seq'] = 1;\
		\}\
		messages.push(rcv_msg_arr);\
		resp_obj["messages"] = messages;\
		if(resp_obj["enquiry_id"] == "" && resp_obj["product_id"] == "") \{\
			$('.suggested_reply_nav').remove();\
			return false;\
		\}\
	\}\
	if(enq_sender == glid && resp_obj["messages"] == undefined) \{ //if only topic is initiated\
		IF_SELLER_REPLIED = true;\
		ML_ARRAY = [];\
		ML_ARRAY = [\{\
			"response": "Waiting for your reply",\
			"score": null\
		\}, \{\
			"response": "What will be the minimum quantity and best price?",\
			"score": null\
		\}, \{\
			"response": "I need to see some samples before placing the order",\
			"score": null\
		\}, \{\
			"response": "Do you deliver in:",\
			"score": null\
		\}, \{\
			"response": "Please send some product images.",\
			"score": null\
		\}, \{\
			"response": "Is the product currently in stock?",\
			"score": null\
		\}];\
		createSuggestedReplyHtml();\
		return false;\
	\}\
	resp_obj['modid'] = "MY";\
	var service_resp_obj = JSON.stringify(resp_obj);\
	service_resp_obj = service_resp_obj.replace(/<(?:.|\\n)*?>/gm, ' '); //code to replace html tags from the sugg array data\
	url = '/enquiry/messagecentre/GetSuggestedReplies';\
	$.ajax(\{\
		url: url,\
		data: \{\
			"suggArr": service_resp_obj\
		\},\
		dataType: "json",\
		type: "POST",\
		success: function(jsonResult) \{\
			if(jsonResult != null && jsonResult != undefined) \{\
				mltemplateused = 1;\
				ML_ARRAY = jsonResult[0].reply;\
				createSuggestedReplyHtml();\
				//logResponse(resp_obj, jsonResult); \
			\} else \{\
				$('.suggested_reply_nav').remove();\
				ML_ARRAY = [];\
				getGAEventTrackingJS("messagecentre", "GetSuggestedReplies_null", glid);\
				ML_ARRAY = [\{\
					"response": "Waiting for your reply",\
					"score": null\
				\}, \{\
					"response": "What will be the minimum quantity and best price?",\
					"score": null\
				\}, \{\
					"response": "I need to see some samples before placing the order",\
					"score": null\
				\}, \{\
					"response": "Do you deliver in:",\
					"score": null\
				\}, \{\
					"response": "Please send some product images.",\
					"score": null\
				\}, \{\
					"response": "Is the product currently in stock?",\
					"score": null\
				\}];\
				createSuggestedReplyHtml();\
			\}\
		\},\
		error: function(err) \{\
			$('.suggested_reply_nav').remove();\
			ML_ARRAY = [];\
			getGAEventTrackingJS("messagecentre", "GetSuggestedReplies_error", glid);\
			ML_ARRAY = [\{\
				"response": "Waiting for your reply",\
				"score": null\
			\}, \{\
				"response": "What will be the minimum quantity and best price?",\
				"score": null\
			\}, \{\
				"response": "I need to see some samples before placing the order",\
				"score": null\
			\}, \{\
				"response": "Do you deliver in:",\
				"score": null\
			\}, \{\
				"response": "Please send some product images.",\
				"score": null\
			\}, \{\
				"response": "Is the product currently in stock?",\
				"score": null\
			\}];\
			createSuggestedReplyHtml();\
		\}\
	\});\
\}\
\
function createSuggestedReplyHtml() \{\
	$('.suggested_reply_nav').remove();\
	var template_html = '';\
	var temp_class = 'suggested_reply_nav';\
	if(ML_ARRAY == undefined) ML_ARRAY = [];\
	for(var i = 0; i < ML_ARRAY.length; i++) \{\
		var tempId = 'l1_' + i;\
		var onclick = "getGAEventTrackingJS('Suggestive_Replies','suggestive_reply_" + (i + 1) + "','MY'); sendtypeofcode('ML_Template');";\
		if(ML_ARRAY[i].response != null) \{\
			var response_trunc = ML_ARRAY[i].response;\
			var in_list = auto_msg_list.indexOf(response_trunc);\
			if(in_list == -1) var in_icon = "<span title=\\"Edit\\" class=\\"fa fa-pencil\\" id=\\"down_temp_icon\\" style=\\"margin-left: 6px;\\"></span>";\
			else var in_icon = "<span title=\\"Send\\" class=\\"bg-msg ico Msg-snd-auto\\" id=\\"down_temp_icon\\"></span>";\
			response_trunc = response_trunc.length > 25 ? response_trunc.substring(0, 22) + "..." : response_trunc;\
			template_html = template_html + "<div class=\\"slr-chatSgtnBlk " + temp_class + "\\" id=\\"" + tempId + "\\" onclick=\\"fillSuggestedTemplate(event);" + onclick + "\\" title=\\"" + ML_ARRAY[i].response + "\\" value=\\"" + ML_ARRAY[i].response + "\\">" + response_trunc + in_icon + "</div>";\
		\}\
	\}\
	/*if(!IF_SELLER_REPLIED)\{\
	    resetSuggestedRepliesNavBar();\
	    return;\
	\}*/\
	if($('#quick_reply_list_div .last_reply_nav').length == 1) \{\
		$(template_html).insertAfter('.last_reply_nav');\
	\} else if($('#quick_reply_list_div .reply_cat_link_nav').length == 1) \{\
		$(template_html).insertAfter('.reply_cat_link_nav');\
	\} else if($('#quick_reply_list_div #sug_2').length == 1) \{\
		$(template_html).insertBefore('#quick_reply_list_div #sug_2');\
	\} else \{\
		$('#quick_reply_list_div').html(template_html);\
	\}\
	if(IF_SELLER_REPLIED_TWICE) \{\
		changeCatalogLinkPos(IF_SELLER_REPLIED_TWICE);\
	\} else \{\
		changeCatalogLinkPos(IF_SELLER_REPLIED_TWICE);\
	\}\
	resetSuggestedRepliesNavBar();\
\}\
\
function fillSuggestedTemplate(event) \{\
	//$('#supp_rat').css("display", "none"); //popup 2 //priya //commented //shikha\
	$('.send_button').css(\{\
		'background':'#02887d',\
		'cursor': 'pointer'\
	\});\
	$('.slr-chatSgtnBlk').removeClass('msgctr_svrep_clkd');\
	$(".msg-placeholder").hide();\
	var msg_desc = event.currentTarget.getAttribute('value');\
	msg_desc = htmlEscape(msg_desc);\
	msg_desc = decodeEntities(msg_desc);\
	$("#massage-text").val(msg_desc);\
	$('#temp_main').hide();\
	if(event.currentTarget.classList[0].trim() == 'slr-chatSgtnBlk') \{\
		$(event.currentTarget).addClass('msgctr_svrep_clkd');\
	\}\
	$("#massage-text").focus();\
	//when user clicks the suggestive in down form\
	var usr_id = event.currentTarget.getAttribute('id');\
	if(usr_id.indexOf('l1_') !== -1) \{\
		var msg_desc = $('#' + usr_id).attr("title")\
		var a = auto_msg_list.indexOf(msg_desc);\
		if(a != -1) \{\
			trackEvent('messagecentre', 'down_ml_auto_sug_send');\
			temp_display_msg();\
		\} else \{\
			trackEvent('messagecentre', 'down_ml_auto_sug_edit');\
		\}\
	\}\
\
	// for updating position_flag\
	let idx = $('#quick_reply_list_div').children().index(event.currentTarget);\
	position_flag = idx + 1;\
\}\
\
function stripHtml(text) \{\
	var stripedText = '';\
	stripedText = text.replace(/<strong>/g, ' ');\
	stripedText = stripedText.replace(/<strong\\/>/g, ' ');\
	stripedText = stripedText.replace(/<\\/strong>/g, ' ');\
	stripedText = stripedText.replace(/<br>/g, '\\n');\
	stripedText = stripedText.replace(/<br\\/>/g, '\\n');\
	stripedText = stripedText.replace(/<\\/br>/g, '\\n');\
	return stripedText;\
\}\
\
function updateMLResponse(msg, glid) \{\
	IF_SELLER_REPLIED = true;\
	if(resp_obj["messages"] != undefined) \{\
		var messages = resp_obj["messages"];\
		var resp_length = parseInt(messages.length) + 1;\
	\} else \{\
		var messages = [];\
		var resp_length = 1;\
	\}\
	if(byId('msg_enq_sender_js') != null) var enq_sender = byId('msg_enq_sender_js').value;\
	if(enq_sender == parseInt(glid)) var th_sender = 'B';\
	else var th_sender = 'S';\
	var rcv_msg_array = \{\
		"message": msg,\
		"person_id": parseInt(glid),\
		"msg_align": "right",\
		"seq": resp_length,\
		"b_s": th_sender\
	\};\
	messages.push(rcv_msg_array);\
	resp_obj["messages"] = messages;\
	chatSectionHeight();\
\}\
\
function isSuggestiveRepliesEnabled() \{\
	/*Earlier we enabled suggestive for few user but now it has been lived for all. hence commenting the code now to stop the controller hit and setting the value here as default which is used in further programming...*/\
	IS_SUGGESTED_REPLY = 1;\
	/*var element = document.getElementById('trackid');\
        if (element != null) \{\
            var glid = element.value;\
        \}\
        else \{\
            var glid = '';\
        \}\
        //var glid = byId('trackid').value;\
    \
        var url = '/enquiry/messagecentre/isSuggestiveRepliesEnabled';\
        $.ajax(\{\
            url         : url,\
            dataType    : "json",\
            type        : "POST",\
            data        : \{"glusrid" : glid\},\
            success     : function(jsonResult)\{\
                if(jsonResult)\{\
                    IS_SUGGESTED_REPLY = 1;\
                \} else\{\
                    console.log("Not authorised to use suggestive replies.");\
                \}\
            \},\
            error       : function(err)\{\
                    console.log("Not authorised to use suggestive replies.");\
            \}\
        \}); */\
\}\
\
function resetSuggestedRepliesNavBar() \{\
	$("#quick_reply_list_div").css('left', '0');\
	$("#leftArrow").css('color', '#999');\
	$("#rightArrow").css('color', '#000');\
	quickReplyNavigation();\
\}\
\
\
//supplier rating code from user in msg chat\
var rate_from_popup =0;\
function rateSupplier() \{\
var rating_from_popup = 0;\
rating_ppop = 1;\
\
if(rate_from_popup==1)\
\{\
	$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight);\
\
rate_from_popup =0;\}\
	\
	\
	$('#toSaveRatingFromEmail').val('');\
	// 	console.log('rateSupplier i.e SAVE RATING');\
	var ModrefType = $("#MODREFTYPE").val();\
	\
	var val_isLandingFromEmail = extractContactGlidFromUrl('isLandingFromEmail=');\
	var radioValue = '';\
	var radioValue = $("input[name='star']:checked").val();\
	var rating_modid = 'MY';\
	var buyer_glid = parseInt($('#trackid').val());\
	var supplier_glid = trim(document.getElementById('contactglid').value);\
	var givenrating = $('#given_sup_rating').text();\
	var starRating = givenrating.split(' ')[0];\
	var rating_value = '';\
	if(radioValue == undefined) rating_value = starRating;\
	else rating_value = radioValue;\
\
	// bs_rating_type to identify whether the person who is rating a seller or a buyer\
	var bs_rating_type = $('#bs_rating_type').val();\
	\
	//\
	// modref id = msg_query_id is the ID of the product that the two people are talking about\
	var msg_query_id_MODREF = $('#msg_query_id_MODREF').val();\
\
\
	//       console.log('Rating val '+rating_value);\
	var rating_comment = $("#addComment").val();\
	var rating_param_id = $("#rate_sel_val").val();\
	var location_obj = getLocationDetailOfUser();\
	if(location_obj.IP_COUNTRY === '' || location_obj.GEOIP_COUNTRY_ISO === '' || location_obj.IPADDRESS === '') \{\
		console.log("LOCATION DETAILS NOT PRESENT !!\\nCannot Rate the Supplier");\
		return;\
	\}\
	var rating_img_arr = \{\};\
	var img_arr = document.getElementsByName('val_ratingImg[]');\
	var img_arr_size = img_arr.length;\
	var j = 0;\
	for(var i = 1; i <= img_arr_size; i++) \{\
		var rating_img = \{\};\
		var img_id_arr = $("#val_id_ratingImg" + i).val();\
		var img_ori_arr = $("#val_ori_ratingImg" + i).val();\
		var img_125_arr = $("#val_125_ratingImg" + i).val();\
		//                 var img_250_arr =$("#val_250_ratingImg"+i).val();\
		var img_500_arr = $("#val_500_ratingImg" + i).val();\
		rating_img['IMG_ID'] = img_id_arr;\
		rating_img['IMG_DOC_PATH'] = img_ori_arr;\
		rating_img['IMG_DOC_125X125'] = img_125_arr;\
		rating_img['IMG_DOC_500X500'] = img_500_arr;\
		rating_img_arr[j] = rating_img;\
		j++;\
	\}\
	var rating_img_json = JSON.stringify(rating_img_arr);\
	// 	console.log('Imgs '+rating_img_json);\
	var influentialParams = '';\
       if(document.getElementById("infuentialParams"))\{\
                       var ratingZero = "";\
                       var ratingOne = "";\
            var ratingOneText = "";\
            var ratingZeroText = "";\
                       var ratingEls = document.getElementsByClassName('f1 thumb_bx');\
                       for(var i = 0; i < ratingEls.length; i++)\{\
                               var str = ratingEls[i].value;\
                               if(str==null||str=='')\{\
                                               continue;\
                               \}else\{\
                                               if(str.substr(0,1)=='0')\{\
                                                       if(ratingZero!="")\{\
                                                                       ratingZero += ",";\
                                                                       ratingZeroText += ",";\
                                                       \}\
                                                       ratingZero += str.substr(2);\
                                                       ratingZeroText += document.getElementsByClassName('f1 thumb_bx')[i].parentElement.getElementsByClassName('f1 tx_l')[0].innerText;\
                                               \}else\{\
                                                       if(ratingOne!="")\{\
                                                                       ratingOne += ",";\
                                                                       ratingOneText += ",";\
                                                       \}\
                                                       ratingOne += str.substr(2);      \
                                                       ratingOneText += document.getElementsByClassName('f1 thumb_bx')[i].parentElement.getElementsByClassName('f1 tx_l')[0].innerText;\
                                               \}\
                               \}\
                       \}\
                       if(ratingZero!=""&&ratingOne!="")\{\
                               influentialParams = \{"0":ratingZero,"1":ratingOne\};\
	                      \}else if(ratingOne!="")\{\
                               influentialParams = \{"1":ratingOne\};\
                       \}else if(ratingZero!="")\{\
                               influentialParams = \{"0":ratingZero\};\
                       \}\
       \}\
\
	   //console.log(JSON.stringify(influentialParams));\
	   \
\
	   //-------- functionality to display thumbs up and down in box 3 -------------\
\
\
	   var ratingHTML =  '';\
	   ratingHTML += `</div>`;\
	   if(influentialParams != '')\{\
			 ratingHTML += `<div class="param">`;\
			 if(ratingOneText != '')\{\
				   ratingHTML += `<svg style="position: relative;top: 3px" xmlns="http://www.w3.org/2000/svg" width="21px" height="21px" viewBox="0 0 21 21" version="1.1"> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" style="fill: green;"><g transform="translate(-224.000000, -415.000000)" fill-rule="nonzero" stroke="#979797"><g transform="translate(224.000000, 416.000000)"><path d="M0.5,7.96875 L0.5,16.46875 C0.5,17.0555114 0.779808125,17.53125 1.125,17.53125 L3,17.53125 L3,6.90625 L1.125,6.90625 C0.779808125,6.90625 0.5,7.38192381 0.5,7.96875 Z" id="Path" fill="#979797"></path><path d="M13.6239641,6.64034609 C13.280908,6.64034609 13.1090566,6.41142648 13.0513403,6.31285438 C12.993624,6.21493105 12.8768938,5.95358594 13.0429098,5.65397953 C13.5301452,2.16116219 13.5716453,0.364387031 13.1674101,0.263654063 L12.1920683,0.0198182813 C11.9547177,-0.0398436172 11.7031005,0.0360308359 11.537733,0.219556328 L6.24210015,6.10273836 C5.69282218,6.71427219 5.39062195,7.50284773 5.39062195,8.32384148 L5.39062195,15.2731493 C5.39062195,17.1038634 6.88022038,18.5934618 8.71093445,18.5934618 L15.3171876,18.5928133 C16.8087384,18.5928133 18.1258399,17.5882886 18.5194696,16.1505641 L19.9370837,9.64482343 C19.9785876,9.46389296 19.999988,9.27842163 19.999988,9.09295163 C19.999988,7.74082741 18.8994864,6.64032976 17.5473662,6.64032976 L13.6239641,6.64034609 Z" id="Path"></path></g></g></g></svg> `+ratingOneText;\
				   if(ratingZeroText != '')\{\
						 ratingHTML += `&nbsp; `;\
				   \}\
			 \}\
			 if(ratingZeroText != '')\{\
				   ratingHTML += `<svg style="position: relative;top: 7px" xmlns="http://www.w3.org/2000/svg" width="21px" height="21px" viewBox="0 0 21 21" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" style="fill: red;"><g transform="translate(-293.000000, -361.000000)" fill-rule="nonzero" stroke="#979797"><g transform="translate(304.000000, 371.375000) scale(-1, -1) translate(-304.000000, -371.375000) translate(294.000000, 362.000000)"><path d="M0.5,7.96875 L0.5,16.46875 C0.5,17.0555114 0.779808125,17.53125 1.125,17.53125 L3,17.53125 L3,6.90625 L1.125,6.90625 C0.779808125,6.90625 0.5,7.38192381 0.5,7.96875 Z" id="Path" fill="#979797"></path><path d="M13.6239641,6.64034609 C13.280908,6.64034609 13.1090566,6.41142648 13.0513403,6.31285438 C12.993624,6.21493105 12.8768938,5.95358594 13.0429098,5.65397953 C13.5301452,2.16116219 13.5716453,0.364387031 13.1674101,0.263654063 L12.1920683,0.0198182813 C11.9547177,-0.0398436172 11.7031005,0.0360308359 11.537733,0.219556328 L6.24210015,6.10273836 C5.69282218,6.71427219 5.39062195,7.50284773 5.39062195,8.32384148 L5.39062195,15.2731493 C5.39062195,17.1038634 6.88022038,18.5934618 8.71093445,18.5934618 L15.3171876,18.5928133 C16.8087384,18.5928133 18.1258399,17.5882886 18.5194696,16.1505641 L19.9370837,9.64482343 C19.9785876,9.46389296 19.999988,9.27842163 19.999988,9.09295163 C19.999988,7.74082741 18.8994864,6.64032976 17.5473662,6.64032976 L13.6239641,6.64034609 Z" id="Path"></path></g></g></g></svg> ` + ratingZeroText;\
			 \}\
			 ratingHTML += `</div>`;\
	   \}\
	   document.getElementById('thumbs_box3').innerHTML = ratingHTML;\
\
\
\
	   //-----------------------------------------------------------------\
\
	if ($("#bs_rating_type").val() == "S") \
	\{influentialParams = "";\
	var rating_comment1 = rating_comment;\
	 rating_comment1 = rating_comment1.split(" ").join("")\
     if(!rating_comment1)\{\
		 document.getElementById('error msg').style.display= "block";\
		 return;\
	 \}\
	 else\
	 document.getElementById('error msg').style.display= "none";\
\
\}\
	\
if(document.getElementById("myModal5").style.display=="block")\{\
	attaching();\
	checksubmit();\
	place_review_bottom();\
	rating_from_popup = 1;\
\}\
	var rating_type_temp = 1;\
	\
	if(val_isLandingFromEmail == 1 || rating_from_popup == 1)\
	\{\
		rating_type_temp = 4;\
		/*vinay*/yandex_impression_my('rating_landing_from_email_onclick_save_start');\
	\}\
	$("#confirmSpan").children().prop("disabled", true);\
\
	var RATING_MCAT_ID = document.getElementById('last_mcat_id').value;\
	var RATING_MCAT_NAME = document.getElementById('last_mcat_name').value;\
	var RATING_MODREF_NAME = document.getElementById('last_transaction_prodName').value ;\
	$.ajax(\{\
		url: '/enquiry/messagecentre/supplierRating', //priya\
		data: \{\
			"RATING_MODID": 'MY',\
			"BUYER_ID": buyer_glid,\
			"SUPPLIER_ID": supplier_glid,\
			"RATING_VAL": rating_value,\
			"UPDATEDBY": 'USER',\
			"UPDATEDUSING": 'BUYER MY',\
			"IP_COUNTRY": location_obj.IP_COUNTRY,\
			"IP": location_obj.IPADDRESS,\
			"RATING_COMMENTS": rating_comment,\
			"RATING_TYPE": rating_type_temp,\
			"RATING_SOURCE": -111,\
			"RATING_PARAMETER": '',\
			"MODREF_ID": msg_query_id_MODREF,\
			"DISPLAY_STATUS": 0,\
			"VALIDATION_KEY": "5cca91f15b8c8ddd91c0fc7abfebc0c7",\
			"FK_GLUSR_RATING_INFLU_PARAM_ID": influentialParams,\
			"RATING_IMGS": rating_img_json,\
			"BS_RATING_TYPE": bs_rating_type,\
			"MODREFTYPE": ModrefType,\
			"RATING_MCAT_ID":RATING_MCAT_ID,\
			"RATING_MCAT_NAME":RATING_MCAT_NAME,\
			"RATING_MODREF_NAME":RATING_MODREF_NAME,\
		\},\
		dataType: "JSON",\
		type: "POST",\
		success: function(result) \{\
			if(result.failure != "" && result.failure == "Authorization Fail") \{\
				console.log(result);\
				if(val_isLandingFromEmail == 1)\
				\{\
					/*vinay*/yandex_impression_my('rating_landing_from_email_onclick_save_failed');\
				\}\
				window.location.reload();\
			\}\
			console.log(result);\
			if(result == 1) \{\
				if(val_isLandingFromEmail == 1)\
				\{\
					/*vinay*/yandex_impression_my('rating_landing_from_email_onclick_save_success');\
				\}\
				$('#oldImg').html('');\
				$('#supp_rat').css("display", "none");\
				get_rateSupplier();\
				if(val_isLandingFromEmail == 1)\
				\{\
					window.location = window.location.href.substr(0, window.location.href.indexOf("&isLandingFromEmail="));\
				\}\
			\}\
			$("#confirmSpan").children().prop("disabled", false);\
		\}\
	\});\
	/*category = 'messagecentre';  \
	trackEvent(category, 'rateSupplier');*/\
	// getGAEventTrackingJS("supplier_rating","click_submit",'MY');\
	yandex_impression_pers('supplier_rating_click_submit_MY');\
\}\
function rateSupplier_from_email() \{\
	// $('#toSaveRatingFromEmail').val('');\
	$('#massage-text').css('height','30px');\
	chatSectionHeight();\
	console.log('rateSupplier via email');\
	/*vinay*/yandex_impression_my('rating_landing_from_email_automatic_save_start');\
	var radioValue = '';\
	var radioValue = $("input[name='star']:checked").val();\
	var rating_modid = 'MY';\
	var buyer_glid = parseInt($('#trackid').val());\
	var supplier_glid = trim(document.getElementById('contactglid').value);\
	var givenrating = $('#given_sup_rating').text();\
	var starRating = givenrating.split(' ')[0];\
	var rating_value = '';\
	if(radioValue == undefined) rating_value = starRating;\
	else rating_value = radioValue;\
	//       console.log('Rating val '+rating_value);\
	var rating_comment = $("#addComment").val();\
	var rating_param_id = $("#rate_sel_val").val();\
	var location_obj = getLocationDetailOfUser();\
	if(location_obj.IP_COUNTRY === '' || location_obj.GEOIP_COUNTRY_ISO === '' || location_obj.IPADDRESS === '') \{\
		console.log("LOCATION DETAILS NOT PRESENT !!\\nCannot Rate the Supplier");\
		return;\
	\}\
	var rating_img_arr = \{\};\
	var img_arr = document.getElementsByName('val_ratingImg[]');\
	var img_arr_size = img_arr.length;\
	var j = 0;\
	for(var i = 1; i <= img_arr_size; i++) \{\
		var rating_img = \{\};\
		var img_id_arr = $("#val_id_ratingImg" + i).val();\
		var img_ori_arr = $("#val_ori_ratingImg" + i).val();\
		var img_125_arr = $("#val_125_ratingImg" + i).val();\
		//                 var img_250_arr =$("#val_250_ratingImg"+i).val();\
		var img_500_arr = $("#val_500_ratingImg" + i).val();\
		rating_img['IMG_ID'] = img_id_arr;\
		rating_img['IMG_DOC_PATH'] = img_ori_arr;\
		rating_img['IMG_DOC_125X125'] = img_125_arr;\
		rating_img['IMG_DOC_500X500'] = img_500_arr;\
		rating_img_arr[j] = rating_img;\
		j++;\
	\}\
	var rating_img_json = JSON.stringify(rating_img_arr);\
\
	var influentialParams = '';\
       if(document.getElementById("infuentialParams"))\{\
                       var ratingZero = "";\
                       var ratingOne = "";\
            var ratingOneText = "";\
            var ratingZeroText = "";\
                       var ratingEls = document.getElementsByClassName('f1 thumb_bx');\
                       for(var i = 0; i < ratingEls.length; i++)\{\
                               var str = ratingEls[i].value;\
                               if(str==null||str=='')\{\
                                               continue;\
                               \}else\{\
                                               if(str.substr(0,1)=='0')\{\
                                                       if(ratingZero!="")\{\
                                                                       ratingZero += ",";\
                                                                       ratingZeroText += ",";\
                                                       \}\
                                                       ratingZero += str.substr(2);\
                                                       ratingZeroText += document.getElementsByClassName('f1 thumb_bx')[i].parentElement.getElementsByClassName('f1 tx_l')[0].innerText;\
                                               \}else\{\
                                                       if(ratingOne!="")\{\
                                                                       ratingOne += ",";\
                                                                       ratingOneText += ",";\
                                                       \}\
                                                       ratingOne += str.substr(2);      \
                                                       ratingOneText += document.getElementsByClassName('f1 thumb_bx')[i].parentElement.getElementsByClassName('f1 tx_l')[0].innerText;\
                                               \}\
                               \}\
                       \}\
                       if(ratingZero!=""&&ratingOne!="")\{\
                               influentialParams = \{"0":ratingZero,"1":ratingOne\};\
	                      \}else if(ratingOne!="")\{\
                               influentialParams = \{"1":ratingOne\};\
                       \}else if(ratingZero!="")\{\
                               influentialParams = \{"0":ratingZero\};\
                       \}\
       \}\
\
	// 	console.log('Imgs '+rating_img_json);\
	\
	if ($("#bs_rating_type").val() == "S") influentialParams = "";\
\
	$("#confirmSpan").children().prop("disabled", true);\
	var RATING_MCAT_ID = document.getElementById('last_mcat_id').value;\
	var RATING_MCAT_NAME = document.getElementById('last_mcat_name').value;\
	var RATING_MODREF_NAME = document.getElementById('last_transaction_prodName').value ;\
\
\
	$.ajax(\{\
		url: '/enquiry/messagecentre/supplierRating', //priya\
		data: \{\
			"RATING_MODID": 'MY',\
			"BUYER_ID": buyer_glid,\
			"SUPPLIER_ID": supplier_glid,\
			"RATING_VAL": rating_value,\
			"UPDATEDBY": 'USER',\
			"UPDATEDUSING": 'BUYER MY',\
			"IP_COUNTRY": location_obj.IP_COUNTRY,\
			"IP": location_obj.IPADDRESS,\
			"RATING_COMMENTS": rating_comment,\
			"RATING_TYPE": 4,\
			"RATING_SOURCE": -111,\
			"RATING_PARAMETER": '',\
			"MODREF_ID": $('#msg_query_id_MODREF').val(),\
			"DISPLAY_STATUS": 0,\
			"VALIDATION_KEY": "5cca91f15b8c8ddd91c0fc7abfebc0c7",\
			"FK_GLUSR_RATING_INFLU_PARAM_ID": influentialParams,\
			"RATING_IMGS": rating_img_json,\
			"BS_RATING_TYPE": $("#bs_rating_type").val(),\
			"MODREFTYPE": $('#MODREFTYPE').val(),\
			"RATING_MCAT_ID":RATING_MCAT_ID,\
			"RATING_MCAT_NAME":RATING_MCAT_NAME,\
			"RATING_MODREF_NAME":RATING_MODREF_NAME,\
		\},\
		dataType: "JSON",\
		type: "POST",\
		success: function(result) \{\
			if(result.failure != "" && result.failure == "Authorization Fail") \{\
				console.log(result);\
				/*vinay*/yandex_impression_my('rating_landing_from_email_automatic_save_failed');\
				window.location.reload();\
                return;\
			\}\
			console.log(result);\
			if(result == 1) \{\
				/*vinay*/yandex_impression_my('rating_landing_from_email_automatic_save_success');\
				console.log('rateSupplier via email done');\
				// $('#oldImg').html('');\
				$('#box1').css("display", "none");\
				get_rateSupplier();\
			\}\
			$("#confirmSpan").children().prop("disabled", false);\
		\}\
	\});\
	/*category = 'messagecentre';  \
	trackEvent(category, 'rateSupplier');*/\
	// getGAEventTrackingJS("supplier_rating","click_submit",'MY');\
	// yandex_impression_pers('supplier_rating_click_submit_MY'); // event tracking\
\}\
\
function handleTimeoutListing(source)\{\
    document.getElementById('fetch_list').innerHTML = `<span style="margin:0 auto;text-align:center;width: 75%;display:block;margin-top: 50%;color: #000;line-height: 150%;"> <i class="fa fa-exclamation-triangle" aria-hidden="true" style="color: #999;font-size: 71px;"></i><br> <b style=" font-size: 15px; color: #333; ">Timeout Error</b><br> <span style="font-size: 13px;">The service encountered an error and could not complete your request.<br><span style=" font-size: 15px; padding-top: 4px; display: block; ">Please try again after 30 seconds</span> </span> <span><i class="fa fa-refresh" aria-hidden="true" style=" font-size: 22px; color: #068c81;cursor:pointer; display: block; margin-top: 5px; " id="listing_timeout"></i></span> </span>`;\
    getGAEventTrackingJS("Server_Error_Messagecentre","Contact_List",'MY');\
    hideScroller();\
    source = source !== undefined || source !== null || source !== '' ? source : 1;\
    if(source==1)\{\
        document.getElementById('listing_timeout').setAttribute('onclick','addContactListLoader();refreshPage();');\
        $('.massage-type-box').css("display", "none");\
        $("#pd15_0").css("display", "none");\
        $('#enq_stat_box_preloader').css("display", "none");\
    \}else if(source=='archive')\{\
        document.getElementById('listing_timeout').setAttribute('onclick','addContactListLoader();showArchivedContacts(true);');\
        $('.massage-type-box').css("display", "none");\
        $("#pd15_0").css("display", "none");\
        $('#enq_stat_box_preloader').css("display", "none");\
    \}\
\}\
\
function refreshPage()\{\
     window.parent.location = window.parent.location.href;\
\}\
\
function get_rateSupplier() \{\
// 	console.log('In get_rateSupplier');\
	var buyer_glid = parseInt($('#trackid').val());\
	var supplier_glid = trim(document.getElementById('contactglid').value);\
	//condition to show sup rating\
	var is_rating_display = $("#is_rating_display").val();\
	var toSaveRatingFromEmail = $("#toSaveRatingFromEmail").val();\
    if ($('#conCode').length > 0 ) \{\
        return;\
    \}\
	if(is_rating_display != undefined) \{\
		$('#oldImg').html('');\
		$.ajax(\{\
			url: '/phpajax/enquiry/messagecentre/getRatingInChat',\
			data: \{\
				"sup_glid": supplier_glid,\
				"buy_glid": buyer_glid,\
			\},\
			dataType: "JSON",\
			type: "POST",\
			success: function(result) \{\
				if(result == null) return;\
				if(result.failure != "" && result.failure == "Authorization Fail") \{\
					console.log(result);\
					window.location.replace('https://my.indiamart.com');\
                    return;\
				\}\
				if(is_rating_display == 0 && result.r == -3) \{\
					return;\
				\}\
				if(is_rating_display == 0 && result.r != -3) \{\
					$('.get_sup_rat').css("display", "block");\
					 $('.chat-section').scrollTop($('.chat-section')[0].scrollHeight + 100);\
					yandex_impression_pers('supplier_rating_display_impression_filled_form');\
					//------------Pop1 start display functionality-----------------\
					var xyz = "s";\
					if(result.r == 1) xyz = '';\
					$('#given_sup_rating').text(result.r + ' star' + xyz); //not in use\
					for(var i = 1; i <= 5; i++) $('#star_col' + i).css("color", "rgba(0,0,0,0.1)");\
					for(var i = 1; i <= result.r; i++) $('#star_col' + i).css("color", "#FFCA00");\
					//-----------Pop2 star display & msg functionality-------------\
					for(var i = 1; i <= result.r; i++) $('#star' + i).css("color", "#fd4");\
					$('#deal' + result.r).css('display', 'block');\
					//-----------Influ Param functionality-------------\
					var arg = result.influ;\
					//if(arg != 0) markDiv(arg);\
							//-- star display in box 2\
					if (result.r >= 1 && result.r <= 5) $("#star-"+result.r).click();\
							// ----\
					//----comment display-------s\
					var comment = result.comment;\
					var nullComment = "";\
					if (comment.length!=0) \{\
						$("#comment_box3").html('<span>\\"' + comment + '\\"</span>');\
						$('#addComment').val(comment);\
					\}\
					else \{\
						$("#comment_box3").text(nullComment);\
						$('#addComment').val(nullComment);\
					\}\
					//------------------Image functionality---------------------------------------\
					var x = result.img;\
					var imgcnt = 0;\
					for(var i = 1; i <= x.length; i++) //priya\
					\{\
						imgcnt++;\
						var j = i - 1;\
						var x_img_id = x[j].IMG_ID;\
						var x_img_ori = x[j].IMG_DOC_PATH;\
						var x_img_125 = x[j].IMG_DOC_125X125;\
						var x_img_250 = x[j].IMG_DOC_250X250;\
						var x_img_500 = x[j].IMG_DOC_500X500;\
						if(x_img_id) \{\
							var opDiv = 'ratingImg';\
							var imgdiv = '<div class="imgD45 rt_centr iPr" id="div_' + opDiv + i + '" name="div_' + opDiv + '[]"><img id="val_' + opDiv + i + '" name="val_' + opDiv + '[]"  src="' + x_img_125 + '" class="imIg" ><input id="val_id_' + opDiv + i + '" name="val_id_' + opDiv + '[]" value="' + x_img_id + '" type="hidden"><input id="val_ori_' + opDiv + i + '" name="val_ori_' + opDiv + '[]" value="' + x_img_ori + '" type="hidden"><input id="val_125_' + opDiv + i + '" name="val_125_' + opDiv + '[]" value="' + x_img_125 + '" type="hidden"><input id="val_250_' + opDiv + i + '" name="val_250_' + opDiv + '[]" value="' + x_img_250 + '" type="hidden"><input id="val_500_' + opDiv + i + '" name="val_500_' + opDiv + '[]" value="' + x_img_500 + '" type="hidden"><span class="iclse iCp" id="delete_' + opDiv + i + '" ></span></div>';\
							$('#oldImg').append(imgdiv);\
							$("#delete_" + opDiv + i).click(function() \{\
								deleteImg('ratingImg', this.id);\
							\});\
							$("#val_" + opDiv + i).click(function() \{\
								showZoom('ratingImg', this.id);\
							\});\
						\}\
					\}\
					if(imgcnt < 5) \{\
						$('#ratingImg').css("display", "block");\
					\}\
\
					\
\
\
					//-------- functionality to display thumbs up and down in box 3 -------------\
					var influentialParams = result.influ;\
                    var value1_influ = [];\
                    if(result.influ != '' && result.influ != undefined && result.influ != "null")\{\
                        var value = JSON.stringify(result.influ);\
                        value_influ = JSON.parse(value);\
                        value1_influ =  JSON.parse(value_influ);\
					\}\
                    \
                   if(0 in value1_influ)\
                   var thmb_down = value1_influ[0];\
                   else\
                   var thmb_down = '';\
                   \
                   if(1 in value1_influ)\
                   var thmb_up = value1_influ[1];\
                   else\
                   var thmb_up = '';\
                    \
					var ratingDwnText = '';\
					var ratingUPText = '';\
\
					if (value1_influ[1] != "-1")\{\
							\
\
					document.getElementById('R0').getElementsByTagName('g')[0].style.fill = '';\
					document.getElementById('R1').getElementsByTagName('g')[0].style.fill = '';\
					document.getElementById('Q0').getElementsByTagName('g')[0].style.fill = '';\
					document.getElementById('Q1').getElementsByTagName('g')[0].style.fill = '';\
					document.getElementById('D0').getElementsByTagName('g')[0].style.fill = '';\
					document.getElementById('D1').getElementsByTagName('g')[0].style.fill = '';\
\
                    \
                    if(thmb_down !== '')\{\
                          for(var i = 0; i < thmb_down.length; i++)\{\
							var c = thmb_down.charAt(i);\
							if (c == '1') \{\
								ratingDwnText += "Response";\
								$('#R0').click();\
							\}\
							else if (c == '2')\{\
                                if(ratingDwnText !== '')\
                                ratingDwnText += ", Quality";\
                                else\
								ratingDwnText += "Quality";\
								$('#Q0').click();\
                            \}\
							else if (c == '3')\{\
                                if(ratingDwnText !== '')\
                                ratingDwnText += ", Delivery";\
                                else\
								ratingDwnText += "Delivery";\
								$('#D0').click();    \
                            \}\
						\}\
                    \}                   \
                    \
                    if(thmb_up !== '')\{\
                        for(var i = 0; i < thmb_up.length; i++)\{\
							var c = thmb_up.charAt(i);\
							if (c == '1') \{\
								ratingUPText += "Response";\
								$('#R1').click();\
							\}\
							else if (c == '2')\{ \
                                if(ratingUPText !== '')\
                                ratingUPText += ", Quality";\
                                else\
								ratingUPText += "Quality";\
								$('#Q1').click();    \
                            \}\
							else if (c == '3')\{\
                                if(ratingUPText !== '')\
                                ratingUPText += ", Delivery";\
                                else\
								ratingUPText += "Delivery";\
								$('#D1').click();  \
                            \}\
						\}\
                    \}\
\
					var ratingHTML =  '';\
					ratingHTML += '</div>';\
					if(influentialParams != '')\{\
							ratingHTML += '<div class="param">';\
							if(ratingUPText != '')\{\
								ratingHTML += '<svg style="position: relative;top: 3px" xmlns="http://www.w3.org/2000/svg" width="21px" height="21px" viewBox="0 0 21 21" version="1.1"> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" style="fill: green;"><g transform="translate(-224.000000, -415.000000)" fill-rule="nonzero" stroke="#979797"><g transform="translate(224.000000, 416.000000)"><path d="M0.5,7.96875 L0.5,16.46875 C0.5,17.0555114 0.779808125,17.53125 1.125,17.53125 L3,17.53125 L3,6.90625 L1.125,6.90625 C0.779808125,6.90625 0.5,7.38192381 0.5,7.96875 Z" id="Path" fill="#979797"></path><path d="M13.6239641,6.64034609 C13.280908,6.64034609 13.1090566,6.41142648 13.0513403,6.31285438 C12.993624,6.21493105 12.8768938,5.95358594 13.0429098,5.65397953 C13.5301452,2.16116219 13.5716453,0.364387031 13.1674101,0.263654063 L12.1920683,0.0198182813 C11.9547177,-0.0398436172 11.7031005,0.0360308359 11.537733,0.219556328 L6.24210015,6.10273836 C5.69282218,6.71427219 5.39062195,7.50284773 5.39062195,8.32384148 L5.39062195,15.2731493 C5.39062195,17.1038634 6.88022038,18.5934618 8.71093445,18.5934618 L15.3171876,18.5928133 C16.8087384,18.5928133 18.1258399,17.5882886 18.5194696,16.1505641 L19.9370837,9.64482343 C19.9785876,9.46389296 19.999988,9.27842163 19.999988,9.09295163 C19.999988,7.74082741 18.8994864,6.64032976 17.5473662,6.64032976 L13.6239641,6.64034609 Z" id="Path"></path></g></g></g></svg> '+ratingUPText;\
								if(ratingDwnText != '')\{\
										ratingHTML += '&nbsp; ';\
								\}\
							\}\
							if(ratingDwnText != '')\{\
								ratingHTML += '<svg style="position: relative;top: 7px" xmlns="http://www.w3.org/2000/svg" width="21px" height="21px" viewBox="0 0 21 21" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" style="fill: red;"><g transform="translate(-293.000000, -361.000000)" fill-rule="nonzero" stroke="#979797"><g transform="translate(304.000000, 371.375000) scale(-1, -1) translate(-304.000000, -371.375000) translate(294.000000, 362.000000)"><path d="M0.5,7.96875 L0.5,16.46875 C0.5,17.0555114 0.779808125,17.53125 1.125,17.53125 L3,17.53125 L3,6.90625 L1.125,6.90625 C0.779808125,6.90625 0.5,7.38192381 0.5,7.96875 Z" id="Path" fill="#979797"></path><path d="M13.6239641,6.64034609 C13.280908,6.64034609 13.1090566,6.41142648 13.0513403,6.31285438 C12.993624,6.21493105 12.8768938,5.95358594 13.0429098,5.65397953 C13.5301452,2.16116219 13.5716453,0.364387031 13.1674101,0.263654063 L12.1920683,0.0198182813 C11.9547177,-0.0398436172 11.7031005,0.0360308359 11.537733,0.219556328 L6.24210015,6.10273836 C5.69282218,6.71427219 5.39062195,7.50284773 5.39062195,8.32384148 L5.39062195,15.2731493 C5.39062195,17.1038634 6.88022038,18.5934618 8.71093445,18.5934618 L15.3171876,18.5928133 C16.8087384,18.5928133 18.1258399,17.5882886 18.5194696,16.1505641 L19.9370837,9.64482343 C19.9785876,9.46389296 19.999988,9.27842163 19.999988,9.09295163 C19.999988,7.74082741 18.8994864,6.64032976 17.5473662,6.64032976 L13.6239641,6.64034609 Z" id="Path"></path></g></g></g></svg> ' + ratingDwnText;\
							\}\
							ratingHTML += '</div>';\
					\}\
					document.getElementById('thumbs_box3').innerHTML = ratingHTML;\
					   \
				\}\
\
				else\{\
					document.getElementById('R0').getElementsByTagName('g')[0].style.fill = '';\
					document.getElementById('R1').getElementsByTagName('g')[0].style.fill = '';\
					document.getElementById('Q0').getElementsByTagName('g')[0].style.fill = '';\
					document.getElementById('Q1').getElementsByTagName('g')[0].style.fill = '';\
					document.getElementById('D0').getElementsByTagName('g')[0].style.fill = '';\
					document.getElementById('D1').getElementsByTagName('g')[0].style.fill = '';\
				\}\
\
\
				//$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight + 100);\
\
				\
					//------------------Click on Edit functionality---------------------------------------\
					$("#tap_edit_rate, #rate_me_now").click(function() \{\
						// body...\
						// var rating_popup = document.getElementById('supp_rat');   \
						// if (rating_popup) document.getElementById('chat-section-main').scrollTo(0,rating_popup.offsetTop - 120);\
						// if ($('.chat-section')[0].scrollHeight - $('.chat-section').scrollTop() == $('.chat-section').outerHeight())\
						// 	\{  $('#supp_rat').css("display", "block");//pop2\
						// 		$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight);\
							\
						// 	\}\
						// 	else\{\
						// 		$('#supp_rat').css("display", "block");//pop2\
						// 	\}	\
						$('#supp_rat').css("display", "block");//pop2\
						document.getElementById('supp_rat').scrollIntoView();\
						$('.get_sup_rat').css("display", "none"); //pop1 \
						\
						$('#box1').css("display", "none");\
						$('#box2').css("display", "flow-root");\
						$("#confirmSpan").children().css('display', 'block'); //pop3-Submit\
						$("#satisfaction_box").css('display', 'inline-block'); //pop3\
						\
						yandex_impression_pers('supplier_rating_click_edit_MY');\
						yandex_impression_pers('supplier_rating_display_impression_new_form');\
					\});\
				\} else \{\
					if(result.r == -3) \{ //when 0 rating is available\
						$('#supp_rat').css("display", "block");\
						$('#ratingImg').css("display", "block");\
						//$('#box1').css("display", "none");\
						//$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight + 100);\
						yandex_impression_pers('supplier_rating_display_impression_new_form');\
					\} else \{\
						$('.get_sup_rat').css("display", "block");\
						//$("box1").css("display", "none");\
						//$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight + 80);\
						yandex_impression_pers('supplier_rating_display_impression_filled_form');\
						//------------Pop1 start display functionality-----------------\
						var xyz = "s";\
						if(result.r == 1) xyz = '';\
						$('#given_sup_rating').text(result.r + ' star' + xyz); //when >1 rating is available\
						for(var i = 1; i <= 5; i++) $('#star_col' + i).css("color", "rgba(0,0,0,0.1)");\
						for(var i = 1; i <= result.r; i++) $('#star_col' + i).css("color", "#FFCA00");\
						//-----------Pop2 star display & msg functionality-------------\
						for(var i = 1; i <= result.r; i++) $('#star' + i).css("color", "#fd4");\
						$('#deal' + result.r).css('display', 'block');\
						//-----------Influ Param functionality-------------\
						var arg = result.influ;\
						//if(arg != 0) markDiv(arg);\
						//-- star display in box 2\
						if (result.r >= 1 && result.r <= 5) $("#star-"+result.r).click();\
						// ----\
						//----comment display-------\
						var comment = result.comment;\
						var nullComment = "";\
						if (comment.length!=0) \{\
							$("#comment_box3").html('<span>\\"' + comment + '\\"</span>');\
							$('#addComment').val(comment);\
						\}\
						else \{\
							$("#comment_box3").text(nullComment);\
							$('#addComment').val(nullComment);\
						\}\
						//------------------Image functionality---------------------------------------\
						var x = result.img;\
						var imgcnt = 0;\
						for(var i = 1; i <= x.length; i++) //priya\
						\{\
							imgcnt++;\
							var j = i - 1;\
							var x_img_id = x[j].IMG_ID;\
							var x_img_ori = x[j].IMG_DOC_PATH;\
							var x_img_125 = x[j].IMG_DOC_125X125;\
							var x_img_250 = x[j].IMG_DOC_250X250;\
							var x_img_500 = x[j].IMG_DOC_500X500;\
							if(x_img_id) \{\
								var opDiv = 'ratingImg'; //shubham\
								var imgdiv = '<div class="imgD45 rt_centr iPr" id="div_' + opDiv + i + '" name="div_' + opDiv + '[]"><img id="val_' + opDiv + i + '" name="val_' + opDiv + '[]"  src="' + x_img_125 + '" class="imIg"><input id="val_id_' + opDiv + i + '" name="val_id_' + opDiv + '[]" value="' + x_img_id + '" type="hidden"><input id="val_ori_' + opDiv + i + '" name="val_ori_' + opDiv + '[]" value="' + x_img_ori + '" type="hidden"><input id="val_125_' + opDiv + i + '" name="val_125_' + opDiv + '[]" value="' + x_img_125 + '" type="hidden"><input id="val_250_' + opDiv + i + '" name="val_250_' + opDiv + '[]" value="' + x_img_250 + '" type="hidden"><input id="val_500_' + opDiv + i + '" name="val_500_' + opDiv + '[]" value="' + x_img_500 + '" type="hidden"><span class="iclse iCp" id="delete_' + opDiv + i + '" ></span></div>'; //onclick="deleteImg(\\''+ opDiv +'\\','+ i +');" //onclick="showZoom(\\''+ opDiv +'\\','+ this.id +')"\
								$('#oldImg').append(imgdiv);\
								//                               setTimeout(function() \{\
								$("#delete_" + opDiv + i).click(function() \{\
									deleteImg('ratingImg', this.id);\
								\});\
								$("#val_" + opDiv + i).click(function() \{\
									showZoom('ratingImg', this.id);\
								\});\
								// 						\}, 3000);\
							\}\
						\}\
						if(imgcnt < 5) \{\
							$('#ratingImg').css("display", "block");\
						\}\
\
						//-------- functionality to display thumbs up and down in box 3 -------------\
						var influentialParams = result.influ;\
                        var value1_influ = [];\
                    if(result.influ != '' && result.influ != undefined && result.influ != "null")\{\
                        var value = JSON.stringify(result.influ);\
                        value_influ = JSON.parse(value);\
                        value1_influ =  JSON.parse(value_influ);\
					\}\
                    \
						if(0 in value1_influ)\
						var thmb_down = value1_influ[0];\
						else\
						var thmb_down = '';\
						\
						if(1 in value1_influ)\
						var thmb_up = value1_influ[1];\
						else\
						var thmb_up = '';\
							\
							var ratingDwnText = '';\
							var ratingUPText = '';\
\
				if (value1_influ[1] != "-1")\{\
\
					document.getElementById('R0').getElementsByTagName('g')[0].style.fill = '';\
					document.getElementById('R1').getElementsByTagName('g')[0].style.fill = '';\
					document.getElementById('Q0').getElementsByTagName('g')[0].style.fill = '';\
					document.getElementById('Q1').getElementsByTagName('g')[0].style.fill = '';\
					document.getElementById('D0').getElementsByTagName('g')[0].style.fill = '';\
					document.getElementById('D1').getElementsByTagName('g')[0].style.fill = '';\
\
                    \
                    if(thmb_down !== '')\{\
                          for(var i = 0; i < thmb_down.length; i++)\{\
							var c = thmb_down.charAt(i);\
							if (c == '1') \{\
								ratingDwnText += "Response";\
								$('#R0').click();\
							\}\
							else if (c == '2')\{\
                                if(ratingDwnText !== '')\
                                ratingDwnText += ", Quality";\
                                else\
								ratingDwnText += "Quality";\
								$('#Q0').click();\
                            \}\
							else if (c == '3')\{\
                                if(ratingDwnText !== '')\
                                ratingDwnText += ", Delivery";\
                                else\
								ratingDwnText += "Delivery";\
								$('#D0').click();    \
                            \}\
						\}\
                    \}                   \
                    \
                    if(thmb_up !== '')\{\
                        for(var i = 0; i < thmb_up.length; i++)\{\
							var c = thmb_up.charAt(i);\
							if (c == '1') \{\
								ratingUPText += "Response";\
								$('#R1').click();\
							\}\
							else if (c == '2')\{ \
                                if(ratingUPText !== '')\
                                ratingUPText += ", Quality";\
                                else\
								ratingUPText += "Quality";\
								$('#Q1').click();    \
                            \}\
							else if (c == '3')\{\
                                if(ratingUPText !== '')\
                                ratingUPText += ", Delivery";\
                                else\
								ratingUPText += "Delivery";\
								$('#D1').click();  \
                            \}\
						\}\
                    \}\
\
					var ratingHTML =  '';\
					ratingHTML += '</div>';\
					if(influentialParams != '')\{\
							ratingHTML += '<div class="param">';\
							if(ratingUPText != '')\{\
								ratingHTML += '<svg style="position: relative;top: 3px" xmlns="http://www.w3.org/2000/svg" width="21px" height="21px" viewBox="0 0 21 21" version="1.1"> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" style="fill: green;"><g transform="translate(-224.000000, -415.000000)" fill-rule="nonzero" stroke="#979797"><g transform="translate(224.000000, 416.000000)"><path d="M0.5,7.96875 L0.5,16.46875 C0.5,17.0555114 0.779808125,17.53125 1.125,17.53125 L3,17.53125 L3,6.90625 L1.125,6.90625 C0.779808125,6.90625 0.5,7.38192381 0.5,7.96875 Z" id="Path" fill="#979797"></path><path d="M13.6239641,6.64034609 C13.280908,6.64034609 13.1090566,6.41142648 13.0513403,6.31285438 C12.993624,6.21493105 12.8768938,5.95358594 13.0429098,5.65397953 C13.5301452,2.16116219 13.5716453,0.364387031 13.1674101,0.263654063 L12.1920683,0.0198182813 C11.9547177,-0.0398436172 11.7031005,0.0360308359 11.537733,0.219556328 L6.24210015,6.10273836 C5.69282218,6.71427219 5.39062195,7.50284773 5.39062195,8.32384148 L5.39062195,15.2731493 C5.39062195,17.1038634 6.88022038,18.5934618 8.71093445,18.5934618 L15.3171876,18.5928133 C16.8087384,18.5928133 18.1258399,17.5882886 18.5194696,16.1505641 L19.9370837,9.64482343 C19.9785876,9.46389296 19.999988,9.27842163 19.999988,9.09295163 C19.999988,7.74082741 18.8994864,6.64032976 17.5473662,6.64032976 L13.6239641,6.64034609 Z" id="Path"></path></g></g></g></svg> '+ratingUPText;\
								if(ratingDwnText != '')\{\
										ratingHTML += '&nbsp; ';\
								\}\
							\}\
							if(ratingDwnText != '')\{\
								ratingHTML += '<svg style="position: relative;top: 7px" xmlns="http://www.w3.org/2000/svg" width="21px" height="21px" viewBox="0 0 21 21" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" style="fill: red;"><g transform="translate(-293.000000, -361.000000)" fill-rule="nonzero" stroke="#979797"><g transform="translate(304.000000, 371.375000) scale(-1, -1) translate(-304.000000, -371.375000) translate(294.000000, 362.000000)"><path d="M0.5,7.96875 L0.5,16.46875 C0.5,17.0555114 0.779808125,17.53125 1.125,17.53125 L3,17.53125 L3,6.90625 L1.125,6.90625 C0.779808125,6.90625 0.5,7.38192381 0.5,7.96875 Z" id="Path" fill="#979797"></path><path d="M13.6239641,6.64034609 C13.280908,6.64034609 13.1090566,6.41142648 13.0513403,6.31285438 C12.993624,6.21493105 12.8768938,5.95358594 13.0429098,5.65397953 C13.5301452,2.16116219 13.5716453,0.364387031 13.1674101,0.263654063 L12.1920683,0.0198182813 C11.9547177,-0.0398436172 11.7031005,0.0360308359 11.537733,0.219556328 L6.24210015,6.10273836 C5.69282218,6.71427219 5.39062195,7.50284773 5.39062195,8.32384148 L5.39062195,15.2731493 C5.39062195,17.1038634 6.88022038,18.5934618 8.71093445,18.5934618 L15.3171876,18.5928133 C16.8087384,18.5928133 18.1258399,17.5882886 18.5194696,16.1505641 L19.9370837,9.64482343 C19.9785876,9.46389296 19.999988,9.27842163 19.999988,9.09295163 C19.999988,7.74082741 18.8994864,6.64032976 17.5473662,6.64032976 L13.6239641,6.64034609 Z" id="Path"></path></g></g></g></svg> ' + ratingDwnText;\
							\}\
							ratingHTML += '</div>';\
					\}\
					document.getElementById('thumbs_box3').innerHTML = ratingHTML;\
\
					\}\
\
					else\{\
						document.getElementById('R0').getElementsByTagName('g')[0].style.fill = '';\
						document.getElementById('R1').getElementsByTagName('g')[0].style.fill = '';\
						document.getElementById('Q0').getElementsByTagName('g')[0].style.fill = '';\
						document.getElementById('Q1').getElementsByTagName('g')[0].style.fill = '';\
						document.getElementById('D0').getElementsByTagName('g')[0].style.fill = '';\
						document.getElementById('D1').getElementsByTagName('g')[0].style.fill = '';\
					\}\
\
\
					//$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight + 80);\
\
\
					//-----------------------------------------------------------------\
						//------------------Click on Edit functionality---------------------------------------\
						$("#tap_edit_rate, #rate_me_now").click(function() \{\
							// var rating_popup = document.getElementById('supp_rat');   \
							// if (rating_popup) document.getElementById('chat-section-main').scrollTo(0,rating_popup.offsetTop - 120);\
							// if ($('.chat-section')[0].scrollHeight - $('.chat-section').scrollTop() == $('.chat-section').outerHeight())\
							// \{  $('#supp_rat').css("display", "block");//pop2\
							// 	$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight);\
							\
							// \}\
							// else\{\
							// 	$('#supp_rat').css("display", "block");//pop2\
							// \}\
							$('#supp_rat').css("display", "block");//pop2\
							document.getElementById('supp_rat').scrollIntoView();\
							$('#box1').css("display", "none");\
							$('#box2').css("display", "flow-root");\
							$('.get_sup_rat').css("display", "none"); //pop1 \
							//$('#supp_rat').css("display", "block"); //pop2\
							$("#confirmSpan").children().css('display', 'block'); //pop3-Submit\
							$("#satisfaction_box").css('display', 'inline-block'); //pop3\
							//$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight + 100);\
							yandex_impression_pers('supplier_rating_click_edit_MY');\
							yandex_impression_pers('supplier_rating_display_impression_new_form');\
						\});\
					\}\
				\}\
				if(toSaveRatingFromEmail == 1) $('.get_sup_rat').css("display", "none"); //pop1\
			\}\
		\});\
	\}\
\}\
\
\
\
\
function get_rateSupplier_via_email(email_rate_val) \{\
	// 	console.log('In get_rateSupplier');\
		var buyer_glid = parseInt($('#trackid').val());\
		var supplier_glid = trim(document.getElementById('contactglid').value);\
		//condition to show sup rating\
		var is_rating_display = $("#is_rating_display").val();\
		var toSaveRatingFromEmail = $("#toSaveRatingFromEmail").val();\
		if(is_rating_display != undefined) \{\
			$('#oldImg').html('');\
			$.ajax(\{\
				url: '/phpajax/enquiry/messagecentre/getRatingInChat',\
				data: \{\
					"sup_glid": supplier_glid,\
					"buy_glid": buyer_glid,\
				\},\
				dataType: "JSON",\
				type: "POST",\
				success: function(result) \{\
					if(result == null) return;\
					result.r = email_rate_val;\
					if(result.failure != "" && result.failure == "Authorization Fail") \{\
						console.log(result);\
						window.location.replace('https://my.indiamart.com');\
                        return;\
					\}\
					if(is_rating_display == 0 && result.r == -3) \{\
						return;\
					\}\
					if(is_rating_display == 0 && result.r != -3) \{\
						$('.get_sup_rat').css("display", "block");\
						//$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight + 80);\
						/*vinay*/yandex_impression_my('rating_landing_from_email_display_impression_filled_form');\
						//------------Pop1 start display functionality-----------------\
						var xyz = "s";\
						if(result.r == 1) xyz = '';\
						$('#given_sup_rating').text(result.r + ' star' + xyz); //not in use\
						for(var i = 1; i <= 5; i++) $('#star_col' + i).css("color", "rgba(0,0,0,0.1)");\
						for(var i = 1; i <= result.r; i++) $('#star_col' + i).css("color", "#FFCA00");\
						//-----------Pop2 star display & msg functionality-------------\
						for(var i = 1; i <= result.r; i++) $('#star' + i).css("color", "#fd4");\
						$('#deal' + result.r).css('display', 'block');\
						//-----------Influ Param functionality-------------\
						var arg = result.influ;\
						//if(arg != 0) markDiv(arg);\
						//----comment display-------\
						var comment = result.comment;\
						var nullComment = "";\
						if (comment.length!=0) \{\
							$("#comment_box3").html('<span>\\"' + comment + '\\"</span>');\
							//$('#addComment').val(comment);\
						\}\
						else \{\
							$("#comment_box3").text(nullComment);\
							//$('#addComment').val(nullComment);\
						\}\
						//------------------Image functionality---------------------------------------\
						var x = result.img;\
						var imgcnt = 0;\
						for(var i = 1; i <= x.length; i++) //priya\
						\{\
							imgcnt++;\
							var j = i - 1;\
							var x_img_id = x[j].IMG_ID;\
							var x_img_ori = x[j].IMG_DOC_PATH;\
							var x_img_125 = x[j].IMG_DOC_125X125;\
							var x_img_250 = x[j].IMG_DOC_250X250;\
							var x_img_500 = x[j].IMG_DOC_500X500;\
							if(x_img_id) \{\
								var opDiv = 'ratingImg';\
								var imgdiv = '<div class="imgD45 rt_centr iPr" id="div_' + opDiv + i + '" name="div_' + opDiv + '[]"><img id="val_' + opDiv + i + '" name="val_' + opDiv + '[]"  src="' + x_img_125 + '" class="imIg" ><input id="val_id_' + opDiv + i + '" name="val_id_' + opDiv + '[]" value="' + x_img_id + '" type="hidden"><input id="val_ori_' + opDiv + i + '" name="val_ori_' + opDiv + '[]" value="' + x_img_ori + '" type="hidden"><input id="val_125_' + opDiv + i + '" name="val_125_' + opDiv + '[]" value="' + x_img_125 + '" type="hidden"><input id="val_250_' + opDiv + i + '" name="val_250_' + opDiv + '[]" value="' + x_img_250 + '" type="hidden"><input id="val_500_' + opDiv + i + '" name="val_500_' + opDiv + '[]" value="' + x_img_500 + '" type="hidden"><span class="iclse iCp" id="delete_' + opDiv + i + '" ></span></div>';\
								$('#oldImg').append(imgdiv);\
								$("#delete_" + opDiv + i).click(function() \{\
									deleteImg('ratingImg', this.id);\
								\});\
								$("#val_" + opDiv + i).click(function() \{\
									showZoom('ratingImg', this.id);\
								\});\
							\}\
						\}\
						if(imgcnt < 5) \{\
							$('#ratingImg').css("display", "block");\
						\}\
						//------------------Click on Edit functionality---------------------------------------\
						$("#tap_edit_rate, #rate_me_now").click(function() \{\
							// body...\
							// var rating_popup = document.getElementById('supp_rat');   \
							// if (rating_popup) document.getElementById('chat-section-main').scrollTo(0,rating_popup.offsetTop - 120);\
							// if ($('.chat-section')[0].scrollHeight - $('.chat-section').scrollTop() == $('.chat-section').outerHeight())\
							// \{  $('#supp_rat').css("display", "block");//pop2\
							// 	$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight);\
							\
							// \}\
							// else\{\
							// 	$('#supp_rat').css("display", "block");//pop2\
							// \}\
							$('#supp_rat').css("display", "block");//pop2\
							document.getElementById('supp_rat').scrollIntoView();\
							$('#box1').css("display", "none");\
							$('#box2').css("display", "flow-root");\
							$('.get_sup_rat').css("display", "none"); //pop1 \
							$('#supp_rat').css("display", "block"); //pop2\
							$("#confirmSpan").children().css('display', 'block'); //pop3-Submit\
							$("#satisfaction_box").css('display', 'inline-block'); //pop3\
							//$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight + 80);\
							/*vinay*/yandex_impression_my('rating_landing_from_email_click_edit_MY');\
							/*vinay*/yandex_impression_my('rating_landing_from_email_display_impression_new_form');\
						\});\
					\} else \{\
						if(result.r == -3) \{ //when 0 rating is available\
							$('#supp_rat').css("display", "block");\
							$('#ratingImg').css("display", "block");\
							$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight + 80);\
							/*vinay*/yandex_impression_my('rating_landing_from_email_display_impression_new_form');\
						\} else \{\
							$('.get_sup_rat').css("display", "block");\
							$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight + 80);\
							/*vinay*/yandex_impression_my('rating_landing_from_email_display_impression_filled_form');\
							//------------Pop1 start display functionality-----------------\
							var xyz = "s";\
							if(result.r == 1) xyz = '';\
							$('#given_sup_rating').text(result.r + ' star' + xyz); //when >1 rating is available\
							for(var i = 1; i <= 5; i++) $('#star_col' + i).css("color", "rgba(0,0,0,0.1)");\
							for(var i = 1; i <= result.r; i++) $('#star_col' + i).css("color", "#FFCA00");\
							//-----------Pop2 star display & msg functionality-------------\
							for(var i = 1; i <= result.r; i++) $('#star' + i).css("color", "#fd4");\
							$('#deal' + result.r).css('display', 'block');\
							//-----------Influ Param functionality-------------\
							var arg = result.influ;\
							//if(arg != 0) markDiv(arg);\
							//----comment display-------\
							var comment = result.comment;\
							var nullComment = "";\
							if (comment.length!=0) \{\
								$("#comment_box3").html('<span>\\"' + comment + '\\"</span>');\
								//$('#addComment').val(comment);\
							\}\
							else \{\
								$("#comment_box3").text(nullComment);\
								//$('#addComment').val(nullComment);\
							\}\
							//------------------Image functionality---------------------------------------\
							var x = result.img;\
							var imgcnt = 0;\
							for(var i = 1; i <= x.length; i++) //priya\
							\{\
								imgcnt++;\
								var j = i - 1;\
								var x_img_id = x[j].IMG_ID;\
								var x_img_ori = x[j].IMG_DOC_PATH;\
								var x_img_125 = x[j].IMG_DOC_125X125;\
								var x_img_250 = x[j].IMG_DOC_250X250;\
								var x_img_500 = x[j].IMG_DOC_500X500;\
								if(x_img_id) \{\
									var opDiv = 'ratingImg'; //shubham\
									var imgdiv = '<div class="imgD45 rt_centr iPr" id="div_' + opDiv + i + '" name="div_' + opDiv + '[]"><img id="val_' + opDiv + i + '" name="val_' + opDiv + '[]"  src="' + x_img_125 + '" class="imIg"><input id="val_id_' + opDiv + i + '" name="val_id_' + opDiv + '[]" value="' + x_img_id + '" type="hidden"><input id="val_ori_' + opDiv + i + '" name="val_ori_' + opDiv + '[]" value="' + x_img_ori + '" type="hidden"><input id="val_125_' + opDiv + i + '" name="val_125_' + opDiv + '[]" value="' + x_img_125 + '" type="hidden"><input id="val_250_' + opDiv + i + '" name="val_250_' + opDiv + '[]" value="' + x_img_250 + '" type="hidden"><input id="val_500_' + opDiv + i + '" name="val_500_' + opDiv + '[]" value="' + x_img_500 + '" type="hidden"><span class="iclse iCp" id="delete_' + opDiv + i + '" ></span></div>'; //onclick="deleteImg(\\''+ opDiv +'\\','+ i +');" //onclick="showZoom(\\''+ opDiv +'\\','+ this.id +')"\
									$('#oldImg').append(imgdiv);\
									//                               setTimeout(function() \{\
									$("#delete_" + opDiv + i).click(function() \{\
										deleteImg('ratingImg', this.id);\
									\});\
									$("#val_" + opDiv + i).click(function() \{\
										showZoom('ratingImg', this.id);\
									\});\
									// 						\}, 3000);\
								\}\
							\}\
							if(imgcnt < 5) \{\
								$('#ratingImg').css("display", "block");\
							\}\
							//------------------Click on Edit functionality---------------------------------------\
							$("#tap_edit_rate, #rate_me_now").click(function() \{\
								// body...\
								// var rating_popup = document.getElementById('supp_rat');\
								// if (rating_popup) document.getElementById('chat-section-main').scrollTo(0,rating_popup.offsetTop - 120);\
				// 				if ($('.chat-section')[0].scrollHeight - $('.chat-section').scrollTop() == $('.chat-section').outerHeight())\
				// \{  $('#supp_rat').css("display", "block");//pop2\
				// 	$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight);\
                \
				// \}\
				// else\{\
				// 	$('#supp_rat').css("display", "block");//pop2\
				// \}\
								$('#supp_rat').css("display", "block");//pop2\
								document.getElementById('supp_rat').scrollIntoView();\
								$('#box1').css("display", "none");\
							$('#box2').css("display", "flow-root");\
								$('.get_sup_rat').css("display", "none"); //pop1 \
								$('#supp_rat').css("display", "block"); //pop2\
								$("#confirmSpan").children().css('display', 'block'); //pop3-Submit\
								$("#satisfaction_box").css('display', 'inline-block'); //pop3\
								//$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight + 80);\
								/*vinay*/yandex_impression_my('rating_landing_from_email_click_edit_MY');\
								/*vinay*/yandex_impression_my('rating_landing_from_email_display_impression_new_form');\
							\});\
						\}\
					\}\
					if(toSaveRatingFromEmail == 1) $('.get_sup_rat').css("display", "none"); //pop1\
				\}\
			\});\
		\}\
	\}\
var cmp_list;\
// function get_user_company_detail(loginglid,contactglid,rec)\{\
// 	var usr_alias = \{\
// 		glsr_id: contactglid,\
// 		alias: ''\
// 	\}\
// 	var user_alias_det = '';\
// 	if(rec == undefined || rec == null)\
// 		rec = 0;\
// 	if(localStorage.getItem('user_alias') == null) \{\
//     	var user_alias = [];\
// 		user_alias.push(usr_alias);\
// 		localStorage.setItem('user_alias',JSON.stringify(user_alias));\
// 	\}\
// 	else\{\
// 		var user_alias = JSON.parse(localStorage.getItem('user_alias'));\
// 		var fnd = 0;\
// 		for(var i=0; i < user_alias.length; i++)\{\
// 			var glsr_id = user_alias[i].glsr_id;\
// 			if(glsr_id == contactglid)\{\
// 				fnd = 1;\
// 				user_alias_det = user_alias[i].alias;\
// 			\}\
// 		\}\
// 		if(fnd !=1)\{\
// 			var user_alias = JSON.parse(localStorage.getItem('user_alias'));\
// 			user_alias.push(usr_alias);\
// 			localStorage.setItem('user_alias',JSON.stringify(user_alias));\
// 		\}\
// 	\}\
// 	$.ajax(\{\
//         url: "/phpajax/enquiry/messagecentre/get_user_company_detail",\
//         data: \{"loginglid" : loginglid,"contactglid" : contactglid,"user_alias_det" : user_alias_det\},\
//         dataType: "json",\
//         type: "GET",\
//         success: function(data)\{\
//         	data = JSON.parse(data);\
//         	if(data.failure !="" && data.failure == "Authorization Fail")\{\
// 	 			console.log(result);\
// 	 			window.location.reload();\
// 	 		\}\
//     		var code = data["URL_DETAIL"]["URL_STATUS"];\
//     		var alias = '';\
//     		if(code == "404")\
//     			return;\
//     		if(code == "301")\
//     			alias = data["URL_DETAIL"]["FREESHOWROOM_ALIAS"];\
//     		if(code == "301" && (user_alias_det != '' || rec == 1))\{\
//     			alias = data["URL_DETAIL"]["URL"];\
//     			rec = 1;\
//     			if(alias != '')\
//     				alias = alias.replace(/\\//g, "");\
//     		\}\
//     		if(alias != '' && (user_alias_det == '' || (user_alias_det != '' && rec == 1)) )\{\
//     			var user_alias = JSON.parse(localStorage.getItem('user_alias'));\
// 				for(var i=0; i < user_alias.length; i++)\{\
// 					var glsr_id = user_alias[i].glsr_id;\
// 					if(glsr_id == contactglid)\{\
// 						user_alias[i].alias = alias;\
// 						localStorage.setItem("user_alias", JSON.stringify(user_alias));\
// 						break;\
// 					\}\
// 				\}\
// 				get_user_company_detail(loginglid,contactglid,1);\
// 				return;\
//     		\}\
//     		cmp_list = data;\
//     		var c_company       = $("#ed_company").val()    ? htmlEscape($("#ed_company").val())    : '';\
//     		/*if(c_company != '')\
//     			$('#seller_profile').css("display","block");*/\
//     		var pns_ratio = '';\
//     		if(cmp_list["DATA"] != "" && cmp_list["DATA"] != undefined && cmp_list["DATA"] != null)\
//     			pns_ratio = cmp_list["DATA"]["COMPANYDETAIL"]["PNS_RATIO"] ? cmp_list["DATA"]["COMPANYDETAIL"]["PNS_RATIO"] : '';\
//     		if(pns_ratio != "" && pns_ratio != undefined && pns_ratio != null && c_company != '')\{\
//     			pns_ratio = Math.floor(pns_ratio);\
//     			if(pns_ratio > 0)\{\
// 	    			$('#pns_response_rate').html(pns_ratio+"% Response rate");\
// 	    			$('#pns_response_rate').css("display","block");\
// 	    		\}\
//     		\}\
//     	\}\
//   	\});\
// \}\
// function show_seller_profile() \{\
// 	// body...\
// 	if($('#seller_profile_sec').css('display') == 'block')\{\
// 		$('#seller_profile_sec').css("display","none");\
//     	$('.chat-section').css("width","100%");\
//     	$('.bottom-send-section').css("width","100%");\
//     	$("#tap_edit_rate, #rate_me_now").css("padding-right","70px");\
//     	$('#div_show_star').css("padding-left","65px");\
//     	$('i.bg-msg-1.msg_drop').css("background-position","-168px -12px");\
//     	$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight);\
//     	category = 'messagecentre';  \
//   		trackEvent(category, 'seller_profile_dis_none');\
//     	return;\
// 	\}  \
//     else\{\
//         $('#seller_profile_sec').css("display","block");\
//         $('.chat-section').css("width","70%");\
//         $('.bottom-send-section').css("width","71%");\
//         $("#tap_edit_rate, #rate_me_now").css("padding-right","10px");\
//         $('#div_show_star').css("padding-left","30px");\
//         $('i.bg-msg-1.msg_drop').css("background-position","-168px 3px");\
// 	    $(".seller_profile_sec").css("min-height",$('.chat-section').height()+$('.bottom-send-section').height());\
// 	    $(".seller_profile_sec").css("max-height",$('.chat-section').height()+$('.bottom-send-section').height());\
// 	    $('.chat-section').scrollTop($('.chat-section')[0].scrollHeight);\
//         category = 'messagecentre';  \
//   		trackEvent(category, 'seller_profile_dis_block');\
//     \}\
//     /*to get the user company and logo detail*/\
//     var edit_option = '';/*$('#edit_box').html();\
//  	edit_option = (edit_option != '' && edit_option != undefined) ? edit_option.trim() : '';*/\
//  	var c_name          = $("#ed_name").val()       ? htmlEscape($("#ed_name").val())       : "Buyer";\
//     var c_company       = $("#ed_company").val()    ? htmlEscape($("#ed_company").val())    : '';\
//     var c_city          = $("#ed_city").val()       ? htmlEscape($("#ed_city").val())       : '';\
//     var c_state         = $("#ed_state").val()      ? htmlEscape($("#ed_state").val())      : '';\
//     var c_country       = $("#recv_country").val()  ? htmlEscape($("#recv_country").val())  : '';\
//     var c_mob           = $('#recv_mob').val()      ? htmlEscape($('#recv_mob').val())      : '';\
//     // var c_district      = cmp_list["DATA"]["COMPANYDETAIL"]["DIR_SEARCH_DISTRICT"]      ? htmlEscape(cmp_list["DATA"]["COMPANYDETAIL"]["DIR_SEARCH_DISTRICT"])      : '';\
//     // if(c_district !=='')\{\
//     // 	c_city = c_city !== '' ? c_city+', '+c_district : c_district ;\
//     // \}\
//     if(c_state !=='')\{\
//     	c_city = c_city !== '' ? c_city+', '+c_state : c_state ;\
//     \}\
//     if(c_company !=="" && c_city !=='')\{\
//     	var head_c_cmpny_city = '<div id="sel_head" style="text-align: center;margin-top: 65px !important;"><span style="font-weight: bold;margin-top: 5px;max-width: 575px;font-size: 16px;" >' + c_company +'<br><span style="font-weight:100;font-size: 12px;">'+ c_city + '</span></span>';\
//     \}\
//     else if(c_company !=="" || c_city !=='')\{\
//     	var c_cm_cty = c_company != '' ? c_company : c_city;\
//     	var head_c_cmpny_city = '<div id="sel_head" style="text-align: center;margin-top: 65px !important;"><span style="font-weight: bold;margin-top: 5px;max-width: 575px;font-size: 16px;" >' + c_cm_cty + '</span>';\
//     \}\
//     else\{\
//     	var head_c_cmpny_city = '<div>';\
//     \}\
//  	var profile_img1 = '<div id="hdr_img_1" ><img src="" class="cmp_logo_header"><span id="nm_txt_pro"></span></div>';\
//  	var cmp_img = $(".user-name1.active div img").attr('src');\
//  	/*to get the user trustseal and star sup detail*/\
//  	var custypeweight = cmp_list["DATA"]["COMPANYDETAIL"]["CUSTWT"] ? cmp_list["DATA"]["COMPANYDETAIL"]["CUSTWT"] : '';\
//     var tscode 		  = cmp_list["DATA"]["COMPANYDETAIL"]["TSCODE"] ? cmp_list["DATA"]["COMPANYDETAIL"]["TSCODE"] : '';\
//     var trustseel 	  = cmp_list["DATA"]["COMPANYDETAIL"]["TS"] ? cmp_list["DATA"]["COMPANYDETAIL"]["TS"] : '';\
//     var leadSupplier  = cmp_list["DATA"]["COMPANYDETAIL"]["LS"] ? cmp_list["DATA"]["COMPANYDETAIL"]["LS"] : '';\
//     var StarSupplier  = cmp_list["DATA"]["COMPANYDETAIL"]["SS"] ? cmp_list["DATA"]["COMPANYDETAIL"]["SS"] : '';\
//     var ts = '', ls = '', ss = '';\
//     if (trustseel.toLowerCase() == 't' || leadSupplier.toLowerCase() == 't' || StarSupplier.toLowerCase() == 't' ) \{\
//         if (trustseel.toLowerCase() == 't') 	\{   ts = 1;   \}\
//         if (leadSupplier.toLowerCase() == 't') 	\{   ls = 1;   \}\
//         if (StarSupplier.toLowerCase() == 't') 	\{   ss = 1;   \}\
//     \} \
//     else if (custypeweight == 149 || custypeweight == 179 || (tscode != null && tscode != '') || custypeweight == 199) \{\
//         if ((tscode != null && tscode != '')  || custypeweight == 199)\
//             ts = 1;\
//         if (custypeweight == 149)\
//             ls = 1;\
//         if (custypeweight == 179)\
//             ss = 1;\
//     \}\
//     var trst_det = '<div style="display: inline-block;">';\
//     if(ts == 1)\{\
//     	trst_det = trst_det + '<div class="trst_det_blk"><span class="trst_det_col"></span><span style="font-weight:100;font-size: 12px;">Trust Seal Verified </span></div>';\
//     \}\
//     if(ls == 1)\{\
//     	trst_det = trst_det + '<div class="trst_det_blk"><span class="trst_det_col"></span><span style="font-weight:100;font-size: 12px;">Leading Supplier </span></div>';\
//     \}\
//     if(ss == 1)\{\
//     	trst_det = trst_det + '<div class="trst_det_blk"><span class="trst_det_col"></span><span style="font-weight:100;font-size: 12px;">Star Supplier </span></div>';\
//     \}\
//     /* add the value in the div*/\
// 	$('#profile_sec1').html(edit_option + profile_img1+'<br>'+head_c_cmpny_city+'<br>'+trst_det+'</div></div>');\
// 	if(cmp_img == "")\{\
// 		/*var x = $(".user-name1.active div").css("background-image").slice(5,-2);\
// 		$(".cmp_logo_header").attr('src',x);*/\
// 		var nm_txt = '';\
// 		if(c_company !='')\
// 			nm_txt = c_company.charAt(0).toUpperCase();\
// 		else\
// 			nm_txt = c_name.charAt(0).toUpperCase();\
// 		$("#hdr_img_1").addClass('no_cmp_logo');\
// 		$("#hdr_img_1").addClass('no_cmp_logo_hdr');\
// 		$("#hdr_img_1").addClass('no_cmp_logo_hdr1');\
// 		$("#nm_txt_pro").text(nm_txt);\
// 	\}else\{\
// 		$("#hdr_img_1 .cmp_logo_header").attr('src',cmp_img);\
// 		$("#hdr_img_1 .cmp_logo_header").addClass('no_cmp_logo_hdr2');\
// 		$("#hdr_img_1 .cmp_logo_header").css("display","block");\
// 	\}\
// 	var html = '', html1 = '', red_url = '';\
//     var dt = cmp_list["DATA"]["FACTSHEET"][0]["DATA"];\
//     var f_page_url = cmp_list["URL_DETAIL"]["FREE_SHOWROOM_URL"];\
// 	var p_page_url = cmp_list["URL_DETAIL"]["PAID_SHOWROOM_URL"];\
// 	if(f_page_url != '' && f_page_url != undefined && f_page_url != null )\{\
// 		red_url = f_page_url;\
// 	\}\
// 	else if(p_page_url != '' && p_page_url != undefined && p_page_url != null )\{\
// 		red_url = p_page_url;\
// 	\}\
//     if(dt != "")\{\
//     	html = '<div style="background-color: white;padding: 3px 6px 3px 6px;"><h2 style="font-size: 14px;line-height: 16px;color: #000000;">Company Factsheet</h2>';\
//     	html = html + '<div><span style="font-size: 14px;line-height: 16px;color: #555555;">' + cmp_list["DATA"]["FACTSHEET"][0]["TITLE"] + '</span><table style="margin-top: 4px;margin-bottom: 4px;"><tbody style = "font-size: 12px;">';\
//     	var len = cmp_list["DATA"]["FACTSHEET"][0]["DATA"]["length"];\
//     	var len_count = 0;\
//     	for(var i=0 ; i<len ; i++)\{\
//     		if(cmp_list["DATA"]["FACTSHEET"][0]["DATA"][i]["DATA"] != '' && cmp_list["DATA"]["FACTSHEET"][0]["DATA"][i]["DATA"] != undefined && cmp_list["DATA"]["FACTSHEET"][0]["DATA"][i]["DATA"] != null )\
//     			html = html + '<tr style="color: #555555;"><td class="pro_s1">'+cmp_list["DATA"]["FACTSHEET"][0]["DATA"][i]["TITLE"]+'</td><td class="pro_s2">'+cmp_list["DATA"]["FACTSHEET"][0]["DATA"][i]["DATA"]+'</td></tr><tr><td style="padding:2px;"></td></tr>';\
//     		else\
//     			len_count++;\
//     	\}\
//     	html = html + '</tbody></table></div></div>';\
//     	if(len == len_count)\
//     		html = '';\
//     \}\
//     var prd_list = cmp_list["DATA"]["PRDSERV"];\
//     if(prd_list != '')\{\
//     	html1 = '<div style="background-color: white;padding: 10px 6px 3px 6px;"><h2 style="font-size: 14px;line-height: 16px;color: #000000; margin-bottom: 6px;">Also Deals In</h2>';\
//     	var len = cmp_list["DATA"]["PRDSERV"]["length"];\
//     	for(var i=0 ; i<len ; i++)\{\
//     		var pr_name  = cmp_list["DATA"]["PRDSERV"][i]["ITEM_NAME"] ? cmp_list["DATA"]["PRDSERV"][i]["ITEM_NAME"] : '';\
//     		var pr_price = cmp_list["DATA"]["PRDSERV"][i]["PC_ITEM_FOB_PRICE"] ? cmp_list["DATA"]["PRDSERV"][i]["PC_ITEM_FOB_PRICE"] : '';\
//     		var pr_unit  = cmp_list["DATA"]["PRDSERV"][i]["PC_ITEM_MOQ_UNIT_TYPE"] ? cmp_list["DATA"]["PRDSERV"][i]["PC_ITEM_MOQ_UNIT_TYPE"] : '';\
//     		var pr_clnt_name  = cmp_list["DATA"]["PRDSERV"][i]['PC_CLNT_FLNAME'] ? cmp_list["DATA"]["PRDSERV"][i]['PC_CLNT_FLNAME'] : '';\
//     		//var red_url_prod = red_url+pr_clnt_name+"#"+pr_name;\
//     		html1 = html1 + '<div class="prd_list_block" onclick="trackEvent(\\'messagecentre\\', \\'seller_profile_also_deal\\');"><a style="display: grid;letter-spacing: 0px;margin-left: 0px;float: left;width: 100%;"><span class="prd_list_block_nm">'+pr_name+'</span>';\
//     		var mrp = '';\
//     		if(pr_price != '' && pr_unit != '')\
//     			mrp = 'Rs. '+pr_price+'/'+pr_unit+' onwards';\
//     		else if(pr_price != '')\
//     			mrp = 'Rs. '+pr_price+' onwards';\
//     		if(mrp != '')\
//     			html1 = html1 + '<span class="prd_list_block_pr">'+mrp+'</span>';\
//     		html1 = html1 +'</a><i class="bg-msg-1" style="background-position: 0px -21px; float: right; background-repeat: no-repeat; width:20px; height:32px; display:none;"></i></div>';\
//     	\}\
//     	var pr_cat_indx  = cmp_list["DATA"]["HEADER"]["CAT_INDEX"] ? cmp_list["DATA"]["HEADER"]["CAT_INDEX"] : '';\
//     	var pr_cat_indx_url = red_url + pr_cat_indx;\
//     	html1 = html1 + '</div>';\
//     \}\
//     var about_us_dec0 = cmp_list['DATA']['HOME_FEATURED_ITEM'] ? cmp_list['DATA']['HOME_FEATURED_ITEM'] : '';\
//     var about_us_dec1 = cmp_list["URL_DETAIL"]["GLUSR_USR_COMPANY_DESC"] ? cmp_list["URL_DETAIL"]["GLUSR_USR_COMPANY_DESC"] : '';\
//     var about_us_dec2 = cmp_list["URL_DETAIL"]["GLUSR_USR_SELLINTEREST"] ? cmp_list["URL_DETAIL"]["GLUSR_USR_SELLINTEREST"] : '';\
//     var about_us_dec3 = cmp_list["URL_DETAIL"]["ABOUTPAGE_DESC"] ? cmp_list["URL_DETAIL"]["ABOUTPAGE_DESC"] : '';\
//     var user_abt = '';\
//     if(about_us_dec0 != '')\
//     	user_abt = about_us_dec0;\
//     else if(about_us_dec1 != '')\
//     	user_abt = about_us_dec1;\
//     else if(about_us_dec2 != '')\
//     	user_abt = about_us_dec2;\
//     else if(about_us_dec3 != '')\
//     	user_abt = about_us_dec3;\
//     var html2 = '';\
//     if(user_abt != '')\{\
//     	html2 = '<div style="background-color: white;padding: 10px 6px 3px 6px;"><h2 style="font-size: 14px;line-height: 16px;color: #000000; margin-bottom: 6px;">About Us</h2>';\
//     	if(user_abt.length > 250)\
//     		user_abt = user_abt.slice(0,250) + '...';\
//     	html2 = html2 + '<p class="about_us_decs">'+user_abt+'</p>';\
//     	var pr_about_us  = cmp_list["DATA"]["HEADER"]["PROFILE"] ? cmp_list["DATA"]["HEADER"]["PROFILE"] : '';\
//     	var pr_about_us_url = red_url + pr_about_us;\
//     	html2 = html2 + '<br></div>';\
//     \}\
//     $('#profile_sec2').html(html+html1+html2+'<div style="font-size: 14px;line-height: 16px;margin-left: 0px;padding: 6px 6px 6px 6px;width: 280px;background-color: white;"><span style="font-weight: bold;">Know More</span><span style="color: #999999;margin-left: 10px;font-size: 12px;">Send a quick Message</span><div style="border-radius:5px;background-color: #ededed;display: flex;margin-top: 5px;padding: 7px 5px;"><p class="seller_know_more_msg" >Please tell me more about your Products and Catalog.</p><div class="seller_know_more_cls" title="Send Message to Know More" onclick="send_usr_know_reply();"><span class="bg-msg ico Msg-snd" style="top:auto; margin-top:5px; margin-left: 9px;"></span></div></div></div>');\
// \}\
// var send_usr_know_reply_done;\
// function send_usr_know_reply() \{\
// 	// body...\
// 	if(send_usr_know_reply_done == null || send_usr_know_reply_done == undefined)\
// 		send_usr_know_reply_done = 1;\
// 	if(send_usr_know_reply_done == 1)\{\
// 		send_usr_know_reply_done = 0;\
// 		category = 'messagecentre';  \
// 	  	trackEvent(category, 'seller_profile_know_more');\
// 		document.getElementById('massage-text').value = 'Please tell me more about your Products and Catalog.';\
// 		temp_display_msg();\
// 		setTimeout(function () \{\
// 			send_usr_know_reply_done = 1;\
// 		\},5000);\
// 		$(".seller_profile_sec").css("min-height",$('.chat-section').height()+$('.bottom-send-section').height());\
// 		$(".seller_profile_sec").css("max-height",$('.chat-section').height()+$('.bottom-send-section').height());\
// 	\}\
// \}\
//display msg temporarily in conversation chat with timer\
var temp_reply_msg, inst_sug_timer;\
var temp_reply_mth_used;\
\
function temp_display_msg() \{\
	var is_real_time = false;\
	if(disabled_send_reply) return;\
	temp_reply_msg = trim(document.getElementById("massage-text").value).replace(/\\u200B/g, "");\
	if(temp_reply_msg == '' || temp_reply_msg == null) //case when user clicks the text twice continuously but need to send only once\
		return;\
	if(temp_reply_mth_used == 1) return;\
	var today = new Date();\
	var bname = $("#bn").val();\
	var msg_date = today.toLocaleDateString("en-US", \{\
		month: 'short'\
	\}) + ' ' + today.toLocaleDateString("en-US", \{\
		day: 'numeric',\
		hour: 'numeric',\
		minute: 'numeric'\
	\}).toLowerCase();\
	var dte_frmt = today.getDate() + '-' + (today.getMonth() + 1) + '-' + today.getFullYear() + ',' + today.getHours() + ':' + today.getMinutes();\
	var dsply_msg = temp_reply_msg.replace(/</g, '&lt;');\
	dsply_msg = dsply_msg.replace(/>/g, '&gt;');\
	dsply_msg = dsply_msg.replace(/\\n/g, '<br>');\
	dsply_msg = dsply_msg.replace(/&lt;\\s*\\/?\\s*br\\s*&gt;/g, "<br>");\
	var regex = /((http\\:\\/\\/|ftp\\:\\/\\/|https\\:\\/\\/)|www\\.)([-a-zA-Z0-9\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)_\\-\\=\\+\\\\\\/\\?\\.\\:\\;\\'\\,]*)/;\
	var main_cls = "message-send";\
	var rply_html = '<div id="temp_msg_div" class="' + main_cls + '"><div class="inner_msg_div" style="background: #bdc3c3;"><div class="arrow" style="border-color: transparent transparent transparent #bdc3c3;"></div>' + '<h2>' + dsply_msg + '</h2>';\
	var gray_tick = is_real_time ? "" : TICK.replace('CUSTOM_COLOR', '#999999');\
	var match_reply = dsply_msg.match(regex);\
	var tick_icon = "";\
	//dsply_msg       = match_reply ? dsply_msg.replace(match_reply[0],'<a href="http:"'+match_reply[0]+'" target="_blank" style="color:#0072bc;">'+match_reply[0]+'</a>') : dsply_msg;\
	if(match_reply) \{\
		if(match_reply[0].indexOf('http') > -1 || match_reply[0].indexOf('ftp') > -1) dsply_msg = dsply_msg.replace(match_reply[0], '<a href=' + match_reply[0] + ' target="_blank" style="color:#0072bc;">' + match_reply[0] + '</a>');\
		else dsply_msg = dsply_msg.replace(match_reply[0], '<a href=https://' + match_reply[0] + ' target="_blank" style="color:#0072bc;">' + match_reply[0] + '</a>');\
	\}\
	if(main_cls == "message-send") tick_icon = '<span style="float: right;margin-left: 3px;height: 10px;margin-top: -1px;padding-bottom:20px;"><span color="#999999" style="font-size:12px">Sending...</span></span>'\
	rply_html = rply_html + tick_icon + '</div><div class="time" style="clear: none;">' + msg_date + '</div></div><span class="msg-full-time" style="display: none;">' + dte_frmt + '</span><div class="clr"></div></div>';\
	$(".chat-section").css("height", "");\
	$(rply_html).insertBefore('#reply_text');\
	document.getElementById("massage-text").value = '';\
	$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight);\
	temp_reply_mth_used = 1; //value created so that if used clicks auto send mutiple time only one can be send at a time next msg to be send after time interval or undo\
	var auto_timer = 1;\
	inst_sug_timer = setInterval(function() \{\
		auto_timer = auto_timer - 1;\
		if(auto_timer == 0) \{\
			console.log("message sent");\
			clearInterval(inst_sug_timer);\
			temp_reply_mth_used = 0;\
			document.getElementById("massage-text").value = temp_reply_msg;\
			$('#temp_msg_div').remove();\
			trackEvent('messagecentre', 'success_auto_sug');\
			sendreply();\
		\}\
	\}, 1000);\
\}\
/*function to send the instant message from the last BL/ENQ*/\
var hid_inst;\
\
function send_inst_enq_msg(argument) \{\
	var byr_name = $('#receiver_name').val() ? $('#receiver_name').val() : '';\
	if(argument == 1 || argument == 5) hid_inst = 1;\
	else hid_inst = 0;\
	if(argument == 1) \{\
		document.getElementById('massage-text').value = 'Hi';\
		getGAEventTrackingJS("messagecentre", "reply_sent_bl_msg_1", glid);\
		$('#send_inst_enq_msg_1').css("display", "none");\
	\} else if(argument == 2 || argument == 7 || argument == 9) \{\
		var ImeshVisitorcookie = readCookie("ImeshVisitor");\
		var mb_val = getparamVal(ImeshVisitorcookie, "mb1");\
		var em_val = getparamVal(ImeshVisitorcookie, "em");\
		var phcc_val = getparamVal(ImeshVisitorcookie, "phcc");\
		if(phcc_val == 91) document.getElementById('massage-text').value = 'Hey!<br>Please Call me at ' + mb_val;\
		else document.getElementById('massage-text').value = 'Hey!<br>Please Contact me at ' + em_val;\
		if(argument == 2) getGAEventTrackingJS("messagecentre", "reply_sent_bl_msg_2", glid);\
		else if(argument == 7) getGAEventTrackingJS("messagecentre", "reply_sent_bl_msg_7", glid);\
		else if(argument == 9) getGAEventTrackingJS("messagecentre", "reply_sent_bl_msg_9", glid);\
		$('.inst_enq_msg').css("display", "none");\
	\} else if(argument == 3) \{\
		document.getElementById('massage-text').value = 'Hi, please Share more details of Requirement.';\
		getGAEventTrackingJS("messagecentre", "reply_sent_bl_msg_3", glid);\
		$('.inst_enq_msg').css("display", "none");\
	\} else if(argument == 4) \{\
		document.getElementById('massage-text').value = 'Hi, The Product is Available';\
		getGAEventTrackingJS("messagecentre", "reply_sent_bl_msg_4", glid);\
		$('.inst_enq_msg').css("display", "none");\
	\} else if(argument == 5) \{\
		document.getElementById('massage-text').value = 'Hi, I wanted to get a followup on my last message to you. Can you please update me on the Requirement?';\
		getGAEventTrackingJS("messagecentre", "reply_sent_bl_msg_5", glid);\
		$('#send_inst_enq_msg_2').css("display", "none");\
	\} else if(argument == 6) \{\
		document.getElementById('massage-text').value = 'Hi, I wanted to get a followup on the Requirement. Can you please provide an update?';\
		getGAEventTrackingJS("messagecentre", "reply_sent_bl_msg_6", glid);\
		$('.inst_enq_msg').css("display", "none");\
	\} else if(argument == 8) \{\
		document.getElementById('massage-text').value = 'Hi, I wanted to get a followup on our last conversation. Can you please update me on the Requirement?';\
		getGAEventTrackingJS("messagecentre", "reply_sent_bl_msg_8", glid);\
		$('.inst_enq_msg').css("display", "none");\
	\}\
	getGAEventTrackingJS("messagecentre", "reply_sent_bl_msg", glid);\
	sendreply();\
\}\
/*function to open the fraud alert box connected to the buyer*/\
function openFraudAlert() \{\
	if($("#fraud_div").length == 0) \{\
		fraud_div = '<div id="fraud_div">' + '<svg onclick="$(\\'#fraud_div\\').remove();" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="16" height="16" viewBox="0 0 16 16" style="fill:#333333;margin-top: 7px;float: right;cursor:pointer;margin-right: 7px;"><g id="surface1"><path style=" " d="M 2.75 2.042969 L 2.042969 2.75 L 2.398438 3.101563 L 7.292969 8 L 2.042969 13.25 L 2.75 13.957031 L 8 8.707031 L 12.894531 13.605469 L 13.25 13.957031 L 13.957031 13.25 L 13.605469 12.894531 L 8.707031 8 L 13.957031 2.75 L 13.25 2.042969 L 8 7.292969 L 3.101563 2.398438 Z "></path></g></svg>' + '<p style="color:#da2931;font-size:16px;line-height:25px;"><span class="warning20"></span>Be Aware of this User!</p>' + '<p style="line-height: 17px;font-size: 13px;">This user has been removed from IndiaMART. </p><p style="line-height: 15px;font-size: 13px;padding-bottom: 5px">Please don\'92t communicate with the user or exchange any money or items.</p>' + '</div>';\
		$(".dflx.pd15_0 ").after(fraud_div);\
	\}\
\}\
\
function show_prfile() \{\
	getGAEventTrackingJS("messagecentre", "user_click_view_detail", glid);\
	if($('#buyer_profile_details').html() != null && $('#buyer_profile_details').html() != undefined && $('#buyer_profile_details').html() != '') \{\
		$('#buyer_profile_details').css("display", "block");\
		$('#view_detail_icn').css("display", "none");\
		chatSectionHeight();\
		$(".chat-section").scrollTop(90000);\
	\} else \{\
		var k = $('#k').val() ? $('#k').val() : '1';\
		var promise = new Promise(function(resolve, reject) \{\
			$.ajax(\{\
				url: '/phpajax/enquiry/messagecentre/buyerProfile',\
				data: \{\
					"k": k\
				\},\
				dataType: "json",\
				type: "GET",\
				success: function(jsonResult) \{\
					jsonResult = JSON.parse(jsonResult);\
					resolve(jsonResult);\
				\},\
				error: function(err) \{\
					console.log(err);\
				\}\
			\});\
		\});\
		promise.then(function(result) \{\
			if(result['Response'] && result['Response']['Data'] && result['Response']['Data']['contacts_glid']) \{\
				var design = '';\
				var contactData = result['Response']['Data'];\
				if(contactData['contacts_company']) \{\
					var designation = contactData['glusr_usr_designation'] !== undefined && contactData['glusr_usr_designation'] !== null && contactData['glusr_usr_designation'].trim() !== '' ? contactData['glusr_usr_designation'].trim() + ' at' : '';\
					var website_link = contactData['contacts_website'] !== undefined && contactData['glusr_usr_designation'] !== null && contactData['contacts_website'].trim() !== '' ? '<a style="text-decoration:underline" onclick="getGAEventTrackingJS(\\'messages_company_link_clicked\\')" href="' + contactData['contacts_website'] + '" target="_blank">' + contactData['contacts_company'] + '</a>' : contactData['contacts_company'];\
					design += '<li><span class="dtl_icn"><span class="cnt_dtl_icn_new dtl_company"></span></span>' + '<span class="f1 w500">' + designation + ' ' + website_link + '</span></li>';\
				\}\
				var address = '';\
				if(contactData['contacts_address']) \{\
					address += contactData['contacts_address'];\
				\}\
				if(contactData['contact_locality']) \{\
					if(address != '') \{\
						address += ', ' + contactData['contact_locality'];\
					\} else \{\
						address += contactData['contact_locality'];\
					\}\
				\}\
				if(contactData['contact_city']) \{\
					if(address != '') \{\
						address += ', ' + contactData['contact_city'];\
					\} else \{\
						address += contactData['contact_city'];\
					\}\
				\}\
				if(contactData['contact_district']) \{\
					if(address != '') \{\
						address += ', ' + contactData['contact_district'];\
					\} else \{\
						address += contactData['contact_district'];\
					\}\
				\}\
				if(contactData['contact_state']) \{\
					if(address != '') \{\
						address += ', ' + contactData['contact_state'];\
					\} else \{\
						address += contactData['contact_state'];\
					\}\
				\}\
				if(contactData['contact_pincode']) \{\
					if(address != '') \{\
						address += '-' + contactData['contact_pincode'];\
					\} else \{\
						address += contactData['contact_pincode'];\
					\}\
				\}\
				if(address) \{\
					design += '<li><span class="dtl_icn dsp_inb"><span class="cnt_dtl_icn_new dtl_loc_unfil"></span></span>' + '<spanfGN  class="f1 w500 dsp_inb" id="recv_address" sAseddtyle="word-wrap:break-word;max-width:calc(100% - 140px);">' + address + ' </span><div class="f1 dsp_inb"><span id ="dir" class="gd" onclick="getGAEventTrackingJS(\\'direction_link_clicked\\')"><span class="get_direction"></span><a href = "http://maps.google.com/maps?q=' + address + '" target="_blank">Get direction</a></span></div></li>';\
				\}\
				if(contactData['business_type']) \{\
					design += '<li><span class="dtl_icn"><span class="cnt_dtl_icn_new dtl_business_type"></span></span>' + '<span class="f1" style="margin-right:7px;">Business Type: </span>' + '<span class="f1 w500 cont_dtl_val" >' + contactData['business_type'] + '</span></li>';\
				\}\
				if(contactData['gst']) \{\
					design += '<li><span class="dtl_icn"><span class="cnt_dtl_icn_new dtl_gst"></span></span>' + '<span class="f1" style="margin-right:7px;">GST: </span>' + '<span class="f1 w500 cont_dtl_val" >' + contactData['gst'] + '</span>';\
					if(contactData['is_gst_verified'] == 1) \{\
						design += '<span class="cnt_dtl_icn_new dtl_verified" style="margin-top: 5px;margin-left:3px;"></span>';\
					\}\
					design += '</li>';\
				\}\
				if(contactData['iec_code']) \{\
					design += '<li><span class="dtl_icn"><span class="cnt_dtl_icn_new dtl_gst"></span></span>' + '<span class="f1" style="margin-right:7px;">IEC: </span>' + '<span class="f1 w500 cont_dtl_val" >' + contactData['iec_code'] + '</span></li>';\
				\}\
				if(contactData['glusr_usr_membersince']) \{\
					var sinceDate = new Date(contactData['glusr_usr_membersince']);\
					var diff = new Date().getFullYear() - sinceDate.getFullYear();\
					if(diff == 0) \{\
						diff = "this Year";\
					\} else if(diff == 1) \{\
						diff = "1 Year";\
					\} else \{\
						diff += " Years";\
					\}\
					design += '<li><span class="dtl_icn"><span class="cnt_dtl_icn_new dtl_member_since"></span></span>' + '<span class="f1" style="margin-right:7px;">Member Since: </span>' + '<span class="f1 w500 cont_dtl_val" >' + diff + '</span></li>';\
				\}\
				if(contactData['buyer_product_sold']) \{\
					design += '<li><span class="dtl_icn"><span class="cnt_dtl_icn_new dtl_sells"></span></span>' + '<span class="f1" style="margin-right:7px;">Sells: </span>' + '<span class="f1 w500 cont_dtl_val" >' + contactData['buyer_product_sold'] + '</span></li>';\
				\}\
				if(contactData['turn_over']) \{\
					design += '<li><span class="dtl_icn"><span class="cnt_dtl_icn_new dtl_rs"></span></span>' + '<span class="f1" style="margin-right:7px;">Turnover: </span>' + '<span class="f1 w500 cont_dtl_val" >' + contactData['turn_over'] + '</span></li>';\
				\}\
				if(contactData['glusr_usr_year_of_estb']) \{\
					design += '<li><span class="dtl_icn"><span class="cnt_dtl_icn_new dtl_estb"></span></span>' + '<span class="f1" style="margin-right:7px;">Year of establishment: </span>' + '<span class="f1 w500 cont_dtl_val" >' + contactData['glusr_usr_year_of_estb'] + '</span></li>';\
				\}\
				if(contactData['no_of_emp']) \{\
					design += '<li><span class="dtl_icn"><span class="cnt_dtl_icn_new dtl_emp"></span></span>' + '<span class="f1" style="margin-right:7px;">Number of employees: </span>' + '<span class="f1 w500 cont_dtl_val" >' + contactData['no_of_emp'] + '</span></li>';\
				\}\
				$('#buyer_profile_details').html(design);\
				$('#buyer_profile_details').css("display", "block");\
				$('#view_detail_icn').css("display", "none");\
				chatSectionHeight();\
				$(".chat-section").scrollTop(90000);\
				if($("#hdr_img img").attr("src")) $('#buyer_profile_details').css("margin-left", "77px");\
			\}\
			//document.getElementsByClassName('adress_dtl')[0].setAttribute('id','buyerProfile');\
			//$(".nav-toggle").html('<i class="fa fa-caret-up" aria-hidden="true"></i>');\
			//change chat section height\
			// var changedHeight = ($('.right-section').height() - ($('.header.border').height() + $('.bottom-send-section').height()));\
			// $('.chat-section').css('height',changedHeight);\
			// $('.chat-section').css('max-height',changedHeight);\
		\}).\
		catch(function() \{\
			console.log('Some error has occured');\
		\});\
	\}\
\}\
$(document).on('click', '.chat-section, .bottom-send-section', function() \{\
	if($('#buyer_profile_details1').css("display") == "flex") \{\
		if($('.slidbox').is(":visible")) \{\
			slideUpProfileInformation();\
		\} else \{\
			slideDownProfileInformation();\
		\}\
		$('#mslft').html('');\
		$('#mslrt1').html('');\
		$('#buyer_profile_details1').css("display", "none");\
		$('#view_detail_icn').css("display", "inline-block");\
		chatSectionHeight();\
	\}\
\});\
\
\
/* product catalog changes */\
// Get the modal\
var modal = document.getElementById("myModal");\
\
// Get the button that opens the modal\
var btn = document.getElementById("myBtn");\
\
// Get the <span> element that closes the modal\
var span = document.getElementsByClassName("close")[0];\
\
function showPayModal(ele, prodName, prodAmt, prodGlid)\{\
\
	document.getElementById("amount_err_mpos").innerHTML = '';\
	$("#btnContinue").addClass('active');\
	$('#'+ele).show();\
	if(prodName) \{\
		$("#cust_product").val(prodName);\
		$("#cust_product_hr").text(prodName);\
	\}\
	else if(ele == 'myModal3')\{\
		if(document.getElementById('msg_prod_name'))\
	\{   prdvalid = 1;\
		document.getElementById('cust_product1').value = document.getElementById('msg_prod_name').value;\}	\
	\}\
	if(prodAmt) \{\
		$("#cust_amount").val(prodAmt);\
	\}\
	if(prodGlid) \{\
		$("#glid_hidden").val(prodGlid);\
	\}\
	$("#cust_amount").focus();\
\}\
function hidePayModal(ele)\{\
	$('#'+ele).hide();\
\}\
\
// When the user clicks anywhere outside of the modal, close it\
window.onclick = function(event) \{\
  if (event.target == modal) \{\
    modal.style.display = "none";\
  \}\
\}\
\
// Identify seller tye and  sent payment link\
function identifySellerType() \{\
    \
    var imesh = new userDataCookie().get();\
    var buyerGLID = imesh.glid;\
    mpos_product();\
    mpos_amount();\
    var product_err_mpos = document.getElementById('product_err_mpos').style.display;\
    var amount_err_mpos = document.getElementById('amount_err_mpos').style.display;\
    var product_name = document.getElementById('cust_product').value;\
    var amount = document.getElementById('cust_amount').value;\
    var glid = document.getElementById('glid_hidden').value;\
    if (product_name != '' && amount != '' && glid != '')\
    \{\
		generatePayxLead('BUYER_MSG',glid);\
    \}\
\
    getGAEventTrackingJS('Payments', 'CTA Click', 'Secure Your Payment Now');\
\}\
\
function getCookie(cname) \{\
    var name = cname + "=";\
    var decodedCookie = decodeURIComponent(document.cookie);\
    var ca = decodedCookie.split('|');\
    for (var i = 0; i < ca.length; i++) \{\
        var c = ca[i];\
        while (c.charAt(0) == ' ') \{\
            c = c.substring(1);\
        \}\
        if (c.indexOf(name) == 0) \{\
            return c.substring(name.length, c.length);\
        \}\
    \}\
    return "";\
\}\
\
function mpos_product() \{\
\
\
\
    var prod_name = $("#cust_product").val();\
    prod_name = prod_name.trim();\
    if (prod_name == "")\
    \{\
        $('#product_err_mpos').css('display', 'block');\
        $("#cust_product").parent().addClass('active');\
        document.getElementById("product_err_mpos").innerHTML = 'Please enter product name';\
        return false;\
\
    \}else\
    \{\
        $('#product_err_mpos').css('display', 'none');\
        $("#cust_product").parent().addClass('active');\
    \}\
\
    productName = document.getElementById("cust_product").value;\
    return true;\
\}\
\
function mpos_amount() \{\
    var amount_limit = $("#amount_limit").val();\
\
    document.getElementById("cust_amount").value = document.getElementById("cust_amount").value.replace(/^\\s+|\\s+$/g, "");\
    var prod_amount = document.getElementById("cust_amount").value;\
    if (document.getElementById("cust_amount").value == "") \{\
        $('#amount_err_mpos').css('display', 'block');\
        $("#cust_amount").parent().addClass('active');\
		$("#btnContinue").removeClass('active');\
        document.getElementById("amount_err_mpos").innerHTML = 'Please enter amount';\
        return false;\
    \} else if (!prod_amount.match(/^\\d+(\\.\\d\{0,2\})?$/)) \{\
        $('#amount_err_mpos').css('display', 'block');\
        $("#cust_amount").parent().addClass('active');\
		$("#btnContinue").removeClass('active');\
        document.getElementById("amount_err_mpos").innerHTML = 'Amount must be number OR number with max two decimal';\
        return false;\
    \} else if (Number(amount_limit) < 20) \{\
        $('#amount_err_mpos').css('display', 'block');\
        $("#cust_amount").parent().addClass('active');\
		$("#btnContinue").removeClass('active');\
        document.getElementById("amount_err_mpos").innerHTML = 'You can not accept any payment right now';\
        return false;\
\
    \} else if (prod_amount < 20 || prod_amount > Number(amount_limit)) \{\
        $('#amount_err_mpos').css('display', 'block');\
        $("#cust_amount").parent().addClass('active');\
		$("#btnContinue").removeClass('active');\
        document.getElementById("amount_err_mpos").innerHTML = 'Amount must be in the range of (Min 20 to Max ' + amount_limit + ')';\
        return false;\
\
    \} else \{\
        $('#amount_err_mpos').css('display', 'none');\
        $("#cust_amount").parent().addClass('active');\
		$("#btnContinue").addClass('active');\
	\}\
    amountToBePaid = document.getElementById('cust_amount').value;\
	\
    return true;\
\}\
\
function amount_keyup_mpos() \{\
    document.getElementById("cust_amount").value = document.getElementById("cust_amount").value.replace(/^\\s+|\\s+$/g, "");\
    var prod_amount = document.getElementById("cust_amount").value;\
    if (prod_amount != '') \{\
        mpos_amount();\
    \}\
\}\
\
function generatePayxLead(bs_modid,supplierGLID) \{\
\
    if (bs_modid == 'PAYX')\
    \{\
        var lead_mode = '168835';\
    \} else\
    \{\
        var lead_mode = '181716';\
    \}\
\
\
\
    if ($('#mobile_err_mpos').css('display') == 'block')\
        return false;\
\
    if ($('#product_err_mpos').css('display') == 'block')\
        return false;\
\
    if ($('#amount_err_mpos').css('display') == 'block')\
        return false;\
\
\
    var imesh = new userDataCookie().get();\
    var buyerGLID = imesh.glid;\
    $('.paynowbtns').addClass('load');\
    \
\
    $.ajax(\{\
        url: '/phpajax/buyertools/payments/generatePayWithURL',\
        timeout: 10000,\
        data: \{\
            'BS_BUYER_GLID': buyerGLID,\
            'BS_SUPPLIER_GLID': supplierGLID,\
            'BS_PRODUCT_DETAIL': productName,\
            'BS_PAYMENT_AMOUNT': amountToBePaid,\
            'BS_MODID': bs_modid,\
            'BS_BUYER_EMAIL': imesh.em\
        \},\
\
        dataType: "JSON",\
        type: "GET",\
        success: function (result) \{\
//            console.log('generate paywith success');\
//            console.log(result);\
            //document.getElementById('loaderdiv').style.display = 'none';\
            if (result.status == 200) \{\
                getGAEventTrackingJS('Payments', 'Generate URL', 'Payment Protection');\
                var payURL = window.location.href.match(/(\\/\\/dev-my|\\/\\/stg-my)/gi) ? "https://dev-paywith.indiamart.com/invoice/#/" : "https://paywith.indiamart.com/invoice/#/";\
                //  var payURL = "https://paywith.indiamart.com/payx/#/";\
                var payWithURL = payURL + (result.result);\
                window.location = payWithURL;\
//                        window.open(payWithURL, '_blank');\
                $('#cust_mobile').val('');\
                $('#cust_product').val('');\
                $('#cust_amount').val('');\
                // window.location.reload(true);\
            \}\
            if (result.status == 206)\
            \{\
                //document.getElementById('loaderdiv').style.display = 'none';\
                document.getElementById('mobile_err_mpos').innerHTML = 'Some error occurred. Please contact 9696969696 for Support';\
                return false;\
            \}\
\
            if (result.status == 205)\
            \{\
                //document.getElementById('loaderdiv').style.display = 'none';\
                document.getElementById('mobile_err_mpos').innerHTML = 'Payment cannot proceed as Seller KYC is Pending. Please contact Seller or 9696969696 for support';\
//                        alert('Payment cannot proceed as Seller KYC is Pending. Please contact Seller or 9696969696 for support');\
                return false;\
            \}\
        \},\
        error: function (data) \{\
            //document.getElementById('loaderdiv').style.display = 'none';\
            //get the status code\
            alert('Please check your Internet Connection!!');\
        \}, complete: function (data) \{\
            //document.getElementById('loaderdiv').style.display = 'none';\
            $('.paynowbtn').removeClass('load');\
        \},\
\
    \});\
\
\}\
/**\
* @description: Function to display scrollbar in message centre chat box only after 5 lines have been written\
*/\
function toggleScrollDisplay()\{\
	var height_textarea = $('#massage-text').height();\
	if (height_textarea <= 30)\{\
		$('#massage-text').css('height','30px');\
	\}\
	if (height_textarea > 95)\{\
			$('#massage-text').css('overflow','visible');\
	\}\
	else\{\
			$('#massage-text').css('overflow','hidden');\
	\}\
\}\
function chatSectionHeight()\{\
       var bottomsection = $('.bottom-send-section').height();\
       var name_header = $('#pd15_0').height();\
       var total = $('.right-section').height();\
       var viewMoreSection = $('.slidbox').outerHeight(true);\
       var finalValue = 0;\
       finalValue = total - bottomsection - name_header - 55;\
       $('.chat-section').css('height',finalValue+'px');\
\}\
function slideUpProfileInformation()\{\
	$('.slidbox').slideUp(50);\
	$('#view_detail_icn2').hide();\
	setTimeout(function()\{\
		$('#view_detail_icn').show();\
		$('#topsection_container').css('border-radius','8px 8px 8px 8px');\
	\}, 20);\
\}\
function slideDownProfileInformation()\{\
	$('.slidbox').slideDown(50);\
	$('#view_detail_icn').hide();\
	$('#buyer_profile_details1').css('z-index', '2');\
	$('#topsection_container').css('border-radius','8px 8px 0px 0px');\
	setTimeout(function()\{\
		$('#buyer_profile_details1').css('overflow', 'visible');\
		$('#view_detail_icn2').show();\
	\}, 20);\
\}\
function toggleSubmitButton()\{\
	var message_content = $('#massage-text').val().trim();\
	if (message_content == "")\{\
		$('.send_button').css(\{\
			'background':'#999',\
			'cursor': 'not-allowed'\
		\});\
	\}\
	else \{\
		$('.send_button').css(\{\
			'background':'#02887d',\
			'cursor': 'pointer'\
		\});\
	\}\
\}\
// $( document ).ready(function() \{\
// 	var cookie = readCookie('ImeshVisitor');\
// 	var glusr = getparamVal(cookie, "glid");\
// 	var cookieName = 'bannerDisplay'+glusr;\
// 	var cookie = readCookie(cookieName);\
// 	if (cookie == null || cookie == "") \{ \
// 		document.cookie = cookieName+"=done";\
// 		var modal = document.getElementById("myModal_25Anniversary"); \
// 		modal.style.display = "table";\
// 	\}\
// \});\
// function closeModal()\{\
// 	$("#myModal_25Anniversary").hide();\
// \}\
function textToInfluRating(influ)\{\
	var value1_influ = [];\
	if(influ != '' && influ != undefined && influ != "null")\{\
		var value = JSON.stringify(influ);\
		value_influ = JSON.parse(value);\
		value1_influ =  JSON.parse(value_influ);\
	\}\
\
	var thumbsUpIcon = `<svg style="position: relative;top: 2px" xmlns="http://www.w3.org/2000/svg" width="16px" height="16px" viewBox="0 0 21 21" version="1.1"> <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" style="fill: #72ae44;"><g transform="translate(-224.000000, -415.000000)" fill-rule="nonzero" stroke="#979797"><g transform="translate(224.000000, 416.000000)"><path d="M0.5,7.96875 L0.5,16.46875 C0.5,17.0555114 0.779808125,17.53125 1.125,17.53125 L3,17.53125 L3,6.90625 L1.125,6.90625 C0.779808125,6.90625 0.5,7.38192381 0.5,7.96875 Z" id="Path" fill="#72ae44"></path><path d="M13.6239641,6.64034609 C13.280908,6.64034609 13.1090566,6.41142648 13.0513403,6.31285438 C12.993624,6.21493105 12.8768938,5.95358594 13.0429098,5.65397953 C13.5301452,2.16116219 13.5716453,0.364387031 13.1674101,0.263654063 L12.1920683,0.0198182813 C11.9547177,-0.0398436172 11.7031005,0.0360308359 11.537733,0.219556328 L6.24210015,6.10273836 C5.69282218,6.71427219 5.39062195,7.50284773 5.39062195,8.32384148 L5.39062195,15.2731493 C5.39062195,17.1038634 6.88022038,18.5934618 8.71093445,18.5934618 L15.3171876,18.5928133 C16.8087384,18.5928133 18.1258399,17.5882886 18.5194696,16.1505641 L19.9370837,9.64482343 C19.9785876,9.46389296 19.999988,9.27842163 19.999988,9.09295163 C19.999988,7.74082741 18.8994864,6.64032976 17.5473662,6.64032976 L13.6239641,6.64034609 Z" id="Path"></path></g></g></g></svg> `;\
	var thumbsDnIcon = `<svg style="position: relative;top: 4px" xmlns="http://www.w3.org/2000/svg" width="16px" height="16px" viewBox="0 0 21 21" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" style="fill: red;"><g transform="translate(-293.000000, -361.000000)" fill-rule="nonzero" stroke="#979797"><g transform="translate(304.000000, 371.375000) scale(-1, -1) translate(-304.000000, -371.375000) translate(294.000000, 362.000000)"><path d="M0.5,7.96875 L0.5,16.46875 C0.5,17.0555114 0.779808125,17.53125 1.125,17.53125 L3,17.53125 L3,6.90625 L1.125,6.90625 C0.779808125,6.90625 0.5,7.38192381 0.5,7.96875 Z" id="Path" fill="red"></path><path d="M13.6239641,6.64034609 C13.280908,6.64034609 13.1090566,6.41142648 13.0513403,6.31285438 C12.993624,6.21493105 12.8768938,5.95358594 13.0429098,5.65397953 C13.5301452,2.16116219 13.5716453,0.364387031 13.1674101,0.263654063 L12.1920683,0.0198182813 C11.9547177,-0.0398436172 11.7031005,0.0360308359 11.537733,0.219556328 L6.24210015,6.10273836 C5.69282218,6.71427219 5.39062195,7.50284773 5.39062195,8.32384148 L5.39062195,15.2731493 C5.39062195,17.1038634 6.88022038,18.5934618 8.71093445,18.5934618 L15.3171876,18.5928133 C16.8087384,18.5928133 18.1258399,17.5882886 18.5194696,16.1505641 L19.9370837,9.64482343 C19.9785876,9.46389296 19.999988,9.27842163 19.999988,9.09295163 C19.999988,7.74082741 18.8994864,6.64032976 17.5473662,6.64032976 L13.6239641,6.64034609 Z" id="Path"></path></g></g></g></svg>`;\
	\
	if(0 in value1_influ)\
	var thmb_down = value1_influ[0];\
	else\
	var thmb_down = '';\
	\
	if(1 in value1_influ)\
	var thmb_up = value1_influ[1];\
	else\
	var thmb_up = '';\
		\
	var ratingDwnText = '';\
	var ratingUPText = '';\
\
	var final_text = '';\
\
	if(thmb_up !== '')\{\
		for(var i = 0; i < thmb_up.length; i++)\{\
			var c = thmb_up.charAt(i);\
			if (c == '1') \{\
				ratingUPText += "Response " + thumbsUpIcon + "&emsp;";\
			\}\
			else if (c == '2')\{\
				ratingUPText += "Quality " + thumbsUpIcon + "&emsp;";\
			\}\
			else if (c == '3')\{\
				ratingUPText += "Delivery " + thumbsUpIcon + "&emsp;";\
			\}\
		\}\
	\}\
	if(thmb_down !== '')\{\
		for(var i = 0; i < thmb_down.length; i++)\{\
			var c = thmb_down.charAt(i);\
			if (c == '1') \{\
				ratingDwnText += "Response " + thumbsDnIcon + "&emsp;";\
			\}\
			else if (c == '2')\{\
				ratingDwnText += "Quality " + thumbsDnIcon + "&emsp;";\
			\}\
			else if (c == '3')\{\
				ratingDwnText += "Delivery " + thumbsDnIcon + "&emsp;";\
			\}\
		\}\
	\}\
	  final_text = ratingUPText + ratingDwnText;\
	  return final_text;                   \
\}\
\
function avgRatingDate(date)\{\
	var date_array = [];\
	date_array = date.split('-');\
	var months = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];\
	var month_name = months[date_array[1] - 1];\
	var final_date = date_array[0] + "-" + month_name + "-" + date_array[2];\
	return final_date;  \
\}\
\
\
var Imesh = readCookie("ImeshVisitor");\
var gliduser = getparamVal(Imesh, "glid");\
\
\
\
function myFunc() \{\
	var nodivmail = 0;\
	var nodivnum = 0;\
	var total = 0;\
	var remaining = 0;\
	var unverified = 0;\
	var utypelabel = '';\
	var Imesh = readCookie("ImeshVisitor");\
    var phcc = getparamVal(Imesh, "phcc");\
	var utyp = getparamVal(Imesh, "utyp");\
  if(utyp == 'N')\{\
	utypelabel = 'Buyer';\
  \}\
  else if(utyp == 'F')\
  \{utypelabel = 'FreeSeller';\}\
\
  else if(utyp == 'P')\{\
	utypelabel = 'PaidSeller';\
  \}\
\
	\
	var v1 = '<div id="modal_window" class="modalp-content" style="top: 61px;position: relative;left: 0%;text-align: center;text-align: -moz-center;text-align: -ms-center;text-align: -o-center;text-align: -webkit-center;width: max-content;"><div class="popup-header"><h2 class="popup-heading text-center upsell-heading">Verify Details to Confirm your Identity</h2></div> <div class="popup-body"><div class="popup-content"><div class="verification-block"><h3 id ="m1" class="main_heading" style="font-size: 17px;color: black;padding: 1.8%;">Verify your Contact Details to proceed</h3><p id = "dt" class="ver_cs"></p><div class="form-group form-input"></div><div class="verification_cover mauto"><div class="mobileBlock" id ="mobblock" ><span class="headU">Mobile No.</span><div id ="mob" class="primary"><span class="phn_ico"></span><p id="p_mo" class="numberC"></p><div style="display: inline-block;position: relative;right: 257px;bottom: -16px;font-size: 11px;font-style: italic;color: #848080;top: 16px;">primary</div><span id="vrf_mob" class="vrfy" onclick =" verify_popup(this.id) ;getGAEventTrackingJS(\\'MyMessages\\',\\'ClickOnVerify\\',\\'PrimaryMobile\\');">verify</span><div id="pm_otp"></div></div></div><div id = "emblock" class="emailBlock"></div></div><div class="hereEdit" style="text-align: center;" onclick ="getGAEventTrackingJS(\\'editprofile\\',\\'click\\',\\'editprofile section\\');"><a href="/userprofile/contactprofile/" ;=""> Edit</a> your contact details</div></div></div></div></div>';\
	var v2 = '<div id="modal_window" class="modalp-content" style="top: 61px;position: relative;left: 0%;text-align: center;text-align: -moz-center;text-align: -ms-center;text-align: -o-center;text-align: -webkit-center;width: max-content;"><div class="popup-header"><h2 class="popup-heading text-center upsell-heading">Verify Details to Confirm your Identity</h2></div><div class="popup-body"><div class="popup-content"><div class="verification-block"><h3 id = "m2" class="main_heading"style="font-size: 17px;color: black;padding: 1.8%;">Verify your Contact Details to proceed</h3><p id = "dt" class="ver_cs"></p><div class="form-group form-input"> </div><div class="verification_cover mauto"><div class="mobileBlock" id ="mobblock"><span class="headU">Mobile No.</span><div id ="mob" class="primary"><span class="phn_ico"></span><p id="p_mo1" class="numberC"></p><div style="display: inline-block;position: relative;right: 257px;bottom: -16px;font-size: 11px;font-style: italic;color: #848080;top: 16px;">primary</div><span id="vrf_mob" class="vrfy " onclick =" verify_popup(this.id) ; getGAEventTrackingJS(\\'MyMessages\\',\\'ClickOnVerify\\',\\'PrimaryMobile\\');">verify</span><div id="pm_otp"></div></div></div><div id = "emblock" class="emailBlock"><span class="headU">Email ID</span><div id ="emil" class="primary"><span class="eml_ico"></span><p id ="p_email1" class="numberC" style="position: relative;right: 37px;"></p><div style="display: inline-block;position: relative;right: 257px;bottom: -16px;font-size: 11px;font-style: italic;color: #848080;top: 16px;">primary</div><span id="vrf_eml" class="vrfy" onclick =" verify_popup(this.id) ; getGAEventTrackingJS(\\'MyMessages\\',\\'ClickOnVerify\\',\\'PrimaryEmail\\');">verify</span><div id="eml_otp"></div></div></div></div><div class="hereEdit" style=" text-align: center;" onclick ="getGAEventTrackingJS(\\'editprofile\\',\\'click\\',\\'editprofile section\\');"><a href="/userprofile/contactprofile/" ;=""> Edit</a> your contact details</div></div></div></div></div>';\
	var v3 = '<div id="modal_window" class="modalp-content" style="top: 61px;position: relative;left: 0%;text-align: center;text-align: -moz-center;text-align: -ms-center;text-align: -o-center;text-align: -webkit-center;width: max-content;"><div class="popup-header"><h2 class="popup-heading text-center upsell-heading">Verify Details to Confirm your Identity</h2> </div> <div class="popup-body"><div class="popup-content"><div class="verification-block"><h3 id ="m3" class="main_heading" style="font-size: 17px;color: black; padding: 1.8%;">Verify your Contact Details to proceed</h3><p id = "dt" class="ver_cs"></p><div class="form-group form-input"></div><div class="verification_cover mauto"><div class="mobileBlock" id ="mobblock"><div id = "emblock" class="emailBlock"><span class="headU">Email ID</span><div id ="emil" class="primary"><span class="eml_ico"></span><p id ="p_email2" class="numberC" style="position: relative;right: 37px;"></p><div style="display: inline-block;position: relative;right: 257px;bottom: -16px;font-size: 11px;font-style: italic;color: #848080;top: 16px;">primary</div><span id="vrf_eml" class="vrfy " onclick =" verify_popup(this.id) ; getGAEventTrackingJS(\\'MyMessages\\',\\'ClickOnVerify\\',\\'PrimaryEmail\\');">verify</span><div id="eml_otp"></div></div></div></div> <div class="hereEdit" style="text-align: center;"onclick ="getGAEventTrackingJS(\\'editprofile\\',\\'click\\',\\'editprofile section\\');"><a href="/userprofile/contactprofile/" ;=""> Edit</a> your contact details</div></div></div></div></div>';\
	var v4 = '<div id="modal_window" class="modalp-content" style="top: 61px;position: relative;left: 0%;text-align: center;text-align: -moz-center;text-align: -ms-center;text-align: -o-center;text-align: -webkit-center;width: max-content;"><div class="popup-header"><h2 class="popup-heading text-center upsell-heading">Verify Details to Confirm your Identity</h2></div><div class="popup-body"><div class="popup-content"><div class="verification-block"><h3 id = "m4" class="main_heading" style="font-size: 17px;color: black;padding: 1.8%;"></h3><p  id = "dt" class="ver_cs"></p><div class="form-group form-input"></div><div class="verification_cover mauto"><div class="mobileBlock" id ="mobblock"><span class="headU">Mobile No.</span><div id = "mob" class="primary"><span class="phn_ico"></span><p id="p_mo4" class="numberC"></p><div style="display: inline-block;position: relative;right: 257px;bottom: -16px;font-size: 11px;font-style: italic;color: #848080;top: 16px;">primary</div><span class="verified" ></span><div id="pm_otp"></div></div></div><div id ="emblock" class="emailBlock"><span class="headU">Email ID</span><div id ="emil" class="primary"><span class="eml_ico"></span><p id ="p_email4" class="numberC" style="position: relative;right: 37px;"></p><div style="display: inline-block;position: relative;right: 257px;bottom: -16px;font-size: 11px;font-style: italic;color: #848080;top: 16px;">primary</div><span id="vrf_eml" class="vrfy " onclick =" verify_popup(this.id) ; getGAEventTrackingJS(\\'MyMessages\\',\\'ClickOnVerify\\',\\'PrimaryEmail\\');">verify</span><div id="eml_otp"></div></div></div></div><div class="hereEdit" style="text-align: center;"onclick ="getGAEventTrackingJS(\\'editprofile\\',\\'click\\',\\'editprofile section\\');"><a href="/userprofile/contactprofile/" ;=""> Edit</a> your contact details</div></div></div></div></div>';\
	var v5 = '<div id="modal_window" class="modalp-content" style="top: 61px;position: relative;left: 0%;text-align: center;text-align: -moz-center;text-align: -ms-center;text-align: -o-center;text-align: -webkit-center;width: max-content;"><div class="popup-header"><h2 class="popup-heading text-center upsell-heading">Verify Details to Confirm your Identity</h2></div> <div class="popup-body"><div class="popup-content"><div class="verification-block"><h3  id ="m5" class="main_heading"style=" font-size: 17px; color: black; padding: 1.8%;">Verify your Contact Details to proceed</h3><p  id = "dt" class="ver_cs"></p><div class="form-group form-input"></div><div class="verification_cover mauto"><div class="mobileBlock" id ="mobblock"><span class="headU">Mobile No.</span><div id = "mob" class="primary"><span class="phn_ico"></span><p id="p_mo5" class="numberC"></p><div style="display: inline-block;position: relative;right: 257px;bottom: -16px;font-size: 11px;font-style: italic;color: #848080;top: 16px;">primary</div><span id="vrf_mob" class="vrfy" onclick =" verify_popup(this.id) ;getGAEventTrackingJS(\\'MyMessages\\',\\'ClickOnVerify\\',\\'PrimaryMobile\\');">verify</span><div id="pm_otp"></div></div></div><div id = "emblock" class="emailBlock"><span class="headU">Email ID</span><div id ="emil" class="primary"><span class="eml_ico"></span><p id ="p_email5" class="numberC" style="position: relative;right: 37px;"></p><div style="display: inline-block;position: relative;right: 257px;bottom: -16px;font-size: 11px;font-style: italic;color: #848080;top: 16px;">primary</div><span class="verified" ></span><div id="eml_otp"></div></div></div></div><div class="hereEdit"  style="text-align: center;"onclick ="getGAEventTrackingJS(\\'editprofile\\',\\'click\\',\\'editprofile section\\');"><a href="/userprofile/contactprofile/" ;=""> Edit</a> your contact details</div></div></div></div></div>';\
	var v6 = '<div id="modal_window" class="modalp-content" style="top: 61px;position: relative;left: 0%;text-align: center;text-align: -moz-center;text-align: -ms-center;text-align: -o-center;text-align: -webkit-center;width: max-content;"><div class="popup-header"><h2 class="popup-heading text-center upsell-heading">Verify Details to Confirm your Identity</h2></div><div class="popup-body"><div class="popup-content"><div class="verification-block"><h3 id="m6" class="main_heading" style="font-size: 17px;color: black;padding: 1.8%;">Verify your Contact Details to proceed</h3><p id="dt" class="ver_cs"></p><div class="form-group form-input"></div><div class="verification_cover mauto"><div class="mobileBlock" id="mobblock"><span class="headU">Mobile No.</span><div id="mob" class="primary"><span class="phn_ico"></span><p id="p_mo6" class="numberC"></p><div style="display: inline-block;position: relative;right: 257px;bottom: -16px;font-size: 11px;font-style: italic;color: #848080;top: 16px;">primary</div><span class="verified"></span><div id="pm_otp"></div></div></div><div id="emblock" class="emailBlock"></div></div><div class="hereEdit" style="text-align: center;" onclick="getGAEventTrackingJS(\\'editprofile\\',\\'click\\',\\'editprofile_section\\');"><a href="/userprofile/contactprofile/" ;=""> Edit</a> your contact details</div></div></div></div></div>';\
	var v7 = '<div id="modal_window" class="modalp-content" style="top: 61px;position: relative;left: 0%;text-align: center;text-align: -moz-center;text-align: -ms-center;text-align: -o-center;text-align: -webkit-center;width: max-content;"><div class="popup-header"><h2 class="popup-heading text-center upsell-heading">Verify Details to Confirm your Identity</h2></div><div class="popup-body"><div class="popup-content"><div class="verification-block"><h3 id="m7" class="main_heading" style="font-size: 17px;color: black;padding: 1.8%;">Verify your Contact Details to proceed</h3><p id="dt" class="ver_cs"></p><div class="form-group form-input"></div><div class="verification_cover mauto"><div class="mobileBlock" id="mobblock"></div><div id="emblock" class="emailBlock"><span class="headU">Email ID</span><div id="emil" class="primary"><span class="eml_ico"></span><p id="p_email7" class="numberC" style="position: relative;right: 37px;"></p><div style="display: inline-block;position: relative;right: 257px;bottom: -16px;font-size: 11px;font-style: italic;color: #848080;top: 16px;">primary</div><span class="verified"></span><div id="eml_otp"></div></div></div></div><div class="hereEdit" style="text-align: center;" onclick="getGAEventTrackingJS(\\'editprofile\\',\\'click\\',\\'editprofile section\\');"><a href="/userprofile/contactprofile/" ;=""> Edit</a> your contact details</div></div></div></div></div>';\
	var v8 = '<div id="modal_window" class="modalp-content" style="top: 61px;position: relative;left: 0%;text-align: center;text-align: -moz-center;text-align: -ms-center;text-align: -o-center;text-align: -webkit-center;width: max-content;"><div class="popup-header"><h2 class="popup-heading text-center upsell-heading">Verify Details to Confirm your Identity</h2></div><div class="popup-body"><div class="popup-content"><div class="verification-block"><h3 id="m8" class="main_heading" style="font-size: 17px;color: black;padding: 1.8%;">Verify your Contact Details to proceed</h3><p id="dt" class="ver_cs"></p><div class="form-group form-input"></div><div class="verification_cover mauto"><div class="mobileBlock" id="mobblock"><span class="headU">Mobile No.</span><div id="mob" class="primary"><span class="phn_ico"></span><p id="p_mo8" class="numberC"></p><div style="display: inline-block;position: relative;right: 257px;bottom: -16px;font-size: 11px;font-style: italic;color: #848080;top: 16px;">primary</div><span class="verified"></span><div id="pm_otp"></div></div></div><div id="emblock" class="emailBlock"><span class="headU">Email ID</span><div id="emil" class="primary"><span class="eml_ico"></span><p id="p_email8" class="numberC" style="position: relative;right: 37px;"></p><div style="display: inline-block;position: relative;right: 257px;bottom: -16px;font-size: 11px;font-style: italic;color: #848080;top: 16px;">primary</div><span class="verified"></span><div id="eml_otp"></div></div></div></div><div class="hereEdit" style="text-align: center;" onclick="getGAEventTrackingJS(\\'editprofile\\',\\'click\\',\\'editprofile section\\');"><a href="/userprofile/contactprofile/" ;=""> Edit</a> your contact details</div></div></div></div></div>';\
	if (document.getElementById('myModal2')) \{\
\
		\
		if(document.getElementById('mobile number').value.length!=0 ||document.getElementById('email').value.length!=0 )\
		\{ \
		if(phcc== "91" && document.getElementById('mobile number verified').value=='NOT VERIFIED' && document.getElementById('mobile number').value.length!=0 && document.getElementById('email verified').value=='NOT VERIFIED' && document.getElementById('email').value.length!=0)\{\
			\
			unverified =1;\
			$("#myModal2").append(v2);\
			remaining =0;\
			total =2;\
\
			$("#m2").html($("#hd_usrnm").text().bold()+",Verify your Contact Details to proceed");\
			console.log(document.getElementById("hd_usrnm"));\
			document.getElementById('myModal2').style.display = 'block';\
			\
			var phoneno = "+" + phcc + " "+ document.getElementById('mobile number').value;\
			var t = document.createTextNode(phoneno);     // Create a text node\
            document.getElementById('p_mo1').appendChild(t);\
			var email = document.getElementById('email').value;\
			document.getElementById('p_email1').appendChild(document.createTextNode(email));\
			\
			\
		\}\
\
\
		if(document.getElementById('mobile number verified').value=='VERIFIED' && document.getElementById('mobile number').value.length!=0 && document.getElementById('email verified').value=='VERIFIED' && document.getElementById('email').value.length!=0)\{\
		\
			$("#myModal2").append(v8);\
			remaining =2;\
			total =2;\
\
			$("#m8").html($("#hd_usrnm").text().bold()+",Verify your Contact Details to proceed");\
			console.log(document.getElementById("hd_usrnm"));\
			document.getElementById('myModal2').style.display = 'block';\
			\
			var phoneno = "+" + phcc + " "+ document.getElementById('mobile number').value;\
			var t = document.createTextNode(phoneno);     // Create a text node\
            document.getElementById('p_mo8').appendChild(t);\
			var email = document.getElementById('email').value;\
			document.getElementById('p_email8').appendChild(document.createTextNode(email));\
			\
			\
		\}\
\
else if(document.getElementById('mobile number verified').value=='VERIFIED' && document.getElementById('email').value.length==0)\
\{ remaining =1;\
	total=1;\
	nodivmail=1;\
	$("#myModal2").append(v6);\
				\
				$("#m6").html($("#hd_usrnm").text().bold()+",Verify your Contact Details to proceed");\
			var phoneno = "+" + phcc + " "+ document.getElementById('mobile number').value;\
			var t = document.createTextNode(phoneno);     // Create a text node\
            document.getElementById('p_mo6').appendChild(t);\
			document.getElementById('myModal2').style.display = 'block';\
			\
			\
\}\
\
else if( document.getElementById('email verified').value=='VERIFIED' && (document.getElementById('mobile number').value.length==0|| phcc!= "91" && document.getElementById('mobile number verified').value=='NOT VERIFIED'))\{\
	remaining =1;\
	total=1;\
	nodivnum=1;\
	$("#myModal2").append(v7);\
	$("#m7").html($("#hd_usrnm").text().bold()+",Verify your Contact Details to proceed");\
document.getElementById('myModal2').style.display = 'block';\
var email = document.getElementById('email').value;\
document.getElementById('p_email7').appendChild(document.createTextNode(email));\
\}\
\
		else if( phcc== "91" && document.getElementById('mobile number verified').value=='NOT VERIFIED' && document.getElementById('mobile number').value.length!=0 && (document.getElementById('email verified').value=='VERIFIED'|| document.getElementById('email').value.length==0))\
		\{ unverified =1;\
			\
            if(document.getElementById('email verified').value=='VERIFIED')\
             \{  $("#myModal2").append(v5);\
\
			 remaining =1;\
			total =2;\
				document.getElementById('myModal2').style.display = 'block';\
				$("#m5").html($("#hd_usrnm").text().bold()+",Verify your Contact Details to proceed");\
				var phoneno = "+" + phcc + " "+ document.getElementById('mobile number').value;\
				var t = document.createTextNode(phoneno);     // Create a text node\
				document.getElementById('p_mo5').appendChild(t);\
				var email = document.getElementById('email').value;\
				document.getElementById('p_email5').appendChild(document.createTextNode(email));\
				\
				\
			 \}\
\
\
           \
			 else\{\
				 nodivmail=0;\
				$("#myModal2").append(v1);\
				remaining =0;\
			total =1;\
				$("#m1").html($("#hd_usrnm").text().bold()+",Verify your Contact Details to proceed");\
			var phoneno = "+" + phcc + " "+ document.getElementById('mobile number').value;\
			var t = document.createTextNode(phoneno);     // Create a text node\
            document.getElementById('p_mo').appendChild(t);\
			document.getElementById('myModal2').style.display = 'block';\
			\
			\
			 \}	\
		\}\
\
		else if(document.getElementById('email verified').value=='NOT VERIFIED' && document.getElementById('email').value!=0 && (document.getElementById('mobile number verified').value=='VERIFIED' || phcc!= '91'))\
        \{ unverified=1;\
			\
			if(document.getElementById('mobile number verified').value=='VERIFIED')\
			\{\
				$("#myModal2").append(v4);\
		    remaining =1;\
			total =2;\
				$("#m4").html($("#hd_usrnm").text().bold()+",Verify your Contact Details to proceed");\
				document.getElementById('myModal2').style.display = 'block';\
			\
				var phoneno = "+" + phcc + " "+ document.getElementById('mobile number').value;\
				var t = document.createTextNode(phoneno);     // Create a text node\
				document.getElementById('p_mo4').appendChild(t);\
				var email = document.getElementById('email').value;\
				document.getElementById('p_email4').appendChild(document.createTextNode(email));\
				\
			\}\
            \
\
            else if(document.getElementById('email verified').value=='NOT VERIFIED' && (document.getElementById('mobile number').value.length==0 || (phcc!="91" && document.getElementById('mobile number verified').value== 'NOT VERIFIED')))\{\
				nodivnum =1;\
				$("#myModal2").append(v3);\
				remaining =0;\
			    total =1;\
				$("#m3").html($("#hd_usrnm").text().bold()+",Verify your Contact Details to proceed");\
			document.getElementById('myModal2').style.display = 'block';\
			var email = document.getElementById('email').value;\
			document.getElementById('p_email2').appendChild(document.createTextNode(email));\
			\
			\
\
			\}\
		\}  \
\
	\}\
\
	if( document.getElementById('secondary mobile number').value.length!=0 )\{\
		\
		if(nodivnum==1)\
		\{var dv ='<span class="headU">Mobile No.</span>';\}\
		\
\
		if(phcc== "91" && document.getElementById('secondary mobile number verified').value== 'NOT VERIFIED' )\
     \
            \{total +=1;\
				 unverified=1;\
				$("#mobblock").append(dv);\
				var vrfid = '<div id="mobil_sec" class="secondary"><span class="phn_ico" style="right: 4%;"></span><p id="del_pos" class="numberC" style="right: 26%;"></p><span id="vrf_mob_second" class="vrfy" onclick=" verify_popup(this.id); getGAEventTrackingJS(\\'MyMessages\\',\\'ClickOnVerify\\',\\'SecondaryMobile\\');" style="left: 5%;position: relative;">verify</span><div id="second_mob_otp"></div></div>';\
		  $("#mobblock").append(vrfid);\
		  var phoneno = "+" + phcc + " "+ document.getElementById('secondary mobile number').value;\
		  document.getElementById('del_pos').appendChild(document.createTextNode(phoneno));\
			\}\
\
			else if(document.getElementById('secondary mobile number verified').value== 'VERIFIED')\{\
				total +=1;\
				remaining +=1;\
				$("#mobblock").append(dv);\
          var vrfid = '<div id="mobil_sec" class="secondary"><span class="phn_ico" style="right: 5%;"></span><p id="del_pos" class="numberC" style="right: 26%;"></p><span class="verified" style="right: -5%;"></span><div id="second_mob_otp"></div></div>';\
		  $("#mobblock").append(vrfid);\
		  var phoneno = "+" + phcc + " "+ document.getElementById('secondary mobile number').value;\
		  document.getElementById('del_pos').appendChild(document.createTextNode(phoneno));\
\
			\}\
\
\
\
		\}\
		if(document.getElementById('secondary email').value.length!=0 )\{\
			total +=1;\
			if(nodivmail==1)\
			\{var dv ='<span class="headU">Email.</span>';\
			$("#emblock").append(dv);\}\
\
           if(document.getElementById('secondary email verified').value== 'NOT VERIFIED')\{\
			   unverified =1;\
			   var vrfid = '<div id="emil_sec" class="secondary"><span class="eml_ico" style="position: relative;right: 4%;"></span><p id="eml_scnd" class="numberC" style="position: relative;right: 58px;"></p><span id="vrf_eml_second" class="vrfy" onclick=" verify_popup(this.id); getGAEventTrackingJS(\\'MyMessages\\',\\'ClickOnVerify\\',\\'SecondaryEmail\\');" style="left: 5%;position: relative;">verify</span><div id="eml_second_otp"></div></div>';\
			$("#emblock").append(vrfid);\
			document.getElementById('eml_scnd').appendChild(document.createTextNode(document.getElementById('secondary email').value));\
\
\
		   \}\
\
		   else\{\
			   remaining +=1;\
             var vrfid = '<div id="emil_sec" class="secondary"><span class="eml_ico" style="position: relative;right: 4%;"></span><p id="eml_scnd" class="numberC" style="position: relative;right: 58px;"></p><span class="verified" style="right: -5%;"></span><div id="eml_second_otp"></div></div>';\
             $("#emblock").append(vrfid);\
			 document.getElementById('eml_scnd').appendChild(document.createTextNode(document.getElementById('secondary email').value));\
\
		   \}\
\
              \
	\
		\}\
		if(unverified == 0)\{\
			document.getElementById('myModal2').style.display = 'none';  \
		  \}\
\
		  else\{\
			getGAEventTrackingJS("MyMessages","VerificationPopup",utypelabel);\
			var myElement = document.getElementsByClassName("bottom-send-section");\
\
			  if(myElement)\{\
				$(".bottom-send-section").css("display", "none")\
			  \}\
			  var myElement2 =document.getElementById("myenqtab");\
			  var el3 = document.getElementById("left_list");\
			  if(el3)\{\
				  el3.remove();\
			  \}\
			  if(myElement2)\{\
				myElement2.remove();\
			  \} \
		  \}\
\
	   var inf = remaining+' of '+total+' details verified';\
	   document.getElementById('dt').appendChild(document.createTextNode(inf));\
\
	\} \
	\
	else \{\
	  setTimeout(myFunc, 15);\
	\}\
  \}\
\
\
\
  var otpHTML = '<div class="otp"><span class="crosss">X</span><p id="msg">Enter the 4 digit One Time Password (OTP) sent to you via SMS</p><input class="mobbox1 f1 border_black1" type="text" id="first" onkeypress="return chkInput(event)" onkeyup="move_toNext1(\\event\\,\\'first\\', \\'second\\')" maxlength="1"><input class="mobbox1 f1 border_black1" type="text" id="second" onkeypress="return chkInput(event)" onkeyup="move_toNext1(\\event\\,\\'second\\', \\'third\\')" maxlength="1"><input class="mobbox1 f1 border_black1" type="text" id="third" onkeypress="return chkInput(event)" onkeyup="move_toNext1(\\event\\,\\'third\\', \\'fourth_num\\')" maxlength="1"><input class="mobbox1 f1 border_black1" type="text" id="fourth_num" maxlength="1" onkeypress="return chkInput(event)" autocomplete="off"><button id="bttn" class="btn btn-primary otpSub" style="display: inline-block;">Submit</button><p class="didRcv" id="err_msg"></p><p class="didRcv"><span id="resend_txt">Didn\\'t receive OTP?</span><span id = "rsnd" class"resend" style="cursor: pointer;color:#2e3192;"> Resend</span></p> </div>';\
 \
  var emlHTML = "<div class='otp'><span class='crosss'></span><div><div><img src='https://"+UrlPri+"my.imimg.com/gifs_new/alert_img.png' style='width:9%;float:left;margin-top:7px;margin-right:7px;'><p style='color:#e00d0d' >This <span class='emlTxt'></span> will be removed from your account permanently. Are you sure? Please Confirm.</p></div><p class='didRcv' id='er_msg'></p><button id='det_del' class='btn btn-primary otpSub' style='text-align: center;left:5%;'>Yes, Delete</button><button id='det_del_no' class='btn btn-primary otpSub' style='text-align: center;left: 32%;'>No</button></p></div></div>";\
\
	function verify_popup(id)\
	\{  var cookie = readCookie('ImeshVisitor');\
	var glusrId = getparamVal(cookie, "glid");\
		rmv_popup();		\
		var idcheck = id;\
		var data = '';\
		var phcc = getparamVal(cookie, "phcc");\
		if(idcheck == 'vrf_eml')\
		data = document.getElementById('email').value;\
\
        else if(idcheck == 'vrf_mob_second')\{\
         data = document.getElementById('secondary mobile number').value;\
		\}\
\
		else if( idcheck == 'vrf_eml_second')\{\
		data = document.getElementById('secondary email').value;\
		\}\
		else\
		 data = "+" + phcc + " "+ document.getElementById('mobile number').value;\
\
\
		sendOTPForVerify(data,glusrId,idcheck);\
\
		if(idcheck == 'vrf_eml')\
		$('#emil').addClass('expnd').append(otpHTML);\
		else if(idcheck == 'vrf_eml_second')\
		\{$('#emil_sec').addClass('expnd').append(otpHTML);\}\
		else if(idcheck == 'vrf_mob_second')\{\
	     $('#mobil_sec').addClass('expnd').append(otpHTML);	\
		\}\
		else\
		$('#mob').addClass('expnd').append(otpHTML);\
		\
		$('#first').focus();\
\
		if(idcheck == 'vrf_eml' || idcheck == 'vrf_eml_second')\
			$('#msg').html("Enter the 4 digit One Time Password (OTP) sent to you via Email");\
\
\
		$("#bttn").on('click', function()\{\
			otpCheckForVerify(glusrId,data,idcheck);\
		\});\
\
		$(".crosss").click(function()\{\
			$("#mob").removeClass('expnd').find('.otp').remove();\
			$("#emil").removeClass('expnd').find('.otp').remove();\
			$("#emil_sec").removeClass('expnd').find('.otp').remove();\
			$("#mobil_sec").removeClass('expnd').find('.otp').remove();\
		\});\
\
		$("#rsnd").on('click', function()\{\
			sendOTPForVerify(data,glusrId,idcheck,true);\
		\});\
\
	\}\
\
	function wait(ms)\{\
		var start = new Date().getTime();\
		var end = start;\
		while(end < start + ms) \{\
		  end = new Date().getTime();\
	   \}\
	 \}\
	\
	function otpCheckForVerify(userGLID, updatedData, idcheck)\{\
		var webAddress=location.hostname; \
		var params,attr_id,v1 = '0',v2 = '0';\
		var UrlPri = webAddress.match(/^dev/)?"stg-":(webAddress.match(/^stg/))?"stg-":"";\
		var auth_key = document.getElementById("first").value + document.getElementById("second").value + document.getElementById("third").value + document.getElementById("fourth_num").value;\
		auth_key = auth_key.replace(/^\\s+|\\s+$/g,"");\
		if(!(/\\d\{4\}/.test(auth_key)))\{    \
			document.getElementById("err_msg").innerHTML = 'Please enter 4-digit OTP.';\
			document.getElementById("err_msg").style.color = "red";\
			document.getElementById("err_msg").style.display = 'block';\
			document.getElementById("first").value="";\
			document.getElementById("second").value="";\
			document.getElementById("third").value="";\
			document.getElementById("fourth_num").value="";\
			$('#first').focus();\
			return false;       \
		\}\
	\
		if(idcheck == "vrf_mob")\
			attr_id = '121';\
		else if(idcheck == "vrf_mob_second")\
			attr_id = '48';\
		else if(idcheck == "vrf_eml")\
			attr_id = '109';\
		else if(idcheck == "vrf_eml_second")\
			attr_id = '157';\
		\
			if(attr_id == '121' || attr_id == '48')\{\
				v1 = updatedData.slice(4);\
			\}\
	\
			else\
				v2 = updatedData;\
		\
		params = \{  \
			'mobile_num': v1,\
			'email': v2,\
			'auth_key':auth_key,\
			'glusrid': userGLID,\
			'attribute_id':attr_id,\
			'typ' : '2'\
		\};\
	\
		$.ajax(\{\
				type: "POST",\
				dataType: "json",\
				crossDomain: true,\
				url : '/userprofile/userverification/otp_auth/',\
				data: params,\
				success:function(response)\{\
					var stat = response.Response.Status;\
					var message = response.Response.Message;\
					var responseCode = response.Response.Code;\
					if(response['failure'] == "Access Denied" )\{\
						document.getElementById("err_msg").innerHTML = 'OTP can\\'t be Verified';\
						setTimeout(function()\{ window.location.reload() \}, 1500);\
						return;\
					\}\
					if ( stat == 'FAILURE' || message.match('OTP not Verified') || message.match('Mobile Number not Verified') || message.match('Email not Verified'))\{\
						document.getElementById("err_msg").innerHTML = "Please type the correct OTP";\
						document.getElementById("err_msg").style.display = 'block';\
						document.getElementById("err_msg").style.color = "red";\
						document.getElementById("first").value="";\
						document.getElementById("second").value="";\
						document.getElementById("third").value="";\
						document.getElementById("fourth_num").value="";\
						return false;\
					\}\
					\
					if ( responseCode == "200" && ( message.match('Email Verified') || message.match('Mobile Number Verified')) ) \{\
						document.getElementById(idcheck).style.display = 'none';\
						$("#"+idcheck).after("<span class='verified'></span>");\
						if(idcheck == 'vrf_mob_second')\
						$("#mobil_sec").removeClass('expnd').find('.otp').remove();\
						if(idcheck == 'vrf_eml_second')\
						$("#emil_sec").removeClass('expnd').find('.otp').remove();\
						rmv_popup();\
						wait(5000);\
						window.location.reload();\
						return 1;\
					\}\
					\
					return true;\
				\}\
		\});\
	\}\
\
\
\
\
\
\
function sendOTPForVerify(data, userGLID,idcheck,resend)\{\
	var webAddress=location.hostname; \
	var attr_id,v1 = '0',v2 = '0',rsnd = '0';\
	var params =Array();\
	var UrlPri = webAddress.match(/^dev/)?"stg-":(webAddress.match(/^stg/))?"stg-":"";\
	if ( resend == true )\{\
		rsnd = '1';\
	\}\
\
	if(idcheck == "vrf_mob")\
		attr_id = '121';\
	else if(idcheck == "vrf_mob_second")\
		attr_id = '48';\
	else if(idcheck == "vrf_eml")\
		attr_id = '109';\
	else if(idcheck == "vrf_eml_second")\
		attr_id = '157';\
	\
		if(attr_id == '121' || attr_id == '48')\{\
			v1 = data.slice(4);\
		  \}\
		  \
		  else\
			  v2 = data;\
	\
	params = \{  \
		'OTPResend' : rsnd,\
		'mobile_num': v1,\
		'email': v2,\
		'glusrid': userGLID,\
		'attribute_id':attr_id,\
		'typ' : '1'\
	\};\
	\
	$.ajax(\{\
			type: "POST",\
			url : '/userprofile/userverification/otp_auth/',\
			data: params,\
			dataType:"json",\
			crossDomain: true,\
			success: function(response)\{\
				if(response['failure'] == "Access Denied" )\{\
					document.getElementById("err_msg").innerHTML = 'OTP can\\'t be sent';\
					setTimeout(function()\{ window.location.reload() \}, 1500);\
					return;\
				\}\
				\
				var message = response.Response.Message;\
\
				if ( message.match('We have already sent an OTP on your mobile'))\{\
					document.getElementById("err_msg").innerHTML = 'OTP has already been sent';\
					document.getElementById("err_msg").style.display = 'block';\
					document.getElementById("err_msg").style.color = "black";\
					return false;\
				\}\
\
				var stat = response.Response.Status;\
				var serviceCode = response.Response.Code;\
				   var vendorErrorResponse = response.Response.VENDOR_ERROR_RESPONSE;\
				if (serviceCode == '204' && stat == 'Failure' && vendorErrorResponse != '')\
				   \{\
					   document.getElementById("err_msg").innerHTML = vendorErrorResponse;\
					document.getElementById("err_msg").style.display = 'block';\
					document.getElementById("err_msg").style.color = "red";\
					return false;\
				   \}\
\
				   if ( message.match('OTP Sent') && rsnd==1)\{\
					document.getElementById("err_msg").innerHTML = 'OTP has been sent';\
					document.getElementById("err_msg").style.display = 'block';\
					document.getElementById("err_msg").style.color = "black";\
					return false;\
				\}\
					\
				return true;\
			\}\
	\});\
\}\
\
\
var otpHTML = '<div class="otp"><span class="crosss">X</span><p id="msg">Enter the 4 digit One Time Password (OTP) sent to you via SMS</p><input class="mobbox1 f1 border_black1" type="text" id="first" onkeypress="return chkInput(event)" onkeyup="move_toNext1(\\event\\,\\'first\\', \\'second\\')" maxlength="1"><input class="mobbox1 f1 border_black1" type="text" id="second" onkeypress="return chkInput(event)" onkeyup="move_toNext1(\\event\\,\\'second\\', \\'third\\')" maxlength="1"><input class="mobbox1 f1 border_black1" type="text" id="third" onkeypress="return chkInput(event)" onkeyup="move_toNext1(\\event\\,\\'third\\', \\'fourth_num\\')" maxlength="1"><input class="mobbox1 f1 border_black1" type="text" id="fourth_num" maxlength="1" onkeypress="return chkInput(event)" onkeyup="move_toNext1(\\event\\,\\'fourth_num\\', \\'fourth_num\\')" autocomplete="off"><button id="bttn" class="btn btn-primary otpSub" style="top: 1px;position: relative;display: inline-block;">Submit</button><p class="didRcv" id="err_msg"></p><p class="didRcv"><span id="resend_txt">Didn\\'t receive OTP?</span><span id = "rsnd" class"resend" style="cursor: pointer;color:#2e3192;"> Resend</span></p> </div>';\
  \
var emlHTML = "<div class='otp'><span class='crosss'></span><div><div><img src='https://"+UrlPri+"my.imimg.com/gifs_new/alert_img.png' style='width:9%;float:left;margin-top:7px;margin-right:7px;'><p style='color:#e00d0d' >This <span class='emlTxt'></span> will be removed from your account permanently. Are you sure? Please Confirm.</p></div><p class='didRcv' id='er_msg'></p><button id='det_del' class='btn btn-primary otpSub' style='text-align: center;left:5%;'>Yes, Delete</button><button id='det_del_no' class='btn btn-primary otpSub' style='text-align: center;left: 32%;'>No</button></p></div></div>";\
\
$(".hereEdit").on('click', function()\{\
	getGAEventTrackingJS("verification_blocker","click_edit",label);\
	\});\
\
\
\
\
\
//close the blocker\
/*$("#close_blkr").on('click', function()\{\
	$('#showSecond').hide();\
	getGAEventTrackingJS("verification_blocker","click_cross",label);\
\});*/\
\
\
\
function rmv_popup() \{\
// body...\
$("#vrf_mob").parent().removeClass('expnd').find('.otp').remove();\
$("#vrf_mob_second").parent().removeClass('expnd').find('.otp').remove();\
$("#vrf_eml").parent().removeClass('expnd').find('.otp').remove();\
$("#emil_sec").removeClass('expnd').find('.otp').remove();\
$("#mobil_sec").removeClass('expnd').find('.otp').remove();\
\}\
\
function chkInput(evt)\{\
var charCode = (evt.which) ? evt.which : event.keyCode\
if (charCode > 31 && (charCode < 48 || charCode > 57))\
	return false;\
\
return true;\
\}\
\
function move_toNext1(event,e, i) \{\
	if(event.keyCode == '8') \{\
        $('#' + e).prev().focus();\
    \}\
$('#' + e).val().length >= $('#' + e).prop('maxLength') && $('#' + i).focus()\
\
\
\}\
\
$(".crosss").click(function()\{\
	$("#mob").removeClass('expnd').find('.otp').remove();\
	$("#emil").removeClass('expnd').find('.otp').remove();\
	$("#emil_sec").removeClass('expnd').find('.otp').remove();\
	$("#mobil_sec").removeClass('expnd').find('.otp').remove();\
\});\
\
function sim_chk(a,b)\
\{\
	a=a.toLowerCase();\
	b=b.toLowerCase();\
	if(b.indexOf(a)!=-1)\{\
		return 1;\
	\}\
\
	\}\
	\
function sendtypeofcode(a)\{\
	if(a == 'Catalog_Link')\{\
		saved_template_code = 23;	\
	\}\
\
	else if(a == 'ML_Template')\{\
		saved_template_code = 11;	\
	\}\
\
  else if(a == 'User_Defined')\{\
	saved_template_code = 21;\
  \} \
\
	else if(a == 'Last_Message')\{\
		saved_template_code = 22;\
	\}\
\
\}\
\
function clk()\{\
	\
	if(document.getElementById("compname").innerHTML)\
	document.getElementById("compname").innerHTML = " ";\
\
	if(document.getElementById("paaccount").innerHTML)\
	document.getElementById("paaccount").innerHTML = "";\
	if(document.getElementById("paemil").innerHTML)\
	 document.getElementById("paemil").innerHTML = "";\
\
\
	 if(document.getElementById("paphoneno").innerHTML)\
	document.getElementById("paphoneno").innerHTML = "";\
\
	if(pemail)\{\
		var pe = '<img src="https://my.imimg.com/gifs_new/messagecentre/email.png" style="  width: 20px;"><div id ="pemail" style="position: relative;left: 12px;"></div>';\
	    document.getElementById("paemil").innerHTML+= pe;\
	\}\
	\
	if(pname)\{\
		var pn ='<img src="https://my.imimg.com/gifs_new/messagecentre/account.png" style=" width: 20px;"><div id ="pname" style="position: relative;left: 12px;"></div>';\
	    document.getElementById("paaccount").innerHTML+= pn;\
	\}\
\
	if(pphone_no)\{\
		\
	var pno = 	'<img src="https://my.imimg.com/gifs_new/messagecentre/tab.png" style="width: 20px;"><div id ="pphone_no" style="position: relative;left: 12px;"></div>';\
    document.getElementById("paphoneno").innerHTML+= pno;	\
\}\
\
\
\
	document.getElementById("compname").appendChild(document.createTextNode(comname));\
	document.getElementById("pname").appendChild(document.createTextNode(pname));\
	document.getElementById("pemail").appendChild(document.createTextNode(pemail));\
	document.getElementById("pphone_no").appendChild(document.createTextNode(pphone_no));\
\}\
\
\
function addpaymentdetails()\{\
	var li = byId("fetch_list").getElementsByTagName("li");\
	var c_company = li[id].querySelector("p.c_addr c_company").innerText;\
		var c_city = li[id].querySelector("p.c_addr c_city").innerText;	\
	c_company = c_company !== '' ? c_company : 'IndiaMART Seller' ;\
\}\
\
\
function showPayModal2(ele, prodName, prodAmt, prodGlid)\{\
	\
	document.getElementById("amount_err_mpos").innerHTML = '';\
	$("#btnContinue").addClass('active');\
	$('#'+ele).show();\
	if(prodName) \{\
		$("#cust_product").val(prodName);\
		$("#cust_product_hr").text(prodName);\
	\}\
	if(prodAmt) \{\
		$("#cust_amount").val(prodAmt);\
	\}\
	if(prodGlid) \{\
		$("#glid_hidden").val(prodGlid);\
	\}\
	$("#cust_amount").focus();\
\}\
\
\
function mpos_product2() \{\
\
\
	\
\{\
	var regEx = /^[0-9a-z A-Z]+$/;\
    var prod_name = $("#cust_product1").val();\
    prod_name = prod_name.trim();\
\
\
\
    if (prod_name == "")\
    \{prdvalid = 0;\
		$("#btnContinue").removeClass('active');\
        $('#product_err_mpos1').css('display', 'block');\
        $("#cust_product").parent().addClass('active');\
		document.getElementById("btnContinue1").disabled = true;\
        document.getElementById("product_err_mpos1").innerHTML = 'Product Name should not be empty';\
        return false;\
\
    \}else if(vld(prod_name)== false)\
	\{ prdvalid = 0;\
		$("#btnContinue").removeClass('active');\
	$('#product_err_mpos1').css('display', 'block');\
		document.getElementById("btnContinue1").disabled = true;\
		document.getElementById("product_err_mpos1").innerHTML = 'Product Name should not contain any special characters except space and comma';\
        return false;\
	\}\
\
\
	else\
    \{ $('#product_err_mpos1').css('display', 'none');\
        // if(activatebutton())\{\
			prdvalid = 1;\
		// 	$("#btnContinue").addClass('active');\
		document.getElementById("btnContinue1").disabled = false;\
		// 	\}\
        // $("#cust_product").parent().addClass('active');\
		\
				\
		\
    \}\
\}\
\
    productName = document.getElementById("cust_product1").value;\
    return true;\
\}\
\
\
function hidePayModal(ele)\{\
	$('#'+ele).hide();\
\}\
\
function identifySellerType2() \{\
    \
\
    var imesh = new userDataCookie().get();\
    var buyerGLID = imesh.glid;\
    mpos_product2();\
    mpos_amount2();\
    var product_name = document.getElementById('cust_product1').value;\
    var amount = document.getElementById('cust_amount1').value;\
    var glid = document.getElementById('contactglid').value;\
    if (product_name != '' && amount != '' && glid != '')\
    \{\
		generatePayxLead2('BUYER_MSG',glid);\
    \}\
\
    getGAEventTrackingJS('Payments', 'CTA Click', 'Secure Your Payment Now');\
\}\
\
function vld(name)\
\{\
   var regEx = /^[0-9a-z ,A-Z]+$/;\
   if(name.match(regEx))\
     \{\
      return true;\
     \}\
   else\
     \{\
     return false;\
     \}\
\} \
\
function mpos_amount2() \{\
    var amount_limit = $("#amount_limit").val();\
\
    document.getElementById("cust_amount1").value = document.getElementById("cust_amount1").value.replace(/^\\s+|\\s+$/g, "");\
    var prod_amount = document.getElementById("cust_amount1").value;\
    if (document.getElementById("cust_amount1").value == "") \{\
		document.getElementById("btnContinue1").disabled = true;\
        $('#amount_err_mpos1').css('display', 'block');\
        $("#cust_amount").parent().addClass('active');\
		amtvalid=0;\
        document.getElementById("amount_err_mpos1").innerHTML = 'Please enter amount';\
        return false;\
    \} else if (!prod_amount.match(/^\\d+(\\.\\d\{0,2\})?$/)) \{\
		document.getElementById("btnContinue1").disabled = true;\
        $('#amount_err_mpos1').css('display', 'block');\
        $("#cust_amount").parent().addClass('active');\
		$("#btnContinue").removeClass('active');\
		amtvalid=0;\
        document.getElementById("amount_err_mpos1").innerHTML = 'Amount must be number OR number with max two decimal';\
        return false;\
    \} else if (Number(amount_limit) < 20) \{\
		document.getElementById("btnContinue1").disabled = true;\
        $('#amount_err_mpos1').css('display', 'block');\
        $("#cust_amount").parent().addClass('active');\
		$("#btnContinue").removeClass('active');\
		amtvalid=0;\
        document.getElementById("amount_err_mpos1").innerHTML = 'You can not accept any payment right now';\
        return false;\
\
    \} else if (prod_amount < 20 || prod_amount > Number(amount_limit)) \{\
		document.getElementById("btnContinue1").disabled = true;\
        $('#amount_err_mpos1').css('display', 'block');\
        $("#cust_amount").parent().addClass('active');\
		amtvalid=0;\
        document.getElementById("amount_err_mpos1").innerHTML = 'Amount must be in the range of (Min 20 to Max ' + amount_limit + ')';\
        return false;\
\
    \} else \{\
        $('#amount_err_mpos1').css('display', 'none');\
		amtvalid  =1;\
		document.getElementById("btnContinue1").disabled = false;\
        \
		\
	\}\
    amountToBePaid = document.getElementById('cust_amount1').value;\
	\
    return true;\
\}\
\
\
function identifySupplierwithglid(glid)\
\
\
\{\
	                   document.getElementById('paynow').style.display = 'none';\
                    var url = '/phpajax/buyertools/payments/identifySellerType';\
                    var imesh = new userDataCookie().get();\
                    $.ajax(\{\
                        url: url,\
                        data: \{\
                            'supplier_glid': glid\
                        \},\
                        dataType: "JSON",\
                        type: "GET",\
                        timeout: 3000,\
                        success: function (result) \{\
                            if (result == 0)\
                            \{\
                                document.getElementById('paynow').style.display = 'none';\
                            \} else\
                            \{                  \
								document.getElementById('paynow').style.display = 'block';\
                                getGAEventTrackingJS("MyMessages","Payment_popup_appeared",'MY'); \
							\}\
\
                        \},\
\
                        error: function (data) \{\
                            //get the status code\
                            document.getElementById('loaderdiv').style.display = 'none';\
                            alert('Please check your Internet Connection!!');\
                        \},\
                        complete: function (data)\
                        \{\
                            $('.paynowbtn').removeClass('load');\
                        \}\
\
\
                    \});\
\}\
\
function removeamountpos()\{\
	document.getElementById("amount_err_mpos1").style.display ="none";\
\}\
\
function removeproductpos()\{\
	document.getElementById("product_err_mpos1").style.display ="none";\
\}\
\
function refreshcount()\{\
	amtvalid =0;\
	prdvalid = 0;\
\}\
\
function checkvliditypayment()\{\
	if (prdvalid+amtvalid == 2)\{\
      document.getElementById("btnContinue1").style.backgroundColor = "#0057D8";\
	  document.getElementById("btnContinue1").style.border = "1px solid #0057D8";\
	  \
	\}\
\
	else\{\
		document.getElementById("btnContinue1").style.backgroundColor ="grey";\
		document.getElementById("btnContinue1").style.border = "1px solid grey";\
	\}\
\
\}\
\
function generatePayxLead2(bs_modid,supplierGLID) \{\
\
    if (bs_modid == 'PAYX')\
    \{\
        var lead_mode = '168835';\
    \} else\
    \{\
        var lead_mode = '181716';\
    \}\
\
\
\
    if ($('#mobile_err_mpos1').css('display') == 'block')\
        return false;\
\
    if ($('#product_err_mpos1').css('display') == 'block')\
        return false;\
\
    if ($('#amount_err_mpos1').css('display') == 'block')\
        return false;\
\
\
    var imesh = new userDataCookie().get();\
    var buyerGLID = imesh.glid;\
    $('.paynowbtns').addClass('load');\
    \
\
    $.ajax(\{\
        url: '/phpajax/buyertools/payments/generatePayWithURL',\
        timeout: 10000,\
        data: \{\
            'BS_BUYER_GLID': buyerGLID,\
            'BS_SUPPLIER_GLID': supplierGLID,\
            'BS_PRODUCT_DETAIL': productName,\
            'BS_PAYMENT_AMOUNT': amountToBePaid,\
            'BS_MODID': bs_modid,\
            'BS_BUYER_EMAIL': imesh.em\
        \},\
\
        dataType: "JSON",\
        type: "GET",\
        success: function (result) \{\
			\
//            console.log('generate paywith success');\
//            console.log(result);\
            //document.getElementById('loaderdiv').style.display = 'none';\
            if (result.status == 200) \{\
				getGAEventTrackingJS('Payments', 'Generate URL', 'Payment Protection');\
                var payURL = window.location.href.match(/(\\/\\/dev-my|\\/\\/stg-my)/gi) ? "https://dev-paywith.indiamart.com/invoice/#/" : "https://paywith.indiamart.com/invoice/#/";\
                //  var payURL = "https://paywith.indiamart.com/payx/#/";\
                var payWithURL = payURL + (result.result);\
                window.location = payWithURL;\
//                        window.open(payWithURL, '_blank');\
                $('#cust_mobile').val('');\
                $('#cust_product').val('');\
                $('#cust_amount').val('');\
                // window.location.reload(true);\
            \}\
            if (result.status == 206)\
            \{\
                //document.getElementById('loaderdiv').style.display = 'none';\
                document.getElementById('product_err_mpos1').innerHTML = 'Some error occurred. Please contact 9696969696 for Support';\
                return false;\
            \}\
\
            if (result.status == 205)\
            \{\
                //document.getElementById('loaderdiv').style.display = 'none';\
                document.getElementById('product_err_mpos1').innerHTML = 'Payment cannot proceed as Seller KYC is Pending. Please contact Seller or 9696969696 for support';\
//                        alert('Payment cannot proceed as Seller KYC is Pending. Please contact Seller or 9696969696 for support');\
                return false;\
            \}\
        \},\
        error: function (data) \{\
            //document.getElementById('loaderdiv').style.display = 'none';\
            //get the status code\
            alert('Please check your Internet Connection!!');\
        \}, complete: function (data) \{\
            //document.getElementById('loaderdiv').style.display = 'none';\
            $('.paynowbtn').removeClass('load');\
        \},\
\
    \});\
\
\}\
\
\
\
function cl1 ()\{\
		document.getElementById('error msg').style.display= "none";\
\}\
\
if(Comp_url1!='')\{\
			document.getElementById('msgvline').style.display ="block";\
\}\
\
function capture_impression()\{\
		if(document.getElementById('send_button').style.background == 'rgb(2, 136, 125)')\{\
			getGAEventTrackingJS('messages', 'Send button clicked', 'Sendbutton');	\
		\}\
	\}\
\
	function timeConversion(s) \{\
		const isPM = s.indexOf('PM') !== -1;\
		let [hours, minutes, seconds] = s.replace(isPM ? 'PM':'AM', '').split(':');\
	\
		if (isPM) \{\
			hours = parseInt(hours, 10) + 12;\
			hours = hours === 24 ? 12 : hours;\
		\} else \{\
			hours = parseInt(hours, 10);\
			hours = hours === 12 ? 0 : hours;\
			if (String(hours).length === 1) hours = '0' + hours;\
		\}\
	\
		const time = [hours, minutes, seconds].join(':');\
	\
		return time;\
	\}\
	\
\
\
	function closediv()\{\
		document.getElementById('myModal4').style.display = 'none';\
		document.getElementById('box2').style.display = 'none';\
		if(rating_ppop == 1)\
		\{document.getElementById('es1').style.display = 'block';\
		document.getElementById('supp_rat').style.display = 'none';\
	\}\
		else\
		document.getElementById('box1').style.display = 'block';\
	\}\
	\
	\
	function hidepopup()\{\
		document.getElementById('es1').style.display = 'block';\
		document.getElementById('supp_rat').style.display = 'none';\
		document.getElementById("myModal5").style.display="none";\
	\
	\}\
	\
	function hidepopup2()\{\
		document.getElementById('box1').style.display = 'block';\
		document.getElementById('box2').style.display = 'none';\
		document.getElementById("myModal5").style.display='none';\
	\
	\}\
	\
		var x7,x8=0;\
		function detaching()//function to place the box in model5 i.e outside chat window\
		  \{ \
			  \
			\
			if(document.getElementById("es1").style.display=="block")\
		  \{x8 =1;\}\
			rate_from_popup =1;  \
			$(".fb_ss").css("width", "45%");\
		  document.getElementById("cancel").style.left = '96%';\
		  document.getElementById("textinput").style.left = '26%';\
		  document.getElementById("cancel").onclick = "";\
		  $("#ratingImg").css("display", "block");\
	\
		  \
									// body...\
									// var rating_popup = document.getElementById('supp_rat');\
									// if (rating_popup) document.getElementById('chat-section-main').scrollTo(0,rating_popup.offsetTop - 120);\
									if ($('.chat-section')[0].scrollHeight - $('.chat-section').scrollTop() == $('.chat-section').outerHeight())\
					\{  $('#supp_rat').css("display", "block");//pop2\
						$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight);\
					\
					\}\
					else\{\
						$('#supp_rat').css("display", "block");//pop2\
					\}\
									$('#box1').css("display", "none");\
									$('#box2').css(\{"display": "flow-root", "width": "116%"\});\
									$('.get_sup_rat').css("display", "none"); //pop1 \
									$('#supp_rat').css("display", "block"); //pop2\
									$("#confirmSpan").children().css('display', 'block'); //pop3-Submit\
									$("#satisfaction_box").css('display', 'inline-block'); //pop3\
									//$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight + 80);\
									/*vinay*/yandex_impression_my('rating_landing_from_email_click_edit_MY');\
									/*vinay*/yandex_impression_my('rating_landing_from_email_display_impression_new_form');\
								\
		  \
	\
		  \
	\
		  var cancelButton = document.getElementById('cancel');\
		  cancelButton.setAttribute('onclick',  'attaching();');\
			  x7 = $(".fb_ss").detach();\
		  $("#myModal5").prepend(x7);\
		  $('#rate_txt').text('you are reviewing ');\
		  document.getElementById("myModal5").style.display="block";\
		\}\
		\
		function attaching()//function to fix the rating popup to its original div\
		  \{ rate_from_popup =0;\
			$(".fb_ss").detach();\
			$("#supp_rat").prepend(x7);\
			$(".fb_ss").css("width", "65%");\
			document.getElementById('myModal5').style.display = 'none';\
			document.getElementById('supp_rat').style.display = 'none';\
			document.getElementById("cancel").style.left = '48%';\
			document.getElementById("textinput").style.left = '14%';\
	\
	\
			if(document.getElementById("is_rating_display").value!='0' ||(document.getElementById("is_rating_display").value=='0'&& x8==1))\
			\{document.getElementById('es1').style.display = 'block';\
			  x8 =0;\}\
			\
			var cancelButton = document.getElementById('cancel');\
			cancelButton.setAttribute('onclick',  "showPayModal('myModal4', '', '', '');"); \
			$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight);\
		\}\
	function checksubmit()\{\
		if(document.getElementById('myModal5').style.display = 'block')\{\
			document.getElementById('myModal5').style.display = 'none';\
		\}	\
	\}\
	\
	function place_review_bottom()\{\
		var review_detach = $("#rating_data").detach();\
		$("#input_review").prepend(review_detach);\
\
		$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight);\
	\
	\}\
\
	$("#massage-text").on("paste", function()\{\
		if(saved_template_code == null)\
		     \{saved_template_code= 81;\}\
		setTimeout(function() \{\
			var message_content = $('#massage-text').val().trim();\
			if (message_content != "")\{\
				$('.send_button').css(\{\
					'background':'#02887d',\
					'cursor': 'pointer'\
				\});\
			\}\
		\}, 500);\
		\});\
\
function addviewmore(total_count)\{\
setTimeout(function() \{\
	var ratee= document.getElementById("p_txtr");\
	var buyerprofilevalue = document.getElementById("buyer_pr_dt_new").value;\
	\
	if(!ratee || buyerprofilevalue=="")\{\
	addviewmore(total_count);   \
	\}\
	else\
	\{\
	\
		\
			if(cataloglnk && (cataloglnk.includes('indiamart.com') && total_count > 2))\
			\{document.getElementById("p_txtr").innerHTML = `<a href="`+cataloglnk+`testimonial.html#reviewsratings" target="_blank" class="pdinb slvmr">View More Reviews</a>`;\
			$("#p_txtr").click(function()\{ getGAEventTrackingJS("MessageCenter","View More reviews ",'Buyer_MY'); \}); \
			cataloglnk="";\
		\}\
				\
		\
		\
	\}\
	\}, 1000);\
\}\
\
function generatePayxLead3(bs_modid,supplierGLID, amountToBePaid) \{\
\
    if (bs_modid == 'PAYX')\
    \{\
        var lead_mode = '168835';\
    \} else\
    \{\
        var lead_mode = '181716';\
    \}\
\
\
\
    // if ($('#mobile_err_mpos1').css('display') == 'block')\
    //     return false;\
\
    // if ($('#product_err_mpos1').css('display') == 'block')\
    //     return false;\
\
    // if ($('#amount_err_mpos1').css('display') == 'block')\
    //     return false;\
\
\
    var imesh = new userDataCookie().get();\
    var buyerGLID = imesh.glid;\
    $('.paynowbtns').addClass('load');\
	var productName = document.getElementById('order_prodname_checkout').innerHTML;\
    \
\
    $.ajax(\{\
        url: '/phpajax/buyertools/payments/generatePayWithURL',\
        timeout: 10000,\
        data: \{\
            'BS_BUYER_GLID': buyerGLID,\
            'BS_SUPPLIER_GLID': supplierGLID,\
            'BS_PRODUCT_DETAIL': productName,\
            'BS_PAYMENT_AMOUNT': amountToBePaid,\
            'BS_MODID': bs_modid,\
            'BS_BUYER_EMAIL': imesh.em\
        \},\
\
        dataType: "JSON",\
        type: "GET",\
        success: function (result) \{\
			\
//            console.log('generate paywith success');\
//            console.log(result);\
            //document.getElementById('loaderdiv').style.display = 'none';\
            if (result.status == 200) \{\
				getGAEventTrackingJS('Payments', 'Generate URL', 'Payment Protection');\
                var payURL = window.location.href.match(/(\\/\\/dev-my|\\/\\/stg-my)/gi) ? "https://dev-paywith.indiamart.com/invoice/#/" : "https://paywith.indiamart.com/invoice/#/";\
                //  var payURL = "https://paywith.indiamart.com/payx/#/";\
                var payWithURL = payURL + (result.result);\
                window.location = payWithURL;\
//                        window.open(payWithURL, '_blank');\
                $('#cust_mobile').val('');\
                $('#cust_product').val('');\
                $('#cust_amount').val('');\
                // window.location.reload(true);\
            \}\
            if (result.status == 206)\
            \{\
                //document.getElementById('loaderdiv').style.display = 'none';\
                document.getElementById('product_err_mpos1').innerHTML = 'Some error occurred. Please contact 9696969696 for Support';\
                return false;\
            \}\
\
            if (result.status == 205)\
            \{\
                //document.getElementById('loaderdiv').style.display = 'none';\
                document.getElementById('product_err_mpos1').innerHTML = 'Payment cannot proceed as Seller KYC is Pending. Please contact Seller or 9696969696 for support';\
//                        alert('Payment cannot proceed as Seller KYC is Pending. Please contact Seller or 9696969696 for support');\
                return false;\
            \}\
        \},\
        error: function (data) \{\
            //document.getElementById('loaderdiv').style.display = 'none';\
            //get the status code\
            alert('Please check your Internet Connection!!');\
        \}, complete: function (data) \{\
            //document.getElementById('loaderdiv').style.display = 'none';\
            $('.paynowbtn').removeClass('load');\
        \},\
\
    \});\
\
\}\
\
\
\
	function cl1 ()\{\
		document.getElementById('error msg').style.display= "none";\
	\}\
\
	if(Comp_url1!='')\{\
		document.getElementById('msgvline').style.display ="block";\
	\}\
\
function attemptOrder(msg, img, pdpLink,msg_text_json) \{\
	// for making quantity editable\
	let orderQuantity = document.getElementById('checkout_quanity_indicator');\
\
	orderQuantity.addEventListener('keypress', function(e) \{\
		// compute max transaction amount\
		let pricePerPiece = document.getElementById('price_per_piece_ordernow_hidden').textContent;\
		let maxAmount = 1000000 / pricePerPiece;\
		maxAmount = Math.round(maxAmount).toFixed();\
\
	    if (isNaN(String.fromCharCode(e.which)))\
		\{\
			e.preventDefault();\
		\} \
		else if(e.key != 8 && orderQuantity.textContent.length > maxAmount.length - 1)\
		\{\
			e.preventDefault();\
		\}\
	\});\
\
	orderQuantity.addEventListener('input', function() \{\
		changeQuantity('?'); // call changeQuantity() and compute the cost\
	\});\
\
	\
	msg = msg.trim().split('<br>');\
	\
	let product_name = msg[0];\
	var temp = msg[1];\
	temp = temp.replace('/',' ');\
	temp = temp.replace(':',' ');\
	temp= temp.replace('  ',' ');\
	let price_per_unit = temp.split(/\\s+/g)[1];\
	let currency = temp.split(/\\s+/g)[2];\
	let unit_type = temp.split(/\\s+/g)[3];\
	let product_id = getProductIdFromURL(msg[msg.length - 2]);\
	//product_id = product_id.split("-") \
	//product_id  = product_id[3];\
	\
	console.log(product_name, price_per_unit, currency, unit_type, product_id);\
	let addr = document.getElementById('order_my_address').value;\
	updateOrderAddressOnCards(addr);\
	updateProductISQ(product_id);\
	saveAddressObject();\
	document.getElementById('checkout_pdp_url').href = pdpLink;	\
	ordernow('', '1', product_id, product_name, price_per_unit, currency, unit_type, img);\
\}\
\
function updateProductISQ(displayid)\{\
	document.getElementById("isqdet10").innerHTML = '';\
	document.getElementById("isqdet11").innerHTML = '';\
\
	console.log('getting product ISQ');\
	console.log(displayid);\
	$.ajax(\{\
		url: '/phpajax/enquiry/messagecentre/ProductIsqs',\
		data : \{ "display_id" : displayid\},\
		\
		\
		type: "POST",\
		/*async: false,*/\
		dataType: "json",\
		success: function (jsonResult) \{\
			console.log(jsonResult);\
			try\{\
				//jsonResult["httpcode"] == 200\
			if(!jsonResult["Status"])\{\
			if(jsonResult[0]["IS_ISQ_FILLED"] && jsonResult[0]["IS_ISQ_FILLED"] == 1)\{\
				isqHtml = '';\
				var isqHtml2 ='';\
				var key = '';\
				var value = '';\
				var t1 = '';\
				var t2 = '';\
				var isqData = jsonResult[0]["ISQ"];\
				if(isqData.length > 4)\{\
					isqHtml += `<table class="isqdet f1 f14" style="width: 47%;"><tbody>`;\
					for(let i=0; i<4; i++)\{\
						key = isqData[i]["FK_IM_SPEC_MASTER_DESC"].length < 15 ? isqData[i]["FK_IM_SPEC_MASTER_DESC"] : isqData[i]["FK_IM_SPEC_MASTER_DESC"].substr(0,13)+'...';\
						value = isqData[i]["SUPPLIER_RESPONSE_DETAIL"].length < 15 ? isqData[i]["SUPPLIER_RESPONSE_DETAIL"] : isqData[i]["SUPPLIER_RESPONSE_DETAIL"].substr(0,13)+'...';\
						t1 = isqData[i]["FK_IM_SPEC_MASTER_DESC"].length < 15 ? '' : String(isqData[i]["FK_IM_SPEC_MASTER_DESC"]);\
						t2 = isqData[i]["SUPPLIER_RESPONSE_DETAIL"].length < 15 ? '' : String(isqData[i]["SUPPLIER_RESPONSE_DETAIL"]);\
						isqHtml += `<tr><td class="fldname colr_isq"><label title="$\{t1\}">$\{key\}</label></td><td class="colon">:</td><td><span class="fldvalue" style="-webkit-box-decoration-break: clone; box-decoration-break: clone; padding-left: 5px;" title="$\{t2\}">$\{value\}</span></td></tr>`;\
					\}\
					isqHtml += `</tbody></table>`;\
					document.getElementById("isqdet10").innerHTML = isqHtml;\
					\
					isqHtml2 += `<table class="isqdet f2 f14" style="width: 33%;"><tbody>`;\
					var k = 0;\
					for(let j=4; j<isqData.length && k<4; j++,k++)\{\
						\
						key = isqData[j]["FK_IM_SPEC_MASTER_DESC"].length < 15 ? isqData[j]["FK_IM_SPEC_MASTER_DESC"] : isqData[j]["FK_IM_SPEC_MASTER_DESC"].substr(0,13)+'...';\
						value = isqData[j]["SUPPLIER_RESPONSE_DETAIL"].length < 15 ? isqData[j]["SUPPLIER_RESPONSE_DETAIL"] : isqData[j]["SUPPLIER_RESPONSE_DETAIL"].substr(0,13)+'...';\
						t1 = isqData[j]["FK_IM_SPEC_MASTER_DESC"].length < 15 ? '' : String(isqData[j]["FK_IM_SPEC_MASTER_DESC"]);\
						t2 = isqData[j]["SUPPLIER_RESPONSE_DETAIL"].length < 15 ? '' : String(isqData[j]["SUPPLIER_RESPONSE_DETAIL"]);\
						isqHtml2 += `<tr><td class="fldname colr_isq"><label title="$\{t1\}">$\{key\}</label></td><td class="colon">:</td><td><span class="fldvalue" style="-webkit-box-decoration-break: clone; box-decoration-break: clone; padding-left: 5px;" title="$\{t2\}">$\{value\}</span></td></tr>`;\
					\}\
					isqHtml2 += `</tbody></table>`;\
					document.getElementById("isqdet11").innerHTML = isqHtml2;\
				\}else\{\
					isqHtml += `<table class="isqdet f1 f14" style="width: 47%;"><tbody>`;\
					for(let j=0; j<isqData.length; j++)\{\
						key = isqData[j]["FK_IM_SPEC_MASTER_DESC"].length < 15 ? isqData[j]["FK_IM_SPEC_MASTER_DESC"] : isqData[j]["FK_IM_SPEC_MASTER_DESC"].substr(0,13)+'...';\
						value = isqData[j]["SUPPLIER_RESPONSE_DETAIL"].length < 15 ? isqData[j]["SUPPLIER_RESPONSE_DETAIL"] : isqData[j]["SUPPLIER_RESPONSE_DETAIL"].substr(0,13)+'...';\
						t1 = isqData[j]["FK_IM_SPEC_MASTER_DESC"].length < 15 ? '' : String(isqData[j]["FK_IM_SPEC_MASTER_DESC"]);\
						t2 = isqData[j]["SUPPLIER_RESPONSE_DETAIL"].length < 15 ? '' : String(isqData[j]["SUPPLIER_RESPONSE_DETAIL"]);\
						isqHtml += `<tr><td class="fldname colr_isq"><label title="$\{t1\}">$\{key\}</label></td><td class="colon">:</td><td><span class="fldvalue" style="-webkit-box-decoration-break: clone; box-decoration-break: clone; padding-left: 5px;" title='$\{t2\}'>$\{value\}</span></td></tr>`;\
					\}\
					isqHtml += `</tbody></table>`;\
					document.getElementById("isqdet10").innerHTML = isqHtml;\
					\
				\}\
\
			\} \
			\}else\{\
				isqHtml = '';\
			\}   \
		\}catch(err)\{\
			console.log(err);\
			isqHtml = '';\
		\}\
		\}\
	\});\
\}\
function getProdISQ(displayid = 2)\{\
	var glusrid = parseInt(trim(document.getElementById('trackid').value));\
	var url = '/phpajax/enquiry/messagecentre/ProductIsqs';\
	console.log('getProdISQ called');\
	$.ajax(\{\
		url: url,\
		data: \{\
			"glusrid": glusrid,\
			"display_id" : displayid,\
		\},\
		dataType: "html",\
		type: "POST",\
		success: function(jsonResult) \{\
			console.log(jsonResult);\
		\}\
	\});\
\}\
function saveAddressObject()\{\
	let addressObj = \{\
		"contact_name": document.getElementById('order_my_name').value,\
		"contact_mobile": document.getElementById('order_my_mobno').value,\
		"address_line_1": document.getElementById('order_my_addr1').value,\
		"address_line_2": document.getElementById('order_my_addr2').value,\
		"city": document.getElementById('order_my_city').value,\
		"state": document.getElementById('order_my_state').value,\
		"pincode": document.getElementById('order_my_pin').value,\
	\}\
	document.getElementById('order_addr_obj').value = JSON.stringify(addressObj);\
\}\
function updateOrderAddressOnCards(addr)\{\
	document.getElementById('orderCheckout_DeliveryAddress1').innerText = addr;\
	document.getElementById('orderCheckout_DeliveryAddress2').innerText = addr;\
	document.getElementById('orderCheckout_DeliveryAddress3').innerText = addr;\
	document.getElementById('orderCheckout_DeliveryAddress4').innerText = addr;\
\}\
function getProductIdFromURL(url_prod)\{\
	url_prod = url_prod.split('/');\
	\
	let product_id = url_prod[url_prod.length - 1].split('.')[0];\
	product_id=product_id.split('-');\
	product_id =product_id[product_id.length-1];\
	console.log("check msg");console.log(product_id);\
	return product_id;\
\}\
\
function ordernow(mcat_id, msg_modref_id, std_prod_id, msg_prod_name, price_per_unit, currency, unit_type, prod_img)\{\
	var glusrid = parseInt(trim(document.getElementById('trackid').value));\
	var receiver_glid = trim(document.getElementById('contactglid').value);\
	var location_obj = getLocationDetailOfUser();\
	// if(location_obj.IP_COUNTRY === '' || location_obj.GEOIP_COUNTRY_ISO === '' || location_obj.IPADDRESS === '') \{\
	// 	console.log("LOCATION DETAILS NOT PRESENT !!\\nCannot Rate the Supplier");\
	// 	return;\
	// \}\
	// var buyer_ip = location_obj.IPADDRESS;\
	var url = '/phpajax/enquiry/messagecentre/generateOrder';\
	console.log('order now called');\
	$.ajax(\{\
		url: url,\
		data: \{\
			"glusrid": glusrid,\
			"receiver_glid": receiver_glid,\
			"product_id": std_prod_id,\
			"modref_id": msg_modref_id,\
			// "buyer_ip": buyer_ip,\
			"buyer_ip": '121.241.109.212',\
			"mcat_id": mcat_id,\
			"product_name": msg_prod_name,\
		\},\
		dataType: "html",\
		type: "POST",\
		success: function(jsonResult) \{\
			console.log(jsonResult);\
			jsonResult = JSON.parse(jsonResult);\
			if (jsonResult.code != 200) return false;\
			updateCheckoutCard(prod_img, msg_prod_name, price_per_unit, currency, unit_type)\
			document.getElementById('orderNow_order_id').value = jsonResult.order_id;\
			\
			showOrderNowModal();\
		\}\
	\});\
\}\
\
function updateCheckoutCard(prod_img, prod_name, price_per_unit, currency, unit_type, quantity_order = 1)\{\
	document.getElementById('order_img_checkout').src = prod_img;\
	document.getElementById('order_prodname_checkout').innerText = prod_name;\
	document.getElementById('placedsuccessful').innerText = "Your order for "+prod_name+" has been placed successfully";\
	document.getElementById('price_per_piece_ordernow_hidden').innerText = price_per_unit;\
	document.getElementById('price_per_piece_ordernow').innerText = price_per_unit.toString().split('.')[0]; \
	document.getElementById('price_per_piece_ordernow_decimals').innerText = `.$\{price_per_unit.toString().split('.')[1] === undefined ? '00' : price_per_unit.toString().split('.')[1]\}`; // to show digits after decimal smaller than digits before decimal\
	document.getElementById('order_unit_type').innerText = unit_type;\
	document.getElementById('checkout_quanity_indicator').innerText = quantity_order;\
	let totalPrice = price_per_unit * quantity_order;\
	totalPrice = totalPrice.toFixed(2); // to convert price to two decimal places\
	document.getElementById('total_order_price_hidden').innerText = totalPrice;\
    document.getElementById('total_order_price').innerText = totalPrice.split('.')[0];\
	document.getElementById('total_order_price_decimals').innerText = `.$\{totalPrice.split('.')[1]\}`;\
	document.getElementById('order_paylater_amt').innerText = price_per_unit * quantity_order;\
\}\
\
function validateName(name) \{\
	return /^[A-Za-z\\s]+$/.test(name);\
\}\
\
function populatecityandstate()\{\
    if(arr1.length > 0)\
    \{\
        document.getElementById("order_addr_state").value=arr1[3];\
        document.getElementById("order_addr_city").value=arr1[1];\
        document.getElementById('zip-dropdown').style.visibility = 'hidden';\
        document.getElementById('zip-dropdown').innerHTML = '';\
		$('#save_delivery_address_btn').css(\{'background': '#00a699', 'border-color': '#00a699', 'color': '#fff', 'cursor': 'pointer'\}); // added\
		$('#save_delivery_address_btn').attr('disabled', false);\
    \}\
\}\
\
// for Suggester function\
function onselect_city(event, ui)\{ \
	this.value = ui.item.value;\
	$('#temp_city_others').val(ui.item.value);\
	document.getElementById('order_addr_state').value = ui.item.data.state; // changed state_others\
	document.getElementById('city').value = ui.item.data.id;\
	document.getElementById('state').value = ui.item.data.stateid; \
	$("#saveAddress").removeClass("dsbl");\
	$("#saveAddress").addClass("sv");\
	document.getElementById("c1").innerHTML='';\
	$("#city_others").css("border-color",""); \
	$('#save_delivery_address_btn').css(\{'background': '#00a699', 'border-color': '#00a699', 'color': '#fff', 'cursor': 'pointer'\}); // added\
	$('#save_delivery_address_btn').attr('disabled', false);\
\}\
\
let arr1 = [];\
function zipCodeAPI(event) \{\
	if(event.keyCode == 40 && document.getElementById('zip-dropdown').innerHTML!="")\
    \{\
        $('#zip-dropdown').css('background-color','#ebecf1');\
        return;\
    \}\
\
\
    if(event.keyCode == 13 && $('#zip-dropdown').css('visibility', 'visible'))\
    \{\
        $('#zip-dropdown').click();\
		$('#zip-dropdown').css('visibility', 'hidden');\
        return;\
    \} \
\
	if(document.getElementById('order_addr_pin').value.length < 6)\
	\{\
		document.getElementById('zip-dropdown').style.visibility = 'hidden';\
		document.getElementById('zip-dropdown').innerHTML = '';\
	\}\
\
    if(document.getElementById('order_addr_pin') && document.getElementById('order_addr_pin').value && document.getElementById('order_addr_pin').value!="" && document.getElementById('order_addr_pin').readOnly == false)\
	\{\
		let pincode = document.getElementById('order_addr_pin').value.trim();\
		let list1;\
		let url = '/phpajax/userprofile/editprofile/GetCityState';\
		let zip = pincode;\
		$.ajax(\{\
			url : url,\
			data : \{PIN: zip\},\
			dataType : 'html',\
			type: 'POST',\
			success : function(jsonResult) \{\
				if(jsonResult['failure']=="Authorization Fail")\{\
					return;\
				\}\
				list1 = JSON.parse(jsonResult);\
				arr1 = list1;\
\
				if(list1.length>0)\{\
					document.getElementById('zip-dropdown').style.visibility = 'visible';\
					$('#zip-dropdown').css('background-color','#fff');\
					document.getElementById('zip-dropdown').innerHTML = `$\{list1[1]\}, $\{list1[3]\}`;\
				\}\
				else \{\
					document.getElementById('zip-dropdown').style.visibility = 'hidden';\
					document.getElementById('zip-dropdown').innerHTML = '';\
				\}\
			\} \
		\});\
	\}\
\}\
\
\
function saveOrderAddr()\{\
	let addressObj = \{\
		"contact_name": document.getElementById('order_addr_name').value,\
		"contact_mobile": document.getElementById('order_my_mobno').value,\
		"address_line_1": document.getElementById('order_addr_addr1').value,\
		"address_line_2": document.getElementById('order_addr_addr2').value,\
		"city": document.getElementById('order_addr_city').value,\
		"state": document.getElementById('order_addr_state').value,\
		"pincode": document.getElementById('order_addr_pin').value,\
	\}\
	if (!validateAddress(addressObj)) return false;\
	let addressString = addressObj.contact_name + ', '\
		+ addressObj.address_line_1 + ', '\
		+ addressObj.city + ', '\
		+ addressObj.state + ' - '\
		+ addressObj.pincode;\
	updateOrderAddress(addressObj);\
	//pass in API\
	document.getElementById('myModal_OrderNow_editAddr').style.display = 'none';\
	document.getElementById('myModal_OrderNow_checkout').style.display = 'block';\
	document.getElementById('order_addr_obj').value = JSON.stringify(addressObj);\
	console.log(addressString);\
\}\
function updateOrderAddress(addressObj)\{\
	$.ajax(\{\
			url: '/phpajax/enquiry/messagecentre/UpdateAddress',\
			data: \{\
				"FIRSTNAME":addressObj.contact_name,\
				"ADD1":addressObj.address_line_1,\
				"ADD2":addressObj.address_line_2,\
				"PH_MOBILE":addressObj.contact_mobile,\
				"CITY":addressObj.city,\
				"STATE":addressObj.state,\
				"ZIP":addressObj.pincode\
			\},\
			type: "POST",\
			async: false,\
			dataType: "json",\
			success: function (jsonResponse) \{\
				console.log(jsonResponse);\
				if (jsonResponse.CODE != 200) return;\
				let addressString = addressObj.address_line_1+", "+\
				addressObj.address_line_2+", "+\
				addressObj.city+", "+\
				addressObj.state+"- "+\
				addressObj.pincode;\
				updateOrderAddressOnCards(addressString);\
				document.getElementById('order_my_address').value = addressString;\
				document.getElementById('order_my_name').value = addressObj.contact_name;\
				document.getElementById('order_my_mobno').value = addressObj.contact_mobile;\
				document.getElementById('order_my_addr1').value = addressObj.address_line_1;\
				document.getElementById('order_my_addr2').value = '';\
				document.getElementById('order_my_city').value = addressObj.city;\
				document.getElementById('order_my_state').value = addressObj.state;\
				document.getElementById('order_my_pin').value = addressObj.pincode;\
			\},\
			error: function (err) \{\
			\}\
		\});\
\}\
function validateAddress(obj)\{\
	if (obj.contact_name == '' || \
		obj.contact_mobile == '' || \
		obj.address_line_1 == '' ||\
		obj.address_line_2 == '' ||\
		obj.city == '' ||\
		obj.state == '' ||\
		obj.pincode == '')\{\
			alert('Please enter all the details!');\
			return false;\
	\}\
	else if(/^[a-zA-Z ]\{2,30\}$/.test(obj.contact_name) == false) // validate name\
	\{\
		alert('Name is not valid!');\
		return false;\
	\}\
	else if(/^(\\d\{4\}|\\d\{6\})$/.test(obj.pincode) == false) // validate pincode\
	\{\
		alert('Pincode is not valid!');\
		return false;\
	\}\
	else return true;\
\}\
function enrichorder(checkingOut = false)\{\
	var order_id = document.getElementById('orderNow_order_id').value;\
	var order_quantity = parseInt(document.getElementById('checkout_quanity_indicator').innerHTML);\
	var total_order_price = document.getElementById('total_order_price_hidden').innerHTML.split(',').join('');\
	var order_unit_type = document.getElementById('order_unit_type').innerHTML;\
	var order_unit_price  = document.getElementById('price_per_piece_ordernow_hidden').innerText;\
	var glusrid = parseInt(trim(document.getElementById('trackid').value));\
	var url = '/phpajax/enquiry/messagecentre/enrichOrder';\
	console.log('enrich order called');\
	if(order_quantity == 0)\
	\{\
		alert('Order quantity cannot be zero!');\
		return;\
	\}\
	$.ajax(\{\
		url: url,\
		data: \{\
			"glusrid": glusrid,\
			"order_id": order_id,\
			"order_quantity": order_quantity,\
			"total_order_price": total_order_price,\
			"order_unit_type": order_unit_type,\
			"order_unit_price": order_unit_price,\
			"order_currency": 'INR',\
			"pay_mode": 1,\
		\},\
		dataType: "html",\
		type: "POST",\
		success: function(jsonResult) \{\
			console.log(jsonResult);\
			let payOption = document.querySelector('input[name="orderPay"]:checked').id;\
			if (payOption == 'pay2')\{ //Pay Later\
				updatePayLaterCard(total_order_price, order_unit_price, order_unit_type, order_quantity);\
				finishorder(order_id);\
			\}\
			else if (payOption == 'pay1')\{// Pay Now\
				finishorder(order_id, false);\
				identifySellerType3();\
			\}\
			else\{\
				alert('please choose a payment method to continue');\
			\}\
			\
		\}	\
	\});\
\}\
\
function updatePayLaterCard(total_order_price, order_unit_price, order_unit_type, order_quantity)\{\
	document.getElementById('order_paylater_amt').innerText = total_order_price.split('.')[0];\
	document.getElementById('order_paylater_amt_decimals').innerText = `.$\{total_order_price.split('.')[1] === undefined ? '00' : total_order_price.split('.')[1]\}`;\
	// document.getElementById('order_checkout_datetime').innerText = \
	document.getElementById('order_checkout_price_and_unit').innerText = order_unit_price.split('.')[0];\
	document.getElementById('order_checkout_price_and_unit_decimals').innerText = `.$\{order_unit_price.split('.')[1] === undefined ? '00' : order_unit_price.split('.')[1]\}`;\
	document.getElementById('order_placed_unit').innerText = ` / $\{order_unit_type\}`;\
	document.getElementById('order_checkout_quantity').innerText = order_quantity;\
\}\
\
function finishorder(order_id, paylater = true)\{\
	var address = JSON.parse(document.getElementById('order_addr_obj').value);\
	var pay_mode = '1';\
	var pay_status = ''; \
	var pay_inv_id = '';\
	var glusrid = parseInt(trim(document.getElementById('trackid').value));\
	var url = '/phpajax/enquiry/messagecentre/finishOrder';\
	console.log('finish order called');\
	$.ajax(\{\
		url: url,\
		data: \{\
			"glusrid": glusrid,\
			"order_id": order_id,\
			"address": address,\
			"pay_mode": pay_mode,\
			"pay_status": pay_status,\
			"pay_inv_id": pay_inv_id,\
		\},\
		dataType: "html",\
		type: "POST",\
		success: function(jsonResult) \{\
			console.log(jsonResult);\
			if (paylater)\{\
				document.getElementById('myModal_OrderNow_editAddr').style.display = 'none';\
				document.getElementById('myModal_OrderNow_checkout').style.display = 'none';\
				document.getElementById('checkout_order_id').innerText = order_id;\
\
				let date_today = new Date();\
				//let date_in_format = date_today.toShortFormat();\
				let time_in_format = date_today.toLocaleTimeString('en-US', \{ hour: 'numeric', hour12: true, minute: 'numeric' \});\
				//document.getElementById('order_checkout_stg_date').innerHTML = date_in_format;\
				document.getElementById('order_checkout_stg_time').innerHTML = time_in_format;\
				//document.getElementById('order_checkout_datetime').innerHTML = date_in_format+" | "+time_in_format;\
\
				document.getElementById('myModal_OrderNow_PayLater').style.display = 'block';\
			\}\
		\}\
	\});\
\}\
function cancelorder(cancel_sub_disp_id,can_reason)\{\
	// console.log($('input[name="dispReason"]:checked').val());\
	// let cancel_sub_disp_id = console.log($('input[name="dispReason"]:checked').val());\
	let order_id = document.getElementById('orderNow_order_id').value;\
	var glusrid = parseInt(trim(document.getElementById('trackid').value));\
	var url = '/phpajax/enquiry/messagecentre/cancelOrder';\
	console.log('cancel order called');\
	$.ajax(\{\
		url: url,\
		data: \{\
			"glusrid": glusrid,\
			"order_id": order_id,\
			"cancel_by": "b",\
			"can_sub_disp_id": cancel_sub_disp_id,\
			"can_reason": can_reason,\
		\},\
		dataType: "html",\
		type: "POST",\
		success: function(jsonResult) \{\
			console.log(jsonResult);\
			let response = JSON.parse(jsonResult);\
			if (response.code != '200')\{\
				alert('Cannot cancel. Some error occured.');\
				return;\
			\} \
			showCancelSuccessful(response, cancel_sub_disp_id, order_id);\
		\}\
	\});\
\}\
function showCancelSuccessful(response, cancel_id, order_id)\{\
	//Update cross sign\
	let cancel_stage_num = response.order_stage;\
	let cancel_stage_el = document.getElementById('cd_sym'+cancel_stage_num);\
	if (cancel_stage_el)\{\
			cancel_stage_el.innerHTML = \
				`<svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">\
					<path d="M6.99999 5.58599L11.95 0.635986L13.364 2.04999L8.41399 6.99999L13.364 11.95L11.95 13.364L6.99999 8.41399L2.04999 13.364L0.635986 11.95L5.58599 6.99999L0.635986 2.04999L2.04999 0.635986L6.99999 5.58599Z" fill="white"></path>\
				</svg>`;\
	\}\
	//Update cancel reason\
	let cancel_reason = '';\
	if (cancel_id == 101) cancel_reason = 'Order created by mistake';\
	else if (cancel_id == 201) cancel_reason = 'Item(s) would not arrive on time';\
	else if (cancel_id == 301) cancel_reason = 'Found cheaper somewhere else';\
	else if (cancel_id == 401) cancel_reason = document.getElementById('401dispReason').value;\
	document.getElementById('cd_cancel_card_reason').innerText = cancel_reason;\
\
	//update cancelled card\
	getOrderDetails(order_id, null, null, true);\
	//visibility manipulation\
	hideAllOrderModals();\
	document.getElementById('myModal_OrderNow_Cancelled').style.display = 'block';\
\}\
function cancelOrderClicked()\{\
	hideAllOrderModals();\
	document.getElementById('myModal_OrderNow_CancelReasons').style.display = 'block';\
\}\
function getOrderDispList()\{\
	var glusrid = parseInt(trim(document.getElementById('trackid').value));\
	var url = '/phpajax/enquiry/messagecentre/getOrderDispositionList';\
	console.log('getOrderDispList called');\
	$.ajax(\{\
		url: url,\
		data: \{\
			"glusrid": glusrid,\
		\},\
		dataType: "html",\
		type: "GET",\
		success: function(jsonResult) \{\
			console.log(jsonResult);\
			let reasonsObj = JSON.parse(jsonResult);\
			let buyerReasons = reasonsObj['order_disposition']['buyer_disposition'];\
			const keys = Object.keys(buyerReasons);\
			// console.log(keys);\
			let cancelHTML = ``;\
			keys.forEach((key, index) => \{\
				// console.log(`$\{key\}: $\{buyerReasons[key]\}`);\
				cancelHTML +=\
				`<div style="display:flex;flex-direction:row;margin-bottom:10px">\
					<input type="radio" id="input$\{key\}" name="dispReason" value="$\{key\}">\
					<label style="margin-left:5px; font-size:13px;" class="posr top_2" for="input$\{key\}">$\{buyerReasons[key]\}</label>\
				</div>\
				`;\
			\});\
			cancelHTML += `\
				<textarea class="othr_txaea" id="401dispReason"> </textarea>\
                <span class="order_nw_btn acpt f2 mr10" onclick="attemptCancel()" style="position: relative;right: -190px;top: 5px;">Cancel Order</span>\
			`\
			document.getElementById('cancelReasonsList').innerHTML = cancelHTML;\
			document.getElementById('myModal_OrderNow_editAddr').style.display = 'none';\
			document.getElementById('myModal_OrderNow_checkout').style.display = 'none';\
			document.getElementById('myModal_OrderNow_PayLater').style.display = 'none';\
			// document.getElementById('myModal_OrderNow_CancelReasons').style.display = 'block';\
		\}\
	\});\
\}\
function attemptCancel()\{\
   var cancel_id =$('input[name="dispReason"]:checked').val();\
	var cancel_reason ='';\
\
	if (cancel_id == '101') cancel_reason = 'Order created by mistake';\
	else if (cancel_id == '201') cancel_reason = 'Item(s) would not arrive on time';\
	else if (cancel_id == '301') cancel_reason = 'Found cheaper somewhere else';\
	else if (cancel_id == '401') cancel_reason = document.getElementById('401dispReason').innerText;\
    cancelorder(cancel_id,cancel_reason);\
\}\
getOrderDispList();\
function getOrderStages()\{\
	var glusrid = parseInt(trim(document.getElementById('trackid').value));\
	var url = '/phpajax/enquiry/messagecentre/getOrderStages';\
	console.log('getOrderStages called');\
	$.ajax(\{\
		url: url,\
		data: \{\
			"glusrid": glusrid,\
		\},\
		dataType: "html",\
		type: "GET",\
		success: function(jsonResult) \{\
			console.log(jsonResult);\
		\}\
	\});\
\}\
function orderInfo(order_id, curr_status, modref, prod_img, prod_name, curr_state, orig_state)\{\
	//storing current status in hidden input field to refer to later\
	updateProductISQdetails(modref);\
	document.getElementById('order_curr_state').value = curr_status+"##"+curr_state+"##"+orig_state;\
	getOrderDetails(order_id, prod_img, prod_name);\
\}\
function getOrderDetails(order_id, prod_img, prod_name, order_cancel = false)\{\
	var glusrid = parseInt(trim(document.getElementById('trackid').value));\
	var url = '/phpajax/enquiry/messagecentre/getOrderDetails';\
	\
	console.log('getOrderDetails called');\
	\
	$.ajax(\{\
		url: url,\
		data: \{\
			"glusrid": glusrid,\
			"order_id": order_id,\
		\},\
		dataType: "html",\
		type: "GET",\
		success: function(jsonResult) \{\
			var obj = JSON.parse(jsonResult);\
			console.log(obj);\
			document.getElementById('orderNow_order_id').value = order_id;\
			if (!order_cancel)\{\
				updateViewDetailsCard(obj, prod_img, prod_name);\
\
				hideAllOrderModals();\
				document.getElementById('myModal_OrderNow_ViewDetails').style.display = 'block';\
			\}else\{\
				updateCancelSuccessfulCard(obj);\
				hideAllOrderModals();\
				document.getElementById('myModal_OrderNow_Cancelled').style.display = 'block';\
				document.getElementById('vd_status_small').innerText = 'Order cancelled';\
			\}\
		\}\
	\});\
\}\
function updateViewDetailsCard(details, prod_img, prod_name)\{ //vd = view details\
	details = details.response;\
	//progress\
	let status = details.transition_details.length;\
	let curr_status = document.getElementById('order_curr_state').value;\
	curr_status = curr_status.split("##");\
	for(let i = 0; i < curr_status.length; i++) curr_status[i] = trim(curr_status[i]);\
	for(let i = 1; i <= 4; i++)\{		//resetting all circles\
		document.getElementById(`vd_sym$\{i\}`).className = 'f1';\
		document.getElementById(`vd_sym$\{i\}`).innerHTML = '';\
		document.getElementById(`vd_time_$\{i\}`).innerHTML = '';\
	\}\
	for(let i = 1; i <= 4; i++)\{\
		var transition = details.transition_details;\
		console.log(curr_status[0], curr_status[1]);\
		if (i == status)\{\
			if (curr_status[0] != 'OC' && curr_status[1] != "Cancelled" && curr_status[2] != "Cancelled")\{\
				document.getElementById(`vd_sym$\{i\}`).classList.add('status_green');\
				let progress_msg = document.getElementById('vd_status_small');\
				if (progress_msg)\{\
					document.getElementById('vd_cancel_btn').style.display = 'block';\
					if (status == 1) \{\
						progress_msg.innerText = 'Awaiting acceptance by seller';\
						// document.getElementById('vd_cancel_btn').style.display = 'none';\
					\}\
					else if (status == 2) progress_msg.innerText = 'Awaited shipment by seller';\
					else if (status == 3) progress_msg.innerText = 'Awaiting order delivery';\
					else \{\
						progress_msg.innerText = ''; // showing blank..\
						document.getElementById('vd_cancel_btn').style.display = 'none';\
					\}\
				\}\
			\}\
			else\{\
				document.getElementById('vd_cancel_btn').style.display = 'none'; //hide cancel button\
				document.getElementById(`vd_sym$\{i\}`).classList.add('status_gray');\
				document.getElementById(`vd_sym$\{i\}`).classList.add('status_red');\
				document.getElementById(`vd_sym$\{i\}`).innerHTML = \
				`<svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">\
					<path d="M6.99999 5.58599L11.95 0.635986L13.364 2.04999L8.41399 6.99999L13.364 11.95L11.95 13.364L6.99999 8.41399L2.04999 13.364L0.635986 11.95L5.58599 6.99999L0.635986 2.04999L2.04999 0.635986L6.99999 5.58599Z" fill="white"></path>\
				</svg>`;\
			\}\
			document.getElementById(`vd_time_$\{i\}`).innerHTML = formatAMPM(transition[i-1].status_date);\
		\} \
		else if (i < status)\{\
			document.getElementById(`vd_sym$\{i\}`).classList.add('status_green');\
			document.getElementById(`vd_time_$\{i\}`).innerHTML = formatAMPM(transition[i-1].status_date);\
		\} \
		else document.getElementById(`vd_sym$\{i\}`).classList.add('status_gray');\
	\}\
\
	//address, changed\
	if (details.address)\{\
		let addr_line_1 = details.address.address_line_1 === null ? '' : details.address.address_line_1 + ', ';\
		let addr_line_2 = details.address.address_line_2 === null ? '' : details.address.address_line_2 + ', ';\
		let city = details.address.city === null ? '' : details.address.city + ', ';\
		let state = details.address.state === null ? '' : details.address.state + ' - ';\
		let pincode = details.address.pincode === null ? '' : details.address.pincode;\
		let addr = addr_line_1 +\
		addr_line_2 +\
		city +\
		state +\
		pincode;\
		document.getElementById('orderCheckout_DeliveryAddress3').innerHTML = addr;\
		document.getElementById('orderCheckout_DeliveryAddress4').innerText = addr;\
	\}\
	else\{\
		document.getElementById('orderCheckout_DeliveryAddress3').innerHTML = '';\
		document.getElementById('orderCheckout_DeliveryAddress4').innerText = '';\
	\}\
	//other details\
	document.getElementById('order_img_vd').src = prod_img;\
	document.getElementById('order_prodname_vd').innerText = prod_name;\
	let order_id = details.order_id;\
	let order_date = details.order_date;\
 	let payment_mode = details.payment_details.pay_mode == 1 ? 'Pay Later' : 'Pay Now';\
	let payment_status = details.payment_details.pay_status;\
	let payment_trx_id = details.payment_details.pay_inv_ref_id;\
	let price = details.attributes.order_unit_price +' / '+ details.attributes.order_unit_type;\
	let quantity = details.attributes.order_quantity;\
	let delivery_charges = details.delivery_charge;\
	let courier_contact = details.courier_contact_number;\
	let delivery_mode = findDeliveryMode(details.delivery_mode);\
	let delivery_time = findDeliveryTime(details.delivery_time);\
	let total_price = details.total_price;\
	let info_html = `<tr><td class="fldname colr_isq"><label>Order ID </label></td><td><span class="fldvalue">$\{order_id\}</span> </td></tr>\
	<tr><td class="fldname colr_isq"><label>Payment Mode </label></td><td><span class="fldvalue">$\{payment_mode\}</span> </td></tr>`;\
	if (payment_status != -1 && payment_trx_id)\{\
		info_html += `<tr><td class="fldname colr_isq"><label>Payment Status </label></td><td><span class="fldvalue">$\{payment_status\}</span> </td></tr>`;\
		info_html += `<tr><td class="fldname colr_isq"><label>Transaction ID </label></td><td><span class="fldvalue">$\{payment_trx_id\}</span> </td></tr>`;\
	\}\
	info_html += `<tr><td class="fldname colr_isq"><label>Order Date </label></td><td><span class="fldvalue">$\{order_date\}</span> </td></tr>\
	<tr><td class="fldname colr_isq"><label>Price </label></td><td><span class="fldvalue">$\{price.split('.')[0]\}</span><span style="font-size: 10px;">.$\{price.split('.')[1].split('/')[0] === undefined ? '00' : price.split('.')[1].split('/')[0]\}</span><span> / $\{price.split('/')[1]\}</span></td></tr>\
	<tr><td class="fldname colr_isq"><label>Quantity </label></td><td><span class="fldvalue">$\{quantity\}</span> </td></tr>\
	`;\
	if (delivery_charges) \
		info_html += `<tr><td class="fldname colr_isq"><label>Delivery Charges </label></td><td><span class="fldvalue">$\{delivery_charges\}</span> </td></tr>`;\
	if (delivery_mode) \
		info_html += `<tr><td class="fldname colr_isq"><label>Delivery Mode </label></td><td><span class="fldvalue">$\{delivery_mode\}</span> </td></tr>`;\
	if (delivery_time) \
		info_html += `<tr><td class="fldname colr_isq"><label>Delivery Time </label></td><td><span class="fldvalue">$\{delivery_time\}</span> </td></tr>`;\
	if (courier_contact) \
		info_html += `<tr><td class="fldname colr_isq"><label>Courier Contact No. </label></td><td><span class="fldvalue">$\{courier_contact\}</span> </td></tr>`;\
	if(!delivery_mode)\
	\{\
		info_html += `<tr id="totalPriceAtBottom" style="font-weight:bold;bottom:30px;position:absolute;"><td class="fldname \'c3\'af\'c2\'bf\'c2\'bdf16 pb10"><label class="fwb">Total Amount</label></td><td><span class="fldvalue f18 pb10"><i class="fa fa-inr" aria-hidden="true"></i><b><span>$\{total_price.split('.')[0]\}</span><span style="font-size: 13px;">.$\{total_price.split('.')[1]\}<span></b></span> </td></tr>`;\
	\}\
	else \
	\{ // added\
		info_html += `<tr id="totalPriceAtBottom" style="font-weight:bold;bottom:30px;position:absolute;"><td class="fldname \'c3\'af\'c2\'bf\'c2\'bdf16 pb10"><label class="fwb">Total Amount</label></td><td><span class="fldvalue f18 pb10"><i class="fa fa-inr" aria-hidden="true"></i><b><span>$\{total_price.split('.')[0]\}</span><span style="font-size: 13px;">.$\{total_price.split('.')[1]\}<span></b></span> </td></tr>`\
	\}\
	\
	document.getElementById('vd_table_info').innerHTML = info_html;\
	$('#totalPriceAtBottom').prepend('<hr style="width: 24.5rem; border-top: 1px dotted; position: absolute; bottom: 26px;">'); // added line\
\}\
function updateCancelSuccessfulCard(details)\{\
	details = details.response;\
	//progress\
	let status = details.transition_details.length;\
	for(let i = 1; i <= 4; i++)\{		//resetting all circles\
		document.getElementById(`cd_sym$\{i\}`).className = 'f1';\
		document.getElementById(`vd_sym$\{i\}`).innerHTML = '';\
		document.getElementById(`vd_time_$\{i\}`).innerHTML = '';\
	\}\
	for(let i = 1; i <= 4; i++)\{\
		var transition = details.transition_details;\
		if (i == status)\{\
				document.getElementById(`cd_sym$\{i\}`).classList.add('status_gray');\
				document.getElementById(`cd_sym$\{i\}`).classList.add('status_red');\
				document.getElementById(`cd_sym$\{i\}`).innerHTML = \
				`<svg width="14" height="14" viewBox="0 0 14 14" fill="none" xmlns="http://www.w3.org/2000/svg">\
					<path d="M6.99999 5.58599L11.95 0.635986L13.364 2.04999L8.41399 6.99999L13.364 11.95L11.95 13.364L6.99999 8.41399L2.04999 13.364L0.635986 11.95L5.58599 6.99999L0.635986 2.04999L2.04999 0.635986L6.99999 5.58599Z" fill="white"></path>\
				</svg>`;\
			document.getElementById(`cd_time_$\{i\}`).innerHTML = formatAMPM(transition[i-1].status_date);\
		\} \
		else if (i < status)\{\
			document.getElementById(`cd_sym$\{i\}`).classList.add('status_green');\
			document.getElementById(`cd_time_$\{i\}`).innerHTML = formatAMPM(transition[i-1].status_date);\
		\} \
		else document.getElementById(`cd_sym$\{i\}`).classList.add('status_gray');\
	\}\
\
	//address\
	if (details.address)\{\
		let addr_line_1 = details.address.address_line_1 === null ? '' : details.address.address_line_1 + ', ';\
		let addr_line_2 = details.address.address_line_2 === null ? '' : details.address.address_line_2 + ', ';\
		let city = details.address.city === null ? '' : details.address.city + ', ';\
		let state = details.address.state === null ? '' : details.address.state + ' - ';\
		let pincode = details.address.pincode === null ? '' : details.address.pincode;\
		let addr = addr_line_1 +\
		addr_line_2 +\
		city +\
		state +\
		pincode;\
		document.getElementById('orderCheckout_DeliveryAddress3').innerHTML = addr;\
		document.getElementById('orderCheckout_DeliveryAddress4').innerText = addr;\
	\}\
	else\{\
		document.getElementById('orderCheckout_DeliveryAddress3').innerHTML = '';\
		document.getElementById('orderCheckout_DeliveryAddress4').innerText = '';\
	\}\
	//other details\
	// document.getElementById('order_img_cd').src = prod_img;\
	// document.getElementById('order_prodname_cd').innerText = prod_name;\
	let order_id = details.order_id;\
	let order_date = details.order_date;\
 	let payment_mode = details.payment_details.pay_mode == 1 ? 'Pay Later' : 'Pay Now';\
	let payment_status = details.payment_details.pay_status;\
	let payment_trx_id = details.payment_details.pay_inv_ref_id;\
	let price = details.attributes.order_unit_price +' / '+ details.attributes.order_unit_type;\
	let quantity = details.attributes.order_quantity;\
	let delivery_charges = details.delivery_charge;\
	let courier_contact = details.courier_contact_number;\
	let delivery_mode = findDeliveryMode(details.delivery_mode);\
	let delivery_time = findDeliveryTime(details.delivery_time);\
	let total_price = details.total_price;\
	let info_html = `<tr><td class="fldname colr_isq"><label>Order ID </label></td><td><span class="fldvalue">$\{order_id\}</span> </td></tr>\
	<tr><td class="fldname colr_isq"><label>Payment Mode </label></td><td><span class="fldvalue">$\{payment_mode\}</span> </td></tr>`;\
	if (payment_status != -1 && payment_trx_id)\{\
		info_html += `<tr><td class="fldname colr_isq"><label>Payment Status </label></td><td><span class="fldvalue">$\{payment_status\}</span> </td></tr>`;\
		info_html += `<tr><td class="fldname colr_isq"><label>Transaction ID </label></td><td><span class="fldvalue">$\{payment_trx_id\}</span> </td></tr>`;\
	\}\
	info_html += `<tr><td class="fldname colr_isq"><label>Order Date </label></td><td><span class="fldvalue">$\{order_date\}</span> </td></tr>\
	<tr><td class="fldname colr_isq"><label>Price </label></td><td><span class="fldvalue">$\{price.split('.')[0]\}</span><span style="font-size: 10px;">.$\{price.split('.')[1].split('/')[0] === undefined ? '00' : price.split('.')[1].split('/')[0]\}</span><span> / $\{price.split('/')[1]\}</span></td></tr>\
	<tr><td class="fldname colr_isq"><label>Quantity </label></td><td><span class="fldvalue">$\{quantity\}</span> </td></tr>\
	`;\
	if (delivery_charges) \
		info_html += `<tr><td class="fldname colr_isq"><label>Delivery Charges </label></td><td><span class="fldvalue">$\{delivery_charges\}</span> </td></tr>`;\
	if (delivery_mode) \
		info_html += `<tr><td class="fldname colr_isq"><label>Delivery Mode </label></td><td><span class="fldvalue">$\{delivery_mode\}</span> </td></tr>`;\
	if (delivery_time) \
		info_html += `<tr><td class="fldname colr_isq"><label>Delivery Time </label></td><td><span class="fldvalue">$\{delivery_time\}</span> </td></tr>`;\
	if (courier_contact) \
		info_html += `<tr><td class="fldname colr_isq"><label>Courier Contact No. </label></td><td><span class="fldvalue">$\{courier_contact\}</span> </td></tr>`;\
	info_html += `<tr id="totalPriceAtBottom_CancelCard" style="font-weight:bold;bottom:30px;position:absolute;"><td class="fldname \'c3\'af\'c2\'bf\'c2\'bdf16 pb10"><label class="fwb">Total Amount</label></td><td><span class="fldvalue f18 pb10"><i class="fa fa-inr" aria-hidden="true"></i><b><span>$\{total_price.split('.')[0]\}</span><span style="font-size: 13px">.$\{total_price.split('.')[1]\}</span></b></span> </td></tr>`;\
	\
	document.getElementById('cd_table_info').innerHTML = info_html;\
	$('#totalPriceAtBottom_CancelCard').prepend('<hr style="width: 24.5rem; border-top: 1px dotted;">'); // added this line\
\}\
function findDeliveryMode(num)\{\
	let mode = '';\
	if (num == 1) mode = 'Self Delivery';\
	else if (num == 2) mode = 'Pickup by Buyer';\
	else if(num == 3) mode = 'Delivery Courier Company';\
	mode = mode == '' ? null : mode;\
	return mode;\
\}\
function findDeliveryTime(num)\{\
	let time = '';\
	if (num == 1) time = '1-3';\
	else if (num == 2) time = '4-5';\
	else if (num == 3) time = '6-10';\
	else if(num == 4) time = '10+';\
	time = time == '' ? null : time+' days';\
	return time;\
\}\
function hideAllOrderModals()\{\
	document.getElementById('myModal_OrderNow_editAddr').style.display = 'none';\
	document.getElementById('myModal_OrderNow_checkout').style.display = 'none';\
	document.getElementById('myModal_OrderNow_PayLater').style.display = 'none';\
	document.getElementById('myModal_OrderNow_CancelReasons').style.display = 'none';\
	document.getElementById('myModal_OrderNow_ViewDetails').style.display = 'none';\
	document.getElementById('myModal_OrderNow_Cancelled').style.display = 'none';\
\}\
function showOrderNowModal()\{\
	document.getElementById('myModal_OrderNow_editAddr').style.display = 'none';\
	document.getElementById('myModal_OrderNow_checkout').style.display = 'flex';\
\}\
\
function emptyAddressForm() \{ // to empty edit address form upon pressing cancel button\
	let allFields = ['order_addr_name', 'order_addr_addr1', 'order_addr_city', 'order_addr_pin', 'order_addr_addr2', 'order_addr_state'];\
\
	for(let i = 0; i < allFields.length; i++)\
	\{\
		$(`#$\{allFields[i]\}`).val('');\
	\}\
\}\
\
function checkIfAddressFormIsCompletelyEmpty() \{ // to check whether the edit address form is completely empty or not\
	let isEmpty = true;\
	let allFields = ['order_addr_name', 'order_addr_addr1', 'order_addr_city', 'order_addr_pin', 'order_addr_addr2', 'order_addr_state'];\
	for(let i = 0; i < allFields.length; i++)\
	\{\
		if($(`#$\{allFields[i]\}`).val() != '')\
		\{\
			isEmpty = false;\
			break;\
		\}\
	\}\
\
	return isEmpty;\
\}\
\
function edit_order_addr()\{ // is called on clicking the Edit Address Button on the Checkout Card in Order Now journey\
	sugg_city = new Suggester(\{"element":"order_addr_city", "onSelect":onselect_city, "filters":"iso:"+'IN' , "placeholder":"", "classPlaceholder":"ui-placeholder-input",updateCache:false, type: "city", minStringLengthToFetchSuggestion:1,fields:"state,id,stateid", "minStringLengthToDisplaySuggestion":1,displayFields:"value,[ >> ],state",recentData:false\}); \
	document.getElementById('myModal_OrderNow_checkout').style.display = 'none';\
	document.getElementById('myModal_OrderNow_editAddr').style.display = 'flex';\
\
	// save_delivery_address_btn should be gray on opening form\
	if(checkIfAddressFormIsCompletelyEmpty())\
	\{\
		$('#save_delivery_address_btn').css(\{'background': '#ddd', 'border-color': '#ddd', 'cursor': 'not-allowed', 'color': 'gray'\});\
		$('#save_delivery_address_btn').attr('disabled', true);\
	\}\
\
	let city_field = document.getElementById('order_addr_city');\
	city_field.addEventListener('input', function() \{\
		$('#save_delivery_address_btn').css(\{'background': '#ddd', 'border-color': '#ddd', 'cursor': 'not-allowed', 'color': 'gray'\});\
		$('#save_delivery_address_btn').attr('disabled', true);\
	\});\
\}\
\
function timeConversion(s) \{\
    const isPM = s.indexOf('PM') !== -1;\
    let [hours, minutes, seconds] = s.replace(isPM ? 'PM':'AM', '').split(':');\
\
    if (isPM) \{\
        hours = parseInt(hours, 10) + 12;\
        hours = hours === 24 ? 12 : hours;\
    \} else \{\
        hours = parseInt(hours, 10);\
        hours = hours === 12 ? 0 : hours;\
        if (String(hours).length === 1) hours = '0' + hours;\
    \}\
\
    const time = [hours, minutes, seconds].join(':');\
\
    return time;\
\}\
\
function changeQuantity(operator)\{\
	var order_quantity = document.getElementById('checkout_quanity_indicator');\
\
	if(operator == '-' && order_quantity.innerHTML == 1) return; // when user clicks on - and order quantity is 1, nothing should happen\
\
	if(order_quantity.textContent == '' || order_quantity.textContent == '0') // when editable quantity is empty\
	\{\
		document.getElementById('total_order_price').textContent = '0';\
		document.getElementById('total_order_price_hidden').textContent = '0';\
		document.getElementById('total_order_price_decimals').textContent = '.00';\
		return;\
	\}\
\
	if (operator == '-' && order_quantity.innerHTML>1) order_quantity.innerHTML -= 1;\
	else if(operator == '+') order_quantity.innerHTML = parseInt(order_quantity.innerHTML) + 1;\
\
	var price_per_unit = document.getElementById('price_per_piece_ordernow_hidden').innerHTML;\
	document.getElementById('total_order_price_hidden').innerHTML = (price_per_unit * order_quantity.innerHTML).toFixed(2);\
	document.getElementById('total_order_price').innerHTML = (price_per_unit * order_quantity.innerHTML).toFixed(2).split('.')[0];\
	document.getElementById('total_order_price_decimals').innerHTML = `.$\{(price_per_unit * order_quantity.innerHTML).toFixed(2).split('.')[1]\}`;\
\}\
\
\
function formatAMPM(info) \{\
	info = info.split(' ');\
	let date = info[0];\
	let time = info[1].split(':');\
	var hours = time[0];\
	var minutes = time[1];\
	var ampm = hours >= 12 ? 'PM' : 'AM';\
	hours = hours % 12;\
	hours = hours ? hours : 12; // the hour '0' should be '12'\
	minutes = minutes < 10 ? '0'+minutes : minutes;\
	var strTime = hours + ':' + minutes + ' ' + ampm;\
	return date+" "+strTime;\
\}\
  \
Date.prototype.toShortFormat = function() \{\
\
    let monthNames =["Jan","Feb","Mar","Apr",\
                      "May","Jun","Jul","Aug",\
                      "Sep", "Oct","Nov","Dec"];\
    \
    let day = this.getDate();\
    \
    let monthIndex = this.getMonth();\
    let monthName = monthNames[monthIndex];\
    \
    let year = this.getFullYear();\
    \
    return `$\{day\}-$\{monthName\}-$\{year\}`;  \
\}\
function closediv()\{\
	document.getElementById('myModal4').style.display = 'none';\
	document.getElementById('box2').style.display = 'none';\
	if(rating_ppop == 1)\
	\{document.getElementById('es1').style.display = 'block';\
	document.getElementById('supp_rat').style.display = 'none';\
\}\
	else\
	document.getElementById('box1').style.display = 'block';\
\}\
\
\
function hidepopup()\{\
	document.getElementById('es1').style.display = 'block';\
	document.getElementById('supp_rat').style.display = 'none';\
	document.getElementById("myModal5").style.display="none";\
\
\}\
\
function hidepopup2()\{\
	document.getElementById('box1').style.display = 'block';\
	document.getElementById('box2').style.display = 'none';\
	document.getElementById("myModal5").style.display='none';\
\
\}\
\
	var x7,x8=0;\
	function detaching()//function to place the box in model5 i.e outside chat window\
	  \{ \
		  \
		\
		if(document.getElementById("es1").style.display=="block")\
	  \{x8 =1;\}\
		rate_from_popup =1;  \
		$(".fb_ss").css("width", "45%");\
	  document.getElementById("cancel").style.left = '96%';\
	  document.getElementById("textinput").style.left = '26%';\
	  document.getElementById("cancel").onclick = "";\
	  $("#ratingImg").css("display", "block");\
\
	  \
								// body...\
								// var rating_popup = document.getElementById('supp_rat');\
								// if (rating_popup) document.getElementById('chat-section-main').scrollTo(0,rating_popup.offsetTop - 120);\
								if ($('.chat-section')[0].scrollHeight - $('.chat-section').scrollTop() == $('.chat-section').outerHeight())\
				\{  $('#supp_rat').css("display", "block");//pop2\
					$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight);\
				\
				\}\
				else\{\
					$('#supp_rat').css("display", "block");//pop2\
				\}\
								$('#box1').css("display", "none");\
								$('#box2').css(\{"display": "flow-root", "width": "108%"\});\
								$('.get_sup_rat').css("display", "none"); //pop1 \
								$('#supp_rat').css("display", "block"); //pop2\
								$("#confirmSpan").children().css('display', 'block'); //pop3-Submit\
								$("#satisfaction_box").css('display', 'inline-block'); //pop3\
								//$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight + 80);\
								/*vinay*/yandex_impression_my('rating_landing_from_email_click_edit_MY');\
								/*vinay*/yandex_impression_my('rating_landing_from_email_display_impression_new_form');\
							\
	  \
\
	  \
\
	  var cancelButton = document.getElementById('cancel');\
	  cancelButton.setAttribute('onclick',  'attaching();');\
		  x7 = $(".fb_ss").detach();\
	  $("#myModal5").prepend(x7);\
	  $('#rate_txt').text('you are reviewing ');\
	  document.getElementById("myModal5").style.display="block";\
	\}\
	\
	function attaching()//function to fix the rating popup to its original div\
	  \{ rate_from_popup =0;\
		$(".fb_ss").detach();\
		$("#supp_rat").prepend(x7);\
		$(".fb_ss").css("width", "65%");\
		document.getElementById('myModal5').style.display = 'none';\
		document.getElementById('supp_rat').style.display = 'none';\
		document.getElementById("cancel").style.left = '48%';\
		document.getElementById("textinput").style.left = '14%';\
\
\
		if(document.getElementById("is_rating_display").value!='0' ||(document.getElementById("is_rating_display").value=='0'&& x8==1))\
		\{document.getElementById('es1').style.display = 'block';\
		  x8 =0;\}\
		\
		var cancelButton = document.getElementById('cancel');\
		cancelButton.setAttribute('onclick',  "showPayModal('myModal4', '', '', '');"); \
		$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight);\
	\}\
function checksubmit()\{\
	if(document.getElementById('myModal5').style.display = 'block')\{\
		document.getElementById('myModal5').style.display = 'none';\
	\}	\
\}\
\
function place_review_bottom()\{\
	var review_detach = $("#rating_data").detach();\
	$("#input_review").prepend(review_detach);\
\
	$('.chat-section').scrollTop($('.chat-section')[0].scrollHeight);\
\
\}\
\
\
$("#massage-text").on("paste", function()\{\
	if(saved_template_code == null)\
		 \{saved_template_code= 81;\}\
	setTimeout(function() \{\
		var message_content = $('#massage-text').val().trim();\
		if (message_content != "")\{\
			$('.send_button').css(\{\
				'background':'#02887d',\
				'cursor': 'pointer'\
			\});\
		\}\
	\}, 500);\
	\});\
\
\
\
	function addviewmore(total_count)\{\
		setTimeout(function() \{\
var ratee= document.getElementById("p_txtr");\
var buyerprofilevalue = document.getElementById("buyer_pr_dt_new").value;\
\
if(!ratee || buyerprofilevalue=="")\{\
addviewmore(total_count);   \
\}\
else\
\{\
\
	\
		if(cataloglnk && (cataloglnk.includes('indiamart.com') && total_count > 2))\
		\{document.getElementById("p_txtr").innerHTML = `<a href="`+cataloglnk+`testimonial.html#reviewsratings" target="_blank" class="pdinb slvmr">View More Reviews</a>`;\
		 cataloglnk="";\
	\}\
			\
	\
	\
\}\
\}, 1000);\
\}\
\
// To detect if the user is a foreign user or not\
// var ImeshVisitorcookie = readCookie("ImeshVisitor");\
// var phcc_val = getparamVal(ImeshVisitorcookie, "phcc");\
// if(phcc_val == '91')\
// \{\
//     document.querySelector('#massage-text').setAttribute('placeholder', 'Type your message (
\f5 \uc0\u2309 \u2346 \u2344 \u2366 
\f0  
\f5 \uc0\u2360 \u2306 \u2342 \u2375 \u2358 
\f0  
\f5 \uc0\u2354 \u2367 \u2326 \u2375 \u2306 
\f0 ...)'); // set this when user is Indian\
// \}\
\
\
function updateProductISQdetails(displayid)\{\
	document.getElementById("isqdet12").innerHTML = '';\
	document.getElementById("isqdet13").innerHTML = '';\
	console.log('getting product ISQ');\
	console.log(displayid);\
	$.ajax(\{\
		url: '/phpajax/enquiry/messagecentre/ProductIsqs',\
		data : \{ "display_id" : displayid\},\
		\
		\
		type: "POST",\
		/*async: false,*/\
		dataType: "json",\
		success: function (jsonResult) \{\
			console.log(jsonResult);\
			try\{\
				//jsonResult["httpcode"] == 200\
			if(!jsonResult["Status"])\{\
			if(jsonResult[0]["IS_ISQ_FILLED"] && jsonResult[0]["IS_ISQ_FILLED"] == 1)\{\
				isqHtml = '';\
				var isqHtml2 ='';\
				var key = '';\
				var value = '';\
				var t1 = '';\
				var t2 = '';\
				var isqData = jsonResult[0]["ISQ"];\
				if(isqData.length > 4)\{\
					isqHtml += `<table class="isqdet f1 f14" style="width: 47%;"><tbody>`;\
					for(let i=0; i<4; i++)\{\
						key = isqData[i]["FK_IM_SPEC_MASTER_DESC"].length < 15 ? isqData[i]["FK_IM_SPEC_MASTER_DESC"] : isqData[i]["FK_IM_SPEC_MASTER_DESC"].substr(0,13)+'...';\
						value = isqData[i]["SUPPLIER_RESPONSE_DETAIL"].length < 15 ? isqData[i]["SUPPLIER_RESPONSE_DETAIL"] : isqData[i]["SUPPLIER_RESPONSE_DETAIL"].substr(0,13)+'...';\
						t1 = isqData[i]["FK_IM_SPEC_MASTER_DESC"].length < 15 ? '' : String(isqData[i]["FK_IM_SPEC_MASTER_DESC"]);\
						t2 = isqData[i]["SUPPLIER_RESPONSE_DETAIL"].length < 15 ? '' : String(isqData[i]["SUPPLIER_RESPONSE_DETAIL"]);\
						isqHtml += `<tr><td class="fldname colr_isq"><label title="$\{t1\}">$\{key\}</label></td><td class="colon">:</td><td><span class="fldvalue" style="-webkit-box-decoration-break: clone; box-decoration-break: clone; padding-left: 5px;" title="$\{t2\}">$\{value\}</span></td></tr>`;\
					\}\
					isqHtml += `</tbody></table>`;\
					document.getElementById("isqdet12").innerHTML = isqHtml;\
					\
					isqHtml2 += `<table class="isqdet f2 f14" style="width: 33%;"><tbody>`;\
					var k = 0;\
					for(let j=4; j<isqData.length && k<4; j++,k++)\{\
						\
						key = isqData[j]["FK_IM_SPEC_MASTER_DESC"].length < 15 ? isqData[j]["FK_IM_SPEC_MASTER_DESC"] : isqData[j]["FK_IM_SPEC_MASTER_DESC"].substr(0,13)+'...';\
						value = isqData[j]["SUPPLIER_RESPONSE_DETAIL"].length < 18 ? isqData[j]["SUPPLIER_RESPONSE_DETAIL"] : isqData[j]["SUPPLIER_RESPONSE_DETAIL"].substr(0,16)+'...';\
						t1 = isqData[j]["FK_IM_SPEC_MASTER_DESC"].length < 15 ? '' : String(isqData[j]["FK_IM_SPEC_MASTER_DESC"]);\
						t2 = isqData[j]["SUPPLIER_RESPONSE_DETAIL"].length < 15 ? '' : String(isqData[j]["SUPPLIER_RESPONSE_DETAIL"]);\
						isqHtml2 += `<tr><td class="fldname colr_isq"><label title="$\{t1\}">$\{key\}</label></td><td class="colon">:</td><td><span class="fldvalue" style="-webkit-box-decoration-break: clone; box-decoration-break: clone; padding-left: 5px;" title="$\{t2\}">$\{value\}</span></td></tr>`; // added box-decoration-break property so that new lines also get padding-left: 5px\
					\}\
					isqHtml2 += `</tbody></table>`;\
					document.getElementById("isqdet13").innerHTML = isqHtml2;\
				\}else\{\
					isqHtml += `<table class="isqdet f1 f14" style="width: 47%;"><tbody>`;\
					for(let j=0; j<isqData.length; j++)\{\
						key = isqData[j]["FK_IM_SPEC_MASTER_DESC"].length < 15 ? isqData[j]["FK_IM_SPEC_MASTER_DESC"] : isqData[j]["FK_IM_SPEC_MASTER_DESC"].substr(0,13)+'...';\
						value = isqData[j]["SUPPLIER_RESPONSE_DETAIL"].length < 15 ? isqData[j]["SUPPLIER_RESPONSE_DETAIL"] : isqData[j]["SUPPLIER_RESPONSE_DETAIL"].substr(0,13)+'...';\
						t1 = isqData[j]["FK_IM_SPEC_MASTER_DESC"].length < 15 ? '' : String(isqData[j]["FK_IM_SPEC_MASTER_DESC"]);\
						t2 = isqData[j]["SUPPLIER_RESPONSE_DETAIL"].length < 15 ? '' : String(isqData[j]["SUPPLIER_RESPONSE_DETAIL"]);\
						isqHtml += `<tr><td class="fldname colr_isq"><label title="$\{t1\}">$\{key\}</label></td><td class="colon">:</td><td><span class="fldvalue" style="-webkit-box-decoration-break: clone; box-decoration-break: clone; padding-left: 5px;" title='$\{t2\}'>$\{value\}</span></td></tr>`;\
					\}\
					isqHtml += `</tbody></table>`;\
					document.getElementById("isqdet12").innerHTML = isqHtml;\
					\
				\}\
\
			\} \
			\}else\{\
				isqHtml = '';\
			\}   \
		\}catch(err)\{\
			console.log(err);\
			isqHtml = '';\
		\}\
		\}\
	\});\
\}\
\
	// quoted replies \
function openQuotedDiv(event) \{\
	let msg = event.currentTarget.nextElementSibling.textContent;\
	$('#quotedRplyTxtOriginal').text(msg);\
	if(msg.length > 250) \
	\{\
		msg = msg.substring(0, 250);\
		msg = msg + '...';\
	\}\
	$('#quotedRplyTxtOriginal').text(msg);\
	msg =msg.substring(0, 100);\
	msg = msg + '...';\
	$('#quotedRplyTxt').text(msg);\
	$('#quotedRplyDiv').css('display', 'block');\
\}\
\
function closeQuotedDiv() \{\
	$('#quotedRplyDiv').css('display', 'none');\
	$('#quotedRplyTxt').text('');\
\}\
\
function addScrollConv()\{\
\
	var scTop = $('.chat-section').scrollTop();\
	if(scTop == 0)\{\
	console.log('reached');	\
	\}\
\}\
\
function displayusuallyreplies(data)\{\
	var reciever_glid = $('#contactglid').val();\
	var account_glid =  $('#trackid').val();\
	// data= "Usually replies within 5 mins";\
	//s\
\
	if(!data) \
	\
	\{\
		getGAEventTrackingJS("MessageCenter","UsuallyReplies- Not Responsive reciever ",'Reciever_glid :'+reciever_glid+' Account_Glid :'+ account_glid );\
		$('#usually-reply-img').css('display', "none");\
	$('#usuallyreplies1').html('');\
		return;\
	\}\
\
	if(data.includes("replies within 5 mins") || data.includes("replies within 3hrs"))\
    \{\
        getGAEventTrackingJS("MessageCenter","UsuallyReplies- Very responsive reciever ",'Reciever_glid :'+reciever_glid+' Account_Glid :'+ account_glid );\
    \}\
    else if(data.includes("replies within 1 day") ||data.includes("replies within 2 to 3 days")) \
    \{\
		getGAEventTrackingJS("MessageCenter","UsuallyReplies-  responsive reciever ",'Reciever_glid :'+reciever_glid+' Account_Glid :'+ account_glid );\
         \
    \}\
\
\
	$('#usually-reply-img').css('display', "block");\
	$('#usuallyreplies1').html(data);\
\}\
	\
#include<bits/stdc++.h>\
using namespace std;\
\
int tripletSum(int *arr, int n, int num)\
\{\
    sort(arr,arr+n);\
    int count =0;\
    for(int i=0;i<n;i++)\{\
        int newsum = num-arr[i];\
        \
        int smallnoindex =0;\
        int largenoindex = n-1;\
        // cout<<i<<endl;\
        while(smallnoindex<largenoindex ) \{\
            if(smallnoindex == i)\{\
               smallnoindex++;\
                \
            \}\
            else if(largenoindex == i)\{\
                largenoindex--;\
               \
            \}\
            else \
                if(arr[smallnoindex]+arr[largenoindex]== newsum ) \{\
                cout<<i<<" "<<smallnoindex<<" "<<largenoindex<<endl;\
                    smallnoindex++;\
                largenoindex--;\
                // cout<<i<<" "<<smallnoindex<<" "<<largenoindex<<endl;\
                count++;\
               \
            \}\
            \
            else if(arr[smallnoindex]+arr[largenoindex]> newsum)\
            \{ largenoindex--;\
            \}\
            \
            else if(arr[smallnoindex]+arr[largenoindex]< newsum)\
            \{ smallnoindex++;\
            \}\
        \}\
        \
    \}\
 return (count);\
\}}